webpackJsonp(["app/js/activity/live/index"],{c6797855be84e924b7d5:function(t,n,a){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,n){for(var a=0;a<n.length;a++){var e=n[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,a,e){return a&&t(n.prototype,a),e&&t(n,e),n}}(),i=a("da32dea28c2b82c7aab1"),r=function(t){return t&&t.__esModule?t:{default:t}}(i),o=function(){function t(){e(this,t),this.init()}return s(t,[{key:"init",value:function(){var t=this;if("1"!=$("#lesson-live-content").data("hasRoom"))return $("#lesson-live-content").find(".lesson-content-text-body").html("<div class='live-show-item'>\n        <p class='title'>直播说明</p>\n        <p>直播教室尚未创建！</p>\n        </div>"),void $("#lesson-live-content").show();var n=JSON.parse($("#activity-data").html()),a=(parseInt(n.startTime),parseInt(n.endTime)),e=parseInt(n.nowDate);this.liveStartTimeFormat=n.startTimeFormat,this.liveEndTimeFormat=n.endTimeFormat;var s=n.fromCourseId,i=n.id;this.summary=$("#activity-summary").text(),this.$liveNotice='<div class="live-show-item">\n          <p class="title">直播时间</p>\n          <p>直播将于'+this.liveStartTimeFormat+"开始，于"+this.liveEndTimeFormat+"结束<p>\n          (请在课前10分钟内提早进入)\n         </div>",this.iID=null,this.iID&&clearInterval(iID),this.intervalSecond=0,this.entry_url=location.protocol+"//"+location.hostname+"/course/"+s+"/activity/"+i+"/live_entry",this.generateHtml();var r=0;a>e&&(r=1e3),this.iID=setInterval(function(){t.generateHtml()},r),$("#lesson-live-content").show(),this.started=!1}},{key:"entryLiveRoom",value:function(){if(!this.started){this.started=!0;(new r.default).emit("start",{}).then(function(){}).catch(function(t){})}window.open(this.entry_url,"_blank")}},{key:"generateHtml",value:function(){var t=JSON.parse($("#activity-data").text()),n=parseInt(t.startTime),a=parseInt(t.endTime),e=parseInt(t.nowDate);e+=this.intervalSecond;var s=parseInt(n-e),i=parseInt(a-e),r=Math.floor(s/86400),o=s%86400,l=Math.floor(o/3600);o%=3600;var c=Math.floor(o/60),v=o%60,d=Translator.trans("老师们：");1==t.ext.liveProvider?d+=Translator.trans("录制直播课程时，需在直播课程间点击")+"\n          <span class='color-info'>"+Translator.trans("录制面板")+"</span>，"+Translator.trans("，录制完成后点击")+"\n          <span class='color-info'>"+Translator.trans("暂停")+"</span>"+Translator.trans("结束录播，录播结束后在")+"\n          <span class='color-info'>"+Translator.trans("录播管理")+"</span>"+Translator.trans("界面生成回放。")+"。\n        ":d+=Translator.trans("直播平台")+"\n        <span class='color-info'>"+Translator.trans("下课后")+"</span>"+Translator.trans("且")+"\n        <span class='color-info'>"+Translator.trans("直播时间")+"</span>"+Translator.trans("结束后，在课时管理的")+"\n        <span class='color-info'>"+Translator.trans("录播管理")+"</span>"+Translator.trans("点击生成回放。")+"\n        ",d="<div class='live-show-item'>"+d+"</div>";var h=this._getCountDown(r,l,c,v),p="";0<s&&s<7200&&(this.$liveNotice='<div class="live-show-item">\n          <p class="title">直播时间</p>\n          <p>直播将于'+this.liveStartTimeFormat+"开始，于"+this.liveEndTimeFormat+"结束<p>\n          (请在课前10分钟内提早进入)\n         </div>",p="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("进入直播教室")+"\n          </a>\n        </div>",t.isTeacher&&(p+=d)),s<=0&&(clearInterval(this.iID),h="",this.$liveNotice="<div class='live-show-item'>\n          <p class=\"title\">直播时间</p>\n          直播已经开始，直播将于"+this.liveEndTimeFormat+"结束。\n        </div>",p="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("进入直播教室")+"\n          </a>\n        </div>",t.isTeacher&&(p+=d)),i<=0&&(h="",p="",this.$liveNotice="<div class='live-show-item'>\n          <i class='es-icon es-icon-xinxi color-danger icon-live-end'></i>\n          "+Translator.trans("直播已经结束")+"\n        </div>",t.replays&&t.replays.length>0&&($.each(t.replays,function(t,n){p+="<a class='btn btn-primary btn-replays' href='"+n.url+"' target='_blank'>"+n.title+"</a>"}),p="<div class='live-show-item'>"+p+"</div>"));var m=this.$liveNotice+" "+h+"\n      <div class='live-show-item'>\n        <p class='title'>直播说明</p>\n        "+this.summary+"\n      </div>"+p;$("#lesson-live-content").find(".lesson-content-text-body").html(m),this.intervalSecond++}},{key:"_getCountDown",value:function(t,n,a,e){var s="";return s+=t?t+Translator.trans(" 天 "):"",s+=n?n+Translator.trans(" 小时 "):"",s+=a?a+Translator.trans(" 分钟 "):"",s+=e?e+Translator.trans(" 秒 "):"",s="<div class='live-show-item'>\n      <p class='title'>"+Translator.trans("倒计时")+'</p>\n      <span class="color-warning">'+s+"</span>\n    </div>"}}]),t}();n.default=o},d9e0e032c89bc7ecf076:function(t,n,a){"use strict";var e=a("c6797855be84e924b7d5"),s=function(t){return t&&t.__esModule?t:{default:t}}(e);window.liveShow=new s.default}},["d9e0e032c89bc7ecf076"]);