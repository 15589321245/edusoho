{% extends 'layout.html.twig' %}
{% do script(['libs/jquery-validation.js', 'libs/iframe-resizer-contentWindow.js', '//service-cdn.qiqiuyun.net/js-sdk/uploader/sdk-v1.js', 'libs/perfect-scrollbar.js', 'app/js/open-course-manage/lesson-modal-form/index.js']) %}

{% set lesson = lesson|default(null) %}

{% block body %}
  <form class="form-horizontal" id="lesson-create-form">
  
    <div class="form-group" style="display:none;">
      <div class="col-md-2 control-label"><label>{{'类型'|trans}}</label></div>
      <div class="col-md-9 controls">
        <div class="radios">
          <label><input type="radio" name="type" value="video" checked="checked" /> {{'视频'|trans}}</label>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-2 control-label">
      <label for="title" class="control-label-required">{{ '标题名称'|trans }}</label>
      </div>
      <div class="col-sm-10">
        <input id="title" class="form-control" type="text" name="title" value="{{ lesson.title|default('') }}">
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-2 control-label">
        <label for="ext_mediaSource" class="style control-label-required">{{ '视频'|trans }}</label>
      </div>
      <div class="col-sm-10">
        {% include 'file-chooser/file-choose.html.twig' with {mediaType: 'video', fileType:'video', file: lesson.file|default(null), link: lesson.mediaSource|default(null) } %}
        <input type="hidden" id="mediaSource" name="mediaSource"
              value="{{ lesson.mediaSource|default(null) }}">
      </div>
    </div>

    <div class="form-group for-video-type" id="lesson-length-form-group">
      <div class="col-sm-2 control-label for-video-type">
        <label class="control-label-required">{{ '视频时长'|trans }}</label>
      </div>
      <div class="col-sm-10">
        <input class="form-control width-150 js-length" id="minute" type="text" name="minute"
              value="{{ lesson.minute|default(null) }}">
        <span class="mhs">{{ '分'|trans }}</span>
        <input
            class="form-control width-150 js-length" id="second" type="text" name="second"
            value="{{ lesson.second|default(null) }}">
        <span class="mhs">{{ '秒'|trans }}</span>
        <input type="hidden" id="mediaId" name="mediaId" value="{{ lesson.mediaId|default(null) }}">
        <input type="hidden" id="mediaUri" name="mediaUri" value="{{ lesson.mediaUri|default(null) }}">
        <input type="hidden" id="length" name="length" value="{{ lesson.length|default(0) }}">
      </div>
    </div>

    {% if setting('storage.upload_mode', 'local') == 'cloud' and lesson.mediaSource|default('self') == 'self' %}
      <div class="form-group for-video-subtitle" id="video-subtitle-form-group">
        <div class="col-sm-2 control-label for-video-subtitle">
          <label class="control-label">{{ '视频字幕'|trans }}</label>
        </div>

        <div class="col-sm-10 controls js-subtitle-list" data-dialog-url="{{ path('media_subtitle_manage_dialog') }}">
          <p style="margin-top:6px;color:#a1a1a1">请等待视频上传完之后再添加字幕</p>
        </div>
        <div class="col-sm-offset-2 help-block">
          <p style="margin-left:10px;">字幕文件暂时仅支持UTF-8编码的srt文件，点击<a href="http://www.qiqiuyu.com/article/883" target="__blank">查看</a>编码转换说明。</p>
        </div>

        <input id="ext_mediaId_for_subtitle" class="form-control" type="hidden" value={{ lesson.mediaId|default(null) }}>
      </div>
    {% endif %}

    
    <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
  </form>
{% endblock %}