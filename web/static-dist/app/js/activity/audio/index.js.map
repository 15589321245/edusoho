{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity/audio/audio-recorder.js","webpack:///./app/Resources/static-src/app/js/activity/audio/audio.js","webpack:///./app/Resources/static-src/app/js/activity/audio/index.js"],"names":["AudioRecorder","container","interval","emitter","player","$container","$","activityId","data","playerCounter","store","get","playing","emit","watchTime","then","catch","error","console","set","AudioPlay","elment","recorder","dom","intervalId","setInterval","addAudioPlayerCounter","messenger","name","project","children","type","on","msg","_onFinishLearnTask","record","log","audioPlay","play"],"mappings":"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","file":"app/js/activity/audio/index.js","sourcesContent":["import 'store';\n\nexport default class AudioRecorder {\n  constructor(container) {\n    this.container = container;\n    this.interval = 120;\n  }\n\n  addAudioPlayerCounter(emitter, player) {\n    let $container = $(this.container);\n    let activityId = $container.data('id');\n    let playerCounter = store.get(\"activity_id_\" + activityId + \"_playing_counter\");\n    if (!playerCounter) {\n      playerCounter = 0;\n    }\n    if (!(player && player.playing)) {\n      return false;\n    }\n    if (playerCounter >= this.interval) {\n      emitter.emit('watching', {watchTime: this.interval}).then(() => {\n      }).catch((error) => {\n        console.error(error);\n      });\n      playerCounter = 0;\n    } else if (player.playing) {\n      playerCounter++;\n    }\n    store.set(\"activity_id_\" + activityId + \"_playing_counter\", playerCounter);\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/audio/audio-recorder.js","import EsMessenger from '../../../common/messenger';\nimport ActivityEmitter from '../activity-emitter';\n\nexport default class AudioPlay {\n  constructor(elment, recorder) {\n    this.dom = $(elment);\n    this.data = this.dom.data();\n    this.recorder = recorder;\n    this.player = {};\n    this.emitter = new ActivityEmitter();\n  }\n\n  record() {\n    this.intervalId = setInterval(() => {\n      this.recorder.addAudioPlayerCounter(this.emitter, this.player);\n    }, 1000);\n  }\n\n  play() {\n    var messenger = new EsMessenger({\n      name: 'partner',\n      project: 'PlayerProject',\n      children: [],\n      type: 'parent'\n    });\n\n    messenger.on(\"ended\", (msg) => {\n      this.player.playing = false;\n      this._onFinishLearnTask(msg);\n    });\n\n    messenger.on(\"playing\", (msg) => {\n      this.player.playing = true;\n    });\n\n    messenger.on(\"paused\", (msg) => {\n      this.player.playing = false;\n    });\n\n    messenger.on(\"timechange\", (msg) => {})\n\n    this.record();\n  }\n\n  _onFinishLearnTask(msg) {\n    this.emitter.emit('finish', { data: msg }).then(() => {\n      console.log('audio.finish');\n    }).catch((error) => {\n      console.error(error);\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/audio/audio.js","import AudioPlay from './audio';\nimport AudioRecorder from './audio-recorder';\n\nlet recorder = new AudioRecorder('#audio-content');\nlet audioPlay = new AudioPlay('#audio-content', recorder);\naudioPlay.play();\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/audio/index.js"],"sourceRoot":""}