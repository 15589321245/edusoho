{% extends 'TopxiaWebBundle::bootstrap-modal-layout.html.twig' %}

{% block title %}公告
	{% if canManage %}
		<a href="#modal" data-url="{{ path('announcement_add',{targetType:targetType, targetId:targetId}) }}" data-toggle="modal" class="es-icon es-icon-anonymous-iconfont annoucement-add-btn"></a>
	{% endif %}
{% endblock %}

{% block body %}
	<div class="announcement-list">
	{% if announcements %}
		{% for announcement in announcements %}
        <div class="alert alert-default alert-edit" role="alert" id="announcement-list-{{ announcement.id }}">
          <a href="javascript:;" class="click"><i class="es-icon {% if announcement.id == currentId %}es-icon-keyboardarrowdown{% else %}es-icon-chevronright{% endif %}"></i></a>
          <span class="title">
            {{ announcement.content|plain_text(40) }}
          </span>

          {% if canManage %}
	          <span class="editor">
	            <a data-target="#modal"  data-toggle="modal" data-url="{{ path('announcement_update',{id:announcement.id, targetType:targetType,  targetId:targetId}) }}"><i class="es-icon es-icon-edit" data-toggle="tooltip" data-placement="top" title="" data-original-title="编辑"></i></a>
	            <a href="javascript:;" data-role="delete" data-url="{{ path('announcement_delete',{id:announcement.id, targetType:targetType, targetId:targetId}) }}"><i class="es-icon es-icon-delete ml10" data-toggle="tooltip" data-placement="top" title="" data-original-title="删除"></i></a>
	          </span>
	          <div class="details" {% if announcement.id == currentId %}style="display: block;"{% endif %}>
	            {{ announcement.content|striptags }}
	          </div>
          {% else %}
	          <div class="details" {% if announcement.id == currentId %}style="display: block;"{% endif %}>
	            {{ announcement.content|striptags }}
	          </div>
        	{% endif %}
        </div>
  	{% endfor %}    
  {% else %}
		<div class="alert alert-edit">暂无公告</div>
	{% endif %}
</div>
	<script>
		app.load('announcement/announcement');
	</script>

{% endblock %}