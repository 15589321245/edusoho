{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"names":["Exercise","$form","$element","_setValidateRule","_init","_initEvent","_inItStep2form","$step2_form","$","validator","validate","rules","title","required","maxlength","trim","itemCount","positiveInteger","min","max","range","difficulty","messages","remote","data","$step3_form","onkeyup","finishCondition","addMethod","value","element","optional","test","format","change","url","checkQuestionNum","courseId","val","lessonId","post","text","attr","each","i","n","questionNum","closest","find"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nclass Exercise {\n\tconstructor($form) {\n\t\tthis.$element = $form;\n\t\tthis._setValidateRule();\n    this._init();\n    this._initEvent();\n  }\n\n  _init() {\n    this._inItStep2form();\n  }\n\n  _initEvent() {\n  }\n\n  _inItStep2form() {\n    let $step2_form = $(\"#step2-form\");\n    let validator = $step2_form.validate({\n        rules: {\n          title: {\n            required:true,\n            maxlength: 50,\n            trim: true,\n          },\n          itemCount: {\n            required: true,\n            positiveInteger:true,\n            min: 1,\n            max: 9999\n          },\n          range:{\n          \trequired:true,\n          },\n          difficulty:{\n          \trequired:true\n          },\n          \n        },\n        messages: {\n          required:\"请填写标题\",\n          range: \"题目来源\",\n          itemCount: {\n            required: '请填写题目个数',\n            positiveInteger: '请输入正整数',\n            min: '题目个数无效',\n            max: '题目个数过大'\n          },\n          difficulty: \"请选择难易程度\",\n          'questionTypes[]': {\n            required:\"请选择题型\",\n            remote:\"题目数量不足\"\n          },\n        }\n    });\n\n    /*if (validator.form()) {\n      $('input[namae=\"checkQuestion\"]').rules('add',{\n        required:true,\n        remote:{\n          url: $('input[namae=\"checkQuestion\"]').data('checkUrl'),     \n          type: 'post',               \n          dataType: 'json',           \n          data: $step2_form.serialize(),\n          success:function(response){\n            console.log(response);\n          }\n        }\n      })\n    }*/\n\n    $step2_form.data('validator',validator);\n  }\n\n  _inItStep3form() {\n    var $step3_form = $(\"#step3-form\");\n    var validator = $step3_form.validate({\n        onkeyup: false,\n        rules: {\n            finishCondition: {\n                required: true,\n            },\n        },\n        messages: {\n            finishCondition: \"请输完成条件\",\n        }\n    });\n    $step3_form.data('validator',validator);\n  }\n\n  _setValidateRule() {\n    $.validator.addMethod(\"positiveInteger\",function(value,element){  \n\t\t  return this.optional( element ) || /^[1-9]\\d*$/.test(value);\n\t\t}, $.validator.format(\"必须为正整数\"));\n\n  }\n}\n\nnew Exercise($('#step2-form'));\nnew SelectLinkage($('[name=\"range[courseId]\"]'),$('[name=\"range[lessonId]\"]'));\n\n$('[name=\"range[courseId]\"]').change(function(){\n  let url = $(this).data('checkNumUrl');\n  checkQuestionNum(url);\n})\n\n$('[name=\"range[lessonId]\"]').change(function(){\n  let url = $(this).data('checkNumUrl');\n  checkQuestionNum(url);\n})\n\n$('[name=\"difficulty\"]').change(function(){\n  let url = $(this).data('checkNumUrl');\n  checkQuestionNum(url);\n})\n\nfunction checkQuestionNum(url) {\n  let courseId = $('[name=\"range[courseId]\"]').val();\n  let lessonId = $('[name=\"range[lessonId]\"]').val();\n  let difficulty = $('[name=\"difficulty\"]').val();\n\n  $.post(url,{courseId:courseId, lessonId:lessonId, difficulty:difficulty},function(data){\n    $('[role=\"questionNum\"]').text(0);\n    $('input[type=\"checkbox\"]').attr({'disabled':true,'checked':false});\n\n    $.each(data,function(i,n){\n      $(\"[type='\"+i+\"']\").text(n.questionNum);\n      $(\"[type='\"+i+\"']\").closest('.js-question-type').find('input[type=\"checkbox\"]').attr('disabled',false);\n    });\n  })\n}\n"]}