{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/help.js"],"names":["taskSortable","$","length","sortable","element","ajax","data","console","log","post","ids","response","lessonNum","chapterNum","unitNum","find","each","$item","hasClass","text","courseFunctionRemask","COURSE_FUNCTION_REMASK","store","get","set","modal","closeCourse","on","evt","$target","currentTarget","confirm","Translator","trans","warn","message","success","location","reload","sortList","document","deleteCourse","publishCourse","target","deleteTask","parents","remove","publishTask","event","unpublishTask","showSettings","$list","delegateTarget","$this","closest","removeClass","slideUp","addClass","slideDown","TabChange","click","siblings"],"mappings":"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","file":"help.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport 'jquery-sortable';\nimport 'store';\n\nexport const taskSortable = ()=> {\n  if ($('#sortable-list').length) {\n  sortable({\n    element: '#sortable-list',\n    ajax: false,\n  }, (data) => {\n    console.log(data);\n    $.post($('#sortable-list').data('sortUrl'), { ids: data }, (response) => {\n      let lessonNum = 0,\n        chapterNum = 0,\n        unitNum = 0;\n      $('#sortable-list').find('.task-manage-item').each(function () {\n        var $item = $(this);\n        if ($item.hasClass('js-task-manage-item')) {\n          lessonNum++;\n          $item.find('.number').text(lessonNum);\n        } else if ($item.hasClass('task-manage-unit')) {\n          unitNum++;\n          $item.find('.number').text(unitNum);\n        } else if ($item.hasClass('task-manage-chapter')) {\n          chapterNum++;\n          unitNum = 0;\n          $item.find('.number').text(chapterNum);\n        }\n      });\n    });\n  });\n}\n\n}\n\nexport const courseFunctionRemask = () => {\n  const COURSE_FUNCTION_REMASK = 'COURSE-FUNCTION-REMASK'; //课程改版功能提醒\n  if (!store.get(COURSE_FUNCTION_REMASK)) {\n    store.set(COURSE_FUNCTION_REMASK, true);\n    $('#course-function-modal').modal('show');\n  }\n}\n\nexport const closeCourse = () => {\n  $('body').on('click', '.js-close-course', function (evt) {\n    let $target = $(evt.currentTarget);\n    if (!confirm(Translator.trans('是否确定关闭该教学计划？'))) {\n      return;\n    }\n\n    $.post($target.data('check-url'), function (data) {\n\n      if (data.warn) {\n        if (!confirm(Translator.trans(data.message))) {\n          return;\n        }\n      }\n\n      $.post($target.data('url'), function (data) {\n        if (data.success) {\n          notify('success', '关闭成功');\n          location.reload();\n        } else {\n          notify('danger', '关闭失败：' + data.message);\n        }\n      });\n    });\n  });\n};\n\nexport const sortList = (element = '#sortable-list') => {\n  let data = $(element).sortable(\"serialize\").get();\n  $.post($(element).data('sortUrl'), { ids: data }, (response) => {\n    if (response) {\n      document.location.reload();\n    }\n  });\n};\n\nexport const deleteCourse = () => {\n  $('body').on('click', '.js-delete-course', function (evt) {\n    if (!confirm(Translator.trans('是否确定删除该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.currentTarget).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        location.reload();\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishCourse = () => {\n  $('body').on('click', '.js-publish-course', function (evt) {\n    if (!confirm(Translator.trans('是否确定发布该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.target).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '发布成功');\n        location.reload();\n      } else {\n        notify('danger', '发布失败：' + data.message, 5000);\n      }\n    });\n  });\n};\n\nexport const deleteTask = () => {\n  $('body').on('click', '.delete-item', function (evt) {\n    if ($(evt.currentTarget).data('type') == 'task') {\n      if (!confirm(Translator.trans('是否确定删除该任务吗？'))) {\n        return;\n      }\n    } else if ($(evt.currentTarget).data('type') == 'chapter') {\n      if (!confirm(Translator.trans('是否确定删除该章节吗？'))) {\n        return;\n      }\n    }\n    $.post($(evt.currentTarget).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        $(evt.target).parents('.task-manage-item').remove();\n        sortList();\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishTask = () => {\n  $('body').on('click', '.publish-item', (event) => {\n    $.post($(event.target).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '发布成功');\n        location.reload();\n      } else {\n        notify('danger', '发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const unpublishTask = () => {\n  $('body').on('click', '.unpublish-item', (event) => {\n    $.post($(event.target).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '取消发布成功');\n        location.reload();\n      } else {\n        notify('danger', '取消发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const showSettings = () => {\n  $(\"#sortable-list\").on('click', '.js-item-content', event => {\n    let $list = $(event.delegateTarget);\n    let $this = $(event.currentTarget).closest('.js-task-manage-item');\n    if ($this.hasClass('active')) {\n      $this.removeClass('active').find('.js-settings-list').slideUp();\n    } else {\n      $list.find(\".js-task-manage-item.active\").removeClass('active').find('.js-settings-list').slideUp();\n      $this.addClass('active').find('.js-settings-list').slideDown();\n    }\n  });\n};\n\nexport const TabChange = () => {\n  $('[data-role=\"tab\"]').click(function (event) {\n    let $this = $(this);\n    $($this.data('tab-content')).removeClass(\"hidden\").siblings('[data-role=\"tab-content\"]').addClass('hidden');\n  });\n};"]}