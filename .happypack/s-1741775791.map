{"version":3,"sources":["app/Resources/static-src/app/js/player/util/duration-storage.js"],"names":["DurationStorage","userId","fileId","duration","durations","store","get","Array","value","length","slice","indexOf","splice","shift","push","set","durationTmpArray","i","index","key","parseFloat","split"],"mappings":";;;;;;qjBAAA;;;;;AAGA;;;;IAEMA,e;;;;;;;wBAEOC,M,EAAQC,M,EAAQC,Q,EAAU;AACnC,UAAIC,YAAYC,MAAMC,GAAN,CAAU,WAAV,EAAuB,EAAvB,CAAhB;AACA,UAAI,CAACF,SAAD,IAAc,EAAEA,qBAAqBG,KAAvB,CAAlB,EAAiD;AAC/CH,oBAAY,IAAIG,KAAJ,EAAZ;AACD;;AAED,UAAIC,QAAQP,SAAS,GAAT,GAAeC,MAAf,GAAwB,GAAxB,GAA8BC,QAA1C;AACA,UAAIC,UAAUK,MAAV,GAAmB,CAAnB,IAAwBL,UAAUM,KAAV,CAAgBN,UAAUK,MAAV,GAAmB,CAAnC,EAAsCL,UAAUK,MAAhD,EAAwD,CAAxD,EAA2DE,OAA3D,CAAmEV,SAAS,GAAT,GAAeC,MAAlF,IAA4F,CAAC,CAAzH,EAA4H;AAC1HE,kBAAUQ,MAAV,CAAiBR,UAAUK,MAAV,GAAmB,CAApC,EAAuCL,UAAUK,MAAjD;AACD;AACD,UAAIL,UAAUK,MAAV,IAAoB,EAAxB,EAA4B;AAC1BL,kBAAUS,KAAV;AACD;AACDT,gBAAUU,IAAV,CAAeN,KAAf;AACAH,YAAMU,GAAN,CAAU,WAAV,EAAuBX,SAAvB;AACD;;;wBAEUH,M,EAAQC,M,EAAQ;AACzB,UAAIc,mBAAmBX,MAAMC,GAAN,CAAU,WAAV,EAAuB,EAAvB,CAAvB;AACA,UAAIU,gBAAJ,EAAsB;AACpB,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAID,iBAAiBP,MAArC,EAA6CQ,GAA7C,EAAkD;AAChD,cAAIC,QAAQF,iBAAiBC,CAAjB,EAAoBN,OAApB,CAA4BV,SAAS,GAAT,GAAeC,MAA3C,CAAZ;AACA,cAAIgB,QAAQ,CAAC,CAAb,EAAgB;AACd,gBAAIC,MAAMH,iBAAiBC,CAAjB,CAAV;AACA,mBAAOG,WAAWD,IAAIE,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAX,IAAgC,CAAvC;AACD;AACF;AACF;AACD,aAAO,CAAP;AACD;;;wBAEUpB,M,EAAQC,M,EAAQ;AACzB,UAAIiB,MAAMlB,SAAS,GAAT,GAAeC,MAAzB;AACA,UAAIc,mBAAmBX,MAAMC,GAAN,CAAU,WAAV,CAAvB;AACA,WAAK,IAAIW,IAAI,CAAb,EAAgBA,IAAID,iBAAiBP,MAArC,EAA6CQ,GAA7C,EAAkD;AAChD,YAAIC,QAAQF,iBAAiBC,CAAjB,EAAoBN,OAApB,CAA4BV,SAAS,GAAT,GAAeC,MAA3C,CAAZ;AACA,YAAIgB,QAAQ,CAAC,CAAb,EAAgB;AACdF,2BAAiBJ,MAAjB,CAAwBK,CAAxB,EAA2B,CAA3B;AACD;AACF;AACDZ,YAAMU,GAAN,CAAU,WAAV,EAAuBC,gBAAvB;AACD;;;;;;kBAGYhB,e","file":"duration-storage.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["/**\n * Created by Simon on 2016/11/18.\n */\nimport 'store';\n\nclass DurationStorage {\n\n  static set(userId, fileId, duration) {\n    var durations = store.get(\"durations\", {});\n    if (!durations || !(durations instanceof Array)) {\n      durations = new Array();\n    }\n\n    var value = userId + \"-\" + fileId + \":\" + duration;\n    if (durations.length > 0 && durations.slice(durations.length - 1, durations.length)[0].indexOf(userId + \"-\" + fileId) > -1) {\n      durations.splice(durations.length - 1, durations.length);\n    }\n    if (durations.length >= 20) {\n      durations.shift();\n    }\n    durations.push(value);\n    store.set(\"durations\", durations);\n  }\n\n  static get(userId, fileId) {\n    var durationTmpArray = store.get(\"durations\", {});\n    if (durationTmpArray) {\n      for (var i = 0; i < durationTmpArray.length; i++) {\n        var index = durationTmpArray[i].indexOf(userId + \"-\" + fileId);\n        if (index > -1) {\n          var key = durationTmpArray[i];\n          return parseFloat(key.split(\":\")[1]) - 5;\n        }\n      }\n    }\n    return 0;\n  }\n\n  static del(userId, fileId) {\n    var key = userId + \"-\" + fileId;\n    var durationTmpArray = store.get(\"durations\");\n    for (var i = 0; i < durationTmpArray.length; i++) {\n      var index = durationTmpArray[i].indexOf(userId + \"-\" + fileId);\n      if (index > -1) {\n        durationTmpArray.splice(i, 1);\n      }\n    }\n    store.set(\"durations\", durationTmpArray);\n  }\n}\n\nexport default DurationStorage;\n"]}