{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/course-manage-file/index/index.js"],"names":["$panel","$","on","console","log","post","data","response","status","alert","message","window","location","reload","fail","Translator","trans","tooltip","modal","backdrop","keyboard","show","url","html","get","asyncLoadFiles","click","flag","ids","each","is","push","value","load","fileIds","Array","isNaN","val","length","join","i","file","inArray","type","storage","convertStatus","id","find","after","metas2","shd","hd","sd","metas","caption"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,KAAIA,SAASC,EAAE,oBAAF,CAAb;AACA,2BAAgBD,MAAhB;;AAEAA,QAAOE,EAAP,CAAU,OAAV,EAAmB,mBAAnB,EAAwC,YAAY;AAClDC,WAAQC,GAAR,CAAY,IAAZ;AACAH,KAAEI,IAAF,CAAOJ,EAAE,IAAF,EAAQK,IAAR,CAAa,KAAb,CAAP,EAA4B,UAAUC,QAAV,EAAoB;AAC9C,SAAIA,SAASC,MAAT,IAAmB,OAAvB,EAAgC;AAC9BC,aAAMF,SAASG,OAAf;AACD,MAFD,MAEO;AACLC,cAAOC,QAAP,CAAgBC,MAAhB;AACD;AACF,IAND,EAMG,MANH,EAMWC,IANX,CAMgB,YAAY;AAC1BL,WAAMM,WAAWC,KAAX,CAAiB,kCAAjB,CAAN;AACD,IARD;AASD,EAXD;;AAaAf,GAAE,MAAF,EAAUgB,OAAV;;AAEAhB,GAAE,QAAF,EAAYiB,KAAZ,CAAkB;AAChBC,aAAU,QADM;AAEhBC,aAAU,KAFM;AAGhBC,SAAM;AAHU,EAAlB;;AAMApB,GAAE,QAAF,EAAY,gBAAZ,EAA8BC,EAA9B,CAAiC,OAAjC,EAA0C,YAAY;AACpD,OAAIoB,MAAMrB,EAAE,IAAF,EAAQK,IAAR,CAAa,KAAb,CAAV;AACAL,KAAE,QAAF,EAAYsB,IAAZ,CAAiB,EAAjB;AACAtB,KAAE,QAAF,EAAYiB,KAAZ,CAAkB,MAAlB;AACAjB,KAAEuB,GAAF,CAAMF,GAAN,EAAW,UAAUC,IAAV,EAAgB;AACzBtB,OAAE,QAAF,EAAYsB,IAAZ,CAAiBA,IAAjB;AACD,IAFD;AAGD,EAPD;;AASAtB,GAAE,iBAAF,EAAqBgB,OAArB;;AAEAQ;;AAEAxB,GAAE,0BAAF,EAA8ByB,KAA9B,CAAoC,YAAY;AAC9C,OAAIC,OAAO,KAAX;AACA,OAAIC,MAAM,EAAV;AACA3B,KAAE,wBAAF,EAA4B4B,IAA5B,CAAiC,YAAY;AAC3C,SAAI5B,EAAE,IAAF,EAAQ6B,EAAR,CAAW,UAAX,CAAJ,EAA4B;AAC1BH,cAAO,IAAP;AACAC,WAAIG,IAAJ,CAAS,KAAKC,KAAd;AACD;AACF,IALD;;AAOA,OAAIL,IAAJ,EAAU;AACR1B,OAAE,QAAF,EAAYsB,IAAZ,CAAiB,EAAjB;AACAtB,OAAE,QAAF,EAAYgC,IAAZ,CAAiBhC,EAAE,IAAF,EAAQK,IAAR,CAAa,KAAb,CAAjB,EAAsC,EAAEsB,KAAKA,GAAP,EAAtC;AACA3B,OAAE,QAAF,EAAYiB,KAAZ,CAAkB,MAAlB;AACD,IAJD,MAIO;AACL,2BAAO,QAAP,EAAgBH,WAAWC,KAAX,CAAiB,gCAAjB,CAAhB;AACA;AACD;AACF,EAlBD;;AAoBA,UAASS,cAAT,GAA0B;AACxB,OAAIS,UAAU,IAAIC,KAAJ,EAAd;AACAlC,KAAE,uBAAF,EAA2B4B,IAA3B,CAAgC,YAAY;AAC1C,SAAI,CAACO,MAAMnC,EAAE,IAAF,EAAQoC,GAAR,EAAN,CAAL,EAA2B;AACzBH,eAAQH,IAAR,CAAa9B,EAAE,IAAF,EAAQoC,GAAR,EAAb;AACD;AACF,IAJD;;AAMA,OAAIH,QAAQI,MAAR,IAAkB,CAAtB,EAAyB;AACvB;AACD;;AAEDrC,KAAEI,IAAF,CAAOJ,EAAE,oBAAF,EAAwBK,IAAxB,CAA6B,eAA7B,CAAP,EAAsD,EAAE,OAAO4B,QAAQK,IAAR,CAAa,GAAb,CAAT,EAAtD,EAAoF,UAAUjC,IAAV,EAAgB;AAClG,SAAI,CAACA,IAAD,IAASA,KAAKgC,MAAL,IAAe,CAA5B,EAA+B;AAC7B;AACD;;AAED,UAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAIlC,KAAKgC,MAAzB,EAAiCE,GAAjC,EAAsC;AACpC,WAAIC,OAAOnC,KAAKkC,CAAL,CAAX;AACA,WAAIvC,EAAEyC,OAAF,CAAUD,KAAKE,IAAf,EAAqB,CAAC,OAAD,EAAU,KAAV,EAAiB,UAAjB,CAArB,IAAqD,CAAC,CAAtD,IAA4DF,KAAKG,OAAL,IAAgB,OAAhF,EAAyF;AACvF,aAAIH,KAAKI,aAAL,IAAsB,SAAtB,IAAmCJ,KAAKI,aAAL,IAAsB,OAA7D,EAAsE;AACpE5C,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,6CAA6CjC,WAAWC,KAAX,CAAiB,8BAAjB,CAA7C,GAAgG,cAAjK;AACD,UAFD,MAEO,IAAIyB,KAAKI,aAAL,IAAsB,OAA1B,EAAmC;AACxC5C,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,4CAA4CjC,WAAWC,KAAX,CAAiB,kCAAjB,CAA5C,GAAmG,cAApK;AACD,UAFM,MAEA,IAAIyB,KAAKI,aAAL,IAAsB,MAA1B,EAAkC;AACvC5C,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,mBAArC,EAA0DC,KAA1D,CAAgE,+CAA+CjC,WAAWC,KAAX,CAAiB,+BAAjB,CAA/C,GAAmG,SAAnK;AACD,UAFM,MAEA,IAAIyB,KAAKI,aAAL,IAAsB,SAA1B,EAAqC;AAC1C5C,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,mBAArC,EAA0DC,KAA1D,CAAgE,+CAA+CjC,WAAWC,KAAX,CAAiB,6BAAjB,CAA/C,GAAiG,SAAjK;AACD;AAEF;AACD,WAAIyB,KAAKE,IAAL,IAAa,OAAb,IAAwBF,KAAKQ,MAAjC,EAAyC;AACvC,aAAIR,KAAKQ,MAAL,CAAYC,GAAhB,EAAqB;AACnBjD,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,4CAA4CjC,WAAWC,KAAX,CAAiB,uBAAjB,CAA5C,GAAwF,SAAzJ;AACD,UAFD,MAEO,IAAIyB,KAAKQ,MAAL,CAAYE,EAAhB,EAAoB;AACzBlD,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,4CAA4CjC,WAAWC,KAAX,CAAiB,uBAAjB,CAA5C,GAAwF,SAAzJ;AACD,UAFM,MAEA,IAAIyB,KAAKQ,MAAL,CAAYG,EAAhB,EAAoB;AACzBnD,aAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,4CAA4CjC,WAAWC,KAAX,CAAiB,uBAAjB,CAA5C,GAAwF,SAAzJ;AACD;AACF;;AAED,WAAIyB,KAAKE,IAAL,IAAa,OAAb,IAAwBF,KAAKY,KAA7B,IAAsCZ,KAAKY,KAAL,CAAWC,OAArD,EAA8D;AAC5DrD,WAAE,qBAAqBwC,KAAKK,EAA5B,EAAgCC,IAAhC,CAAqC,oBAArC,EAA2DC,KAA3D,CAAiE,2CAA2CjC,WAAWC,KAAX,CAAiB,6BAAjB,CAA3C,GAA6F,SAA9J;AACD;AACF;AACF,IAjCD;AAkCD,E","file":"app/js/course-manage-file/index/index.js","sourcesContent":["import notify from 'common/notify';\nimport BatchSelect from 'app/common/widget/batch-select';\n\nvar $panel = $('#file-manage-panel');\nnew BatchSelect($panel);\n\n$panel.on('click', '.convert-file-btn', function () {\n  console.log('re');\n  $.post($(this).data('url'), function (response) {\n    if (response.status == 'error') {\n      alert(response.message);\n    } else {\n      window.location.reload();\n    }\n  }, 'json').fail(function () {\n    alert(Translator.trans('alert.file_convert_error.message'));\n  });\n});\n\n$('.tip').tooltip();\n\n$(\"#modal\").modal({\n  backdrop: 'static',\n  keyboard: false,\n  show: false\n});\n\n$(\"button\", \".panel-heading\").on('click', function () {\n  var url = $(this).data(\"url\");\n  $(\"#modal\").html('');\n  $(\"#modal\").modal('show');\n  $.get(url, function (html) {\n    $(\"#modal\").html(html);\n  });\n})\n\n$(\"[rel='tooltip']\").tooltip();\n\nasyncLoadFiles();\n\n$('[data-role=batch-delete]').click(function () {\n  var flag = false;\n  var ids = [];\n  $('[data-role=batch-item]').each(function () {\n    if ($(this).is(\":checked\")) {\n      flag = true;\n      ids.push(this.value);\n    }\n  })\n\n  if (flag) {\n    $('#modal').html('');\n    $('#modal').load($(this).data('url'), { ids: ids });\n    $('#modal').modal('show');\n  } else {\n    notify('danger',Translator.trans('notify.file_not_select.message'));\n    return;\n  }\n})\n\nfunction asyncLoadFiles() {\n  var fileIds = new Array();\n  $('tbody [type=checkbox]').each(function () {\n    if (!isNaN($(this).val())) {\n      fileIds.push($(this).val());\n    }\n  });\n\n  if (fileIds.length == 0) {\n    return;\n  }\n\n  $.post($(\"#file-manage-panel\").data(\"fileStatusUrl\"), { 'ids': fileIds.join(\",\") }, function (data) {\n    if (!data || data.length == 0) {\n      return;\n    }\n\n    for (var i = 0; i < data.length; i++) {\n      var file = data[i];\n      if ($.inArray(file.type, ['video', 'ppt', 'document']) > -1 &&  file.storage == 'cloud') {\n        if (file.convertStatus == 'waiting' || file.convertStatus == 'doing') {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after(\"<span class='color-warning mr5 text-sm'>\" + Translator.trans('page.file_converting.message') + \"</span><br/>\");\n        } else if (file.convertStatus == 'error') {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after(\"<span class='color-danger mr5 text-sm'>\" + Translator.trans('page.file_convert_failed.message') + \"</span><br/>\");\n        } else if (file.convertStatus == 'none') {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:last').after(\"<span class='label label-default mr5 tip'>\" + Translator.trans('page.file_not_convert.message') + \"</span>\");\n        } else if (file.convertStatus == 'success') {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:last').after(\"<span class='label label-success mr5 tip'>\" + Translator.trans('page.file_converted.message') + \"</span>\");\n        }\n\n      }\n      if (file.type == 'video' && file.metas2) {\n        if (file.metas2.shd) {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after('<span class=\"label label-info mr5 tip\">' + Translator.trans('page.video_sd.message') + '</span>');\n        } else if (file.metas2.hd) {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after('<span class=\"label label-info mr5 tip\">' + Translator.trans('page.video_hd.message') + '</span>');\n        } else if (file.metas2.sd) {\n          $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after('<span class=\"label label-info mr5 tip\">' + Translator.trans('page.video_sd.message') + '</span>');\n        }\n      }\n\n      if (file.type == 'video' && file.metas && file.metas.caption) {\n        $(\"#upload-file-tr-\" + file.id).find('a:first ~ br:first').after('<span class=\"label label-primary tip\">' + Translator.trans('page.video_subtitle.message') + '</span>');\n      }\n    }\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/course-manage-file/index/index.js"],"sourceRoot":""}