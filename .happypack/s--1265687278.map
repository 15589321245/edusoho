{"version":3,"sources":["app/Resources/static-src/app/js/classroom-manage/set-info/index.js"],"names":["editor_classroom_about","CKEDITOR","replace","allowedContent","toolbar","filebrowserImageUploadUrl","$","data","filebrowserFlashUploadUrl","select2","treeview","dropdownAutoWidth","treeviewInitState","placeholderOption","validator","validate","onkeyup","rules","title","required","initDatePicker","change","val","removeClass","addClass","click","form","toggleExpiryValue","app","arguments","classroomStatus","expiryValue","match","$esBlock","text","expiryMode","datetimepicker","language","autoclose","format","minView","Date","$id","$picker","endDate","now"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport 'common/select2';\nimport 'app/js/classroom-manage/classroom-create';\n\nlet editor_classroom_about = CKEDITOR.replace('about', {\n    allowedContent: true,\n    toolbar: 'Detail',\n    filebrowserImageUploadUrl: $('#about').data('imageUploadUrl'),\n    filebrowserFlashUploadUrl: $('#about').data('flashUploadUrl')\n});\n\n$('[data-role=\"tree-select\"], [name=\"categoryId\"]').select2({\n  treeview: true,\n  dropdownAutoWidth: true,\n  treeviewInitState: 'collapsed',\n  placeholderOption: 'first'\n});\n\nlet validator = $('#classroom-set-form').validate({\n  onkeyup: false,\n  rules: {\n    title: {\n      required: true,\n    }\n  },\n});\n\ninitDatePicker('#expiryValueDate');\n\n$('[name=\"expiryMode\"]').change(function () {\n  if($('[name=\"expiryMode\"]:checked').val()==='date') {\n    $('.js-expiryValue-date').removeClass('hidden');\n    $('.js-expiryValue-days').addClass('hidden');\n  }else if($('[name=\"expiryMode\"]:checked').val()==='days') {\n     $('.js-expiryValue-date').addClass('hidden');\n    $('.js-expiryValue-days').removeClass('hidden');\n  }else {\n    $('.js-expiryValue-date').removeClass('hidden').addClass('hidden');\n    $('.js-expiryValue-days').removeClass('hidden').addClass('hidden');\n  }\n})\n\n\n\n$('#classroom-save').click(()=>{\n  validator.form();\n})\n\ntoggleExpiryValue($(\"[name=expiryMode]:checked\").val());\n\n$(\"[name='expiryMode']\").change(function () {\n    if (app.arguments.classroomStatus == 'published') {\n        return false;\n    }\n    // validator.removeItem('[name=expiryValue]');\n\n    var expiryValue = $(\"[name='expiryValue']\").val();\n    if (expiryValue) {\n        if (expiryValue.match(\"-\")) {\n            $(\"[name='expiryValue']\").data('date', $(\"[name='expiryValue']\").val());\n        } else {\n            $(\"[name='expiryValue']\").data('days', $(\"[name='expiryValue']\").val());\n        }\n        $(\"[name='expiryValue']\").val('')\n    }\n\n    if ($(this).val() == 'none') {\n        $('.expiry-value-js').addClass('hidden');\n    } else {\n        $('.expiry-value-js').removeClass('hidden');\n        var $esBlock = $('.expiry-value-js > .controls > .help-block');\n        $esBlock.text($esBlock.data($(this).val()));\n        toggleExpiryValue($(this).val());\n    }\n});\nfunction toggleExpiryValue(expiryMode) {\n    if (!$(\"[name='expiryValue']\").val()) {\n        $(\"[name='expiryValue']\").val($(\"[name='expiryValue']\").data(expiryMode));\n    }\n    switch (expiryMode) {\n        case 'days':\n            $('[name=\"expiryValue\"]').datetimepicker('remove');\n            $(\".expiry-value-js .controls > span\").removeClass('hidden');\n            // validator.addItem({\n            //     element: '[name=expiryValue]',\n            //     rule: 'positive_integer maxlength{max:10}',\n            //     required: true,\n            //     display: '有效期'\n            // });\n            break;\n        case 'date':\n            $(\".expiry-value-js .controls > span\").addClass('hidden');\n            // validator.addItem({\n            //     element: '[name=expiryValue]',\n            //     required: true,\n            //     display: '有效期'\n            // });\n            $(\"#classroom_expiryValue\").datetimepicker({\n                language: 'zh-CN',\n                autoclose: true,\n                format: 'yyyy-mm-dd',\n                minView: 'month'\n            });\n            $(\"#classroom_expiryValue\").datetimepicker('setStartDate', new Date);\n            break;\n        default:\n            break;\n    }\n}\n\nfunction initDatePicker($id) {\n  let $picker = $($id);\n  $picker.datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: \"zh\",\n    minView: 2, //month\n    autoclose: true,\n    endDate: new Date(Date.now() + 86400 * 365 * 10 * 1000)\n  });\n  $picker.datetimepicker('setStartDate', new Date());\n}"]}