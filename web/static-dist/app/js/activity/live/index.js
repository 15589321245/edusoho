webpackJsonp(["app/js/activity/live/index"],{c6797855be84e924b7d5:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i("da32dea28c2b82c7aab1"),r=function(t){return t&&t.__esModule?t:{default:t}}(s),o=function(){function t(){n(this,t),this.init()}return a(t,[{key:"init",value:function(){var t=this;if("1"!=$("#lesson-live-content").data("hasRoom"))return $("#lesson-live-content").find(".lesson-content-text-body").html("<div class='live-show-item'>\n        <p class='title'>"+Translator.trans("site.activity.live.content_title")+"</p>\n        <p>"+Translator.trans("activity.liva.not_created_notice")+"ÔºÅ</p>\n        </div>"),void $("#lesson-live-content").show();var e=JSON.parse($("#activity-data").html()),i=(parseInt(e.startTime),parseInt(e.endTime)),n=parseInt(e.nowDate);this.liveStartTimeFormat=e.startTimeFormat,this.liveEndTimeFormat=e.endTimeFormat;var a=e.fromCourseId,s=e.id;this.summary=$("#activity-summary").text(),this.$liveNotice='<div class="live-show-item">\n          <p class="title">'+Translator.trans("activity.live.notice_title")+"</p>\n           "+Translator.trans("activity.live.default_notice",{startTimeFormat:this.liveStartTimeFormat,endTimeFormat:this.liveEndTimeFormat})+"\n         </div>",this.iID=null,this.iID&&clearInterval(iID),this.intervalSecond=0,this.entry_url=location.protocol+"//"+location.hostname+"/course/"+a+"/activity/"+s+"/live_entry",this.generateHtml();var r=0;i>n&&(r=1e3),this.iID=setInterval(function(){t.generateHtml()},r),$("#lesson-live-content").show(),this.started=!1}},{key:"entryLiveRoom",value:function(){if(!this.started){this.started=!0;(new r.default).emit("start",{}).then(function(){}).catch(function(t){})}window.open(this.entry_url,"_blank")}},{key:"generateHtml",value:function(){var t=JSON.parse($("#activity-data").text()),e=parseInt(t.startTime),i=parseInt(t.endTime),n=parseInt(t.nowDate);n+=this.intervalSecond;var a=parseInt(e-n),s=parseInt(i-n),r=Math.floor(a/86400),o=a%86400,l=Math.floor(o/3600);o%=3600;var c=Math.floor(o/60),v=o%60,d="";d=1==t.ext.liveProvider?Translator.trans("activity.live.replay_guid_1"):Translator.trans("activity.live.replay_guid"),d="<div class='live-show-item'>"+d+"</div>";var m=this._getCountDown(r,l,c,v),h="";0<a&&a<7200&&(this.$liveNotice='<div class="live-show-item">\n          <p class="title">'+Translator.trans("activity.live.notice_title")+"</p>\n          "+Translator.trans("activity.live.default_notice",{startTimeFormat:this.liveStartTimeFormat,endTimeFormat:this.liveEndTimeFormat})+"\n         </div>",h="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n           "+Translator.trans("activity.live.entry_live_room")+"\n          </a>\n        </div>",t.isTeacher&&(h+=d)),a<=0&&(clearInterval(this.iID),m="",this.$liveNotice="<div class='live-show-item'>\n          <p class=\"title\">"+Translator.trans("activity.live.notice_title")+"</p>\n          "+Translator.trans("activity.live.started_notice",{endTimeFormat:this.liveEndTimeFormat})+"\n        </div>",h="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("activity.live.entry_live_room")+"\n          </a>\n        </div>",t.isTeacher&&(h+=d)),s<=0&&(m="",h="",this.$liveNotice="<div class='live-show-item'>\n          <i class='es-icon es-icon-xinxi color-danger icon-live-end'></i>\n          "+Translator.trans("activity.live.ended_notice")+"\n        </div>",t.replays&&t.replays.length>0&&($.each(t.replays,function(t,e){h+="<a class='btn btn-primary btn-replays' href='"+e.url+"' target='_blank'>"+e.title+"</a>"}),h="<div class='live-show-item'>"+h+"</div>"));var u=this.$liveNotice+" "+m+"\n      <div class='live-show-item'>\n        <p class='title'>"+Translator.trans("activity.live.content_title")+"</p>\n        "+this.summary+"\n      </div>"+h;$("#lesson-live-content").find(".lesson-content-text-body").html(u),this.intervalSecond++}},{key:"_getCountDown",value:function(t,e,i,n){var a="";return a+=t?Translator.trans("site.date_format_dhis",{days:t,hours:e,minutes:i,seconds:n}):"",a+=e?Translator.trans("site.date_format_his",{hours:e,minutes:i,seconds:n}):"",a+=i?Translator.trans("site.date_format_is",{minutes:i,seconds:n}):"",a+=n?Translator.trans("site.date_format_s",{seconds:n}):"",a="<div class='live-show-item'>\n      <p class='title'>"+Translator.trans("activity.live.count_down_title")+'</p>\n      <span class="color-warning">'+a+"</span>\n    </div>"}}]),t}();e.default=o},d9e0e032c89bc7ecf076:function(t,e,i){"use strict";var n=i("c6797855be84e924b7d5"),a=function(t){return t&&t.__esModule?t:{default:t}}(n);window.liveShow=new a.default}},["d9e0e032c89bc7ecf076"]);