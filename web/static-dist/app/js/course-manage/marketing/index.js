webpackJsonp(["app/js/course-manage/marketing/index"],[function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Marketing=function(){function Marketing(){_classCallCheck(this,Marketing),this.validator=null,this.init()}return _createClass(Marketing,[{key:"init",value:function(){this.initValidator(),this.taskPriceSetting(),this.checkBoxChange(),this.initDatetimepicker(),this.setService()}},{key:"setService",value:function(){$(".js-service-item").click(function(event){var $item=$(event.currentTarget),$values=$("#course_services").val(),values=void 0;values=$values?JSON.parse($values):[],$item.hasClass("label-primary")?($item.removeClass("label-primary").addClass("label-default"),values.splice($values.indexOf($item.text()),1)):($item.removeClass("label-default").addClass("label-primary"),values.push($item.text())),$("#course_services").val(JSON.stringify(values))})}},{key:"initDatetimepicker",value:function(){var _this=this;$('input[name="buyExpiryTime"]').datetimepicker({format:"yyyy-mm-dd",language:"zh",minView:2,autoclose:!0}).on("hide",function(){_this.validator&&_this.validator.form()}),this.updateDatetimepicker()}},{key:"updateDatetimepicker",value:function(){$('input[name="buyExpiryTime"]').datetimepicker("setStartDate",new Date(Date.now()+864e5)),$('input[name="buyExpiryTime"]').datetimepicker("setEndDate",new Date(Date.now()+31536e7))}},{key:"checkBoxChange",value:function(){var _this2=this;$('input[name="isFree"]').on("change",function(event){0==$('input[name="isFree"]:checked').val()?$(".js-is-free").removeClass("hidden"):$(".js-is-free").addClass("hidden")}),$('input[name="tryLookable"]').on("change",function(event){1==$('input[name="tryLookable"]:checked').val()?$(".js-enable-try-look").removeClass("hidden"):$(".js-enable-try-look").addClass("hidden")}),$('input[name="enableBuyExpiryTime"]').on("change",function(event){0==$('input[name="enableBuyExpiryTime"]:checked').val()?$("#buyExpiryTime").addClass("hidden"):($("#buyExpiryTime").removeClass("hidden"),_this2.updateDatetimepicker())})}},{key:"taskPriceSetting",value:function(){$(".js-task-price-setting").on("click","li",function(event){var $li=$(this).toggleClass("open"),$input=$li.find("input");$input.prop("checked",!$input.is(":checked"))}),$(".js-task-price-setting").on("click","input",function(event){event.stopPropagation();var $input=$(this);$input.closest("li").toggleClass("open")})}},{key:"initValidator",value:function(){var _this3=this,$form=$("#course-marketing-form");$(".js-task-price-setting").perfectScrollbar(),this.validator=$form.validate({rules:{originPrice:{required:function(){return 0==$("[name=isFree]:checked").val()},positive_currency:function(){return 0==$("[name=isFree]:checked").val()}},tryLookLength:{required:function(){return 1==$("[name=tryLookable]:checked").val()},digits:!0,min:1,max:10},tryLookLimit:{digits:!0},buyExpiryTime:{required:function(){return 1==$('input[name="enableBuyExpiryTime"]:checked').val()},after_now_date:!0}},messages:{buyExpiryTime:{required:"请选择有效的购买截止日期",date:"请选择有效的购买截止日期"}}}),$("#course-submit").click(function(event){_this3.validator&&_this3.validator.form()&&($(event.currentTarget).button("loading"),$form.submit())})}}]),Marketing}();new Marketing}]);