{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/article/detail/index.js","webpack:///./app/Resources/static-src/app/js/thread/thread-show.js?d8f5**"],"names":["element","threadShowWidget","$","on","$self","hasClass","post","data","article","find","html","upsNum","always","removeClass","closest","addClass","ThreadShowWidget","prop","ele","init","initEvent","length","get","val","response","modal","initPostForm","$node","console","log","onClickPostMore","event","onClickReply","onPostDelete","onPostUp","onConfirmBtn","onClickToggleSubpostForm","onClickEventCancelBtn","onClickSubpost","e","stopPropagation","$btn","currentTarget","parents","inSubpost","$container","$form","text","Translator","trans","trigger","toggleClass","initSubpostForm","confirm","$subpostsNum","parseInt","remove","status","window","location","href","reload","result","preventDefault","$pageBtn","attr","id","animate","scrollTop","offset","top","$list","that","editor","$textarea","CKEDITOR","replace","toolbar","filebrowserImageUploadUrl","getData","validate","ajax","currentDom","rules","content","submitSuccess","button","append","setData","prepend","pos","empty","submitError","parseJSON","responseText","error","message","parent","eventName","off"],"mappings":"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","file":"app/js/article/detail/index.js","sourcesContent":["import ThreadShowWidget from 'app/js/thread/thread-show';\n\nlet element = '#detail-content';\n\nlet threadShowWidget = new ThreadShowWidget({\n  element: element\n})\n\n$(element).on('click', '.js-article-like', function() {\n    const $self = $(this);\n    if ($self.hasClass('color-primary')) {\n        $.post($self.data('cancelLikeUrl'), function(article) {\n            $('.article-content').find('.js-like-num').html(article.upsNum);\n        }).always(function(){\n            $self.removeClass('color-primary');\n            $self .closest('.icon-favour').removeClass('active');\n        });\n    } else {\n        $.post($self.data('likeUrl'), function(article) {\n            $('.article-content').find('.js-like-num').html(article.upsNum);\n        }).always(function(){\n            $self.addClass('color-primary');\n            $self.closest('.icon-favour').addClass('active');\n        });\n              \n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/article/detail/index.js","import notify from 'common/notify';\n\nclass ThreadShowWidget {\n    constructor(prop) {\n        this.ele = $(prop.element);\n        this.init();\n    }\n\n    init() {\n        this.initEvent();\n        if ($('[name=access-intercept-check]').length > 0) {\n            $.get($('[name=access-intercept-check]').val(), function (response) {\n                if (response) {\n                    return;\n                }\n\n                $('.access-intercept-modal').modal('show');\n\n            }, 'json');\n        }\n        this.initPostForm();\n    }\n    initEvent() {\n        const $node = this.ele;\n\n        console.log($node);\n\n        $node.on('click', '.js-post-more', event => this.onClickPostMore(event));\n        $node.on('click', '.js-reply', event => this.onClickReply(event));\n        $node.on('click', '.js-post-delete', event => this.onPostDelete(event));\n        $node.on('click', '.js-post-up', event => this.onPostUp(event));\n        $node.on('click', '[data-role=confirm-btn]', event => this.onConfirmBtn(event));\n        $node.on('click', '.js-toggle-subpost-form', event => this.onClickToggleSubpostForm(event));\n        $node.on('click', '.js-event-cancel', event => this.onClickEventCancelBtn(event));\n        $node.on('click', '.thread-subpost-container .pagination a', event => this.onClickSubpost(event));\n    }\n\n    onClickPostMore(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        $btn.parents('.thread-subpost-moretext').addClass('hide');\n        $btn.parents('.thread-post').find('.thread-subpost').removeClass('hide');\n        $btn.parents('.thread-post').find('.pagination').removeClass('hide');\n    }\n\n    onClickReply(e) {\n        console.log('ok');\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        const inSubpost = $btn.parents('.thread-subpost-list').length > 0;\n        const $container = $btn.parents('.thread-post').find('.thread-subpost-container');\n        const $form = $container.find('.thread-subpost-form');\n        if (inSubpost) {\n            $form.removeClass('hide');\n            const text = Translator.trans('thread.post.reply') + ' @ ' + $btn.parents('.thread-post').data('authorName') + '： ';\n            $form.find('textarea').val(text).trigger('focus');\n\n        } else {\n            $container.toggleClass('hide');\n        }\n\n        if ($btn.html() == Translator.trans('thread.post.reply')) {\n            $btn.html(Translator.trans('thread.post.put_away'));\n        } else {\n            $btn.html(Translator.trans('thread.post.reply'));\n        }\n\n        this.initSubpostForm($form);\n    }\n\n    onPostDelete(e) {\n        e.stopPropagation();\n        const $node = this.ele;\n        const $btn = $(e.currentTarget);\n        if (!confirm(Translator.trans('thread.post.delete_hint'))) {\n            return;\n        }\n        const inSubpost = $btn.parents('.thread-subpost-list').length > 0;\n\n        $.post($btn.data('url'), function () {\n            if (inSubpost) {\n                const $subpostsNum = $btn.parents('.thread-post').find('.subposts-num');\n                $subpostsNum.text(parseInt($subpostsNum.text()) - 1);\n            } else {\n                $node.find('.thread-post-num').text(parseInt($node.find('.thread-post-num').text()) - 1);\n            }\n            $($btn.data('for')).remove();\n        });\n    }\n\n    onPostUp(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        $.post($btn.data('url'), function (response) {\n            if (response.status == 'ok') {\n                $btn.find(\".post-up-num\").text(parseInt($btn.find(\".post-up-num\").text()) + 1);\n            } else if (response.status == 'votedError') {\n                notify('danger', Translator.trans('thread.post.like_hint'));\n            } else {\n                notify('danger', Translator.trans('thread.post.like_error_hint'));\n            }\n        }, 'json');\n    }\n\n    onConfirmBtn(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        if (!confirm($btn.data('confirmMessage'))) {\n            return;\n        }\n        $.post($btn.data('url'), function () {\n            if ($btn.data('afterUrl')) {\n                window.location.href = $btn.data('afterUrl');\n                return;\n            }\n            window.location.reload();\n        });\n    }\n\n    onClickToggleSubpostForm(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        const $form = $btn.parents('.thread-subpost-container').find('.thread-subpost-form');\n        $form.toggleClass('hide');\n        this.initSubpostForm($form);\n    }\n\n    onClickEventCancelBtn(e) {\n        $.post($(e.currentTarget).data('url'), function (result) {\n            window.location.reload();\n        });\n    }\n\n    onClickSubpost(e) {\n        e.preventDefault();\n        const $pageBtn = $(e.currentTarget);\n\n        $.post($pageBtn.attr('href'), function (result) {\n\n            const id = $pageBtn.parents(\".thread-post\").attr(\"id\");\n            $(\"body,html\").animate({\n                scrollTop: $(\"#\" + id).offset().top\n            }, 300), !1\n\n            $pageBtn.closest('.thread-subpost-container .thread-subpost-content').html(result);\n        });\n    }\n\n    initPostForm() {\n        const $list = $('.thread-pripost-list');\n        const $form = $('#thread-post-form');\n        const that = this;\n\n        if ($form.length == 0) {\n            return;\n        }\n\n        let editor = null;\n        const $textarea = $form.find('textarea[name=content]');\n        if ($textarea.data('imageUploadUrl')) {\n            editor = CKEDITOR.replace($textarea.attr('id'), {\n                toolbar: 'Thread',\n                filebrowserImageUploadUrl: $textarea.data('imageUploadUrl')\n            });\n            editor.on('change',()=> {\n                $textarea.val(editor.getData());\n            })\n        }\n        const $btn = $form.find('[type=submit]');\n        $form.validate({\n            ajax: true,\n            currentDom: $btn,\n            rules: {\n                content: 'required'\n            },\n            submitSuccess: function (response) {\n                $btn.button('reset');\n                if ($textarea.data('imageUploadUrl')) {\n                    $list.append(response);\n                    editor.setData('');\n                } else {\n                    $list.prepend(response);\n                    $textarea.val('');\n                }\n\n                const pos = $list.find('li:last-child').offset();\n                $('body').scrollTop(pos.top);\n                $form.find('.thread-post-num').text(parseInt($form.find('.thread-post-num').text()) + 1);\n                $list.find('li.empty').remove();\n                $list.closest('.top-reply').removeClass('hidden');\n\n                //清除附件\n                $('.js-attachment-list').empty();\n                $('.js-attachment-ids').val(\"\");\n                $('.js-upload-file').removeClass('hidden');\n            },\n            submitError: function (data) {\n                $btn.button('reset');\n                data = $.parseJSON(data.responseText);\n                if (data.error) {\n                    notify('danger', data.error.message)\n                } else {\n                    notify('danger', Translator.trans('thread.post.reply_error_hint'))\n                }\n            }\n        })\n    }\n\n    initSubpostForm($form) {\n        const $btn = $form.find('[type=submit]');\n        $form.validate({\n            ajax: true,\n            currentDom: $btn,\n            rules: {\n                content: 'required'\n            },\n            submitSuccess: function (data) {\n                if (data.error) {\n                    notify('danger', data.error);\n                    return;\n                }\n                $btn.button('reset');\n                $form.parents('.thread-subpost-container').find('.thread-subpost-list').append(data);\n                $form.find('textarea').val('');\n                const $subpostsNum = $form.parents('.thread-post').find('.subposts-num');\n                $subpostsNum.text(parseInt($subpostsNum.text()) + 1);\n                $subpostsNum.parent().removeClass('hide');\n            },\n            submitError: function (data) {\n                $btn.button('reset');\n                data = $.parseJSON(data.responseText);\n                if (data.error) {\n                    notify('danger', data.error.message);\n                } else {\n                    notify('danger', Translator.trans('thread.post.reply_error_hint'));\n                }\n            }\n        })\n    }\n\n    undelegateEvents(element, eventName) {\n        this.ele.off(element, eventName);\n    }\n}\n\nexport default ThreadShowWidget\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/thread/thread-show.js"],"sourceRoot":""}