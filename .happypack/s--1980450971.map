{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/help.js"],"names":["closeCourse","$","on","evt","confirm","Translator","trans","post","currentTarget","data","warn","message","success","location","reload","sortList","element","sortable","get","ids","response","document","deleteCourse","publishCourse","target","deleteTask","parents","remove","publishTask","event","unpublishTask","showSettings","$list","delegateTarget","$this","closest","hasClass","removeClass","find","slideUp","addClass","slideDown","TabChange","click","siblings","generateReplay","url","Promise","resolve","then","catch","error","JSON","parse","responseText","code"],"mappings":"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","file":"help.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport 'jquery-sortable';\n\nexport const closeCourse = () => {\n  $('body').on('click', '.js-close-course', function(evt) {\n    if (!confirm(Translator.trans('是否确定关闭该教学计划？'))) {\n      return;\n    }\n\n    $.post($(evt.currentTarget).data('check-url'), function(data) {\n      if (data.warn) {\n        if (!confirm(Translator.trans(data.message))) {\n          return;\n        }\n      }\n      $.post($(evt.currentTarget).data('url'), function(data) {\n        if (data.success) {\n          notify('success', '关闭成功');\n          location.reload();\n        } else {\n          notify('danger', '关闭失败：' + data.message);\n        }\n      });\n    });\n  });\n};\n\nexport const sortList = (element = '#sortable-list') => {\n  let data = $(element).sortable(\"serialize\").get();\n  $.post($(element).data('sortUrl'), { ids: data }, (response) => {\n    if (response) {\n      document.location.reload();\n    }\n  });\n};\n\nexport const deleteCourse = () => {\n  $('body').on('click', '.js-delete-course', function(evt) {\n    if (!confirm(Translator.trans('是否确定删除该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.currentTarget).data('url'), function(data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        location.reload();\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishCourse = () => {\n  $('body').on('click', '.js-publish-course', function(evt) {\n    if (!confirm(Translator.trans('是否确定发布该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.target).data('url'), function(data) {\n      if (data.success) {\n        notify('success', '发布成功');\n        location.reload();\n      } else {\n        notify('danger','发布失败：' + data.message,5000);\n      }\n    });\n  });\n};\n\nexport const deleteTask = () => {\n  $('body').on('click', '.delete-item', function(evt) {\n    if ($(evt.currentTarget).data('type') == 'task') {\n      if (!confirm(Translator.trans('是否确定删除该任务吗？'))) {\n        return;\n      }\n    } else if ($(evt.currentTarget).data('type') == 'chapter') {\n      if (!confirm(Translator.trans('是否确定删除该章节吗？'))) {\n        return;\n      }\n    }\n    $.post($(evt.currentTarget).data('url'), function(data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        $(evt.target).parents('.task-manage-item').remove();\n        sortList();\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishTask = () => {\n  $('body').on('click', '.publish-item', (event) => {\n    $.post($(event.target).data('url'), function(data) {\n      if (data.success) {\n        notify('success', '发布成功');\n        location.reload();\n      } else {\n        notify('danger', '发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const unpublishTask = () => {\n  $('body').on('click', '.unpublish-item', (event) => {\n    $.post($(event.target).data('url'), function(data) {\n      if (data.success) {\n        notify('success', '取消发布成功');\n        location.reload();\n      } else {\n        notify('danger', '取消发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const showSettings = () => {\n  $(\"#sortable-list\").on('click', '.js-item-content', event => {\n    let $list = $(event.delegateTarget);\n    let $this = $(event.currentTarget).closest('.js-task-manage-item');\n    if($this.hasClass('active')) {\n      $this.removeClass('active').find('.js-settings-list').slideUp();\n    }else {\n      $list.find(\".js-task-manage-item.active\").removeClass('active').find('.js-settings-list').slideUp();\n      $this.addClass('active').find('.js-settings-list').slideDown();\n    }\n  });\n};\n\nexport const TabChange = () => {\n  $('[data-role=\"tab\"]').click(function (event) {\n    let $this = $(this);\n    $($this.data('tab-content')).removeClass(\"hidden\").siblings('[data-role=\"tab-content\"]').addClass('hidden');\n  });\n};\n\nexport const generateReplay = () => {\n  $('.js-generate-replay').on('click', (event) => {\n    const $this = $(event.currentTarget);\n    const url = $this.data('url');\n    if(!url) return;\n    Promise.resolve($.post(url))\n      .then(success => {\n        notify('success', '生成录制回放成功');\n      })\n      .catch(response => {\n        const error = JSON.parse(response.responseText);\n        const code = error.code;\n        const message = error.error;\n        notify('danger', message);\n      });\n  })\n};"]}