webpackJsonp(["app/js/course-manage/create/index"],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("423d5c93d4f10f876e3b"),o=r(s),u=function(){function e(){i(this,e),this.validator=null,this.init()}return a(e,[{key:"init",value:function(){$('[data-toggle="popover"]').popover({html:!0}),this.initValidator(),this.initExpiryMode(),this.checkBoxChange()}},{key:"initValidator",value:function(){var e=this,t=$("#course-create-form");this.validator=t.validate({groups:{date:"expiryStartDate expiryEndDate"},rules:{title:{required:!0,trim:!0}},messages:{title:Translator.trans("course.manage.title_required_error_hint")}}),$("#course-submit").click(function(n){e.validator.form()&&(e.isInitIntro(),$(n.currentTarget).button("loading"),t.submit())}),this.initDatePicker("#expiryStartDate"),this.initDatePicker("#expiryEndDate"),this.initDatePicker("#deadline")}},{key:"isInitIntro",value:function(){var e=$("#courses-list-table").find("tbody tr").length;if(1==e){var t=new o.default;t.isSetCourseListCookies()}}},{key:"checkBoxChange",value:function(){var e=this;$('input[name="deadlineType"]').on("change",function(t){"end_date"==$('input[name="deadlineType"]:checked').val()?($("#deadlineType-date").removeClass("hidden"),$("#deadlineType-days").addClass("hidden")):($("#deadlineType-date").addClass("hidden"),$("#deadlineType-days").removeClass("hidden")),e.initExpiryMode()}),$('input[name="expiryMode"]').on("change",function(t){"date"==$('input[name="expiryMode"]:checked').val()?($("#expiry-days").removeClass("hidden").addClass("hidden"),$("#expiry-date").removeClass("hidden")):"days"==$('input[name="expiryMode"]:checked').val()?($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden"),$('input[name="deadlineType"][value="days"]').prop("checked",!0)):($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden").addClass("hidden")),e.initExpiryMode()}),$('input[name="learnMode"]').on("change",function(e){"freeMode"==$('input[name="learnMode"]:checked').val()?($("#learnLockModeHelp").removeClass("hidden").addClass("hidden"),$("#learnFreeModeHelp").removeClass("hidden")):($("#learnFreeModeHelp").removeClass("hidden").addClass("hidden"),$("#learnLockModeHelp").removeClass("hidden"))})}},{key:"initDatePicker",value:function(e){var t=this,n=$(e);n.datetimepicker({format:"yyyy-mm-dd",language:"zh",minView:2,autoclose:!0,endDate:new Date(Date.now()+31536e7)}).on("hide",function(){t.validator.form()}),n.datetimepicker("setStartDate",new Date)}},{key:"initExpiryMode",value:function(){var e=$('[name="deadline"]'),t=$('[name="expiryDays"]'),n=$('[name="expiryStartDate"]'),r=$('[name="expiryEndDate"]'),i=$('[name="expiryMode"]:checked').val();switch(this.elementRemoveRules(e),this.elementRemoveRules(t),this.elementRemoveRules(n),this.elementRemoveRules(r),i){case"days":var a=$('[name="deadlineType"]:checked');if("end_date"===a.val())return this.elementAddRules(e,this.getDeadlineEndDateRules()),void this.validator.form();this.elementAddRules(t,this.getExpiryDaysRules()),this.validator.form();break;case"date":this.elementAddRules(n,this.getExpiryStartDateRules()),this.elementAddRules(r,this.getExpiryEndDateRules()),this.validator.form()}}},{key:"getExpiryEndDateRules",value:function(){return{required:!0,date:!0,after_date:"#expiryStartDate",messages:{required:Translator.trans("course.manage.expiry_end_date_error_hint")}}}},{key:"getExpiryStartDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,before_date:"#expiryEndDate",messages:{required:Translator.trans("course.manage.expiry_start_date_error_hint")}}}},{key:"getExpiryDaysRules",value:function(){return{required:!0,positive_integer:!0,max_year:!0,messages:{required:Translator.trans("course.manage.expiry_days_error_hint")}}}},{key:"getDeadlineEndDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,messages:{required:Translator.trans("course.manage.deadline_end_date_error_hint")}}}},{key:"elementAddRules",value:function(e,t){e.rules("add",t)}},{key:"elementRemoveRules",value:function(e){e.rules("remove")}}]),e}();new u},"423d5c93d4f10f876e3b":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n("d5e8fa5f17ac5fe79c78");var s=n("fe53252afd7b6c35cb73"),o=r(s),u="COURSE_BASE_INTRO",l="COURSE_TASK_INTRO",d="COURSE_TASK_DETAIL_INTRO",c="COURSE_LIST_INTRO",f="COURSE_LIST_INTRO_COOKIE",p=function(){function e(){var t=this;i(this,e),this.intro=null,this.customClass="es-intro-help multistep",$("body").on("click",".js-skip",function(e){t.intro.exit()})}return a(e,[{key:"introType",value:function(){return this.isTaskCreatePage()?void this.initTaskCreatePageIntro():this.isCourseListPage()?void this.initCourseListPageIntro():void this.initNotTaskCreatePageIntro()}},{key:"isCourseListPage",value:function(){return!!$("#courses-list-table").length}},{key:"isTaskCreatePage",value:function(){return!!$("#step-3").length}},{key:"isInitTaskDetailIntro",value:function(){return $(".js-task-manage-item").attr("into-step-id","step-5"),!!$(".js-settings-list").length}},{key:"introStart",value:function(e){var t=this,n='<i class="es-icon es-icon-close01"></i>';this.intro=introJs(),e.length<2?(n=Translator.trans("intro.confirm_hint"),this.customClass="es-intro-help"):this.customClass="es-intro-help multistep",this.intro.setOptions({steps:e,skipLabel:n,nextLabel:Translator.trans("course_set.manage.next_label"),prevLabel:Translator.trans("course_set.manage.prev_label"),doneLabel:n,showBullets:!1,tooltipPosition:"auto",showStepNumbers:!1,exitOnEsc:!1,exitOnOverlayClick:!1,tooltipClass:this.customClass}),this.intro.start().onexit(function(){}).onchange(function(){t.intro._currentStep==t.intro._introItems.length-1?$(".introjs-nextbutton").before('<a class="introjs-button  done-button js-skip">'+Translator.trans("intro.confirm_hint")+"<a/>"):$(".js-skip").remove()})}},{key:"initTaskCreatePageIntro",value:function(){$(".js-task-manage-item:first .js-item-content").trigger("click"),store.get(u)||store.get(l)?store.get(l)||(store.set(l,!0),this.introStart(this.initTaskSteps())):(store.set(u,!0),store.set(l,!0),this.introStart(this.initAllSteps()))}},{key:"initTaskDetailIntro",value:function(e){store.get(d)||(store.set(d,!0),this.introStart(this.initTaskDetailSteps(e)))}},{key:"initNotTaskCreatePageIntro",value:function(){store.get(u)||(store.set(u,!0),this.introStart(this.initNotTaskPageSteps()))}},{key:"isSetCourseListCookies",value:function(){store.get(c)||o.default.set(f,!0)}},{key:"initCourseListPageIntro",value:function(){var e=this,t=$("#courses-list-table").find("tbody tr").length;2===t&&!store.get(c)&&o.default.get(f)&&(o.default.remove(f),new Promise(function(e,t){setTimeout(function(){var t=$(".js-sidenav-course-menu");return t.length?void $(".js-sidenav-course-menu").slideUp(function(){e()}):void e()},100)}).then(function(){setTimeout(function(){e.initCourseListIntro(".js-sidenav")},100)}))}},{key:"initCourseListIntro",value:function(e){store.get(c)||(store.set(c,!0),this.introStart(this.initCourseListSteps(e)))}},{key:"initAllSteps",value:function(){var e=[{intro:Translator.trans("course_set.manage.upgrade_hint")},{element:"#step-1",intro:Translator.trans("course_set.manage.upgrade_step1_hint")},{element:"#step-2",intro:Translator.trans("course_set.manage.upgrade_step2_hint")},{element:"#step-3",intro:Translator.trans("course_set.manage.upgrade_step3_hint")}];return this.isInitTaskDetailIntro()&&(e.push({element:'[into-step-id="step-5"]',intro:Translator.trans("course_set.manage.upgrade_step5_hint")}),store.get(d)||store.set(d,!0)),e}},{key:"initNotTaskPageSteps",value:function(){return[{intro:Translator.trans("course_set.manage.upgrade_hint")},{element:"#step-1",intro:Translator.trans("course_set.manage.upgrade_step1_hint")},{element:"#step-2",intro:Translator.trans("course_set.manage.upgrade_step2_hint")}]}},{key:"initTaskSteps",value:function(){var e=[{element:"#step-3",intro:Translator.trans("course_set.manage.upgrade_step3_hint")}];return this.isInitTaskDetailIntro()&&(e.push({element:"#step-5",intro:Translator.trans("course_set.manage.upgrade_step5_hint"),position:"bottom"}),store.get(d)||store.set(d,!0)),e}},{key:"initTaskDetailSteps",value:function(e){return[{element:e,intro:Translator.trans("course_set.manage.activity_link_hint"),position:"bottom"}]}},{key:"initCourseListSteps",value:function(e){return[{element:e,intro:Translator.trans("course_set.manage.hint")}]}},{key:"initResetStep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[{element:".js-intro-btn-group",intro:Translator.trans("course_set.manage.all_tutorial",{introBtnClassName:e}),position:"top"}]}}]),e}();t.default=p},d5e8fa5f17ac5fe79c78:function(e,t){(function(e){var t=!1,n=!1,r=!1;(function(){"use strict";!function(e,i){"function"==typeof t&&t.amd?t([],i):"object"==typeof r?n.exports=i():e.store=i()}(this,function(){function t(){try{return s in i&&i[s]}catch(e){return!1}}var n,r={},i="undefined"!=typeof window?window:e,a=i.document,s="localStorage",o="script";if(r.disabled=!1,r.version="1.3.20",r.set=function(e,t){},r.get=function(e,t){},r.has=function(e){return void 0!==r.get(e)},r.remove=function(e){},r.clear=function(){},r.transact=function(e,t,n){null==n&&(n=t,t=null),null==t&&(t={});var i=r.get(e,t);n(i),r.set(e,i)},r.getAll=function(){},r.forEach=function(){},r.serialize=function(e){return JSON.stringify(e)},r.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},t())n=i[s],r.set=function(e,t){return void 0===t?r.remove(e):(n.setItem(e,r.serialize(t)),t)},r.get=function(e,t){var i=r.deserialize(n.getItem(e));return void 0===i?t:i},r.remove=function(e){n.removeItem(e)},r.clear=function(){n.clear()},r.getAll=function(){var e={};return r.forEach(function(t,n){e[t]=n}),e},r.forEach=function(e){for(var t=0;t<n.length;t++){var i=n.key(t);e(i,r.get(i))}};else if(a&&a.documentElement.addBehavior){var u,l;try{l=new ActiveXObject("htmlfile"),l.open(),l.write("<"+o+">document.w=window</"+o+'><iframe src="/favicon.ico"></iframe>'),l.close(),u=l.w.frames[0].document,n=u.createElement("div")}catch(e){n=a.createElement("div"),u=a.body}var d=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(n),u.appendChild(n),n.addBehavior("#default#userData"),n.load(s);var i=e.apply(r,t);return u.removeChild(n),i}},c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),f=function(e){return e.replace(/^d/,"___$&").replace(c,"___")};r.set=d(function(e,t,n){return t=f(t),void 0===n?r.remove(t):(e.setAttribute(t,r.serialize(n)),e.save(s),n)}),r.get=d(function(e,t,n){t=f(t);var i=r.deserialize(e.getAttribute(t));return void 0===i?n:i}),r.remove=d(function(e,t){t=f(t),e.removeAttribute(t),e.save(s)}),r.clear=d(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(s);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(s)}),r.getAll=function(e){var t={};return r.forEach(function(e,n){t[e]=n}),t},r.forEach=d(function(e,t){for(var n,i=e.XMLDocument.documentElement.attributes,a=0;n=i[a];++a)t(n.name,r.deserialize(e.getAttribute(n.name)))})}try{var p="__storejs__";r.set(p,p),r.get(p)!=p&&(r.disabled=!0),r.remove(p)}catch(e){r.disabled=!0}return r.enabled=!r.disabled,r})}).call(window)}).call(t,function(){return this}())},fe53252afd7b6c35cb73:function(e,t,n){var r,i;!function(a){var s=!1;if(r=a,i="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==i&&(e.exports=i)),s=!0,e.exports=a(),s=!0,!s){var o=window.Cookies,u=window.Cookies=a();u.noConflict=function(){return window.Cookies=o,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,i,a){var s;if("undefined"!=typeof document){if(arguments.length>1){if(a=e({path:"/"},r.defaults,a),"number"==typeof a.expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*a.expires),a.expires=o}try{s=JSON.stringify(i),/^[\{\[]/.test(s)&&(i=s)}catch(e){}return i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",i,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}t||(s={});for(var u=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<u.length;d++){var c=u[d].split("="),f=c.slice(1).join("=");'"'===f.charAt(0)&&(f=f.slice(1,-1));try{var p=c[0].replace(l,decodeURIComponent);if(f=n.read?n.read(f,p):n(f,p)||f.replace(l,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(e){}if(t===p){s=f;break}t||(s[p]=f)}catch(e){}}return s}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})}});