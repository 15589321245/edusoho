{% extends 'TopxiaWebBundle::bootstrap-modal-layout.html.twig' %}

{% set modal_class = 'modal-lg' %}

{% block title %}添加讲义{% endblock %}
{% block body %}
  <link rel="stylesheet" media="screen" href="{{ asset('bundles/topxiaweb/css/ztree.css') }}" />
  <link rel="stylesheet" media="screen" href="{{ asset('bundles/topxiaweb/css/tag-chooser2.css') }}" />

<div class="well well-sm">
  <form id="lecture-note-form" class="form-inline" action="" method="get" novalidate>

    <div class="form-group mrl" id="tags-search-group">
      <label>标签：</label>
        <a href="javascript:;" class="tag-search-trigger">
          {% for tag in tagSearchs %}
            {{tag.name}}
          {% else %}
            选择
          {% endfor %}
        </a>
    </div>
    <div class="form-group mrl" id="knowledges-search-group">
      <label>知识点：</label>
      <a href="javascript:;" class="knowledge-search-trigger">
        {% for knowledge in knowledgeSearchs %}
          {{knowledge.name}}
        {% else %}
          选择
        {% endfor %}
      </a>
    </div>

      <div class="form-group mrl">
        <input class="form-control" type="text" name="keyword" value="{{ app.request.query.get('keyword') }}" placeholder="标题关键词">
      </div>

      <button id="article-material-search" data-url="{{ path('admin_essay_content_list',{essayId:essay.id})}}" type="submit" class="btn btn-sm btn-primary">搜索</button>

      <input type="hidden" name="tagIds" value="{{ app.request.query.get('tagIds') }}">
      <input type="hidden" name="knowledgeIds" value="{{ app.request.query.get('knowledgeIds') }}">
  </form>
    {% include 'CustomWebBundle:Tag:tagchooser-overlay.html.twig' with {id: 'tags-search', type: 'question'} %}
    {% include 'CustomWebBundle:Tag:tagchooser-knowledge-overlay.html.twig' with {id: 'knowledges-search', categoryId: category.id} %}
</div>

  <div class="essay-content-list">
    <div id="aticle-table-container">
      <table class="table table-hover table-striped" id="essay-content-item-list">
        <thead>
          <tr>
            <th width="70%">文章素材标题</th>
            <th width="">知识点</th>
          </tr>
        </thead>
        <tbody>
          {% for articleMaterial in articleMaterials %}
          {% set knowledge = knowledges[articleMaterial.mainKnowledgeId]|default(null) %}
            <tr>
              <td>{{ articleMaterial.title }}</td>
              <td>{{ knowledge.name|default(null) }}</td>
            </tr>
          {% else %}
            <tr class="empty"><td colspan="20">无文件记录</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {{ web_macro.paginator(paginator) }}
  <div>
    <button type="submit" id="essay-content-creat-btn" class="btn btn-primary" data-loading-text="正在提交" data-role="batch-delete" data-url="{{ path('admin_essay_content_create', {essayId:essay.id }) }}" data-id="{{ parentId|default(null) }}"tabindex="5">添加</button>
    <button type="button" class="btn btn-link" data-dismiss="modal" tabindex="6">取消</button>
  </div>


<script>app.load('customwebbundle/controller/lecture-note/modal')</script>

{% endblock %}

{% set hide_footer = true %}