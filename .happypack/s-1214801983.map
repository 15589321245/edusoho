{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/index.js"],"names":["initItem","dataSourceUi","value","item","itemId","label","outputValue","push","removeItem","i","length","splice","updateItemSeq","sortDatas","temps","map","sortIndex","sort","console","log","index","datas","j","seq","data","MultiInput","props","event","id","currentTarget","attributes","state","setState","sortItem","addItem","dataSource","addable","searchable","sortable","listClassName","inputName","outputSets","list","getList","getOutputSets","showAddBtnGroup","outputDataElement","JSON","stringify","propTypes","multiInputClassName","PropTypes","string","array","isRequired","bool","shape","enable","url","checkBoxName","defaultProps","childContextTypes","func"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport List from './list';\nimport InputGroup from './input-group';\nimport { getRandomString } from './part';\nimport '!style!css!less!./style.less';\n\nfunction initItem(dataSourceUi, value) {\n  let item = {\n    itemId: getRandomString(),\n    label: value,\n    outputValue: value\n  };\n  dataSourceUi.push(item);\n}\n\nfunction removeItem(dataSourceUi, itemId) {\n  for (let i = 0; i < dataSourceUi.length; i++) {\n    if (dataSourceUi[i].itemId == itemId) {\n      dataSourceUi.splice(i, 1);\n      break;\n    } \n  }\n}\n\nfunction updateItemSeq(sortDatas, dataSourceUi) {\n  // console.log(data);\n  // console.log(datas);\n\n\n  let temps = [];\n  sortDatas.map((sortIndex,sort)=> {\n    console.log(sortIndex);\n    console.log(sort);\n    console.log('..');\n    dataSourceUi.map((index,item)=>{\n      if (sort == item) {\n        datas[j].seq = i + 1;\n        temps.push(datas[j]);\n      }\n      console.log(index);\n      console.log(item);\n    })\n  })\n\n  temps = [];\n  for (let i = 0; i < data.length; i++) {\n    for (let j = 0; j < datas.length; j++) {\n      if (data[i] == datas[j].itemId) {\n        datas[j].seq = i + 1;\n        temps.push(datas[j]);\n      }\n    }\n  }\n\n  return temps;\n}\n\nexport default class MultiInput extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentWillMount() {\n    this.state = {\n      dataSourceUi: [],\n    }\n    this.props.dataSource.map((item, index) => {\n      initItem(this.state.dataSourceUi, item);\n    })\n\n    console.log({'initItem after':this.state.dataSourceUi})\n  }\n\n  getChildContext() {\n    return {\n      removeItem: this.removeItem,\n      sortItem: this.sortItem,\n      addItem: this.addItem,\n      addable: this.props.addable,\n      searchable: this.props.searchable,\n      sortable: this.props.sortable,\n      listClassName:this.props.listClassName,\n      inputName: this.props.inputName,\n      dataSourceUi: this.state.dataSourceUi,\n    }\n  }\n\n  removeItem = (event) => {\n    let id = event.currentTarget.attributes[\"data-item-id\"].value;\n    removeItem(this.state.dataSourceUi, id);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  sortItem = (datas) => {\n    this.state.dataSourceUi = updateItemSeq(datas, this.state.dataSourceUi);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  addItem = (value, data) => {\n    initItem(this.state.dataSourceUi, value);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  getOutputSets() {\n    //应该优化成表单数据进行填充\n    let outputSets = [];\n    this.state.dataSourceUi.map((item, index) => {\n      outputSets.push(item.outputValue);\n    })\n    return outputSets;\n\n  }\n\n  getList() {\n    return (<List></List>);\n  }\n\n  render() {\n    let list = this.getList();\n    let outputSets = this.getOutputSets();\n    return (\n      <div className=\"multi-group\">\n        {list}\n        {this.props.showAddBtnGroup && <InputGroup/>}\n        <input type='hidden' name={this.props.outputDataElement} value={JSON.stringify(outputSets)} />\n      </div>\n    );\n  }\n}\n\nMultiInput.propTypes = {\n  multiInputClassName: React.PropTypes.string,\n  listClassName: React.PropTypes.string,\n  dataSource: React.PropTypes.array.isRequired,\n  sortable: React.PropTypes.bool,\n  addable: React.PropTypes.bool,\n  searchable: React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n  showAddBtnGroup: React.PropTypes.bool,\n  inputName: React.PropTypes.string,\n  checkBoxName: React.PropTypes.string,\n  outputDataElement: React.PropTypes.string,//带删除字段\n};\n\nMultiInput.defaultProps = {\n  multiInputClassName: 'multi-group',\n  listClassName: '',\n  dataSource: [],\n  sortable: true,\n  addable: true,\n  searchable: {\n    enable: false,\n    url: '',\n  },\n  showAddBtnGroup: true,\n  inputName: '',\n  checkBoxName: 'visible_',\n  outputDataElement: 'hidden-input',//带删除字段\n};\n\nMultiInput.childContextTypes = {\n  removeItem: React.PropTypes.func,\n  sortItem: React.PropTypes.func,\n  addItem: React.PropTypes.func,\n  addable: React.PropTypes.bool,\n  searchable:  React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n  sortable: React.PropTypes.bool,\n  listClassName:React.PropTypes.string,\n  inputName: React.PropTypes.string,\n  dataSourceUi: React.PropTypes.array.isRequired,\n};\n\n\n"]}