{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/course-manage/students/index.js"],"names":["Students","initTooltips","initDeleteActions","initFollowActions","initExportActions","initExpiryDayActions","$","popover","html","trigger","placement","content","on","evt","confirm","Translator","trans","post","target","data","success","location","reload","message","$this","hide","hasClass","parent","find","show","$exportBtn","button","get","start","response","status","exportStudents","fileName","href"],"mappings":"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","file":"app/js/course-manage/students/index.js","sourcesContent":["import notify from 'common/notify';\n\nclass Students {\n  constructor() {\n    this.initTooltips();\n    this.initDeleteActions();\n    this.initFollowActions();\n    this.initExportActions();\n    this.initExpiryDayActions();\n  }\n\n  initTooltips() {\n    $(\"#refund-coin-tips\").popover({\n      html: true,\n      trigger: 'hover',//'hover','click'\n      placement: 'left',//'bottom',\n      content: $(\"#refund-coin-tips-html\").html()\n    });\n  }\n\n  initDeleteActions() {\n    $('body').on('click', '.js-remove-student', function(evt) {\n      if (!confirm(Translator.trans('course.manage.student_delete_hint'))) {\n        return;\n      }\n      $.post($(evt.target).data('url'), function (data) {\n        if (data.success) {\n          notify('success', Translator.trans('site.delete_success_hint'));\n          location.reload();\n        } else {\n          notify('danger', Translator.trans('site.delete_fail_hint') + ':' + data.message);\n        }\n      });\n    });\n  }\n\n  initFollowActions() {\n    $(\"#course-student-list\").on('click', '.follow-student-btn, .unfollow-student-btn', function () {\n      let $this = $(this);\n      $.post($this.data('url'), function () {\n        $this.hide();\n        if ($this.hasClass('follow-student-btn')) {\n          $this.parent().find('.unfollow-student-btn').show();\n          notify('success', Translator.trans('user.follow_success_hint'));\n        } else {\n          $this.parent().find('.follow-student-btn').show();\n          notify('success', Translator.trans('user.unfollow_success_hint'));\n        }\n      });\n\n    });\n  }\n\n  initExportActions() {\n    $('#export-students-btn').on('click',  () =>{\n      let $exportBtn = $('#export-students-btn');\n      $exportBtn.button('loading');\n      $.get($exportBtn.data('datasUrl'), { start: 0 },  (response)=> {\n        if (response.status === 'getData') {\n          this.exportStudents(response.start, response.fileName);\n        } else {\n          $exportBtn.button('reset');\n          location.href = $exportBtn.data('url') + '?fileName=' + response.fileName;\n        }\n      });\n    });\n  }\n\n\n  initExpiryDayActions() {\n      $('.js-expiry-days').on('click', () => {\n          notify('danger', '只有按天数设置的学习有效期，才可手动增加有效期。');\n      });\n  }\n\n  exportStudents(start, fileName) {\n    var start = start || 0,\n      fileName = fileName || '';\n\n    $.get($('#export-students-btn').data('datasUrl'), { start: start, fileName: fileName }, function (response) {\n      if (response.status === 'getData') {\n        exportStudents(response.start, response.fileName);\n      } else {\n        $('#export-students-btn').button('reset');\n        location.href = $('#export-students-btn').data('url') + '&fileName=' + response.fileName;\n      }\n    });\n  }\n}\n\nnew Students();\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/course-manage/students/index.js"],"sourceRoot":""}