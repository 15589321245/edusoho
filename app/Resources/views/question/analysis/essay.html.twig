{% set questionType = question.type %}
{% extends 'question/analysis/analysis-layout.html.twig' %}

{% block analysis_body %}
  <div class="testpaper-question-essay__answer">
    <div class="mbl">
      <div class="mbs">{{'参考答案：'|trans}}</div>
      <div>{{ question.answer[0]|bbCode2Html|raw }}</div>
    </div>
  </div>

  {% if testType|default('testpaper') == 'testpaper' %}
    <div class="testpaper-question-body__label hidden-xs">
      <span>{{ '初次答题'|trans }}</span>
    </div>

    <ul class="testpaper-question-choices">
      {% for index in [2,1,0] %}
        {% set itemKeyAnalysis = questionAnalysis[index]|default(null) %}
        <li class="pl0 testpaper-question-body-item testpaper-question-choice-item">
          {% if index == 2 %}
            得 {{ question.score }} 分
          {% elseif index == 1 %}
            得 0 - {{ question.score }} 分
          {% else %}
            得 0 分
          {% endif %}
          
          <span class="label testpaper-question-body-item__label {% if index == 0 %}label-danger{% else %}label-success{% endif %} hidden-xs">
            {% if itemKeyAnalysis and firstCount != 0 %}
              {% set firstAnswerPercent = (itemKeyAnalysis.firstAnswerCount / firstCount * 100)|number_format(1,'.') %}
              {{ firstAnswerPercent }}%
            {% else %}
              0%
            {% endif %}
          </span>
          <span class="testpaper-question-body-item__count">
            {% if itemKeyAnalysis %}{{ itemKeyAnalysis.firstAnswerCount }}{% else %}0{% endif %}人次
          </span>
        </li>
      {% endfor %}
    </ul>
  {% endif %}
{% endblock %}