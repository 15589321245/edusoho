{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/classroom/thread-show/index.js","webpack:///./app/Resources/static-src/app/js/thread/thread-show.js?d8f5*"],"names":["threadShowWidget","element","$onlyTeacherBtnHtml","$","html","find","append","on","$self","$filter","hasClass","$url","data","document","location","href","$userIds","each","substring","length","get","val","ids","$idArray","split","i","addClass","ThreadShowWidget","prop","ele","init","initEvent","response","modal","initPostForm","$node","console","log","onClickPostMore","event","onClickReply","onPostDelete","onPostUp","onConfirmBtn","onClickToggleSubpostForm","onClickEventCancelBtn","onClickSubpost","e","stopPropagation","$btn","currentTarget","parents","removeClass","inSubpost","$container","$form","text","Translator","trans","trigger","toggleClass","initSubpostForm","confirm","post","$subpostsNum","parseInt","remove","status","window","reload","result","preventDefault","$pageBtn","attr","id","animate","scrollTop","offset","top","closest","$list","that","editor","$textarea","CKEDITOR","replace","toolbar","filebrowserImageUploadUrl","getData","validate","ajax","currentDom","rules","content","submitSuccess","button","setData","prepend","pos","empty","submitError","parseJSON","responseText","error","message","parent","eventName","off"],"mappings":"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","file":"app/js/classroom/thread-show/index.js","sourcesContent":["import ThreadShowWidget from 'app/js/thread/thread-show';\n\nvar threadShowWidget = new ThreadShowWidget({\n  element: '.class-detail-content'\n});\n\n\nvar $onlyTeacherBtnHtml = $('.js-only-teacher-div').html();\n$('.class-detail-content').find('.js-all-post-head').append($onlyTeacherBtnHtml);\n\n$('.class-detail-content').on('click', '.js-only-teacher', function () {\n  var $self = $(this);\n  var $filter = $self.hasClass('active') ? '' : '?adopted=1';\n  var $url = $self.data('url') + $filter;\n  document.location.href = $url;\n});\n\nvar $userIds = '';\n$('.class-detail-content').find('.thread-post').each(function () {\n  $userIds += $(this).data('userId') + ',';\n});\n$userIds = $userIds.substring(0, $userIds.length - 1);\n$.get($('#isTeachersUrl').val() + '?ids=' + $userIds, function (ids) {\n  var $idArray = ids.split(',');\n  for (var i = 0; i < $idArray.length; i++) {\n    $('.class-detail-content').find('.user-id-' + $idArray[i]).each(function () {\n      $(this).addClass('teacher');\n    });\n  };\n});\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/classroom/thread-show/index.js","import notify from 'common/notify';\n\nclass ThreadShowWidget {\n    constructor(prop) {\n        this.ele = $(prop.element);\n        this.init();\n    }\n\n    init() {\n        this.initEvent();\n        if ($('[name=access-intercept-check]').length > 0) {\n            $.get($('[name=access-intercept-check]').val(), function (response) {\n                if (response) {\n                    return;\n                }\n\n                $('.access-intercept-modal').modal('show');\n\n            }, 'json');\n        }\n        this.initPostForm();\n    }\n    initEvent() {\n        const $node = this.ele;\n\n        console.log($node);\n\n        $node.on('click', '.js-post-more', event => this.onClickPostMore(event));\n        $node.on('click', '.js-reply', event => this.onClickReply(event));\n        $node.on('click', '.js-post-delete', event => this.onPostDelete(event));\n        $node.on('click', '.js-post-up', event => this.onPostUp(event));\n        $node.on('click', '[data-role=confirm-btn]', event => this.onConfirmBtn(event));\n        $node.on('click', '.js-toggle-subpost-form', event => this.onClickToggleSubpostForm(event));\n        $node.on('click', '.js-event-cancel', event => this.onClickEventCancelBtn(event));\n        $node.on('click', '.thread-subpost-container .pagination a', event => this.onClickSubpost(event));\n    }\n\n    onClickPostMore(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        $btn.parents('.thread-subpost-moretext').addClass('hide');\n        $btn.parents('.thread-post').find('.thread-subpost').removeClass('hide');\n        $btn.parents('.thread-post').find('.pagination').removeClass('hide');\n    }\n\n    onClickReply(e) {\n        console.log('ok');\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        const inSubpost = $btn.parents('.thread-subpost-list').length > 0;\n        const $container = $btn.parents('.thread-post').find('.thread-subpost-container');\n        const $form = $container.find('.thread-subpost-form');\n        if (inSubpost) {\n            $form.removeClass('hide');\n            const text = Translator.trans('thread.post.reply') + ' @ ' + $btn.parents('.thread-post').data('authorName') + '： ';\n            $form.find('textarea').val(text).trigger('focus');\n\n        } else {\n            $container.toggleClass('hide');\n        }\n\n        if ($btn.html() == Translator.trans('thread.post.reply')) {\n            $btn.html(Translator.trans('thread.post.put_away'));\n        } else {\n            $btn.html(Translator.trans('thread.post.reply'));\n        }\n\n        this.initSubpostForm($form);\n    }\n\n    onPostDelete(e) {\n        e.stopPropagation();\n        const $node = this.ele;\n        const $btn = $(e.currentTarget);\n        if (!confirm(Translator.trans('thread.post.delete_hint'))) {\n            return;\n        }\n        const inSubpost = $btn.parents('.thread-subpost-list').length > 0;\n\n        $.post($btn.data('url'), function () {\n            if (inSubpost) {\n                const $subpostsNum = $btn.parents('.thread-post').find('.subposts-num');\n                $subpostsNum.text(parseInt($subpostsNum.text()) - 1);\n            } else {\n                $node.find('.thread-post-num').text(parseInt($node.find('.thread-post-num').text()) - 1);\n            }\n            $($btn.data('for')).remove();\n        });\n    }\n\n    onPostUp(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        $.post($btn.data('url'), function (response) {\n            if (response.status == 'ok') {\n                $btn.find(\".post-up-num\").text(parseInt($btn.find(\".post-up-num\").text()) + 1);\n            } else if (response.status == 'votedError') {\n                notify('danger', Translator.trans('thread.post.like_hint'));\n            } else {\n                notify('danger', Translator.trans('thread.post.like_error_hint'));\n            }\n        }, 'json');\n    }\n\n    onConfirmBtn(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        if (!confirm($btn.data('confirmMessage'))) {\n            return;\n        }\n        $.post($btn.data('url'), function () {\n            if ($btn.data('afterUrl')) {\n                window.location.href = $btn.data('afterUrl');\n                return;\n            }\n            window.location.reload();\n        });\n    }\n\n    onClickToggleSubpostForm(e) {\n        e.stopPropagation();\n        const $btn = $(e.currentTarget);\n        const $form = $btn.parents('.thread-subpost-container').find('.thread-subpost-form');\n        $form.toggleClass('hide');\n        this.initSubpostForm($form);\n    }\n\n    onClickEventCancelBtn(e) {\n        $.post($(e.currentTarget).data('url'), function (result) {\n            window.location.reload();\n        });\n    }\n\n    onClickSubpost(e) {\n        e.preventDefault();\n        const $pageBtn = $(e.currentTarget);\n\n        $.post($pageBtn.attr('href'), function (result) {\n\n            const id = $pageBtn.parents(\".thread-post\").attr(\"id\");\n            $(\"body,html\").animate({\n                scrollTop: $(\"#\" + id).offset().top\n            }, 300), !1\n\n            $pageBtn.closest('.thread-subpost-container .thread-subpost-content').html(result);\n        });\n    }\n\n    initPostForm() {\n        const $list = $('.thread-pripost-list');\n        const $form = $('#thread-post-form');\n        const that = this;\n\n        if ($form.length == 0) {\n            return;\n        }\n\n        let editor = null;\n        const $textarea = $form.find('textarea[name=content]');\n        if ($textarea.data('imageUploadUrl')) {\n            editor = CKEDITOR.replace($textarea.attr('id'), {\n                toolbar: 'Thread',\n                filebrowserImageUploadUrl: $textarea.data('imageUploadUrl')\n            });\n            editor.on('change',()=> {\n                $textarea.val(editor.getData());\n            })\n        }\n        const $btn = $form.find('[type=submit]');\n        $form.validate({\n            ajax: true,\n            currentDom: $btn,\n            rules: {\n                content: 'required'\n            },\n            submitSuccess: function (response) {\n                $btn.button('reset');\n                if ($textarea.data('imageUploadUrl')) {\n                    $list.append(response);\n                    editor.setData('');\n                } else {\n                    $list.prepend(response);\n                    $textarea.val('');\n                }\n\n                const pos = $list.find('li:last-child').offset();\n                $('body').scrollTop(pos.top);\n                $form.find('.thread-post-num').text(parseInt($form.find('.thread-post-num').text()) + 1);\n                $list.find('li.empty').remove();\n                $list.closest('.top-reply').removeClass('hidden');\n\n                //清除附件\n                $('.js-attachment-list').empty();\n                $('.js-attachment-ids').val(\"\");\n                $('.js-upload-file').removeClass('hidden');\n            },\n            submitError: function (data) {\n                $btn.button('reset');\n                data = $.parseJSON(data.responseText);\n                if (data.error) {\n                    notify('danger', data.error.message)\n                } else {\n                    notify('danger', Translator.trans('thread.post.reply_error_hint'))\n                }\n            }\n        })\n    }\n\n    initSubpostForm($form) {\n        const $btn = $form.find('[type=submit]');\n        $form.validate({\n            ajax: true,\n            currentDom: $btn,\n            rules: {\n                content: 'required'\n            },\n            submitSuccess: function (data) {\n                if (data.error) {\n                    notify('danger', data.error);\n                    return;\n                }\n                $btn.button('reset');\n                $form.parents('.thread-subpost-container').find('.thread-subpost-list').append(data);\n                $form.find('textarea').val('');\n                const $subpostsNum = $form.parents('.thread-post').find('.subposts-num');\n                $subpostsNum.text(parseInt($subpostsNum.text()) + 1);\n                $subpostsNum.parent().removeClass('hide');\n            },\n            submitError: function (data) {\n                $btn.button('reset');\n                data = $.parseJSON(data.responseText);\n                if (data.error) {\n                    notify('danger', data.error.message);\n                } else {\n                    notify('danger', Translator.trans('thread.post.reply_error_hint'));\n                }\n            }\n        })\n    }\n\n    undelegateEvents(element, eventName) {\n        this.ele.off(element, eventName);\n    }\n}\n\nexport default ThreadShowWidget\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/thread/thread-show.js"],"sourceRoot":""}