{% extends 'TopxiaAdminBundle:User:layout.html.twig' %}

{% block title %}用户日志 - {{ parent() }}{% endblock %}

{% set menu = 'logs' %}

{% set script_controller = 'log/list' %}

{% block main %}

<div class="page-header"><h1>用户日志</h1></div>

{{ web_macro.flash_messages() }}

<form class="well well-sm form-inline">

  <div class="form-group">
    <select class="form-control" name="level">
        {{ select_options(dict('logLevel'), app.request.query.get('level'), '--所有等级--') }}
    </select>
  </div>

  <div class="form-group">
    <input type="text" id="startDateTime" value="{{app.request.query.get('startDateTime')}}" name="startDateTime" class="form-control" placeholder="起始时间">
  </div>

  <div class="form-group">
    <input type="text" id="endDateTime" value="{{app.request.query.get('endDateTime')}}" name="endDateTime" class="form-control" placeholder="结束时间">
  </div>

  <div class="form-group">
    <input type="text" id="nickname" name="nickname" value="{{app.request.query.get('nickname')}}" class="form-control" placeholder="用户昵称">
  </div>

  <button class="btn btn-primary">搜索</button>

</form>

  <table class="table table-hover">
    <tr>
      <th width="15%">用户</th>
      <th width="15%">操作</th>
      <th width="40%">信息</th>
      <th width="10%">日志等级</th>
      <th width="20%">时间/IP</th>
    </tr>   
    {% for log in logs %}
      <tr>
        <td>{{ admin_macro.user_link(users[log.userId]|default(null)) }}</td>
        <td>{{ log.module }}.{{ log.action }}</td>
        <td>{{ log.message }}</td>
        <td>{{ dict('logLevel:html')[log.level]|raw }}</td>
        <td>
          <span class="">{{ log.createdTime|date("Y-m-d H:i:s") }}</span>
          <br />
          <a  class="text-muted text-sm" href="http://www.baidu.com/s?wd={{ log.ip }}" target="_blank">{{ log.ip }}</a>
        </td>
      </tr>
    {% else %}
      <tr><td class="empty" colspan="5">无日志记录</tr>
    {% endfor %}
  </table>

  {{ web_macro.paginator(paginator) }}

{% endblock %}