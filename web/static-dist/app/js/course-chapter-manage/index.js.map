{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/course-chapter-manage/index.js"],"names":["$","on","e","keyCode","which","preventDefault","sortList","$list","data","sortable","get","lessonNum","chapterNum","unitNum","find","each","$item","hasClass","text","post","ids","response","$this","_this","$form","validator","validate","rules","title","ajax","currentDom","submitSuccess","html","closest","modal","addClass","attr","length","replaceWith","Translator","trans","$parent","add","nextAll","before","append"],"mappings":"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","file":"app/js/course-chapter-manage/index.js","sourcesContent":["import notify from \"common/notify\";\n\n$('#chapter-title-field').on('keypress', function (e) {\n  if ((e.keyCode || e.which) === 13) {\n    e.preventDefault();\n  }\n});\n\nlet sortList = function ($list) {\n  let data = $list.sortable(\"serialize\").get();\n  let lessonNum = 0;\n  let chapterNum = 0;\n  let unitNum = 0;\n\n  $list.find('.task-manage-unit, .task-manage-chapter').each(function () {\n    let $item = $(this);\n    if ($item.hasClass('item-lesson')) {\n      lessonNum++;\n      $item.find('.number').text(lessonNum);\n    } else if ($item.hasClass('task-manage-unit')) {\n      unitNum++;\n      $item.find('.number').text(unitNum);\n    } else if ($item.hasClass('task-manage-chapter')) {\n      chapterNum++;\n      unitNum = 0;\n      $item.find('.number').text(chapterNum);\n    }\n  });\n\n  $.post($list.data('sortUrl'), { ids: data }, function (response) {\n\n  });\n};\n\n\n$('#course-chapter-btn').on('click', function () {\n  let $this = $(this);\n  let _this = this;\n  let $form = $('#course-chapter-form');\n  let validator = $form.validate({\n    rules: {\n      title: 'required'\n    },\n    ajax: true,\n    currentDom: $this,\n    submitSuccess: function (html) {\n      $this.closest('.modal').modal('hide');\n      if (!$('.js-task-empty').hasClass('hidden')) {\n        $('.js-task-empty').addClass('hidden');\n      }\n      let $item = $('#' + $(html).attr('id'));\n\n      if ($item.length) {\n        $item.replaceWith(html);\n        notify('success', Translator.trans('site.save_success_hint'));\n      } else {\n        let $parent = $('#' + $form.data('parentid'));\n        if ($parent.length) {\n          let add = 0;\n          $parent.nextAll().each(function () {\n            if ($(this).hasClass('task-manage-chapter')) {\n              $(this).before(html);\n              add = 1;\n              return false;\n            }\n\n          });\n          if (add != 1) {\n            $(\"#sortable-list\").append(html);\n          }\n        } else {\n          $(\"#sortable-list\").append(html);\n        }\n\n        let $list = $(\"#sortable-list\");\n        sortList($list);\n      }\n    },\n  });\n})\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/course-chapter-manage/index.js"],"sourceRoot":""}