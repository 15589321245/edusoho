{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/announcement/announcement-write/index.js"],"names":["validator","initValidator","initEvent","initCkeditor","initDatetimePicker","$","validate","onkeyup","rules","content","required","startTime","DateAndTime","endTime","modal","click","$modal","html","load","data","form","button","post","attr","serialize","json","window","location","reload","editor","CKEDITOR","replace","toolbar","filebrowserImageUploadUrl","on","val","getData","now","Date","datetimepicker","language","autoclose","ev","substring"],"mappings":";;;;;;AAAA,KAAIA,YAAYC,eAAhB;AACAC,WAAUF,SAAV;AACAG,cAAaH,SAAb;AACAI,oBAAmBJ,SAAnB;;AAEA,UAASC,aAAT,GAAyB;AACvB,UAAOI,EAAE,0BAAF,EAA8BC,QAA9B,CAAuC;AAC5CC,cAAS,KADmC;AAE5CC,YAAO;AACLC,gBAAS;AACPC,mBAAU;AADH,QADJ;AAILC,kBAAW;AACTD,mBAAU,IADD;AAETE,sBAAa;AAFJ,QAJN;AAQLC,gBAAS;AACPH,mBAAU,IADH;AAEPE,sBAAa;AAFN;AARJ;AAFqC,IAAvC,CAAP;AAgBD;;AAED,UAASV,SAAT,GAAqB;AACnBG,KAAE,QAAF,EAAYS,KAAZ,CAAkB,MAAlB;AACAT,KAAE,mCAAF,EAAuCU,KAAvC,CAA6C,YAAY;AACvD,SAAIC,SAASX,EAAE,QAAF,CAAb;AACAW,YAAOC,IAAP,CAAY,EAAZ,EAAgBC,IAAhB,CAAqBb,EAAE,IAAF,EAAQc,IAAR,CAAa,KAAb,CAArB;AACD,IAHD;AAIAd,KAAE,cAAF,EAAkBU,KAAlB,CAAwB,YAAY;AAClC,SAAIf,UAAUoB,IAAV,EAAJ,EAAsB;AACpBf,SAAE,cAAF,EAAkBgB,MAAlB,CAAyB,SAAzB;AACAhB,SAAEiB,IAAF,CAAOjB,EAAE,0BAAF,EAA8BkB,IAA9B,CAAmC,QAAnC,CAAP,EAAqDlB,EAAE,0BAAF,EAA8BmB,SAA9B,EAArD,EAAgG,UAAUC,IAAV,EAAgB;AAC9GC,gBAAOC,QAAP,CAAgBC,MAAhB;AACD,QAFD,EAEG,MAFH;AAGD;AACF,IAPD;AAQD;;AAED,UAASzB,YAAT,CAAsBH,SAAtB,EAAiC;AAC/B;AACA,OAAI6B,SAASC,SAASC,OAAT,CAAiB,4BAAjB,EAA+C;AAC1DC,cAAS,QADiD;AAE1DC,gCAA2B5B,EAAE,6BAAF,EAAiCc,IAAjC,CAAsC,gBAAtC;AAF+B,IAA/C,CAAb;;AAKAU,UAAOK,EAAP,CAAU,QAAV,EAAoB,YAAM;AACxB7B,OAAE,6BAAF,EAAiC8B,GAAjC,CAAqCN,OAAOO,OAAP,EAArC;AACApC,eAAUoB,IAAV;AACD,IAHD;AAIAS,UAAOK,EAAP,CAAU,MAAV,EAAkB,YAAM;AACtB7B,OAAE,6BAAF,EAAiC8B,GAAjC,CAAqCN,OAAOO,OAAP,EAArC;AACApC,eAAUoB,IAAV;AACD,IAHD;AAID;;AAED,UAAShB,kBAAT,CAA4BJ,SAA5B,EAAuC;AACrC,OAAIqC,MAAM,IAAIC,IAAJ,EAAV;AACAjC,KAAE,kBAAF,EAAsBkC,cAAtB,CAAqC;AACnCC,eAAU,IADyB;AAEnCC,gBAAW;AAFwB,IAArC,EAGGP,EAHH,CAGM,MAHN,EAGc,UAAUQ,EAAV,EAAc;AAC1B1C,eAAUoB,IAAV;AACD,IALD;;AAOAf,KAAE,kBAAF,EAAsBkC,cAAtB,CAAqC,cAArC,EAAqDF,GAArD;AACAhC,KAAE,kBAAF,EAAsBkC,cAAtB,GAAuCL,EAAvC,CAA0C,YAA1C,EAAwD,YAAY;AAClE7B,OAAE,gBAAF,EAAoBkC,cAApB,CAAmC,cAAnC,EAAmDlC,EAAE,kBAAF,EAAsB8B,GAAtB,GAA4BQ,SAA5B,CAAsC,CAAtC,EAAyC,EAAzC,CAAnD;AACD,IAFD;;AAIAtC,KAAE,gBAAF,EAAoBkC,cAApB,CAAmC;AACjCE,gBAAW,IADsB;AAEjCD,eAAU;AAFuB,IAAnC,EAGGN,EAHH,CAGM,MAHN,EAGc,UAAUQ,EAAV,EAAc;AAC1B1C,eAAUoB,IAAV;AACD,IALD;;AAOAf,KAAE,gBAAF,EAAoBkC,cAApB,CAAmC,cAAnC,EAAmDF,GAAnD;;AAEAhC,KAAE,gBAAF,EAAoBkC,cAApB,GAAqCL,EAArC,CAAwC,YAAxC,EAAsD,YAAY;AAChE7B,OAAE,kBAAF,EAAsBkC,cAAtB,CAAqC,YAArC,EAAmDlC,EAAE,gBAAF,EAAoB8B,GAApB,GAA0BQ,SAA1B,CAAoC,CAApC,EAAuC,EAAvC,CAAnD;AACD,IAFD;AAGD,E","file":"app/js/announcement/announcement-write/index.js","sourcesContent":["let validator = initValidator();\ninitEvent(validator);\ninitCkeditor(validator);\ninitDatetimePicker(validator);\n\nfunction initValidator() {\n  return $('#announcement-write-form').validate({\n    onkeyup: false,\n    rules: {\n      content: {\n        required: true,\n      },\n      startTime: {\n        required: true,\n        DateAndTime: true,\n      },\n      endTime: {\n        required: true,\n        DateAndTime: true,\n      }\n    },\n  });\n}\n\nfunction initEvent() {\n  $('#modal').modal('show');\n  $('a[data-role=\"announcement-modal\"]').click(function () {\n    var $modal = $(\"#modal\");\n    $modal.html(\"\").load($(this).data('url'));\n  })\n  $('.js-save-btn').click(function () {\n    if (validator.form()) {\n      $('.js-save-btn').button('loading');\n      $.post($('#announcement-write-form').attr('action'), $('#announcement-write-form').serialize(), function (json) {\n        window.location.reload();\n      }, 'json');\n    }\n  })\n}\n\nfunction initCkeditor(validator) {\n  // group: 'course'\n  var editor = CKEDITOR.replace('announcement-content-field', {\n    toolbar: 'Simple',\n    filebrowserImageUploadUrl: $('#announcement-content-field').data('imageUploadUrl')\n  });\n\n  editor.on('change', () => {\n    $('#announcement-content-field').val(editor.getData());\n    validator.form();\n  });\n  editor.on('blur', () => {\n    $('#announcement-content-field').val(editor.getData());\n    validator.form();\n  });\n}\n\nfunction initDatetimePicker(validator) {\n  var now = new Date();\n  $(\"[name=startTime]\").datetimepicker({\n    language: \"zh\",\n    autoclose: true\n  }).on('hide', function (ev) {\n    validator.form();\n  });\n\n  $('[name=startTime]').datetimepicker('setStartDate', now);\n  $('[name=startTime]').datetimepicker().on('changeDate', function () {\n    $('[name=endTime]').datetimepicker('setStartDate', $('[name=startTime]').val().substring(0, 16));\n  });\n\n  $(\"[name=endTime]\").datetimepicker({\n    autoclose: true,\n    language: \"zh\",\n  }).on('hide', function (ev) {\n    validator.form();\n  });\n\n  $('[name=endTime]').datetimepicker('setStartDate', now);\n\n  $('[name=endTime]').datetimepicker().on('changeDate', function () {\n    $('[name=startTime]').datetimepicker('setEndDate', $('[name=endTime]').val().substring(0, 16));\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/announcement/announcement-write/index.js"],"sourceRoot":""}