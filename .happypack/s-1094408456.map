{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/audio/index.js"],"names":["Audio","$","$step2_form","validator","data","validate","groups","nameGroup","rules","title","required","maxlength","trim","minute","second","messages","unsigned_integer","second_range","_inItStep2form","blur","form","parseInt","val","fileChooser","onSelectFile","file","length","Math","round","source","id","uri","on"],"mappings":";;;;AAAA;;;;AACA;;;;;;IAEMA,K;AACJ,mBAAc;AAAA;;AACZ,oCAAgBC,EAAE,uBAAF,CAAhB;AACD;;;;qCAEgB;AACf,UAAIC,cAAcD,EAAE,aAAF,CAAlB;AACA,UAAIE,YAAYD,YAAYE,IAAZ,CAAiB,WAAjB,CAAhB;;AAEAF,kBAAYG,QAAZ,CAAqB;AACnBC,gBAAQ;AACNC,qBAAW;AADL,SADW;AAInBC,eAAO;AACLC,iBAAO;AACLC,sBAAU,IADL;AAELC,uBAAW,EAFN;AAGLC,kBAAM;AAHD,WADF;AAMLC,kBAAQ,4CANH;AAOLC,kBAAQ,wCAPH;AAQL,0BAAgB;AARX,SAJY;AAcnBC,kBAAU;AACRF,kBAAQ;AACNH,sBAAU,OADJ;AAENM,8BAAkB;AAFZ,WADA;AAKRF,kBAAQ;AACNJ,sBAAU,OADJ;AAENO,0BAAc,YAFR;AAGND,8BAAkB;AAHZ,WALA;AAUR,0BAAgB;AAVR;AAdS,OAArB;AA4BD;;;;;;AAUHE;;AAEAjB,EAAE,YAAF,EAAgBkB,IAAhB,CAAqB,YAAY;AAC/B,MAAIhB,YAAYF,EAAE,aAAF,EAAiBG,IAAjB,CAAsB,WAAtB,CAAhB;AACA,MAAID,aAAaA,UAAUiB,IAAV,EAAjB,EAAmC;AACjC,QAAMP,SAASQ,SAASpB,EAAE,SAAF,EAAaqB,GAAb,EAAT,IAA+B,CAA9C;AACA,QAAMR,SAASO,SAASpB,EAAE,SAAF,EAAaqB,GAAb,EAAT,IAA+B,CAA9C;AACArB,MAAE,SAAF,EAAaqB,GAAb,CAAiBT,SAAS,EAAT,GAAcC,MAA/B;AACD;AACF,CAPD;;AASA,IAAMS,cAAc,0BAApB;;AAEA,IAAMC,eAAe,SAAfA,YAAe,OAAQ;AAC3B;AACA,MAAIC,KAAKC,MAAT,EAAiB;AACf,QAAIb,SAASQ,SAASI,KAAKC,MAAL,GAAc,EAAvB,CAAb;AACA,QAAIZ,SAASa,KAAKC,KAAL,CAAWH,KAAKC,MAAL,GAAc,EAAzB,CAAb;AACAzB,MAAE,SAAF,EAAaqB,GAAb,CAAiBT,MAAjB;AACAZ,MAAE,SAAF,EAAaqB,GAAb,CAAiBR,MAAjB;AACAb,MAAE,SAAF,EAAaqB,GAAb,CAAiBT,SAAS,EAAT,GAAcC,MAA/B;AACD;AACDb,IAAE,uBAAF,EAA2BqB,GAA3B,CAA+BG,KAAKI,MAApC;AACA,MAAIJ,KAAKI,MAAL,IAAe,MAAnB,EAA2B;AACzB5B,MAAE,cAAF,EAAkBqB,GAAlB,CAAsBG,KAAKK,EAA3B;AACA7B,MAAE,eAAF,EAAmBqB,GAAnB,CAAuB,EAAvB;AACD,GAHD,MAGO;AACLrB,MAAE,cAAF,EAAkBqB,GAAlB,CAAsB,EAAtB;AACArB,MAAE,eAAF,EAAmBqB,GAAnB,CAAuBG,KAAKM,GAA5B;AACD;AACF,CAjBD;;AAmBAR,YAAYS,EAAZ,CAAe,QAAf,EAAyBR,YAAzB","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import FileChooser from '../../file-chooser/file-choose';\nimport { chooserUiOpen, chooserUiClose, showChooserType } from '../widget/chooser-ui.js';\n\nclass Audio {\n  constructor() {\n    showChooserType($('[name=\"ext[mediaId]\"]'));\n  }\n\n  _inItStep2form() {\n    var $step2_form = $('#step2-form');\n    var validator = $step2_form.data('validator');\n\n    $step2_form.validate({\n      groups: {\n        nameGroup: 'minute second'\n      },\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n        },\n        minute: 'required unsigned_integer unsigned_integer',\n        second: 'required second_range unsigned_integer',\n        'ext[mediaId]': 'required'\n      },\n      messages: {\n        minute: {\n          required: '请输入时长',\n          unsigned_integer: '时长必须大于0'\n        },\n        second: {\n          required: '请输入时长',\n          second_range: '秒只能在0-59之间',\n          unsigned_integer: '时长必须大于0'\n        },\n        'ext[mediaId]': '请上传或选择%display%'\n      }\n    });\n\n  }\n\n\n}\n\n\n\n\n\n\n_inItStep2form();\n\n$(\".js-length\").blur(function () {\n  let validator = $(\"#step2-form\").data('validator');\n  if (validator && validator.form()) {\n    const minute = parseInt($('#minute').val()) | 0;\n    const second = parseInt($('#second').val()) | 0;\n    $(\"#length\").val(minute * 60 + second);\n  }\n});\n\nconst fileChooser = new FileChooser();\n\nconst onSelectFile = file => {\n  chooserUiClose();\n  if (file.length) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#length\").val(minute * 60 + second);\n  }\n  $('[name=\"ext[mediaId]\"]').val(file.source);\n  if (file.source == 'self') {\n    $(\"#ext_mediaId\").val(file.id);\n    $(\"#ext_mediaUri\").val('');\n  } else {\n    $(\"#ext_mediaId\").val('');\n    $(\"#ext_mediaUri\").val(file.uri);\n  }\n}\n\nfileChooser.on('select', onSelectFile);\n"]}