{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/cashier/coin.js","webpack:///./app/Resources/static-src/common/api/modules/trade.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_express.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_wap.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/confirm.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/lianlianpay_wap.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/lianlianpay_web.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/payment.js","webpack:///./app/Resources/static-src/app/js/cashier/index.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_js.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_mweb.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_native.js","webpack:///./app/Resources/static-src/common/api/ajax.js","webpack:///./app/Resources/static-src/common/api/index.js","webpack:///./app/Resources/static-src/common/api/modules/classroom.js","webpack:///./app/Resources/static-src/common/api/modules/course.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/sdk.js"],"names":["Coin","$coinContainer","cashierForm","$container","cashierFrom","maxCoinInput","data","initEvent","self","on","$this","$","event","currentTarget","inputCoinNum","val","isNaN","hidePasswordInput","showPasswordInput","calcPayPrice","find","rules","required","passwordCheck","closest","show","hide","tradeModule","api","get","options","Object","assign","url","params","tradeSn","create","type","AlipayLegacyExpress","res","getOptions","showConfirmModal","window","open","redirectUrl","location","href","AlipayLegacyWap","ConfirmModal","modalID","template","Translator","trans","length","append","checkIsPaid","bind","getTrade","then","isPaid","successUrl","modal","LianlianpayWap","LianlianpayWeb","BasePayment","confirmModal","createTrade","afterTradeCreated","postParams","gateway","orderSn","coinAmount","amount","openid","payPassword","keys","forEach","k","undefined","callback","filterParams","trade","paidSuccessUrl","catch","CashierForm","$form","validator","validate","initCoin","paySdk","$coin","coin","post","text","resp","hasClass","addClass","siblings","removeClass","attr","valid","$btn","button","formDataToObject","payAmount","pay","formArr","serializeArray","index","name","value","WechatPayJs","WechatPayMweb","mweb_url","WechatPayNative","clearInterval","intervalWechatId","$modal","qrcodeUrl","cash_amount","startInterval","setInterval","ajax","parameter","dataType","beforeSend","request","setRequestHeader","Promise","resolve","API_URL_PREFIX","Api","course","classroom","classroomModule","join","classroomId","courseModule","courseId","PaySDK","getGateway","wpn","wpm","wpj","ale","alw","llwp","llwb","payment","isMobile"],"mappings":"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","file":"app/js/cashier/index.js","sourcesContent":["export default class Coin {\n  constructor($coinContainer, cashierForm) {\n    this.$container = $coinContainer;\n    this.cashierFrom = cashierForm;\n    this.maxCoinInput = this.$container.data('maxAllowCoin') > this.$container.data('coinBalance') ? this.$container.data('coinBalance') : this.$container.data('maxAllowCoin');\n    this.initEvent();\n  }\n\n  validate() {\n\n  }\n\n  initEvent() {\n    let self = this;\n    this.$container.on('blur', '.js-coin-amount', event => {\n      let $this = $(event.currentTarget);\n      let inputCoinNum = $this.val();\n      if(isNaN(inputCoinNum) || inputCoinNum <= 0){\n        $this.val(0);\n        self.hidePasswordInput();\n      }\n\n      if ($this.val() > self.maxCoinInput) {\n        $this.val(self.maxCoinInput);\n      }\n\n      if ($this.val() > 0) {\n        self.showPasswordInput();\n        self.cashierFrom.calcPayPrice($this.val());\n      }\n\n    });\n\n  }\n\n  showPasswordInput() {\n    this.$container.find('[name=\"payPassword\"]').rules('add', { required: true, passwordCheck: true});\n    this.$container.find('.js-pay-password').closest('div').show();\n  }\n\n  hidePasswordInput() {\n    this.$container.find('[name=\"payPassword\"]').rules('remove','required passwordCheck');\n    this.$container.find('.js-pay-password').closest('div').hide();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/coin.js","import ajax from '../ajax';\n\nconst tradeModule = (api) => {\n  return {\n    get(options) {\n      return ajax(Object.assign({\n        url: `${api}/trades/${options.params.tradeSn}`,\n      }, options));\n    },\n\n    create(options) {\n      return ajax(Object.assign({\n        url: `${api}/trades`,\n        type: 'POST',\n      }, options));\n\n    }\n  }\n};\n\nexport default tradeModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/trade.js","import BasePayment from './payment';\n\nexport default class AlipayLegacyExpress extends BasePayment {\n\n  afterTradeCreated(res) {\n    let options = this.getOptions();\n    if (options.showConfirmModal) {\n      window.open(res.redirectUrl);\n      this.showConfirmModal(res.tradeSn);\n    } else {\n      location.href = res.redirectUrl;\n    }\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_express.js","import BasePayment from './payment';\n\nexport default class AlipayLegacyWap extends BasePayment {\n\n  afterTradeCreated(res) {\n    location.href = res.redirectUrl;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_wap.js","import notify from 'common/notify';\nimport BasePayment from './payment';\n\nclass ConfirmModal {\n\n  $container = $('body');\n\n  modalID = 'cashier-confirm-modal';\n\n  tradeSn = '';\n\n  constructor() {\n\n    let template = `\n      <div id=\"${this.modalID}\" class=\"modal\">\n        <div class=\"modal-dialog cd-modal-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n                <i class=\"cd-icon cd-icon-close\"></i>\n              </button>\n              <h4 class=\"modal-title\">${Translator.trans('cashier.confirm.title')}</h4>\n            </div>\n            <div class=\"modal-body\">\n              <p>\n              ${Translator.trans('cashier.confirm.desc')}\n              </p>\n            </div>\n            <div class=\"modal-footer\">\n              <a class=\"btn cd-btn cd-btn-flat-default\" data-dismiss=\"modal\">${Translator.trans('cashier.confirm.pick_again')}</a>\n              <a class=\"btn cd-btn cd-btn-primary cd-btn-lg js-confirm-btn\">${Translator.trans('cashier.confirm.success')}</a>\n            </div>\n          </div>\n        <div>  \n      </div>\n    `;\n\n    if (this.$container.find('#'+this.modalID).length === 0) {\n      this.$container.append(template);\n    }\n\n    $('body').on('click', '.js-confirm-btn', this.checkIsPaid.bind(this));\n  }\n\n  checkIsPaid() {\n    BasePayment.getTrade(this.tradeSn).then(res => {\n      if (res.isPaid) {\n        location.href = res.successUrl;\n      } else {\n        notify('danger', Translator.trans('cashier.confirm.fail_message'));\n        $('#' + this.modalID).modal('hide');\n      }\n    });\n  }\n\n  show(tradeSn) {\n    $('#'+this.modalID).modal('show');\n    this.tradeSn = tradeSn;\n  }\n}\n\nexport default ConfirmModal;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/confirm.js","import BasePayment from './payment';\n\nexport default class LianlianpayWap extends BasePayment {\n\n  afterTradeCreated(res) {\n    location.href = res.redirectUrl;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/lianlianpay_wap.js","import BasePayment from './payment';\nimport AlipayLegacyExpress from './alipay_legacy_express';\n\nexport default class LianlianpayWeb extends AlipayLegacyExpress {\n  \n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/lianlianpay_web.js","import Api from 'common/api';\nimport notify from 'common/notify';\nimport ConfirmModal from './confirm';\n\nexport default class BasePayment {\n\n  setOptions(options) {\n    this.options = options;\n  }\n\n  getOptions() {\n    return this.options;\n  }\n\n  showConfirmModal(tradeSn) {\n    if (!this.confirmModal) {\n      this.confirmModal = new ConfirmModal();\n    }\n\n    this.confirmModal.show(tradeSn);\n  }\n\n  pay(params) {\n    BasePayment.createTrade(params, this.afterTradeCreated.bind(this));\n  }\n\n  afterTradeCreated(res) {\n\n  }\n\n  static filterParams(postParams) {\n    let params = {\n      gateway: postParams.gateway,\n      type: postParams.type,\n      orderSn: postParams.orderSn,\n      coinAmount: postParams.coinAmount,\n      amount: postParams.amount,\n      openid: postParams.openid,\n      payPassword: postParams.payPassword\n    };\n\n    Object.keys(params).forEach(k => (!params[k] && params[k] !== undefined) && delete params[k]);\n\n    return params;\n  }\n\n  static createTrade(postParams, callback) {\n\n    let params = this.filterParams(postParams);\n\n    Api.trade.create({data:params}).then(res => {\n      if (res.paidSuccessUrl) {\n        location.href = res.paidSuccessUrl;\n      } else {\n        callback(res)\n      }\n\n    }).catch(res => {\n      notify('danger', Translator.trans('cashier.pay.error_message'));\n    });\n  }\n\n  static getTrade(tradeSn) {\n    let params = {\n      tradeSn: tradeSn\n    };\n\n    return Api.trade.get({\n      params: params\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/payment.js","import Coin from './coin';\nimport PaySDK from './pay/sdk';\n\nclass CashierForm {\n\n  constructor($form) {\n    this.$container = $form;\n\n    this.validator = this.$container.validate();\n\n    this.initEvent();\n    this.initCoin();\n\n    this.paySdk = new PaySDK();\n  }\n\n  initCoin() {\n    let $coin = $('#coin-use-section');\n    if ($coin.length > 0) {\n      this.coin = new Coin($coin, this);\n    }\n  }\n\n  calcPayPrice(coinAmount) {\n\n    let self = this;\n    $.post(this.$container.data('priceUrl'), {\n      coinAmount: coinAmount\n    }, resp => {\n      self.$container.find('.js-pay-price').text(resp.data);\n    });\n\n  }\n\n  initEvent() {\n    // 支付方式切换\n    this.$container.on('click', '.check', event => {\n      let $this = $(event.currentTarget);\n      if (!$this.hasClass('active') && !$this.hasClass('disabled')) {\n        $this.addClass('active').siblings().removeClass('active');\n        $(\"input[name='payment']\").val($this.attr(\"id\"));\n      }\n    });\n\n    let $form = this.$container;\n    let self = this;\n    $form.on('click', '.js-pay-btn', event => {\n\n      if ($form.valid()) {\n        let $btn = $(event.currentTarget);\n        $btn.button('loading');\n        let params = self.formDataToObject($form);\n        params.payAmount = self.$container.find('.js-pay-price').text();\n        self.paySdk.pay(params);\n        $btn.button('reset');\n      }\n\n    });\n  }\n\n  formDataToObject($form) {\n\n    let params = {},\n      formArr = $form.serializeArray();\n    for (let index in formArr) {\n      params[formArr[index].name] = formArr[index].value;\n    }\n\n    return params;\n  }\n}\n\n\nnew CashierForm($('#cashier-form'));\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/index.js","import BasePayment from './payment';\n\nexport default class WechatPayJs extends BasePayment {\n\n  afterTradeCreated(res) {\n    location.href = '/pay/center/wxpay?tradeSn=' + res.tradeSn;\n\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_js.js","import BasePayment from './payment';\n\nexport default class WechatPayMweb extends BasePayment {\n\n\tafterTradeCreated(res) {\n\t\tlocation.href = res.mweb_url;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_mweb.js","import BasePayment from './payment';\n\nexport default class WechatPayNative extends BasePayment {\n  $container = $('body');\n\n  modalID = 'wechat-qrcode-modal';\n\n  constructor() {\n    super();\n\n    let template = `\n      <div id=\"${this.modalID}\" class=\"modal\">\n        <div class=\"modal-dialog cd-modal-dialog\">\n          <div class=\"modal-content\">\n          \n            <div class=\"modal-header\">\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n                <i class=\"cd-icon cd-icon-close\"></i>\n              </button>\n              <h4 class=\"modal-title\">${Translator.trans('cashier.wechat_pay')}</h4>\n            </div>\n            \n            <div class=\"modal-body\">\n              <div class=\"qrcode-img\">\n                <img class = 'img-responsive js-qrcode-img' src=\"\">\n                  <div class=\"text-qrcode hidden-xs\">\n                    ${Translator.trans('cashier.wechat_pay.scan_qcode_pay_tips')}\n                  </div>\n                <span class=\"pay-rmb js-pay-amount\"></span>\n              </div>\n            </div>\n            \n          </div>\n        </div>\n      </div>\n     \n    `;\n\n    if (this.$container.find('#'+this.modalID).length === 0) {\n      this.$container.append(template);\n    }\n\n    this.$container.find('#'+this.modalID).on('hidden.bs.modal', function () {\n      clearInterval(window.intervalWechatId);\n    });\n  }\n\n  afterTradeCreated(res) {\n   let $modal = this.$container.find('#'+this.modalID);\n   $modal.find('.js-qrcode-img').attr('src', res.qrcodeUrl);\n   $modal.find('.js-pay-amount').text(res.cash_amount);\n   $modal.modal('show');\n   this.startInterval(res.tradeSn);\n }\n\n startInterval(tradeSn) {\n   window.intervalWechatId = setInterval(this.checkIsPaid.bind(this, tradeSn), 2000);\n }\n\n checkIsPaid(tradeSn) {\n   BasePayment.getTrade(tradeSn).then(res => {\n     if (res.isPaid) {\n       location.href = res.successUrl;\n     }\n\n   });\n }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_native.js","const ajax = (options) => {\n  let parameter = {\n    type: options.type || 'GET',\n    url: options.url || '',\n    dataType: options.dataType || 'json',\n    beforeSend(request) {\n      request.setRequestHeader(\"Accept\", 'application/vnd.edusoho.v2+json');\n      request.setRequestHeader(\"X-CSRF-Token\", $('meta[name=csrf-token]').attr('content'));\n    }\n  }\n\n  if (options.data) {\n    Object.assign(parameter, {\n      data: options.data\n    })\n  }\n\n  return Promise.resolve($.ajax(parameter));\n}\n\nexport default ajax;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/ajax.js","/**\n * 使用说明\n * \n * import Api from 'common/api';\n * \n * Api.course.create({\n *    params: {},\n *    data: {}\n * }).then((res) => {\n *    // 请求成功\n *    console.log('res', res);\n * }).catch((res) => {\n *   // 异常捕获\n *   console.log('catch', res.responseJSON.error.message);\n * })\n */\n\nimport courseModule from './modules/course';\nimport classroomModule from './modules/classroom';\nimport tradeModule from './modules/trade';\n\nconst API_URL_PREFIX = '/api';\n\nconst Api = {\n  // 课程模块\n  course: courseModule(API_URL_PREFIX),\n  // 班级模块\n  classroom: classroomModule(API_URL_PREFIX),\n  trade: tradeModule(API_URL_PREFIX),\n};\n\nexport default Api;\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/index.js","import ajax from '../ajax';\n\nconst classroomModule = (api) => {\n  return {\n    join(options) {\n      return ajax(Object.assign({\n        url: `${api}/classrooms/${options.params.classroomId}/members`,\n        type: 'POST'\n      }, options));\n    }\n  }\n}\n\nexport default classroomModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/classroom.js","import ajax from '../ajax';\n\nconst courseModule = (api) => {\n  return {\n    get(options) {\n      return ajax(Object.assign({\n        url: `${api}/courses/${options.params.courseId}`,\n      }, options));\n    }\n  }\n}\n\nexport default courseModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/course.js","import WechatPayNative from './wechatpay_native';\nimport AlipayLegacyExpress from './alipay_legacy_express';\nimport AlipayLegacyWap from './alipay_legacy_wap';\nimport LianlianpayWap from './lianlianpay_wap';\nimport LianlianpayWeb from './lianlianpay_web';\nimport WechatPayJs from './wechatpay_js';\nimport WechatPayMweb from './wechatpay_mweb';\n\nexport default class PaySDK {\n\n  pay(params, options = {}) {\n    let gateway = this.getGateway(params['payment'], params['isMobile'], params['openid']);\n\t  params.gateway = gateway;\n    let paySdk = null;\n    switch (gateway) {\n      case 'WechatPay_Native':\n        paySdk = this.wpn ? this.wpn : this.wpn = new WechatPayNative();\n        break;\n\t    case 'WechatPay_MWeb':\n\t\t    paySdk = this.wpm ? this.wpm : this.wpm = new WechatPayMweb();\n\t\t    break;\n      case 'WechatPay_Js':\n        paySdk = this.wpj ? this.wpj : this.wpj = new WechatPayJs();\n        break;\n      case 'Alipay_LegacyExpress':\n        paySdk = this.ale ? this.ale : this.ale = new AlipayLegacyExpress();\n        break;\n      case 'Alipay_LegacyWap':\n        paySdk = this.alw ? this.alw : this.alw = new AlipayLegacyWap();\n        break;\n      case 'Lianlian_Wap':\n        paySdk = this.llwp ? this.llwp : this.llwp = new LianlianpayWap();\n        break;\n      case 'Lianlian_Web':\n        paySdk = this.llwb ? this.llwb : this.llwb = new LianlianpayWeb();\n        break;\n    }\n\n    paySdk.options = Object.assign({\n      'showConfirmModal': 1\n    }, options);\n\n    paySdk.pay(params);\n  }\n\n  getGateway(payment, isMobile, openid) {\n    let gateway = '';\n    switch (payment) {\n      case 'wechat':\n        if (openid > 0) {\n          gateway = 'WechatPay_Js';\n        } else if(isMobile){\n\t        gateway = 'WechatPay_MWeb';\n        }else {\n          gateway = 'WechatPay_Native';\n        }\n        break;\n\n      case 'alipay':\n        if (isMobile) {\n          gateway = 'Alipay_LegacyWap';\n        } else {\n          gateway = 'Alipay_LegacyExpress';\n        }\n        break;\n\n      case 'lianlianpay':\n        if (isMobile) {\n          gateway = 'Lianlian_Wap';\n        } else {\n          gateway = 'Lianlian_Web';\n        }\n        break;\n    }\n\n    return gateway;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/sdk.js"],"sourceRoot":""}