{% extends 'v2/layout.html.twig' %}

{% block title %}{{'user.settings.security_menu'|trans}} - {{ parent() }}{% endblock %}

{% set side_nav = 'profile' %}

{% do script(['libs/es-ckeditor/ckeditor.js', 'libs/bootstrap-datetimepicker.js', 'libs/jquery-validation.js','app/js/settings/profile/index.js']) %}

{% block page_title %}
  {{'user.settings.basic_info.content_title'|trans}}
{% endblock %}

{% block main_body %}
  {% if fromCourse %}
    <div class="alert cd-alert cd-alert-info">{{'user.settings.basic_info.alter_description'|trans}}</div>
  {% endif %}

  <form id="user-profile-form" class="row cd-row" method="post">
    {{ web_macro.flash_messages() }}
    <div class="col-md-11">
      <div class="form-group cd-form-group">
        <label for="">{{'user.fields.username_label'|trans}}</label>
        <input type="text" class="form-control" value="{{app.user.nickname}}">
      </div>
    </div>
    <div class="col-md-5">
      <div class="form-group cd-form-group">
        <label for="profile_truename">{{'user.fileds.realname'|trans}}</label>
        {% if profile.truename and (app.user.approvalStatus == 'approved' or app.user.approvalStatus == 'approving') %}
          <input type="text" id="profile_truename" name="profile[truename]"  class="form-control" value="{{ profile.truename }}" readonly>
        {% else %}
          <input type="text" id="profile_truename" name="profile[truename]" class="form-control" value="{{ profile.truename|default('') }}">
        {% endif %}
      </div>
    </div>
    <div class="col-md-5 col-md-offset-1">
      <div class="form-group cd-form-group">
        <label>{{'user.fields.gender_label'|trans}}</label>
        <div class="cd-radio-group">
          <label class="cd-radio {% if profile.gender == 'male' %}checked{% endif %}" for="profile_gender_0" data-toggle="radio">
            <input type="radio" id="profile_gender_0" name="profile[gender]" value="male" {% if profile.gender == 'male' %}checked{% endif %}>
            {{'user.fields.gender.male'|trans}}
          </label>

          <label class="cd-radio {% if profile.gender == 'female' %}checked{% endif %}" for="profile_gender_1" data-toggle="radio">
            <input type="radio" id="profile_gender_1" name="profile[gender]" value="female" {% if profile.gender == 'female' %}checked{% endif %}>
            {{'user.fields.gender.female'|trans}}
          </label>
        </div>
      </div>
    </div>

    <div class="col-md-5">
      <div class="form-group cd-form-group">
        <label for="profile_title">{{'user.settings.basic_info.rank'|trans}}</label>
        <input type="text" id="profile_title" name="profile[title]" class="form-control" value="{{ profile.title|default('') }}">
      </div>
    </div>

    <div class="col-md-5 col-md-offset-1">
      <div class="form-group cd-form-group">
        <label for="profile_signature">{{'user.settings.basic_info.personal_signature'|trans}}</label>
        <input type="text" id="profile_signature" name="profile[signature]" class="form-control" value="{{ profile.signature|default('') }}">
      </div>
    </div>

    <div class="col-md-11">
      <div class="form-group cd-form-group">
        <label for="profile_about">{{'user.settings.basic_info.self_introduction'|trans}}</label>
        <textarea name="profile[about]" rows="10" id="profile_about" class="form-control" data-image-upload-url="{{ path('editor_upload', {token:upload_token('user')}) }}">{{ profile.about|default('') }}</textarea>
      </div>
    </div>

    <div class="col-md-5">
      <div class="form-group cd-form-group">
        <label for="profile_company">{{'user.fields.company_label'|trans}}</label>
        <input type="text" id="profile_company" name="profile[company]" class="form-control" value="{{ profile.company|default('') }}">
      </div>
    </div>

    <div class="col-md-5  col-md-offset-1">
      <div class="form-group cd-form-group">
        <label for="profile_job">{{'user.settings.basic_info.occupation'|trans}}</label>
        <input type="text" id="profile_job" name="profile[job]" class="form-control" value="{{ profile.job|default('') }}">
      </div>
    </div>

    <div class="col-md-5">
      <div class="form-group cd-form-group">
        <label for="profile_site">{{'user.settings.basic_info.personal_space'|trans}}</label>
        <input type="text" id="profile_site" name="profile[site]" class="form-control" value="{{ profile.site|default('') }}">
      </div>
    </div>

    <div class="col-md-5  col-md-offset-1">
      <div class="form-group cd-form-group">
        <label for="weibo">{{'user.fileds.microblog'|trans}}</label>
        <input type="text" id="weibo" name="profile[weibo]" class="form-control"  value="{{ profile.weibo|default('') }}">
      </div>
    </div>

    <div class="col-md-5">
      <div class="form-group cd-form-group">
        <label for="profile_weixin">{{'user.fileds.wechat'|trans}}</label>
        <input type="text" id="profile_weixin" name="profile[weixin]" class="form-control" value="{{ profile.weixin|default('') }}">
      </div>
    </div>

    <div class="col-md-5  col-md-offset-1">
      <div class="form-group cd-form-group">
        <label for="profile_qq">{{'user.fileds.qq'|trans}}</label>
        <input type="text" id="profile_qq" name="profile[qq]" class="form-control" value="{{ profile.qq|default('') }}">
      </div>
    </div>

    {% if fields %}
      {% for field in fields %}
        <div class="
          {% if field.type == "text" %}
            col-md-11
          {% else %}
            col-md-5 {% if loop.index % 2 == 0 %}col-md-offset-1{% endif %}
          {% endif %}">
          <div class="form-group cd-form-group">
            <label for="{{field.fieldName}}">{{field.title}}</label>

            {% if field.type == "text" %}
              <textarea id="{{field.fieldName}}" rows="4" maxlength="80" name="profile[{{field.fieldName}}]" class="{{field.type}} form-control">{{ profile[field.fieldName]|default('') }}</textarea>
            {% elseif field.type == "int" %}
              <input type="text" id="{{field.fieldName}}" placeholder="{{'site.validate_rules.max_int'|trans}}" name="profile[{{field.fieldName}}]" class="{{field.type}} form-control"  value="{{ profile[field.fieldName]|default('') }}">
            {% elseif field.type == "float" %}
              <input type="text" id="{{field.fieldName}}" placeholder="{{'site.validate_rules.two_decimal_places'|trans}}" name="profile[{{field.fieldName}}]" class="{{field.type}} form-control"  value="{{ profile[field.fieldName]|default('') }}">
            {% elseif field.type == "date" %}
              <input type="text" id="{{field.fieldName}}" name="profile[{{field.fieldName}}]" class="{{field.type}} form-control" value="{% if profile[field.fieldName] %}{{profile[field.fieldName]}}{% endif %}">
            {% elseif field.type == "varchar" %}
              <input type="text" id="{{field.fieldName}}" name="profile[{{field.fieldName}}]" class="form-control" value="{{ profile[field.fieldName]|default('') }}">
            {% endif %}
          </div>
        </div>
      {% endfor %}
    {% endif %}

    <div class="col-md-11">
      <button id="profile-save-btn" data-submiting-text="{{'form.btn.save.submiting'|trans}}" type="submit" class="btn cd-btn cd-btn-primary">{{'form.btn.save'|trans}}</button>
    </div>
    <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
  </form>
{% endblock %}