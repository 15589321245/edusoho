{"version":3,"sources":["plugins/VipPlugin/Resources/static-src/js/admin/index-modal/index.js"],"names":["$modal","$","parents","$table","on","confirm","ids","push","data","ajaxDelete","click","find","each","value","url","userIds","post","response","i","userId","remove","member_count","member_count_text","parseInt","text","length","datetimepicker","format","autoclose","minView","val","substring","html","load","modal","$panel","is","prop","checked_count"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from \"common/notify\";\n\nvar $modal = $('#member-cancel-form').parents('.modal');\nvar $table = $('#member-table');\n\n$('#member-table').on('click', '.delete-member', function () {\n\n  if (!confirm('真的要取消该会员吗?')) {\n    return;\n  }\n\n  var ids = [];\n  ids.push($(this).data('id'));\n\n  ajaxDelete($(this).data('url'), ids);\n\n});\n\n$('.js-batch-delete-btn').click(function () {\n  var ids = [];\n  $('#table-list-panel').find('[data-role=batch-item]:checked').each(function () {\n    ids.push(this.value);\n  });\n  if (ids == \"\") {\n    notify('danger','请先选择你要取消的会员!');\n    return;\n  }\n\n  if (!confirm('真的要取消这些会员吗?')) {\n    return;\n  }\n\n  ajaxDelete($(this).data('url'), ids);\n\n})\n\nfunction ajaxDelete(url, userIds) {\n\n  $.post(url, { userIds: userIds }, function (response) {\n    if (response) {\n      $.each(userIds, function (i, userId) {\n        $('#member-table-tr-' + userId).remove();\n      })\n\n      var member_count = $('.member_count'),\n        member_count_text = parseInt($('.member_count').text());\n      member_count.text(member_count_text - userIds.length);\n      notify('success','操作成功!');\n    }\n\n  });\n}\n\nif ($(\"#startDate\").length > 0) {\n  $(\"#startDate\").datetimepicker({\n    format: 'yyyy-mm-dd',\n    autoclose: true,\n    minView: 'month',\n  }).on('changeDate', function () {\n    $(\"#endDate\").datetimepicker('setStartDate', $(\"#startDate\").val().substring(0, 16));\n  });\n\n  $(\"#startDate\").datetimepicker('setEndDate', $(\"#endDate\").val().substring(0, 16));\n}\n\nif ($(\"#endDate\").length > 0) {\n  $(\"#endDate\").datetimepicker({\n    format: 'yyyy-mm-dd',\n    autoclose: true,\n    minView: 'month',\n  }).on('changeDate', function () {\n    $(\"#startDate\").datetimepicker('setEndDate', $(\"#endDate\").val().substring(0, 16));\n  });\n\n  $(\"#endDate\").datetimepicker('setStartDate', $(\"#startDate\").val().substring(0, 16));\n}\n\n$('.item-vip-edit').click(function () {\n  var url = $(this).data('url');\n  var userIds = $(this).data('id');\n\n  $('#modal').html('');\n  $('#modal').load(url, { userIds: userIds });\n  $('#modal').modal('show');\n})\n\n\n\n\n// require('../../../../topxiaweb/js/util/batch-select')($panel);\n\n$('.js-batch-edit-btn').click(function () {\n  var ids = [];\n  $('#table-list-panel').find('[data-role=batch-item]:checked').each(function () {\n    ids.push(this.value);\n  });\n  if (ids == \"\") {\n    notify('danger','请先选择你要编辑的会员!');\n    return;\n  }\n\n  $('#modal').html('');\n  $('#modal').load($(this).data('url'), { userIds: ids });\n  $('#modal').modal('show');\n})\n\nvar $panel = $('#table-list-panel');\n\n$panel.on('click', '[data-role=batch-select]', function () {\n  if ($(this).is(\":checked\") == true) {\n    $panel.find('[data-role=batch-select], [data-role=batch-item]').prop('checked', true);\n  } else {\n    $panel.find('[data-role=batch-select], [data-role=batch-item]').prop('checked', false);\n  }\n});\n\n$panel.on('click', '[data-role=batch-item]', function () {\n\n  var length = $panel.find('[data-role=batch-item]').length;\n  var checked_count = 0;\n  $panel.find('[data-role=batch-item]').each(function () {\n    if ($(this).is(\":checked\")) {\n      checked_count++;\n    };\n  })\n\n  if (checked_count == length) {\n    $panel.find('[data-role=batch-select]').prop('checked', true);\n  } else {\n    $panel.find('[data-role=batch-select]').prop('checked', false);\n  }\n\n})\n"]}