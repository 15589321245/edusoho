{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/input-group.js"],"names":["InputGroup","props","state","itemName","searched","resultful","searchResult","searchable","enable","searchableUrl","url","addable","context","subscribeMessage","subscribe","channel","topic","callback","console","log","handleAdd","name","data","addItem","setState","event","value","currentTarget","length","setTimeout","itemData","handleNameChange","onFocus","blurAdd","selectChange","childContextTypes","PropTypes","func","bool"],"mappings":"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","file":"input-group.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport { trim } from '../../unit';\nimport { send } from '../../server';\nimport Options from './options';\nimport postal from 'postal';\n\nexport default class InputGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      itemName: \"\",\n      searched: true,\n      resultful: false,\n      searchResult: [],\n    }\n    this.searchable = this.props.searchable.enable;\n    this.searchableUrl = this.props.searchable.url;\n    this.addable = this.context.addable;\n    this.subscribeMessage();\n  }\n\n  subscribeMessage() {\n    postal.subscribe({\n      channel: \"courseInfoMultiInput\",\n      topic: \"addMultiInput\",\n      callback: () => {\n        console.log('add');\n        this.handleAdd();\n      }\n    });\n  }\n\n  selectChange(name, data) {\n    if (data) {\n      this.context.addItem(name, data);\n    }\n    this.setState({\n      itemName: '',\n    });\n  }\n\n  onFocus(event) {\n    //在这种情况下，重新开启搜索功能；\n    this.setState({\n      searched: true,\n    })\n  }\n\n  handleNameChange(event) {\n    // let value = trim(event.currentTarget.value);\n    let value = event.currentTarget.value;\n    this.setState({\n      itemName: value,\n      searchResult: [],\n      resultful: false,\n    });\n\n    if (this.searchable && value.length > 0 && this.state.searched) {\n      setTimeout(() => {\n        send(this.searchableUrl + value, searchResult => {\n          if (this.state.itemName.length > 0) {\n            console.log({ 'searchResult': searchResult });\n            this.setState({\n              searchResult: searchResult,\n              resultful: true,\n            });\n          }\n        });\n      }, 100)\n    }\n  }\n\n  handleAdd() {\n    if (trim(this.state.itemName).length > 0) {\n      this.context.addItem(this.state.itemName, this.state.itemData);\n    }\n    this.setState({\n      itemName: '',\n      searchResult: [],\n      resultful: false,\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"input-group\">\n        <input className=\"form-control\" value={this.state.itemName} onChange={event => this.handleNameChange(event)} onFocus={event => this.onFocus(event)} onBlur={event => this.blurAdd(event)} />\n        {this.searchable && this.state.resultful && <Options searchResult={this.state.searchResult} selectChange={(event, name) => this.selectChange(event, name)} resultful={this.state.resultful} />}\n        {this.addable && <span className=\"input-group-btn\"><a className=\"btn btn-default\" onClick={() => this.handleAdd()}>添加</a></span>}\n      </div>\n    );\n  }\n}\n\nInputGroup.childContextTypes = {\n  addItem: React.PropTypes.func,\n  addable: React.PropTypes.bool,\n};\n"]}