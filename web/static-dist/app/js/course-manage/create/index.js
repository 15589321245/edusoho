webpackJsonp(["app/js/course-manage/create/index"],[function(e,a,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var d=function(){function e(e,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(a,t,i){return t&&e(a.prototype,t),i&&e(a,i),a}}(),r=t("423d5c93d4f10f876e3b"),s=i(r),l=function(){function e(){n(this,e),this.validator=null,this.init()}return d(e,[{key:"init",value:function(){$('[data-toggle="popover"]').popover({html:!0}),this.initValidator(),this.initExpiryMode(),this.checkBoxChange()}},{key:"initValidator",value:function(){var e=this,a=$("#course-create-form");this.validator=a.validate({groups:{date:"expiryStartDate expiryEndDate"},rules:{title:{required:!0,trim:!0}},messages:{title:Translator.trans("请输入教学计划课程标题")}}),$("#course-submit").click(function(t){e.validator.form()&&(e.isInitIntro(),$(t.currentTarget).button("loading"),a.submit())}),this.initDatePicker("#expiryStartDate"),this.initDatePicker("#expiryEndDate"),this.initDatePicker("#deadline")}},{key:"isInitIntro",value:function(){var e=$("#courses-list-table").find("tbody tr").length;if(1==e){var a=new s.default;a.isSetCourseListCookies()}}},{key:"checkBoxChange",value:function(){var e=this;$('input[name="deadlineType"]').on("change",function(a){"end_date"==$('input[name="deadlineType"]:checked').val()?($("#deadlineType-date").removeClass("hidden"),$("#deadlineType-days").addClass("hidden")):($("#deadlineType-date").addClass("hidden"),$("#deadlineType-days").removeClass("hidden")),e.initExpiryMode()}),$('input[name="expiryMode"]').on("change",function(a){"date"==$('input[name="expiryMode"]:checked').val()?($("#expiry-days").removeClass("hidden").addClass("hidden"),$("#expiry-date").removeClass("hidden")):"days"==$('input[name="expiryMode"]:checked').val()?($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden"),$('input[name="deadlineType"][value="days"]').prop("checked",!0)):($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden").addClass("hidden")),e.initExpiryMode()}),$('input[name="learnMode"]').on("change",function(e){"freeMode"==$('input[name="learnMode"]:checked').val()?($("#learnLockModeHelp").removeClass("hidden").addClass("hidden"),$("#learnFreeModeHelp").removeClass("hidden")):($("#learnFreeModeHelp").removeClass("hidden").addClass("hidden"),$("#learnLockModeHelp").removeClass("hidden"))})}},{key:"initDatePicker",value:function(e){var a=this,t=$(e);t.datetimepicker({format:"yyyy-mm-dd",language:"zh",minView:2,autoclose:!0,endDate:new Date(Date.now()+31536e7)}).on("hide",function(){a.validator.form()}),t.datetimepicker("setStartDate",new Date)}},{key:"initExpiryMode",value:function(){var e=$('[name="deadline"]'),a=$('[name="expiryDays"]'),t=$('[name="expiryStartDate"]'),i=$('[name="expiryEndDate"]'),n=$('[name="expiryMode"]:checked').val();switch(this.elementRemoveRules(e),this.elementRemoveRules(a),this.elementRemoveRules(t),this.elementRemoveRules(i),n){case"days":var d=$('[name="deadlineType"]:checked');if("end_date"===d.val())return this.elementAddRules(e,this.getDeadlineEndDateRules()),void this.validator.form();this.elementAddRules(a,this.getExpiryDaysRules()),this.validator.form();break;case"date":this.elementAddRules(t,this.getExpiryStartDateRules()),this.elementAddRules(i,this.getExpiryEndDateRules()),this.validator.form()}}},{key:"getExpiryEndDateRules",value:function(){return{required:!0,date:!0,after_date:"#expiryStartDate",messages:{required:Translator.trans("请输入结束日期")}}}},{key:"getExpiryStartDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,before_date:"#expiryEndDate",messages:{required:Translator.trans("请输入开始日期")}}}},{key:"getExpiryDaysRules",value:function(){return{required:!0,positive_integer:!0,max_year:!0,messages:{required:Translator.trans("请输入有效期天数")}}}},{key:"getDeadlineEndDateRules",value:function(){return{required:!0,date:!0,after_now_date:!0,messages:{required:Translator.trans("请输入截至日期")}}}},{key:"elementAddRules",value:function(e,a){e.rules("add",a)}},{key:"elementRemoveRules",value:function(e){e.rules("remove")}}]),e}();new l}]);