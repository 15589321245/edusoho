{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/create/index.js"],"names":["Creator","init","initDatePicker","checkBoxChange","initValidator","$form","$","validator","validate","groups","date","rules","title","required","trim","expiryDays","digits","max_year","expiryStartDate","val","before","expiryEndDate","after","messages","Translator","trans","addMethod","value","element","params","click","evt","form","currentTarget","button","submit","on","event","removeClass","addClass","$id","$picker","datetimepicker","format","language","minView","autoclose","endDate","Date","now"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["class Creator {\n  constructor() {\n    this.init();\n  }\n  \n  init() {\n    this.initDatePicker('#expiryStartDate');\n    this.initDatePicker('#expiryEndDate');\n    this.checkBoxChange();\n    this.initValidator();\n  }\n\n  initValidator() {\n    let $form = $(\"#course-create-form\");\n    let validator = $form.validate({\n      groups: {\n        date: 'expiryStartDate expiryEndDate'\n      },\n      rules: {\n        title: {\n          required: true,\n          trim: true,\n        },\n        expiryDays: {\n          required: '#expiryByDays:checked',\n          digits: true,\n          max_year: true\n        },\n        expiryStartDate: {\n          required: ()=> {\n            return $('input[name=\"expiryMode\"]:checked').val() !== 'date';\n          },\n          date: true,\n          before: '#expiryEndDate'\n        },\n        expiryEndDate: {\n          required: ()=> {\n            return $('input[name=\"expiryMode\"]:checked').val() !== 'date';\n          },\n          date: true,\n          after: '#expiryStartDate'\n        }\n      },\n      messages: {\n        title: Translator.trans('请输入教学计划课程标题'),\n        expiryStartDate: {\n          required: Translator.trans('请输入开始日期'),\n          before: Translator.trans('开始日期应早于结束日期')\n        },\n        expiryEndDate: {\n          required: Translator.trans('请输入结束日期'),\n          after: Translator.trans('结束日期应晚于开始日期')\n        }\n      }\n    });\n\n    $.validator.addMethod(\n      \"before\",\n      function (value, element, params) {\n        return value && $(params).val() >= value;\n      },\n      Translator.trans('开始日期应早于结束日期')\n    );\n\n    $.validator.addMethod(\n      \"after\",\n      function (value, element, params) {\n        if ($('input[name=\"expiryMode\"]:checked').val() !== 'date') {\n          return true;\n        }\n        return value && $(params).val() <= value;\n      },\n      Translator.trans('结束日期应晚于开始日期')\n    );\n\n    $('#course-submit').click(function (evt) {\n      if (validator.form()) {\n        $(evt.currentTarget).button('loading');\n        $form.submit();\n      }\n    });\n  }\n\n  checkBoxChange() {\n    $('input[name=\"expiryMode\"]').on('change', function (event) {\n      if ($('input[name=\"expiryMode\"]:checked').val() == 'date') {\n        $('#expiry-days').removeClass('hidden').addClass('hidden');\n        $('#expiry-date').removeClass('hidden');\n      } else {\n        $('#expiry-date').removeClass('hidden').addClass('hidden');\n        $('#expiry-days').removeClass('hidden');\n      }\n    });\n\n    $('input[name=\"learnMode\"]').on('change', function (event) {\n      if ($('input[name=\"learnMode\"]:checked').val() == 'freeMode') {\n        $('#learnLockModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnFreeModeHelp').removeClass('hidden');\n      } else {\n        $('#learnFreeModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnLockModeHelp').removeClass('hidden');\n      }\n    });\n  }\n\n  initDatePicker($id) {\n    let $picker = $($id);\n    $picker.datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: \"zh\",\n      minView: 2, //month\n      autoclose: true,\n      endDate: new Date(Date.now() + 86400 * 365 * 100 * 1000)\n    });\n    $picker.datetimepicker('setStartDate', new Date());\n  }\n}\n\nnew Creator();\n"]}