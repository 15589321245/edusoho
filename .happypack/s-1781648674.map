{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/video/index.js"],"names":["Video","showChooseContent","$","on","event","openUI","val","$step3_forom","validator","data","validate","rules","required","positive_integer","max","min","messages","_inItStep2form","$step2_form","groups","date","title","maxlength","trim","minute","second","second_range","blur","form","parseInt","fileChooser","subtitleDialog","onSelectFile","closeUI","file","length","Math","round","source","id","uri","render","children","removeClass","_inItStep3from","target","value","addClass"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import FileChooser from '../../file-chooser/file-choose';\nimport SubtitleDialog from './subtitle/dialog';\n\nclass Video {\n  constructor() {\n    this.showChooseContent();\n  }\n\n  showChooseContent() {\n    $('#iframe-content').on('click', '.js-choose-trigger', (event) => {\n      FileChooser.openUI();\n      $('[name=\"ext[mediaSource]\"]').val(null);\n    });\n  }\n\n  _inItStep3from() {\n\n    var $step3_forom = $('#step3-form');\n    var validator = $step3_forom.data('validator');\n\n    $step3_forom.validate({\n      rules: {\n        'ext[finishDetail]': {\n          required: true,\n          positive_integer: true,\n          max: 300,\n          min: 1,\n        }\n      },\n      messages: {\n        'ext[finishDetail]': {\n          required: '请输入时长',\n        }\n      }\n    });\n    $step3_forom.data('validator', validator);\n  }\n\n\n}\n\n\n\n\n\n\nfunction _inItStep2form() {\n  var $step2_form = $('#step2-form');\n  var validator = $step2_form.data('validator');\n  $step2_form.validate({\n    groups: {\n      date: 'minute second'\n    },\n    rules: {\n      title: {\n        required: true,\n        maxlength: 50,\n        trim: true,\n      },\n      minute: 'required unsigned_integer',\n      second: 'required second_range',\n      'ext[mediaSource]': 'required',\n      'ext[finishDetail]': 'unsigned_integer'\n    },\n    messages: {\n      minute: {\n        required: '请输入时长',\n      },\n      second: {\n        required: '请输入时长',\n        second_range: '秒数只能在0-59之间',\n      },\n      'ext[mediaSource]': \"请上传或选择%display%\",\n    }\n  });\n  $step2_form.data('validator', validator);\n}\n\n_inItStep2form();\n\n\n$(\".js-length\").blur(function () {\n  let validator = $(\"#step2-form\").data('validator');\n  if (validator && validator.form()) {\n    const minute = parseInt($('#minute').val()) | 0;\n    const second = parseInt($('#second').val()) | 0;\n    $(\"#length\").val(minute * 60 + second);\n  }\n});\n\nconst fileChooser = new FileChooser();\n//字幕组件\nconst subtitleDialog = new SubtitleDialog('.js-subtitle-list');\n\n\nconst onSelectFile = file => {\n  FileChooser.closeUI();\n  if (file.length && file.length > 0) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#length\").val(minute * 60 + second);\n  }\n\n  $('[name=\"ext[mediaSource]\"]').val(file.source);\n  if (file.source == 'self') {\n    $(\"#ext_mediaId\").val(file.id);\n    $(\"#ext_mediaUri\").val('');\n  } else {\n    $(\"#ext_mediaUri\").val(file.uri);\n    $(\"#ext_mediaId\").val(0);\n  }\n\n  //渲染字幕\n  subtitleDialog.render(file);\n};\n\n// 完成条件是观看时长的情况\nif ($(\"#finish-condition\").children('option:selected').val() === 'time') {\n  $('.viewLength').removeClass('hidden');\n  _inItStep3from();\n}\n\n$(\"#finish-condition\").on('change', function (event) {\n  if (event.target.value == 'time') {\n    $('.viewLength').removeClass('hidden');\n    _inItStep3from();\n  } else {\n    $('.viewLength').addClass('hidden');\n    $('input[name=\"ext[finishDetail]\"]').rules('remove')\n  }\n})\n\nfileChooser.on('select', onSelectFile);\n"]}