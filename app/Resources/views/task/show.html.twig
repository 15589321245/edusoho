{% extends 'TopxiaWebBundle::layout.html.twig' %}

{% block title %}{{'任务学习'|trans}} - {{ parent() }}{% endblock %}

{#{% set script_controller = 'taskbundle/controller/task/show' %}#}
{% set bodyClass = "" %}
{% do css(['web.css']) %}
{% do script(['libs/perfect-scrollbar.js','libs/es-ckeditor/ckeditor.js','app/js/task/index.js']) %}

{% block body %}

  <div id="js-hidden-data">
    <input type="hidden" name="course-id" value="{{ task.courseId }}">
    <input type="hidden" name="task-id" value="{{ task.id }}">
    <input type="hidden" name="task-result-status" value="{{ taskResult.status }}">
    <input type="hidden" name="mode" value="{% if preview %}preview{% else %}learn{% endif %}">
    <input type="hidden" name="plugins_url" value="{{ path('course_task_show_plugins', {courseId: task.courseId, taskId: task.id, preview: preview}) }}">
  </div>

  <div class="task-dashboard-page js-task-dashboard-page">
    <div class="dashboard-content" id="dashboard-content">
      <div class="dashboard-header">
        <a class="back-link" href="{{backUrl}}">
          <i class="es-icon es-icon-chevronleft"></i>
        </a>
        任务：{{ task.title }}
      </div>
      <div class="dashboard-body">
        <iframe id="task-content-iframe" class="task-content-iframe"

          data-event-url="{{ path('course_task_trigger', {courseId: task.courseId, id: task.id}) }}"
          src="{{path('course_task_activity_show',{courseId:task.courseId, id:task.id, preview: preview })}}"
          style="width:100%;height:100%;border:0px">
        </iframe>
      </div>

      <div class="dashboard-footer ">
        <div class="state-opration "> 

            
            <a class="btn btn-gray text-sm js-learn-prompt {% if taskResult.status != 'finish' %}open{% endif %}" href="javascript:;" data-container=".js-learn-prompt" data-toggle="popover" data-trigger="hover" data-placement="top" data-content='<p class="gray-darker mbs">满足以下条件:</p>点击“学过了”' ><i class="es-icon es-icon-help mrs text-md"></i>任务完成条件</a> 
            

            <a class="btn text-sm js-learning-prompt" href="javascript:;" data-container=".js-learning-prompt" data-toggle="popover" data-trigger="hover" data-placement="top" data-content='<p class="gray-darker mbs">满足以下条件:</p>点击“学过了”'><i class="es-icon es-icon-iccheckcircleblack24px mrs text-md"></i>{{task.title}}任务已完成</a>

            
            <a class="btn text-sm js-learned-prompt {% if taskResult.status == 'finish' %}open{% endif %}  " href="javascript:;" data-container=".js-learned-prompt" data-toggle="popover" data-trigger="hover" data-placement="top" data-content=''>
              <div class="task-state-modal task-state-modal-xs">
                <div class="title">
                  <i class="es-icon es-icon-iccheckcircleblack24px text-success"></i>完成任务
                </div>
                <div class="content">
                  <div class="content-title">《 任务：{{task.title}} 》</div>
                  学习进度
                  <div class="content-progress">
                    <div class="progress progress-radius mts mb0">
                      <div class="progress-bar  progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width:50%">60%</div>
                    </div>

                  </div>
                </div>
                <div class="footer text-right">
                  <a class="btn btn-primary btn-sm">下一任务</a>
                </div>
              </div>
              
              <i class="es-icon es-icon-iccheckcircleblack24px mrs text-md"></i>任务完成
            </a>
            
        </div>

        <a type="button" 
          href="javascript:;" 
        {% if taskResult.status != 'finish' %}
          class="btn btn-transparent btn-learn js-btn-learn" 
          id = 'learn-btn'
          data-url='{{path("course_task_finish",{courseId: task.courseId, id: task.id})}}'
        {% else %}
          class="btn btn-transparent btn-learn js-btn-learn active" 
        {% endif %}
        >
          {% if taskResult.status == 'finish' %}
          <i class="es-icon es-icon--check-circle done"></i>
          {% else %}
          <i class="es-icon es-icon-undone-check doing"></i>
          {% endif %}
          学过了
        </a>
      </div>
    </div>
    <div class="dashboard-sidebar" id="dashboard-sidebar">

    </div>
  </div>

{% endblock %}