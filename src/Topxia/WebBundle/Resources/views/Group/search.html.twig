{% extends 'TopxiaWebBundle:Group:layout.html.twig' %}
{% block title %}搜索 - {{ parent() }}{% endblock %}
{% block content %}
  <ol class="breadcrumb breadcrumb-o" style="margin-top:-18px">
    <li><a href="{{path('homepage')}}">{{ setting('homepage.name', '首页') }}</a></li>
    <li><a href="{{path('group')}}">{{setting('group.name', '小组主页')}}</a></li>
    <li><a href="{{path('group_search_group')}}">{{setting('search.name', '搜索小组')}}</a></li>
  </ol>
  
  <div class="row">
    <div class="col-md-9 group-main">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h2 class="panel-title">所有小组</h2>
        </div>

        <div class="panel-body">
          {% if groups %}
          <div class="row">
            {% for group in groups %}
              
              {% include 'TopxiaWebBundle:Group:group-media-small.html.twig'  %}
              
            {% endfor %}
          </div>
          <div class="text-center">
            {{ web_macro.paginator(paginator) }}
          </div>
          {% else %}
          <div class="empty">暂无小组信息</div>
          {% endif %}

        </div>
      </div>
    </div>
  
    <div class="col-md-3 group-side">
      {% if is_granted('ROLE_ADMIN') %}
        <div class="group-topic-btn">
          <a href="{{path('group_add')}}" class="btn btn-success" role="button">
            <i class="es-icon es-icon-addcircle"></i>创建小组
          </a>
        </div>
      {% endif %}
      <form class="mbl" action="{{path('group_search_group')}}" method="get">
        <div class="group-search">
          <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
          <input type="text" class="form-control" placeholder="小组搜索" name="keyWord">
          <button class="btn btn-default btn-nobg" type="submit">
            <span class="glyphicon glyphicon-search"></span>
          </button>
        </div>
      </form>
      {% if user.id %}
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="media">
              <div class="media-left">
                {{ web_macro.user_avatar(user, '','avatar-md') }}
              </div>
              <div class="media-body">
                <p>{{ web_macro.user_link(user , 'link-light') }}</p>
                <div class="metas">
                  <a href="{{ path ('group_member_center') }}" class="btn btn-info btn-sm" role="button">我的小组</a>
                
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endif %}

      {% if myJoinGroup %}
        <div class="panel panel-default">
          <div class="panel-heading">
            我的小组
            {% if user.id %} 
              <a href="{{ path ('group_member_join',{type:'myGroup'}) }}" class="more">
              <i class="es-icon es-icon-morehoriz"></i></a>
            {% endif %}
          </div>
          <div class="panel-body">
            <div class="group-grids">
              {% for group in myJoinGroup %}
                {% if loop.index <= 6 %}
                <div class="grid media media-group">
                  <div class="media-left">
                    <a href="{{path('group_show',{id:group.id})}}" title="{{group.title}}">
                      <img src="{{filepath(group.logo, 'group.png')}}" alt="{{group.title}}" class="avatar-square-md">
                    </a>
                  </div>
                  <div class="media-body">
                    <div class="title">
                      <a class="gray-darker" href="{{path('group_show',{id:group.id})}}" title="{{group.title}}">{{group.title|sub_text(9)}}</a>
                    </div>
                    <div class="metas">
                      <span><i class="es-icon es-icon-people"></i>{{ group.memberNum }}</span>
                      <span><i class="es-icon es-icon-textsms"></i>{{ group.threadNum }}</span>
                    </div>
                  </div>
                </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}
      {% include 'TopxiaWebBundle:Group:new-group-list.html.twig' %}

    </div>
  </div>
{% endblock %}