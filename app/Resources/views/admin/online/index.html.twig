{% extends 'admin/layout.html.twig' %}

{% set menu = 'admin_user_manage' %}

{% block content %}

    <form id="message-search-form" class="form-inline well well-sm" action="" method="get" novalidate>
        <input type="hidden" name="type" value="{{ app.request.query.get('type') }}">
        <div class="form-group">
            <input class="form-control" type="text" placeholder="{{'用户名'|trans}}" name="name" value="{{ app.request.query.get('name') }}">
        </div>

        <button class="btn btn-primary">{{'搜索'|trans}}</button>

    </form>
    {% if onlines %}
        <table id="table" class="table table-striped table-hover">
            <thead>
            <tr>
                <th>{{'用户名'|trans}}</th>
                <th>{{'设备'|trans}}</th>
                <th>{{'品牌名称'|trans}}</th>
                <th>{{'操作系统'|trans}}</th>
                <th>{{'客户端'|trans}}</th>
                <th>{{'来源'|trans}}</th>
                <th>{{'客户端ip'|trans}}</th>
                <th>{{'最后访问时间'|trans}}</th>
            </tr>
            </thead>
            <tbody>
            {% for online in onlines %}
                <tr id="online-table-tr-{{ online.id }}">
                    <td>
                        {{ users[online.user_id]['nickname']|default('--') }}
                    </td>
                    <td>
                        {{ online.device }}
                    </td>
                    <td>
                        {{ online.device_brand }}
                    </td>
                    <td>
                        {% if online.os|default(false) %}
                            {{ online.os.name|default('') }} {{ online.os.version|default('') }}
                        {% else %}
                            --
                        {% endif %}
                    </td>
                    <td>
                        {% if online.client|default(false) %}
                            {{ online.client.type|default('') }}: {{ online.client.name|default('') }} {{ online.client.version|default('') }}
                        {% else %}
                            --
                        {% endif %}
                    </td>
                    <td>
                        {{ online.source }}
                    </td>
                    <td>
                        {{ online.ip }}
                    </td>
                    <td>
                        {{ online.access_time|date('Y-n-d H:i:s') }}
                    </td>
                </tr>
            {% endfor %}
            </tbody>

        </table>
    {% else %}
        <div class="empty">{{'暂无在线信息!'|trans}}</div>
    {% endif %}
    {{ admin_macro.paginator(paginator) }}
{% endblock %}