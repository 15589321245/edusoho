{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/input-group.js"],"names":["InputGroup","props","state","itemName","searched","resultful","searchResult","searchable","enable","addable","searchableUrl","url","subscribeMessage","subscribe","channel","topic","callback","console","log","handleAdd","name","data","context","addItem","setState","event","value","currentTarget","length","setTimeout","itemData","blurIsAdd","handleNameChange","onFocus","blurAdd","selectChange","contextTypes","PropTypes","func"],"mappings":"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","file":"input-group.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport { trim } from '../../unit';\nimport { send } from '../../server';\nimport Options from './options';\nimport postal from 'postal';\n\nexport default class InputGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      itemName: \"\",\n      searched: true,\n      resultful: false,\n      searchResult: [],\n    }\n    this.searchable = this.props.searchable.enable;\n    this.addable = this.props.addable;\n    this.searchableUrl = this.props.searchable.url;\n    this.subscribeMessage();\n  }\n\n  subscribeMessage() {\n    postal.subscribe({\n      channel: \"courseInfoMultiInput\",\n      topic: \"addMultiInput\",\n      callback: () => {\n        console.log('add');\n        this.handleAdd();\n      }\n    });\n  }\n\n  selectChange(name, data) {\n    if (data) {\n      this.context.addItem(name, data);\n    }\n    this.setState({\n      itemName: '',\n    });\n  }\n\n  onFocus(event) {\n    //在这种情况下，重新开启搜索功能；\n    this.setState({\n      searched: true,\n    })\n  }\n\n  handleNameChange(event) {\n    let value = trim(event.currentTarget.value);\n    this.setState({\n      itemName: value,\n      searchResult: [],\n      resultful: false,\n    });\n\n    if (this.searchable && value.length > 0 && this.state.searched) {\n      setTimeout(() => {\n        send(this.searchableUrl + value, searchResult => {\n          if (this.state.itemName.length > 0) {\n            console.log({ 'searchResult': searchResult });\n            this.setState({\n              searchResult: searchResult,\n              resultful: true,\n            });\n          }\n        });\n      }, 100)\n    }\n  }\n\n  handleAdd() {\n    if (this.state.itemName.length > 0) {\n      this.context.addItem(this.state.itemName, this.state.itemData);\n    }\n    this.setState({\n      itemName: '',\n      searchResult: [],\n      resultful: false,\n    })\n  }\n\n  blurAdd() {\n    if (this.props.blurIsAdd) {\n      console.log('ok');\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"input-group\">\n        <input className=\"form-control\" value={this.state.itemName} onChange={event => this.handleNameChange(event)} onFocus={event => this.onFocus(event)} onBlur={event => this.blurAdd(event)} />\n        {this.searchable && this.state.resultful && <Options searchResult={this.state.searchResult} selectChange={(event, name) => this.selectChange(event, name)} resultful={this.state.resultful} />}\n        {this.addable && <span className=\"input-group-btn\"><a className=\"btn btn-default\" onClick={() => this.handleAdd()}>添加</a></span>}\n      </div>\n    );\n  }\n}\n\nInputGroup.contextTypes = {\n  addItem: React.PropTypes.func,\n};\n"]}