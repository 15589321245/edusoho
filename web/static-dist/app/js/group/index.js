webpackJsonp(["app/js/group/index"],{b7b955d31d3c6acc3b71:function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.initEditor=function(options){var editor=CKEDITOR.replace(options.replace,{toolbar:options.toolbar,filebrowserImageUploadUrl:$("#"+options.replace).data("imageUploadUrl"),allowedContent:!0,height:300});editor.on("change",function(){$("#"+options.replace).val(editor.getData())}),editor.on("blur",function(){$("#"+options.replace).val(editor.getData())})}},0:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _notify=__webpack_require__("b334fd7e4c5a19234db2"),_threadOpreate=(_interopRequireDefault(_notify),__webpack_require__("4833bf6727a52ba97d0c"));(0,_threadOpreate.initThread)(),(0,_threadOpreate.initThreadReplay)();var add_btn_clicked=!1;$("#add-btn").click(function(){return add_btn_clicked||($("#add-btn").button("loading").addClass("disabled"),add_btn_clicked=!0),!0}),$("#thread-list").on("click",".uncollect-btn, .collect-btn",function(){var $this=$(this);$.post($this.data("url"),function(){$this.hide(),$this.hasClass("collect-btn")?$this.parent().find(".uncollect-btn").show():$this.parent().find(".collect-btn").show()})}),$(".attach").tooltip(),$(".group-post-list").length>0&&($(".group-post-list").on("click",".li-reply",function(){var postId=$(this).attr("postId"),fromUserId=$(this).data("fromUserId");$("#fromUserIdDiv").html('<input type="hidden" id="fromUserId" value="'+fromUserId+'">'),$("#li-"+postId).show(),$("#reply-content-"+postId).focus(),$("#reply-content-"+postId).val(Translator.trans("回复 ")+$(this).attr("postName")+":")}),$(".group-post-list").on("click",".reply",function(){var postId=$(this).attr("postId");if(""!=$(this).data("fromUserIdNosub")){var fromUserIdNosubVal=$(this).data("fromUserIdNosub");$("#fromUserIdNoSubDiv").html('<input type="hidden" id="fromUserIdNosub" value="'+fromUserIdNosubVal+'">'),$("#fromUserIdDiv").html("")}$(this).hide(),$("#unreply-"+postId).show(),$(".reply-"+postId).css("display","")}),$(".group-post-list").on("click",".unreply",function(){var postId=$(this).attr("postId");$(this).hide(),$("#reply-"+postId).show(),$(".reply-"+postId).css("display","none")}),$(".group-post-list").on("click",".replyToo",function(){var postId=$(this).attr("postId");"hidden"==$(this).attr("data-status")?($(this).attr("data-status",""),$("#li-"+postId).show(),$("#reply-content-"+postId).focus(),$("#reply-content-"+postId).val("")):($("#li-"+postId).hide(),$(this).attr("data-status","hidden"))}),$(".group-post-list").on("click",".lookOver",function(){var postId=$(this).attr("postId");$(".li-reply-"+postId).css("display",""),$(".lookOver-"+postId).hide(),$(".paginator-"+postId).css("display","")}),$(".group-post-list").on("click",".postReply-page",function(){var postId=$(this).attr("postId");$.post($(this).data("url"),"",function(html){$("body,html").animate({scrollTop:$("#post-"+postId).offset().top},300),!1,$(".reply-post-list-"+postId).replaceWith(html)})})),$("#hasAttach").length>0&&$(".ke-icon-accessory").addClass("ke-icon-accessory-red"),$("#post-action").length>0&&($("#post-action").on("click","#closeThread",function(){var $trigger=$(this);return!!confirm($trigger.attr("title")+"？")&&void $.post($trigger.data("url"),function(data){window.location.href=data})}),$("#post-action").on("click","#elite,#stick,#cancelReward",function(){var $trigger=$(this);$.post($trigger.data("url"),function(data){window.location.href=data})})),$(".actions").length>0&&$(".group-post-list").on("click",".post-delete-btn,.post-adopt-btn",function(){var $trigger=$(this);return!!confirm($trigger.attr("title")+"？")&&void $.post($trigger.data("url"),function(){window.location.reload()})})},"4833bf6727a52ba97d0c":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initThreadReplay=exports.initThread=void 0;var _editor=__webpack_require__("b7b955d31d3c6acc3b71"),_notify=__webpack_require__("b334fd7e4c5a19234db2"),_notify2=_interopRequireDefault(_notify),_attachmentActions=__webpack_require__("d5fb0e67d2d4c1ebaaed"),_attachmentActions2=_interopRequireDefault(_attachmentActions);exports.initThread=function(){var btn="#post-thread-btn",$form=$("#post-thread-form");new _attachmentActions2["default"]($form),(0,_editor.initEditor)({toolbar:"Thread",replace:"post_content"});var formValidator=$form.validate({currentDom:btn,ajax:!0,rules:{content:{required:!0,minlength:2,visible_character:!0}},submitError:function(){data=data.responseText,data=$.parseJSON(data),data.error?(0,_notify2["default"])("danger",data.error.message):(0,_notify2["default"])("danger",Translator.trans("发表回复失败，请重试"))},submitSuccess:function(data){return console.log(data),"/login"==data?void(window.location.href=url):void window.location.reload()}});console.log(formValidator),$(btn).click(function(){formValidator.form()})},exports.initThreadReplay=function(){var $forms=$(".thread-post-reply-form");$forms.each(function(){var $form=$(this),content=$form.find("textarea").attr("name"),formValidator=$form.validate({ignore:"",rules:_defineProperty({},""+content,{required:!0,minlength:2,visible_character:!0}),submitHandler:function(form){var $replyBtn=$(form).find(".reply-btn"),postId=$replyBtn.attr("postId"),fromUserIdVal="";fromUserIdVal=$("#fromUserId").length>0?$("#fromUserId").val():$("#fromUserIdNosub").length>0?$("#fromUserIdNosub").val():"",$replyBtn.button("submiting").addClass("disabled"),console.log($(form).attr("action")),console.log("content="+$(form).find("textarea").val()+"&postId="+postId+"&fromUserId="+fromUserIdVal),$.ajax({url:$(form).attr("action"),data:"content="+$(form).find("textarea").val()+"&postId="+postId+"&fromUserId="+fromUserIdVal,cache:!1,async:!1,type:"POST",dataType:"text",success:function(url){return"/login"==url?void(window.location.href=url):void window.location.reload()},error:function(data){data=$.parseJSON(data.responseText),data.error?(0,_notify2["default"])("danger",data.error.message):(0,_notify2["default"])("danger",Translator.trans("发表回复失败，请重试")),$replyBtn.button("reset").removeClass("disabled")}})}});$form.find("button").click(function(e){formValidator.form()})})}}});