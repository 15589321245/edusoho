{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/order/create/index.js"],"names":["utils","divition","x","y","Math","round","multiple","subtract","moneyFormatFloor","value","tempValue","parseInt","toFixed","moneyFormatCeil","parseFloat","length","substr","OrderCreate","props","element","$","submitBtn","validator","coinSetting","JSON","parse","find","text","init","initEvent","validate","currentDom","couponDefaultSelect","val","couponCode","trigger","totalPrice","_this","coinNum","isNaN","coinPriceZero","showPayPassword","price_type","discount","cash_rate","shouldPay","self","click","e","coinToPay","stopPropagation","form","$this","url","data","$target","attr","modal","load","submit","$node","on","coinNumEvent","event","couponCodeEvent","couponCancelEvent","couponUseEvent","couponSelectEvent","formSubmitEvent","currentTarget","coupon","children","show","hide","removeClass","code","targetType","targetId","amount","post","css","useable","addClass","html","Translator","trans","rate","decreaseAmount","conculatePrice","focus","couponTotalPrice","trim","accountCash","coin","cashDiscount","totalCoinPrice","maxCoin","maxCoinCanPay","myCashAccount","myCash","payRmb","shouldPayMoney","afterCouponPay","cashModel","cash_model","getMaxCoinCanPay","coinNumPay","afterCoinPay","rules","required","passwordCheck"],"mappings":";;;;;;;;AAAA;;;;;;;;AAEA,KAAIA,QAAQ;AACVC,WADU,oBACDC,CADC,EACEC,CADF,EACK;AACb,YAAOC,KAAKC,KAAL,CAAWD,KAAKC,KAAL,CAAWH,IAAI,IAAf,IAAuBE,KAAKC,KAAL,CAAWF,IAAI,IAAf,CAAvB,GAA8C,IAAzD,IAAiE,IAAxE;AACD,IAHS;AAIVG,WAJU,oBAIDJ,CAJC,EAIEC,CAJF,EAIK;AACb,YAAOC,KAAKC,KAAL,CAAWD,KAAKC,KAAL,CAAWH,IAAI,GAAf,IAAsBE,KAAKC,KAAL,CAAWF,IAAI,GAAf,CAAjC,IAAwD,KAA/D;AACD,IANS;AAOVI,WAPU,oBAODL,CAPC,EAOEC,CAPF,EAOK;AACb,YAAOC,KAAKC,KAAL,CAAWD,KAAKC,KAAL,CAAWH,IAAI,IAAf,IAAuBE,KAAKC,KAAL,CAAWF,IAAI,IAAf,CAAlC,IAA0D,IAAjE;AACD,IATS;AAUVK,mBAVU,4BAUOC,KAVP,EAUc;AACtB;AACA,SAAIC,YAAYD,QAAQ,EAAxB;AACAC,iBAAYC,SAASP,KAAKC,KAAL,CAAWK,YAAY,IAAvB,CAAT,CAAZ;AACA;AACAA,iBAAYC,SAASD,YAAY,EAArB,IAA2B,EAA3B,GAAgC,IAA5C;AACA,YAAOA,UAAUE,OAAV,CAAkB,CAAlB,CAAP;AACD,IAjBS;AAkBVC,kBAlBU,2BAkBMJ,KAlBN,EAkBa;AACrB,SAAIC,YAAYD,QAAQ,EAAxB;AACAC,iBAAYI,WAAWJ,SAAX,EAAsBE,OAAtB,CAA8B,CAA9B,CAAZ;AACA,SAAIG,SAASL,UAAUK,MAAvB;AACA,SAAIL,UAAUM,MAAV,CAAiBD,SAAS,CAA1B,EAA6B,CAA7B,MAAoC,GAAxC,EAA6C;AAC3C,cAAO,KAAKP,gBAAL,CAAsBE,SAAtB,CAAP;AACD;AACD,YAAO,KAAKF,gBAAL,CAAsBM,WAAWJ,SAAX,IAAwB,IAA9C,CAAP;AACD;AA1BS,EAAZ;;KA8BMO,W;AACJ,wBAAYC,KAAZ,EAAmB;AAAA;;AACjB,UAAKC,OAAL,GAAeC,EAAEF,MAAMC,OAAR,CAAf;AACA,UAAKE,SAAL,GAAiB,mBAAjB;AACA,UAAKC,SAAL,GAAiB,IAAjB;AACA,UAAKC,WAAL,GAAmBC,KAAKC,KAAL,CAAW,KAAKN,OAAL,CAAaO,IAAb,CAAkB,mBAAlB,EAAuCC,IAAvC,EAAX,CAAnB;AACA,UAAKC,IAAL;AACD;;;;4BAEM;AACL,YAAKC,SAAL;AACA,YAAKP,SAAL,GAAiB,KAAKH,OAAL,CAAaW,QAAb,CAAsB;AACrCC,qBAAY,KAAKV;AADoB,QAAtB,CAAjB;;AAIA,WAAIW,sBAAsBZ,EAAE,gBAAF,EAAoBa,GAApB,EAA1B;AACF,WAAGD,uBAAuB,EAA1B,EAA8B;AAC5B,aAAIE,aAAad,EAAE,4BAAF,CAAjB;AACDc,oBAAWD,GAAX,CAAeD,mBAAf;AACAZ,WAAE,2BAAF,EAA+Be,OAA/B,CAAuC,OAAvC;AACA;;AAEC,WAAIC,aAAatB,WAAWM,EAAE,sBAAF,EAA0BO,IAA1B,EAAX,CAAjB;AACA,WAAIU,QAAQ,IAAZ;AACA,WAAIjB,EAAE,kBAAF,EAAsBL,MAAtB,GAA+B,CAAnC,EAAsC;AACtC,aAAIuB,UAAUlB,EAAE,kBAAF,EAAsBa,GAAtB,EAAd;AACA,aAAIM,MAAMD,OAAN,KAAkBA,WAAW,CAAjC,EAAoC;AACpClB,aAAE,IAAF,EAAQa,GAAR,CAAY,MAAZ;AACAI,iBAAMG,aAAN;AACA,UAHA,MAGM;AACNH,iBAAMI,eAAN;AACA;;AAED,aAAGJ,MAAMd,WAAN,CAAkBmB,UAAlB,IAAgC,KAAnC,EAA0C;AACxC,eAAIC,WAAW3C,MAAMC,QAAN,CAAeqC,OAAf,EAAwBD,MAAMd,WAAN,CAAkBqB,SAA1C,CAAf;AACA,eAAGR,aAAaO,QAAhB,EAAyB;AACxBA,wBAAWP,UAAX;AACA;AACDhB,aAAE,wBAAF,EAA4BO,IAA5B,CAAiC3B,MAAMQ,gBAAN,CAAuBmC,QAAvB,CAAjC;AACAP,wBAAapC,MAAMO,QAAN,CAAe6B,UAAf,EAA2BO,QAA3B,CAAb;AACA,UAPF,MAOQ;AACNvB,aAAE,wBAAF,EAA4BO,IAA5B,CAAiC3B,MAAMQ,gBAAN,CAAuB8B,OAAvB,CAAjC;AACAF,wBAAapC,MAAMO,QAAN,CAAe6B,UAAf,EAA2BE,OAA3B,CAAb;AACA;AACD,QApBA,MAoBM;AACNlB,WAAE,wBAAF,EAA4BO,IAA5B,CAAiC,MAAjC;AACA;;AAEA,YAAKkB,SAAL,CAAeT,UAAf;;AAEA,WAAGhB,EAAE,0BAAF,EAA8BL,MAA9B,GAAuC,CAA1C,EAA4C;AAC1C,aAAI+B,OAAO,IAAX;;AAEF1B,WAAE,0BAAF,EAA8B2B,KAA9B,CAAoC,UAASC,CAAT,EAAY;;AAE/C,eAAIC,YAAY7B,EAAE,gBAAF,EAAoBa,GAApB,EAAhB;AACA,eAAIgB,aAAcA,UAAUlC,MAAV,GAAmB,CAAjC,IAAwC,CAACwB,MAAMU,SAAN,CAAzC,IAA+DA,YAAY,CAA3E,IAAkF7B,EAAE,0BAAF,EAA8BL,MAA9B,GAAuC,CAA7H,EAAiI;AAChIK,eAAE,cAAF,EAAkBe,OAAlB,CAA0B,QAA1B;AACA,iBAAIf,EAAE,yBAAF,EAA6BM,IAA7B,CAAkC,2BAAlC,EAA+DX,MAA/D,GAAwE,CAA5E,EAA+E;AAC9EiC,iBAAEE,eAAF;AACA;;AAEG,iBAAGJ,KAAKxB,SAAL,IAAkBwB,KAAKxB,SAAL,CAAe6B,IAAf,EAArB,EAA4C;AAC1C,mBAAIC,QAAQhC,EAAE,IAAF,CAAZ;AACA,mBAAIiC,MAAMD,MAAME,IAAN,CAAW,KAAX,CAAV;AACA,mBAAIC,UAAUnC,EAAEgC,MAAMI,IAAN,CAAW,aAAX,CAAF,CAAd;AACAD,uBAAQE,KAAR,GAAgBC,IAAhB,CAAqBL,GAArB;AACD;AAEL,YAbD,MAaO;AACNL,eAAEE,eAAF;AACA9B,eAAE,oBAAF,EAAwBuC,MAAxB;AACA;AACD,UApBD;AAqBD;AACA;;;iCAEW;AAAA;;AACV,WAAMC,QAAQ,KAAKzC,OAAnB;AACAyC,aAAMC,EAAN,CAAS,MAAT,EAAiB,kBAAjB,EAAqC;AAAA,gBAAS,OAAKC,YAAL,CAAkBC,KAAlB,CAAT;AAAA,QAArC;AACAH,aAAMC,EAAN,CAAS,OAAT,EAAkB,kBAAlB,EAAsC;AAAA,gBAAS,OAAKG,eAAL,CAAqBD,KAArB,CAAT;AAAA,QAAtC;AACAH,aAAMC,EAAN,CAAS,OAAT,EAAkB,wBAAlB,EAA4C;AAAA,gBAAS,OAAKI,iBAAL,CAAuBF,KAAvB,CAAT;AAAA,QAA5C;AACAH,aAAMC,EAAN,CAAS,OAAT,EAAkB,2BAAlB,EAA+C;AAAA,gBAAS,OAAKK,cAAL,CAAoBH,KAApB,CAAT;AAAA,QAA/C;AACAH,aAAMC,EAAN,CAAS,QAAT,EAAmB,gBAAnB,EAAqC;AAAA,gBAAS,OAAKM,iBAAL,CAAuBJ,KAAvB,CAAT;AAAA,QAArC;AACAH,aAAMC,EAAN,CAAS,OAAT,EAAkB,KAAKxC,SAAvB,EAAkC;AAAA,gBAAS,OAAK+C,eAAL,CAAqBL,KAArB,CAAT;AAAA,QAAlC;AACD;;;qCAEeA,K,EAAO;AACrB,WAAG,KAAKzC,SAAL,IAAkB,KAAKA,SAAL,CAAe6B,IAAf,EAArB,EAA4C;AAC1C,cAAKhC,OAAL,CAAawC,MAAb;AACD;AACF;;;uCAEiBI,K,EAAO;AACvB,WAAMX,QAAQhC,EAAE2C,MAAMM,aAAR,CAAd;AACA,WAAMC,SAASlB,MAAOmB,QAAP,CAAgB,iBAAhB,CAAf;AACA,WAAID,OAAOhB,IAAP,CAAY,MAAZ,KAAuB,EAA3B,EAA+B;AAC7BlC,WAAE,2BAAF,EAA+BoD,IAA/B;AACApD,WAAE,wBAAF,EAA4Be,OAA5B,CAAoC,OAApC;AACA;AACD,QAJD,MAIO;AACLf,WAAE,2BAAF,EAA+BqD,IAA/B;AACD;AACD,WAAIvC,aAAad,EAAE,4BAAF,CAAjB;AACAc,kBAAWD,GAAX,CAAeqC,OAAOhB,IAAP,CAAY,MAAZ,CAAf;AACAlC,SAAE,2BAAF,EAA+Be,OAA/B,CAAuC,OAAvC;AACAf,SAAE,sBAAF,EAA0BsD,WAA1B,CAAsC,eAAtC;AACD;;;oCAEcX,K,EAAO;AACpB,WAAIT,OAAO,EAAX;AACA,WAAIpB,aAAad,EAAE,4BAAF,CAAjB;AACAkC,YAAKqB,IAAL,GAAYzC,WAAWD,GAAX,EAAZ;;AAEA,WAAGqB,KAAKqB,IAAL,IAAa,EAAhB,EAAmB;AACjBvD,WAAE,6BAAF,EAAiCM,IAAjC,CAAsC,gBAAtC,EAAwDC,IAAxD,CAA6D,MAA7D;AACA;AACD;;AAED2B,YAAKsB,UAAL,GAAkB1C,WAAWoB,IAAX,CAAgB,YAAhB,CAAlB;AACAA,YAAKuB,QAAL,GAAgB3C,WAAWoB,IAAX,CAAgB,UAAhB,CAAhB;;AAEA,WAAIlB,aAAatB,WAAWM,EAAE,sBAAF,EAA0BO,IAA1B,EAAX,CAAjB;;AAEA2B,YAAKwB,MAAL,GAAc1C,UAAd;AACA,WAAIC,QAAQ,IAAZ;AACAjB,SAAE2D,IAAF,CAAO,MAAMzB,KAAKsB,UAAX,GAAwB,GAAxB,GAA8BtB,KAAKuB,QAAnC,GAA8C,eAArD,EAAsEvB,IAAtE,EAA4E,UAASA,IAAT,EAAe;AACzFlC,WAAE,sBAAF,EAA0B4D,GAA1B,CAA8B,SAA9B,EAAwC,cAAxC;AACA,aAAI1B,KAAK2B,OAAL,IAAgB,IAApB,EAA0B;;AAExB7D,aAAE,2BAAF,EAA+BoD,IAA/B;AACApD,aAAE,sBAAF,EAA0BsD,WAA1B,CAAsC,eAAtC,EAAuDQ,QAAvD,CAAgE,cAAhE,EAAgFC,IAAhF,CAAqFC,WAAWC,KAAX,CAAiB,2BAAjB,CAArF;AAED,UALD,MAKO,IAAI/B,KAAK2B,OAAL,IAAgB,KAApB,EAA2B;AAChC7D,aAAE,2BAAF,EAA+BqD,IAA/B;;AAEA,eAAInB,KAAK,MAAL,KAAgB,UAApB,EAAgC;AAC9BlC,eAAE,sBAAF,EAA0BsD,WAA1B,CAAsC,cAAtC,EAAsDQ,QAAtD,CAA+D,eAA/D,EAAgFvD,IAAhF,CAAqFyD,WAAWC,KAAX,CAAiB,uCAAjB,EAA0D,EAACC,MAAKhC,KAAK,MAAL,CAAN,EAA1D,CAArF;AACD,YAFD,MAEO;AACLlC,eAAE,sBAAF,EAA0BsD,WAA1B,CAAsC,cAAtC,EAAsDQ,QAAtD,CAA+D,eAA/D,EAAgFvD,IAAhF,CAAqFyD,WAAWC,KAAX,CAAiB,oCAAjB,EAAuD,EAACC,MAAKhC,KAAK,MAAL,CAAN,EAAvD,CAArF;AACD;;AAEDlC,aAAE,uBAAF,EAA2BM,IAA3B,CAAgC,gBAAhC,EAAkDC,IAAlD,CAAuD3B,MAAMQ,gBAAN,CAAuB8C,KAAKiC,cAA5B,CAAvD;;AAEAnE,aAAE,+BAAF,EAAmCa,GAAnC,CAAuCC,WAAWD,GAAX,EAAvC;AACD;;AAEDI,eAAMmD,cAAN;AACD,QAtBD;AAuBD;;;uCAEiBzB,K,EAAO;AACvB,WAAG3C,EAAE,gBAAF,EAAoBa,GAApB,MAA6B,EAAhC,EAAoC;AAClC,aAAID,sBAAsBZ,EAAE,gBAAF,EAAoBa,GAApB,EAA1B;AACA,aAAIC,aAAad,EAAE,4BAAF,CAAjB;AACAc,oBAAWD,GAAX,CAAeD,mBAAf;AACAZ,WAAE,2BAAF,EAA+Be,OAA/B,CAAuC,OAAvC;AACD;;AAEDf,SAAE,sBAAF,EAA0BqD,IAA1B;AACA;AACArD,SAAE,kBAAF,EAAsBoD,IAAtB;AACApD,SAAE,2BAAF,EAA+BoD,IAA/B;AACApD,SAAE,sBAAF,EAA0BqD,IAA1B;AACArD,SAAE,uBAAF,EAA2BM,IAA3B,CAAgC,gBAAhC,EAAkDC,IAAlD,CAAuD,MAAvD;AACAP,SAAE,sBAAF,EAA0BO,IAA1B,CAA+B,EAA/B;AACAP,SAAE,sBAAF,EAA0Ba,GAA1B,CAA8B,EAA9B;AACAb,SAAE,IAAF,EAAQqD,IAAR;AACArD,SAAE,+BAAF,EAAmCa,GAAnC,CAAuC,EAAvC;AACAb,SAAE,4BAAF,EAAgCa,GAAhC,CAAoC,EAApC;;AAEA,YAAKuD,cAAL;AACD;;;kCAEYzB,K,EAAO;AAClB,WAAMX,QAAQhC,EAAE2C,MAAMM,aAAR,CAAd;AACA,WAAI/B,UAAUc,MAAMnB,GAAN,EAAd;AACAK,iBAAUlC,KAAKC,KAAL,CAAWiC,UAAU,GAArB,IAA4B,GAAtC;AACAc,aAAMnB,GAAN,CAAUK,OAAV;;AAEA,WAAGC,MAAMD,OAAN,KAAkBA,WAAW,CAAhC,EAAkC;AAChCc,eAAMnB,GAAN,CAAU,MAAV;AACA,cAAKO,aAAL;AACD,QAHD,MAGO;AACL,cAAKC,eAAL;AACD;AACD,YAAK+C,cAAL;AACD;;;qCAEezB,K,EAAO;AACrB,WAAMX,QAAQhC,EAAE2C,MAAMM,aAAR,CAAd;AACA;AACAjD,SAAE,uBAAF,EAA2BM,IAA3B,CAAgC,gBAAhC,EAAkDC,IAAlD,CAAuD,MAAvD;AACAP,SAAE,sBAAF,EAA0BO,IAA1B,CAA+B,EAA/B,EAAmC+C,WAAnC,CAA+C,eAA/C;AACAtD,SAAE,sBAAF,EAA0Ba,GAA1B,CAA8B,EAA9B;AACAb,SAAE,wBAAF,EAA4BqD,IAA5B;AACArD,SAAE,+BAAF,EAAmCa,GAAnC,CAAuC,EAAvC;AACAb,SAAE,4BAAF,EAAgCa,GAAhC,CAAoC,EAApC;AACA,YAAKuD,cAAL;AACApE,SAAE,sBAAF,EAA0BoD,IAA1B;AACApD,SAAE,4BAAF,EAAgCqE,KAAhC;AACA;AACArE,SAAE,wBAAF,EAA4BoD,IAA5B;AACApD,SAAE,2BAAF,EAA+BqD,IAA/B;;AAEA;AACArB,aAAMqB,IAAN;AACD;;;oCAEcrC,U,EAAY;AACzB,WAAIsD,mBAAmBtE,EAAE,uBAAF,EAA2BM,IAA3B,CAAgC,gBAAhC,EAAkDC,IAAlD,EAAvB;AACA,WAAIP,EAAEuE,IAAF,CAAOD,gBAAP,KAA4B,EAA5B,IAAkCnD,MAAMmD,gBAAN,CAAtC,EAA+D;AAC7DA,4BAAmB,CAAnB;AACD;AACD,WAAItD,aAAasD,gBAAjB,EAAmC;AACjCA,4BAAmBtD,UAAnB;AACD;AACDA,oBAAapC,MAAMO,QAAN,CAAe6B,UAAf,EAA2BsD,gBAA3B,CAAb;AACA,cAAOtD,UAAP;AACD;;;kCAEYE,O,EAAS;AACpB,WAAIsD,cAAcxE,EAAE,sBAAF,EAA0BO,IAA1B,EAAlB;;AAEA,WAAIiE,eAAe,EAAf,IAAqBrD,MAAMqD,WAAN,CAArB,IAA2C9E,WAAW8E,WAAX,KAA2B,CAA1E,EAA6E;AAC3E,cAAKpD,aAAL;AACA,gBAAO,CAAP;AACD;;AAED,WAAIqD,OAAOzF,KAAKC,KAAL,CAAWuF,cAAc,IAAzB,IAAiCxF,KAAKC,KAAL,CAAWiC,UAAU,IAArB,CAAjC,GAA8DA,OAA9D,GAAwEsD,WAAnF;;AAEA,WAAI,KAAKrE,WAAL,CAAiBmB,UAAjB,IAA+B,KAAnC,EAA0C;AACxC,aAAIN,aAAatB,WAAWM,EAAE,sBAAF,EAA0BO,IAA1B,EAAX,CAAjB;AACA,aAAImE,eAAe1F,KAAKC,KAAL,CAAWL,MAAMQ,gBAAN,CAAuBR,MAAMC,QAAN,CAAe4F,IAAf,EAAqB,KAAKtE,WAAL,CAAiBqB,SAAtC,CAAvB,IAA2E,GAAtF,IAA6F,GAAhH;;AAEA,aAAIR,aAAa0D,YAAjB,EAA+B;AAC7BA,0BAAe1D,UAAf;AACD;;AAEDhB,WAAE,wBAAF,EAA4BO,IAA5B,CAAiC3B,MAAMQ,gBAAN,CAAuBsF,YAAvB,CAAjC;AACD,QATD,MASO;AACL1E,WAAE,wBAAF,EAA4BO,IAA5B,CAAiC3B,MAAMQ,gBAAN,CAAuBqF,IAAvB,CAAjC;AACD;AACD,cAAOA,IAAP;AAED;;;sCAEgBE,c,EAAgB;AAC/B,WAAIC,UAAUlF,WAAWM,EAAE,kBAAF,EAAsBO,IAAtB,EAAX,CAAd;AACA,WAAIsE,gBAAgBF,iBAAiBC,OAAjB,GAA2BD,cAA3B,GAA2CC,OAA/D;AACA,WAAIE,gBAAgB9E,EAAE,sBAAF,CAApB;;AAEA,WAAI8E,cAAcnF,MAAd,GAAuB,CAA3B,EAA8B;AAC5B,aAAIoF,SAASrF,WAAWoF,cAAcvE,IAAd,KAAuB,GAAlC,IAAyC,GAAtD;AACAsE,yBAAgBA,gBAAgBE,MAAhB,GAAyBF,aAAzB,GAAwCE,MAAxD;AACD;;AAED,cAAOF,aAAP;AACD;;;+BAES7D,U,EAAY;AACpBA,oBAAahC,KAAKC,KAAL,CAAW+B,aAAa,IAAxB,IAAgC,IAA7C;;AAEA,WAAI,KAAKb,WAAL,CAAiBmB,UAAjB,IAA+B,KAAnC,EAA0C;AACxCN,sBAAapC,MAAMa,eAAN,CAAsBuB,UAAtB,CAAb;AACAhB,WAAE,kBAAF,EAAsBO,IAAtB,CAA2BS,UAA3B;AACAhB,WAAE,8BAAF,EAAkCa,GAAlC,CAAsCG,UAAtC;AAED,QALD,MAKO;AACL,aAAIgE,SAASpG,MAAMa,eAAN,CAAsBb,MAAMC,QAAN,CAAemC,UAAf,EAA2B,KAAKb,WAAL,CAAiBqB,SAA5C,CAAtB,CAAb;AACA,aAAIyD,iBAAiBjG,KAAKC,KAAL,CAAW+F,SAAS,GAApB,IAA2B,GAAhD;;AAEAhF,WAAE,mBAAF,EAAuBO,IAAvB,CAA4BS,UAA5B;AACAhB,WAAE,kBAAF,EAAsBO,IAAtB,CAA2B0E,cAA3B;AACAjF,WAAE,8BAAF,EAAkCa,GAAlC,CAAsCoE,cAAtC;AACD;AACF;;;sCAEgB;AACf,WAAIjE,aAAatB,WAAWM,EAAE,sBAAF,EAA0BO,IAA1B,EAAX,CAAjB;;AAEAS,oBAAa,KAAKkE,cAAL,CAAoBlE,UAApB,CAAb;;AAEA,WAAImE,YAAY,KAAKhF,WAAL,CAAiBiF,UAAjC;;AAEA,eAAOD,SAAP;AACE,cAAK,MAAL;AACEnE,wBAAaA,cAAc,CAAd,GAAkBA,UAAlB,GAA+B,CAA5C;AACA,gBAAKS,SAAL,CAAeT,UAAf;AACA;AACF,cAAK,WAAL;AACE,eAAI2D,iBAAiB/F,MAAMM,QAAN,CAAe8B,UAAf,EAA2B,KAAKb,WAAL,CAAiBqB,SAA5C,CAArB;AACAmD,4BAAiB/F,MAAMa,eAAN,CAAsBkF,cAAtB,CAAjB;AACA,eAAIE,gBAAgB,KAAKQ,gBAAL,CAAsBV,cAAtB,CAApB;AACA,eAAIW,aAAatF,EAAE,kBAAF,EAAsBa,GAAtB,EAAjB;;AAEA,eAAIgE,iBAAiBnF,WAAW4F,UAAX,CAArB,EAA6C;AAC3CA,0BAAaT,aAAb;AACD;;AAED7E,aAAE,kBAAF,EAAsBa,GAAtB,CAA0ByE,UAA1B;;AAEA,eAAIA,cAAc,CAAlB,EAAqB;AACnB,kBAAKlE,aAAL;AACD;;AAED,eAAIkE,cAActF,EAAE,sBAAF,EAA0BL,MAA1B,GAAmC,CAArD,EAAwD;AACtD2F,0BAAa,KAAKC,YAAL,CAAkBD,UAAlB,CAAb;;AAEA,iBAAIZ,eAAe1E,EAAE,wBAAF,EAA4BO,IAA5B,EAAnB;AACAS,0BAAapC,MAAMO,QAAN,CAAe6B,UAAf,EAA2B0D,YAA3B,CAAb;AAED,YAND,MAMO;AACL1E,eAAE,kBAAF,EAAsBa,GAAtB,CAA0B,CAA1B;AACAb,eAAE,wBAAF,EAA4BO,IAA5B,CAAiC,MAAjC;AACD;;AAEDS,wBAAaA,cAAc,CAAd,GAAkBA,UAAlB,GAA+B,CAA5C;AACA,gBAAKS,SAAL,CAAeT,UAAf;AACA;AACF,cAAK,UAAL;AACE,eAAI2D,iBAAiB3D,UAArB;AACA,eAAIsE,aAAatF,EAAE,kBAAF,EAAsBa,GAAtB,EAAjB;;AAEA,eAAI8D,kBAAkBjF,WAAW4F,UAAX,CAAtB,EAA8C;AAC5CA,0BAAaX,cAAb;AACD;;AAED3E,aAAE,kBAAF,EAAsBa,GAAtB,CAA0ByE,UAA1B;;AAEA,eAAIA,cAAc,CAAlB,EAAqB;AACnB,kBAAKlE,aAAL;AACD;;AAED,eAAIkE,cAActF,EAAE,sBAAF,EAA0BL,MAA1B,GAAmC,CAArD,EAAwD;AACtD2F,0BAAa,KAAKC,YAAL,CAAkBD,UAAlB,CAAb;AACA,iBAAIZ,eAAe1E,EAAE,wBAAF,EAA4BO,IAA5B,EAAnB;AACAS,0BAAapC,MAAMO,QAAN,CAAe6B,UAAf,EAA2B0D,YAA3B,CAAb;AACD,YAJD,MAIO;AACL1E,eAAE,kBAAF,EAAsBa,GAAtB,CAA0B,CAA1B;AACAb,eAAE,wBAAF,EAA4BO,IAA5B,CAAiC,MAAjC;AACD;;AAEDS,wBAAaA,cAAc,CAAd,GAAkBA,UAAlB,GAA+B,CAA5C;AACA,gBAAKS,SAAL,CAAeT,UAAf;AACA;AA5DJ;AA8DD;;;qCAEe;AACdhB,SAAE,kBAAF,EAAsBa,GAAtB,CAA0B,CAA1B;AACAb,SAAE,wBAAF,EAA4BkC,IAA5B,CAAiC,cAAjC;AACAlC,SAAE,yBAAF,EAA6BqD,IAA7B;AACArD,SAAE,sBAAF,EAA0BwF,KAA1B,CAAgC,QAAhC,EAAyC,wBAAzC;AACD;;;uCAEiB;AAChBxF,SAAE,yBAAF,EAA6BoD,IAA7B;AACApD,SAAE,sBAAF,EAA0BwF,KAA1B,CAAgC,KAAhC,EAAuC,EAAEC,UAAU,IAAZ,EAAiBC,eAAe,IAAhC,EAAvC;AACD;;;;;;AAGH,KAAI7F,WAAJ,CAAgB;AACdE,YAAS;AADK,EAAhB,E","file":"app/js/order/create/index.js","sourcesContent":["import notify from 'common/notify';\n\nlet utils = {\n  divition(x, y) {\n    return Math.round(Math.round(x * 1000) / Math.round(y * 1000) * 1000) / 1000;\n  },\n  multiple(x, y) {\n    return Math.round(Math.round(x * 100) * Math.round(y * 100)) / 10000;\n  },\n  subtract(x, y) {\n    return Math.round(Math.round(x * 1000) - Math.round(y * 1000)) / 1000;\n  },\n  moneyFormatFloor(value) {\n    // 转化成字符串\n    let tempValue = value + '';\n    tempValue = parseInt(Math.round(tempValue * 1000));\n    // 抹去最后１位\n    tempValue = parseInt(tempValue / 10) * 10 / 1000;\n    return tempValue.toFixed(2);\n  },\n  moneyFormatCeil(value) {\n    let tempValue = value + '';\n    tempValue = parseFloat(tempValue).toFixed(3);\n    let length = tempValue.length;\n    if (tempValue.substr(length - 1, 1) === '0') {\n      return this.moneyFormatFloor(tempValue);\n    }\n    return this.moneyFormatFloor(parseFloat(tempValue) + 0.01);\n  }\n}\n\n\nclass OrderCreate {\n  constructor(props) {\n    this.element = $(props.element);\n    this.submitBtn = '#order-create-btn';\n    this.validator = null;\n    this.coinSetting = JSON.parse(this.element.find('.js-coin-setting ').text());\n    this.init();\n  }\n\n  init() {\n    this.initEvent();\n    this.validator = this.element.validate({\n      currentDom: this.submitBtn,\n    });\n\n    let couponDefaultSelect = $('#coupon-select').val();\n\t\tif(couponDefaultSelect != \"\") {\n\t\t  let\tcouponCode = $('[role=\"coupon-code-input\"]');\n\t\t\tcouponCode.val(couponDefaultSelect);\n\t\t\t$('button[role=\"coupon-use\"]').trigger('click');\n\t\t}\n\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n    let _this = this;\n    if ($('[role=\"coinNum\"]').length > 0) {\n \t\t\tlet coinNum = $('[role=\"coinNum\"]').val();\n \t\t\tif (isNaN(coinNum) || coinNum <= 0) {\n\t\t\t\t$(this).val(\"0.00\");\n\t\t\t\t_this.coinPriceZero();\n\t\t\t} else {\n\t\t\t\t_this.showPayPassword();\n\t\t\t}\n      \n\t\t\tif(_this.coinSetting.price_type == \"RMB\") {\n\t \t\t\tlet discount = utils.divition(coinNum, _this.coinSetting.cash_rate);\n\t \t\t\tif(totalPrice < discount){\n\t \t\t\t\tdiscount = totalPrice;\n\t \t\t\t}\n\t \t\t\t$('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(discount));\n\t \t\t\ttotalPrice = utils.subtract(totalPrice, discount);\n \t\t\t} else {\n \t\t\t\t$('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(coinNum));\n \t\t\t\ttotalPrice = utils.subtract(totalPrice, coinNum);\n \t\t\t}\n \t\t} else {\n \t\t\t$('[role=\"cash-discount\"]').text(\"0.00\");\n \t\t}\n\n    this.shouldPay(totalPrice);\n\n    if($('#js-order-create-sms-btn').length > 0){\n      let self = this;\n\n\t \t\t$('#js-order-create-sms-btn').click(function(e) {\n        \n\t \t\t\tlet coinToPay = $('#coinPayAmount').val();\n\t \t\t\tif (coinToPay && (coinToPay.length > 0) && (!isNaN(coinToPay)) && (coinToPay > 0) && ($(\"#js-order-create-sms-btn\").length > 0)) {\n\t \t\t\t\t$(\"#payPassword\").trigger(\"change\");\n\t \t\t\t\tif ($('[role=\"password-input\"]').find('span[class=\"text-danger\"]').length > 0) {\n\t \t\t\t\t\te.stopPropagation();\n\t \t\t\t\t}\n\n          if(self.validator && self.validator.form()) {\n            let $this = $(this);\n            let url = $this.data('url');\n            let $target = $($this.attr('data-target'));\n            $target.modal().load(url);\n          }\n\n\t \t\t\t} else {\n\t \t\t\t\te.stopPropagation();\n\t \t\t\t\t$(\"#order-create-form\").submit();\n\t \t\t\t}\n\t \t\t});\n\t\t}\n  }\n\n  initEvent() {\n    const $node = this.element;\n    $node.on('blur', '[role=\"coinNum\"]', event => this.coinNumEvent(event));\n    $node.on('click', '#coupon-code-btn', event => this.couponCodeEvent(event));\n    $node.on('click', '[role=\"cancel-coupon\"]', event => this.couponCancelEvent(event));\n    $node.on('click', 'button[role=\"coupon-use\"]', event => this.couponUseEvent(event));\n    $node.on('change', '#coupon-select', event => this.couponSelectEvent(event));\n    $node.on('click', this.submitBtn, event => this.formSubmitEvent(event))\n  }\n\n  formSubmitEvent(event) {\n    if(this.validator && this.validator.form()) {\n      this.element.submit();\n    }\n  }\n  \n  couponSelectEvent(event) {\n    const $this = $(event.currentTarget);\n    const coupon = $this .children('option:selected');\n    if (coupon.data('code') == \"\") {\n      $('[role=no-use-coupon-code]').show();\n      $('[role=\"cancel-coupon\"]').trigger('click');\n      return;\n    } else { \n      $('[role=no-use-coupon-code]').hide();\n    }\n    let couponCode = $('[role=\"coupon-code-input\"]');\n    couponCode.val(coupon.data('code'));\n    $('button[role=\"coupon-use\"]').trigger('click');\n    $('[role=\"code-notify\"]').removeClass('alert-success');\n  }\n\n  couponUseEvent(event) {\n    let data = {};\n    let couponCode = $('[role=\"coupon-code-input\"]');\n    data.code = couponCode.val();\n\n    if(data.code == \"\"){\n      $('[role=\"coupon-price-input\"]').find(\"[role='price']\").text(\"0.00\");\n      return;\n    }\n    \n    data.targetType = couponCode.data(\"targetType\");\n    data.targetId = couponCode.data(\"targetId\");\n\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n    \n    data.amount = totalPrice;\n    let _this = this;\n    $.post('/' + data.targetType + '/' + data.targetId + '/coupon/check', data, function(data) {\n      $('[role=\"code-notify\"]').css(\"display\",\"inline-block\");\n      if (data.useable == \"no\") {\n        \n        $('[role=no-use-coupon-code]').show();\n        $('[role=\"code-notify\"]').removeClass('alert-success').addClass(\"alert-danger\").html(Translator.trans('order.create.useless_hint'));\n\n      } else if (data.useable == \"yes\") {\n        $('[role=no-use-coupon-code]').hide();\n\n        if (data['type'] == 'discount') {\n          $('[role=\"code-notify\"]').removeClass('alert-danger').addClass(\"alert-success\").text(Translator.trans('order.create.use_discount_coupon_hint', {rate:data['rate']}));\n        } else {\n          $('[role=\"code-notify\"]').removeClass('alert-danger').addClass(\"alert-success\").text(Translator.trans('order.create.use_price_coupon_hint', {rate:data['rate']}));\n        }\n\n        $('[role=\"coupon-price\"]').find(\"[role='price']\").text(utils.moneyFormatFloor(data.decreaseAmount));\n\n        $('[role=\"coupon-code-verified\"]').val(couponCode.val());\n      }\n\n      _this.conculatePrice();\n    })\n  }\n\n  couponCancelEvent(event) {\n    if($('#coupon-select').val() != \"\") {\n      let couponDefaultSelect = $('#coupon-select').val();\n      let couponCode = $('[role=\"coupon-code-input\"]');\n      couponCode.val(couponDefaultSelect);\n      $('button[role=\"coupon-use\"]').trigger('click');\n    }\n\n    $('[role=\"coupon-code\"]').hide();\n    // $('[role=\"no-use-coupon-code\"]').show();\n    $(\"#coupon-code-btn\").show();\n    $('[role=\"null-coupon-code\"]').show();\n    $('[role=\"code-notify\"]').hide();\n    $('[role=\"coupon-price\"]').find(\"[role='price']\").text(\"0.00\");\n    $('[role=\"code-notify\"]').text(\"\");\n    $('[role=\"coupon-code\"]').val(\"\");\n    $(this).hide();\n    $('[role=\"coupon-code-verified\"]').val(\"\");\n    $('[role=\"coupon-code-input\"]').val(\"\");\n\n    this.conculatePrice();\n  }\n\n  coinNumEvent(event) {\n    const $this = $(event.currentTarget);\n    let coinNum = $this.val();\n    coinNum = Math.round(coinNum * 100) / 100;\n    $this.val(coinNum);\n\n    if(isNaN(coinNum) || coinNum <= 0){\n      $this.val(\"0.00\");\n      this.coinPriceZero();\n    } else {\n      this.showPayPassword();\n    }\n    this.conculatePrice();\n  }\n\n  couponCodeEvent(event) {\n    const $this = $(event.currentTarget);\n    // $('[role=\"cancel-coupon\"]').trigger('click');\n    $('[role=\"coupon-price\"]').find(\"[role='price']\").text(\"0.00\");\n    $('[role=\"code-notify\"]').text(\"\").removeClass('alert-success');\n    $('[role=\"coupon-code\"]').val(\"\");\n    $('[role=\"cancel-coupon\"]').hide();\n    $('[role=\"coupon-code-verified\"]').val(\"\");\n    $('[role=\"coupon-code-input\"]').val(\"\");\n    this.conculatePrice();\n    $('[role=\"coupon-code\"]').show();\n    $('[role=\"coupon-code-input\"]').focus();\n    // $('[role=\"no-use-coupon-code\"]').hide();\n    $('[role=\"cancel-coupon\"]').show();\n    $('[role=\"null-coupon-code\"]').hide();\n\n    // $('[role=\"code-notify\"]').show();\n    $this.hide();\n  }\n\n  afterCouponPay(totalPrice) {\n    let couponTotalPrice = $('[role=\"coupon-price\"]').find(\"[role='price']\").text();\n    if ($.trim(couponTotalPrice) == \"\" || isNaN(couponTotalPrice)) {\n      couponTotalPrice = 0;\n    }\n    if (totalPrice < couponTotalPrice) {\n      couponTotalPrice = totalPrice;\n    }\n    totalPrice = utils.subtract(totalPrice, couponTotalPrice);\n    return totalPrice;\n  }\n\n  afterCoinPay(coinNum) {\n    let accountCash = $('[role=\"accountCash\"]').text();\n\n    if (accountCash == \"\" || isNaN(accountCash) || parseFloat(accountCash) == 0) {\n      this.coinPriceZero();\n      return 0;\n    }\n\n    let coin = Math.round(accountCash * 1000) > Math.round(coinNum * 1000) ? coinNum : accountCash;\n\n    if (this.coinSetting.price_type == \"RMB\") {\n      let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n      let cashDiscount = Math.round(utils.moneyFormatFloor(utils.divition(coin, this.coinSetting.cash_rate)) * 100) / 100;\n\n      if (totalPrice < cashDiscount) {\n        cashDiscount = totalPrice;\n      }\n\n      $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(cashDiscount));\n    } else {\n      $('[role=\"cash-discount\"]').text(utils.moneyFormatFloor(coin));\n    }\n    return coin;\n    \n  }\n\n  getMaxCoinCanPay(totalCoinPrice) {\n    let maxCoin = parseFloat($('[role=\"maxCoin\"]').text());\n    let maxCoinCanPay = totalCoinPrice < maxCoin ? totalCoinPrice: maxCoin;\n    let myCashAccount = $('[role=\"accountCash\"]');\n\n    if (myCashAccount.length > 0) {\n      let myCash = parseFloat(myCashAccount.text() * 100) / 100;\n      maxCoinCanPay = maxCoinCanPay < myCash ? maxCoinCanPay: myCash;\n    }\n\n    return maxCoinCanPay;\n  }\n\n  shouldPay(totalPrice) {\n    totalPrice = Math.round(totalPrice * 1000) / 1000;\n\n    if (this.coinSetting.price_type == \"RMB\") {\n      totalPrice = utils.moneyFormatCeil(totalPrice);\n      $('[role=\"pay-rmb\"]').text(totalPrice);\n      $('input[name=\"shouldPayMoney\"]').val(totalPrice);\n\n    } else {\n      let payRmb = utils.moneyFormatCeil(utils.divition(totalPrice, this.coinSetting.cash_rate));\n      let shouldPayMoney = Math.round(payRmb * 100) / 100;\n\n      $('[role=\"pay-coin\"]').text(totalPrice);\n      $('[role=\"pay-rmb\"]').text(shouldPayMoney);\n      $('input[name=\"shouldPayMoney\"]').val(shouldPayMoney);\n    }\n  }\n\n  conculatePrice() {\n    let totalPrice = parseFloat($('[role=\"total-price\"]').text());\n\n    totalPrice = this.afterCouponPay(totalPrice);\n    \n    let cashModel = this.coinSetting.cash_model;\n\n    switch(cashModel) {\n      case 'none':\n        totalPrice = totalPrice >= 0 ? totalPrice : 0;\n        this.shouldPay(totalPrice);\n        break;\n      case 'deduction':\n        var totalCoinPrice = utils.multiple(totalPrice, this.coinSetting.cash_rate);\n        totalCoinPrice = utils.moneyFormatCeil(totalCoinPrice);\n        var maxCoinCanPay = this.getMaxCoinCanPay(totalCoinPrice);\n        var coinNumPay = $('[role=\"coinNum\"]').val();\n\n        if (maxCoinCanPay <= parseFloat(coinNumPay)) {\n          coinNumPay = maxCoinCanPay;\n        }\n\n        $('[role=\"coinNum\"]').val(coinNumPay);\n\n        if (coinNumPay == 0) {\n          this.coinPriceZero();\n        }\n\n        if (coinNumPay && $('[name=\"payPassword\"]').length > 0) {\n          coinNumPay = this.afterCoinPay(coinNumPay);\n\n          var cashDiscount = $('[role=\"cash-discount\"]').text();\n          totalPrice = utils.subtract(totalPrice, cashDiscount);\n\n        } else {\n          $('[role=\"coinNum\"]').val(0);\n          $('[role=\"cash-discount\"]').text(\"0.00\");\n        }\n\n        totalPrice = totalPrice >= 0 ? totalPrice : 0;\n        this.shouldPay(totalPrice);\n        break;\n      case 'currency':\n        var totalCoinPrice = totalPrice;\n        var coinNumPay = $('[role=\"coinNum\"]').val();\n\n        if (totalCoinPrice <= parseFloat(coinNumPay)) {\n          coinNumPay = totalCoinPrice;\n        }\n\n        $('[role=\"coinNum\"]').val(coinNumPay);\n\n        if (coinNumPay == 0) {\n          this.coinPriceZero();\n        }\n\n        if (coinNumPay && $('[name=\"payPassword\"]').length > 0) {\n          coinNumPay = this.afterCoinPay(coinNumPay);\n          var cashDiscount = $('[role=\"cash-discount\"]').text();\n          totalPrice = utils.subtract(totalPrice, cashDiscount);\n        } else {\n          $('[role=\"coinNum\"]').val(0);\n          $('[role=\"cash-discount\"]').text(\"0.00\");\n        }\n\n        totalPrice = totalPrice >= 0 ? totalPrice : 0;\n        this.shouldPay(totalPrice);\n        break;\n    }\n  }\n\n  coinPriceZero() {\n    $('[role=\"coinNum\"]').val(0);\n    $('[role=\"cash-discount\"]').data('defaultValue');\n    $(\"[role='password-input']\").hide();\n    $('[name=\"payPassword\"]').rules('remove','required passwordCheck');\n  }\n\n  showPayPassword() {\n    $(\"[role='password-input']\").show();\n    $('[name=\"payPassword\"]').rules('add', { required: true,passwordCheck: true});\n  }\n}\n\nnew OrderCreate({\n  element: '#order-create-form'\n});\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/order/create/index.js"],"sourceRoot":""}