'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.initWatermark = exports.onlyShowError = exports.testpaperCardLocation = exports.testpaperCardFixed = exports.initScrollbar = undefined;

require('app/common/watermark');

var _utils = require('common/utils');

var initScrollbar = exports.initScrollbar = function initScrollbar() {
	var $paneCard = $('.js-panel-card');
	$paneCard.perfectScrollbar();
	$paneCard.perfectScrollbar('update');
};

var testpaperCardFixed = exports.testpaperCardFixed = function testpaperCardFixed() {
	var $testpaperCard = $(".js-testpaper-card");
	if ($testpaperCard.length <= 0) {
		return;
	}
	var testpaperCard_top = $testpaperCard.offset().top;
	$(window).scroll(function (event) {
		var scrollTop = $(window).scrollTop();
		if (scrollTop >= testpaperCard_top) {
			$testpaperCard.addClass('affix');
		} else {
			$testpaperCard.removeClass('affix');
		}
	});
};

var testpaperCardLocation = exports.testpaperCardLocation = function testpaperCardLocation() {
	$('.js-btn-index').click(function (event) {
		var $btn = $(event.currentTarget);
		if ($('.js-testpaper-heading').length <= 0) {
			$btn.addClass('doing').siblings('.doing').removeClass('doing');
		}
		var $current = $($btn.data('anchor'));
		$("body").scrollTop($current.offset().top);
	});
};

var onlyShowError = exports.onlyShowError = function onlyShowError() {
	$('#showWrong').change(function (event) {
		var $current = $(event.currentTarget);
		$('.js-answer-notwrong').each(function (index, item) {
			var $item = $($(item).data('anchor'));
			var $itemParent = $item.closest('.js-testpaper-question-block');
			if ($current.prop('checked')) {
				$item.hide();
				if ($itemParent.find('.js-testpaper-question:visible').length <= 0) {
					$itemParent.hide();
				}
			} else {
				$item.show();
				$itemParent.show();
			}
		});
		initScrollbar();
	});
};

var initWatermark = exports.initWatermark = function initWatermark() {
	var $testpaperWatermark = $('.js-testpaper-watermark');
	if ($testpaperWatermark.length > 0) {
		$.get($testpaperWatermark.data('watermark-url'), function (response) {
			$testpaperWatermark.each(function () {
				$(this).WaterMark({
					'yPosition': 'center',
					'style': { 'font-size': 10 },
					'opacity': 0.6,
					'contents': response
				});
			});
		});
	}
};