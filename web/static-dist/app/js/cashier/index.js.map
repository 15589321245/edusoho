{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/cashier/coin.js","webpack:///./app/Resources/static-src/common/api/modules/trade.js","webpack:///./app/Resources/static-src/app/js/cashier/index.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_express.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_wap.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/confirm.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/lianlianpay_wap.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/lianlianpay_web.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/payment.js","webpack:///./app/Resources/static-src/app/js/cashier/form.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_js.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_mweb.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/wechatpay_native.js","webpack:///./app/Resources/static-src/common/api/ajax.js","webpack:///./app/Resources/static-src/common/api/index.js","webpack:///./app/Resources/static-src/common/api/modules/classroom.js","webpack:///./app/Resources/static-src/common/api/modules/course.js","webpack:///./app/Resources/static-src/app/js/cashier/pay/sdk.js"],"names":["Coin","props","$container","$coinContainer","cashierForm","$form","priceType","data","coinRate","maxCoinInput","initEvent","on","changeAmount","event","$this","$","currentTarget","inputCoinNum","val","parseFloat","toFixed","isNaN","removePasswordValidate","trigger","calcPayPrice","addPasswordValidate","coinName","price","originalPirce","coinPrice","Translator","trans","find","rules","tradeModule","api","get","options","Object","assign","url","params","tradeSn","create","type","element","AlipayLegacyExpress","res","getOptions","showConfirmModal","window","open","payUrl","location","href","AlipayLegacyWap","ConfirmModal","modalID","template","length","append","checkIsPaid","bind","getTrade","then","isPaid","paidSuccessUrl","modal","LianlianpayWap","LianlianpayWeb","BasePayment","confirmModal","show","trade","createTrade","afterTradeCreated","postParams","gateway","orderSn","coinAmount","amount","openid","payPassword","console","log","customParams","keys","forEach","k","undefined","filterParams","async","promise","done","error","CashierForm","$priceList","validator","validate","initCoin","paySdk","$coin","coin","switchPayType","payOrder","id","title","addPriceItem","removePriceItem","changeCoinPrice","valid","$btn","button","formDataToObject","payAmount","text","pay","hasClass","addClass","siblings","removeClass","attr","post","formArr","serializeArray","index","name","value","$priceItem","hasPriceItem","remove","html","$payCoin","WechatPayJs","WechatPayMweb","mwebUrl","startInterval","intervalWechatId","setInterval","WechatPayNative","clearInterval","$modal","qrcodeUrl","cash_amount","ajax","defaultOptions","parameter","dataType","beforeSend","request","setRequestHeader","Promise","resolve","API_URL_PREFIX","Api","course","classroom","classroomModule","join","classroomId","courseModule","courseId","PaySDK","getGateway","wpn","wpm","wpj","ale","alw","llwp","llwb","payment","isMobile"],"mappings":"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","file":"app/js/cashier/index.js","sourcesContent":["export default class Coin {\n  constructor(props) {\n    this.$container = props.$coinContainer;\n    this.cashierForm = props.cashierForm;\n    this.$form = props.$form;\n    this.priceType = this.$container.data('priceType');\n    this.coinRate = this.$container.data('coinRate');\n    this.maxCoinInput = this.$container.data('maxAllowCoin') > this.$container.data('coinBalance') ? \n                        this.$container.data('coinBalance') : this.$container.data('maxAllowCoin');\n    this.initEvent();\n  }\n\n  initEvent() {\n    this.$form.on('change', '.js-coin-amount', event => this.changeAmount(event));\n  }\n\n  changeAmount(event) {\n    let $this = $(event.currentTarget);\n    let inputCoinNum = $this.val();\n    $this.val(parseFloat(inputCoinNum).toFixed(2));\n\n    if (isNaN(inputCoinNum) || inputCoinNum <= 0) {\n      inputCoinNum = 0;\n      $this.val(parseFloat(inputCoinNum).toFixed(2));\n      this.removePasswordValidate();\n      \n      this.$form.trigger('removePriceItem', ['coin-price']);\n      this.cashierForm.calcPayPrice(inputCoinNum);\n    }\n    if (inputCoinNum > this.maxCoinInput) {\n      inputCoinNum = this.maxCoinInput;\n      $this.val(parseFloat(inputCoinNum).toFixed(2));\n    }\n\n    if (inputCoinNum > 0) {\n      this.addPasswordValidate();\n      let coinName = this.$form.data('coin-name');\n      let price = 0.00;\n      if (this.priceType === 'coin') {\n        price = parseFloat(inputCoinNum).toFixed(2) + ' ' + coinName;\n\n        let originalPirce = parseFloat(this.$container.data('maxAllowCoin'));\n        let coinPrice = parseFloat(originalPirce - inputCoinNum).toFixed(2) + ' ' + coinName;;\n        this.$form.trigger('changeCoinPrice', [coinPrice]);\n      } else {\n        price = '￥' + parseFloat(inputCoinNum / this.coinRate).toFixed(2);\n      }\n      this.$form.trigger('addPriceItem', ['coin-price', coinName + Translator.trans('order.create.minus'), price]);\n      this.cashierForm.calcPayPrice(inputCoinNum);\n    }\n  }\n\n  addPasswordValidate() {\n    this.$container.find('[name=\"payPassword\"]').rules('add', 'required passwordCheck');\n  }\n\n  removePasswordValidate() {\n    this.$container.find('[name=\"payPassword\"]').rules('remove', 'required passwordCheck');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/coin.js","import ajax from '../ajax';\n\nconst tradeModule = (api) => {\n  return {\n    get(options) {\n      return ajax(Object.assign({\n        url: `${api}/trades/${options.params.tradeSn}`,\n      }, options));\n    },\n\n    create(options) {\n      return ajax(Object.assign({\n        url: `${api}/trades`,\n        type: 'POST',\n      }, options));\n\n    }\n  }\n};\n\nexport default tradeModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/trade.js","import CashierForm from './form';\n\nnew CashierForm({\n  element: '#cashier-form'\n});\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/index.js","import BasePayment from './payment';\n\nexport default class AlipayLegacyExpress extends BasePayment {\n\n  afterTradeCreated(res) {\n    let options = this.getOptions();\n    if (options.showConfirmModal) {\n      window.open(res.payUrl, '_blank');\n      this.showConfirmModal(res.tradeSn);\n    } else {\n      location.href = res.payUrl;\n    }\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_express.js","import BasePayment from './payment';\n\nexport default class AlipayLegacyWap extends BasePayment {\n\n\tafterTradeCreated(res) {\n\t\tlocation.href = res.payUrl;\n\t}\n\n\tcustomParams(params) {\n\t\tparams['app_pay'] = 'Y';\n\t\treturn params;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/alipay_legacy_wap.js","import notify from 'common/notify';\nimport BasePayment from './payment';\n\nclass ConfirmModal {\n\n  $container = $('body');\n\n  modalID = 'cashier-confirm-modal';\n\n  tradeSn = '';\n\n  constructor() {\n\n    let template = `\n      <div id=\"${this.modalID}\" class=\"modal\">\n        <div class=\"modal-dialog cd-modal-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n                <i class=\"cd-icon cd-icon-close\"></i>\n              </button>\n              <h4 class=\"modal-title\">${Translator.trans('cashier.confirm.title')}</h4>\n            </div>\n            <div class=\"modal-body\">\n              <p>\n              ${Translator.trans('cashier.confirm.desc')}\n              </p>\n            </div>\n            <div class=\"modal-footer\">\n              <a class=\"btn cd-btn cd-btn-flat-default cd-btn-lg\" data-dismiss=\"modal\">${Translator.trans('cashier.confirm.pick_again')}</a>\n              <a class=\"btn cd-btn cd-btn-primary cd-btn-lg js-confirm-btn\">${Translator.trans('cashier.confirm.success')}</a>\n            </div>\n          </div>\n        <div>  \n      </div>\n    `;\n\n    if (this.$container.find('#'+this.modalID).length === 0) {\n      this.$container.append(template);\n    }\n\n    $('body').on('click', '.js-confirm-btn', this.checkIsPaid.bind(this));\n  }\n\n  checkIsPaid() {\n    BasePayment.getTrade(this.tradeSn).then(res => {\n      if (res.isPaid) {\n        location.href = res.paidSuccessUrl;\n      } else {\n        notify('danger', Translator.trans('cashier.confirm.fail_message'));\n        $('#' + this.modalID).modal('hide');\n      }\n    });\n  }\n\n  show(tradeSn) {\n    $('#'+this.modalID).modal('show');\n    this.tradeSn = tradeSn;\n  }\n}\n\nexport default ConfirmModal;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/confirm.js","import AlipayLegacyWap from './alipay_legacy_wap';\n\nexport default class LianlianpayWap extends AlipayLegacyWap {\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/lianlianpay_wap.js","import AlipayLegacyExpress from './alipay_legacy_express';\n\nexport default class LianlianpayWeb extends AlipayLegacyExpress {\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/lianlianpay_web.js","import Api from 'common/api';\nimport notify from 'common/notify';\nimport ConfirmModal from './confirm';\n\nexport default class BasePayment {\n\n\tsetOptions(options) {\n\t\tthis.options = options;\n\t}\n\n\tgetOptions() {\n\t\treturn this.options;\n\t}\n\n\tshowConfirmModal(tradeSn) {\n\t\tif (!this.confirmModal) {\n\t\t\tthis.confirmModal = new ConfirmModal();\n\t\t}\n\n\t\tthis.confirmModal.show(tradeSn);\n\t}\n\n\tpay(params) {\n\n\t\tlet trade = this.createTrade(params);\n\t\tif (trade.paidSuccessUrl) {\n\t\t\tlocation.href = trade.paidSuccessUrl;\n\t\t} else {\n\t\t\tthis.afterTradeCreated(trade)\n\t\t}\n\n\t}\n\n\tafterTradeCreated(res) {\n\n\t}\n\n\tcustomParams(params) {\n\t\treturn params;\n\t}\n\n\tfilterParams(postParams) {\n\t\tlet params = {\n\t\t\tgateway: postParams.gateway,\n\t\t\ttype: postParams.type,\n\t\t\torderSn: postParams.orderSn,\n\t\t\tcoinAmount: postParams.coinAmount,\n\t\t\tamount: postParams.amount,\n\t\t\topenid: postParams.openid,\n\t\t\tpayPassword: postParams.payPassword\n\t\t};\n\n\t\tconsole.log(params)\n\t\tparams = this.customParams(params);\n\n\t\tObject.keys(params).forEach(k => (!params[k] && params[k] !== undefined) && delete params[k]);\n\n\t\treturn params;\n\t}\n\n\tcreateTrade(postParams) {\n\n\t\tlet params = this.filterParams(postParams);\n\n\t\tlet trade = null;\n\n\t\tApi.trade.create({data: params, async: false, promise: false}).done(res => {\n\t\t\ttrade = res;\n\t\t}).error(res => {\n\t\t\tnotify('danger', Translator.trans('cashier.pay.error_message'));\n\t\t});\n\n\t\treturn trade;\n\t}\n\n\tstatic getTrade(tradeSn, orderSn = '') {\n\t\tlet params = {};\n\n\t\tif (tradeSn) {\n\t\t\tparams.tradeSn = tradeSn;\n\t\t}\n\n\t\tif (orderSn) {\n\t\t\tparams.orderSn = orderSn;\n\t\t}\n\n\t\treturn Api.trade.get({\n\t\t\tparams: params\n\t\t});\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/payment.js","import Coin from './coin';\nimport PaySDK from './pay/sdk';\n\nclass CashierForm {\n  constructor(props) {\n    this.$form = $(props.element);\n    this.$priceList = this.$form.find('#order-center-price-list');\n\n    this.validator = this.$form.validate();\n\n    this.initEvent();\n    this.initCoin();\n\n    this.paySdk = new PaySDK();\n  }\n\n  initCoin() {\n    let $coin = $('#coin-use-section');\n    if ($coin.length > 0) {\n      this.coin = new Coin({\n        $coinContainer: $coin,\n        cashierForm: this,\n        $form: this.$form\n      });\n    }\n  }\n\n  initEvent() {\n    let $form = this.$form;\n\n    $form.on('click', '.js-pay-type', event => this.switchPayType(event));\n    $form.on('click', '.js-pay-btn', event => this.payOrder(event));\n    $form.on('addPriceItem', (event, id, title, price) => this.addPriceItem(event, id, title, price));\n    $form.on('removePriceItem', (event, id) => this.removePriceItem(event, id));\n    $form.on('changeCoinPrice', (event, price) => this.changeCoinPrice(event, price));\n    \n  }\n\n  payOrder(event) {\n    let $form = this.$form;\n\n    if ($form.valid()) {\n      let $btn = $(event.currentTarget);\n      $btn.button('loading');\n      let params = this.formDataToObject($form);\n\n      params.payAmount = $form.find('.js-pay-price').text();\n      this.paySdk.pay(params);\n      $btn.button('reset');\n    }\n  }\n\n  switchPayType(event) {\n    let $this = $(event.currentTarget);\n    if (!$this.hasClass('active')) {\n      $this.addClass('active').siblings().removeClass('active');\n      $(\"input[name='payment']\").val($this.attr(\"id\"));\n    }\n  }\n\n  calcPayPrice(coinAmount) {\n    $.post(this.$form.data('priceUrl'), {\n      coinAmount\n    }).done((res) => {\n      this.$form.find('.js-pay-price').text(res.data);\n    });\n  }\n\n  formDataToObject($form) {\n    let params = {},\n      formArr = $form.serializeArray();\n    for (let index in formArr) {\n      params[formArr[index].name] = formArr[index].value;\n    }\n\n    return params;\n  }\n\n  hasPriceItem(event, id) {\n    let $priceItem = $(`#${id}`);\n    if ($priceItem.length) {\n      return true;\n    }\n\n    return false;\n  }\n\n  addPriceItem(event, id, title, price) {\n    let $priceItem = $(`#${id}`);\n\n    if (this.hasPriceItem(event, id)) {\n      $priceItem.remove();\n    }\n\n    let html = `\n      <div class=\"order-center-price\" id=\"${id}\">\n        <div class=\"order-center-price__title\">${title}</div>\n        <div class=\"order-center-price__content\">-${price}</div>\n      </div>\n    `;\n\n    this.$priceList.append(html);\n  }\n\n  removePriceItem(event, id) {\n    let $priceItem = $(`#${id}`);\n    \n    if (this.hasPriceItem(event, id)) {\n      $priceItem.remove();\n    }\n  }\n\n  changeCoinPrice(event, price) {\n    let $payCoin = this.$form.find('.js-pay-coin');\n    $payCoin.text(price);\n  }\n}\n\n\nexport default CashierForm;\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/form.js","import BasePayment from './payment';\n\nexport default class WechatPayJs extends BasePayment {\n\n  afterTradeCreated(res) {\n    location.href = '/pay/center/wxpay?tradeSn=' + res.tradeSn;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_js.js","import BasePayment from './payment';\n\nexport default class WechatPayMweb extends BasePayment {\n\n\tafterTradeCreated(res) {\n\t\tlocation.href = res.mwebUrl;\n\t\tthis.startInterval(res.tradeSn);\n\t}\n\n\tstartInterval(tradeSn) {\n\t\twindow.intervalWechatId = setInterval(this.checkIsPaid.bind(this, tradeSn), 2000);\n\t}\n\n\tcheckIsPaid(tradeSn) {\n\t\tBasePayment.getTrade(tradeSn).then(res => {\n\t\t\tif (res.isPaid) {\n\t\t\t\tlocation.href = res.paidSuccessUrl;\n\t\t\t}\n\t\t});\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_mweb.js","import BasePayment from './payment';\n\nexport default class WechatPayNative extends BasePayment {\n  $container = $('body');\n\n  modalID = 'wechat-qrcode-modal';\n\n  constructor() {\n    super();\n\n    let template = `\n      <div id=\"${this.modalID}\" class=\"modal\">\n        <div class=\"modal-dialog cd-modal-dialog cd-modal-dialog-sm\">\n          <div class=\"modal-content\">\n          \n            <div class=\"modal-header\">\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\n                <i class=\"cd-icon cd-icon-close\"></i>\n              </button>\n              <h4 class=\"modal-title\">${Translator.trans('cashier.wechat_pay')}</h4>\n            </div>\n            \n            <div class=\"modal-body\">\n              <div class=\"text-center\">\n                <img class=\"cd-mb16 js-qrcode-img\" src=\"\">\n                <div class=\"cd-mb16\">\n                  ${Translator.trans('cashier.wechat_pay.scan_qcode_pay_tips')}\n                </div>\n                <div class=\"cd-text-danger cd-mb32 js-pay-amount\" style=\"font-size:16px;\"></div>\n              </div>\n            </div>\n            \n          </div>\n        </div>\n      </div>\n    `;\n\n    if (this.$container.find('#'+this.modalID).length === 0) {\n      this.$container.append(template);\n    }\n\n    this.$container.find('#'+this.modalID).on('hidden.bs.modal', function () {\n      clearInterval(window.intervalWechatId);\n    });\n  }\n\n  afterTradeCreated(res) {\n   let $modal = this.$container.find('#'+this.modalID);\n   $modal.find('.js-qrcode-img').attr('src', res.qrcodeUrl);\n   $modal.find('.js-pay-amount').text('￥' + res.cash_amount);\n   $modal.modal('show');\n   this.startInterval(res.tradeSn);\n }\n\n startInterval(tradeSn) {\n   window.intervalWechatId = setInterval(this.checkIsPaid.bind(this, tradeSn), 2000);\n }\n\n checkIsPaid(tradeSn) {\n   BasePayment.getTrade(tradeSn).then(res => {\n     if (res.isPaid) {\n       location.href = res.paidSuccessUrl;\n     }\n   });\n }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/wechatpay_native.js","const ajax = (options) => {\n\n  let defaultOptions = {\n    async: true,\n    promise: true\n  };\n\n  options = Object.assign(defaultOptions, options);\n\n  let parameter = {\n    type: options.type || 'GET',\n    url: options.url || '',\n    dataType: options.dataType || 'json',\n    async: options.async,\n    beforeSend(request) {\n      request.setRequestHeader(\"Accept\", 'application/vnd.edusoho.v2+json');\n      request.setRequestHeader(\"X-CSRF-Token\", $('meta[name=csrf-token]').attr('content'));\n    }\n  };\n\n  if (options.data) {\n    Object.assign(parameter, {\n      data: options.data\n    })\n  }\n\n  if (options.promise) {\n    return Promise.resolve($.ajax(parameter));\n  } else {\n    return $.ajax(parameter);\n  }\n\n};\n\nexport default ajax;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/ajax.js","/**\n * 使用说明\n * \n * import Api from 'common/api';\n * \n * Api.course.create({\n *    params: {},\n *    data: {}\n * }).then((res) => {\n *    // 请求成功\n *    console.log('res', res);\n * }).catch((res) => {\n *   // 异常捕获\n *   console.log('catch', res.responseJSON.error.message);\n * })\n */\n\nimport courseModule from './modules/course';\nimport classroomModule from './modules/classroom';\nimport tradeModule from './modules/trade';\n\nconst API_URL_PREFIX = '/api';\n\nconst Api = {\n  // 课程模块\n  course: courseModule(API_URL_PREFIX),\n  // 班级模块\n  classroom: classroomModule(API_URL_PREFIX),\n  trade: tradeModule(API_URL_PREFIX),\n};\n\nexport default Api;\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/index.js","import ajax from '../ajax';\n\nconst classroomModule = (api) => {\n  return {\n    join(options) {\n      return ajax(Object.assign({\n        url: `${api}/classrooms/${options.params.classroomId}/members`,\n        type: 'POST'\n      }, options));\n    }\n  }\n}\n\nexport default classroomModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/classroom.js","import ajax from '../ajax';\n\nconst courseModule = (api) => {\n  return {\n    get(options) {\n      return ajax(Object.assign({\n        url: `${api}/courses/${options.params.courseId}`,\n      }, options));\n    }\n  }\n}\n\nexport default courseModule;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/common/api/modules/course.js","import WechatPayNative from './wechatpay_native';\nimport AlipayLegacyExpress from './alipay_legacy_express';\nimport AlipayLegacyWap from './alipay_legacy_wap';\nimport LianlianpayWap from './lianlianpay_wap';\nimport LianlianpayWeb from './lianlianpay_web';\nimport WechatPayJs from './wechatpay_js';\nimport WechatPayMweb from './wechatpay_mweb';\n\nexport default class PaySDK {\n\n  pay(params, options = {}) {\n    let gateway = this.getGateway(params['payment'], params['isMobile'], params['openid']);\n\t  params.gateway = gateway;\n    let paySdk = null;\n    switch (gateway) {\n      case 'WechatPay_Native':\n        paySdk = this.wpn ? this.wpn : this.wpn = new WechatPayNative();\n        break;\n\t    case 'WechatPay_MWeb':\n\t\t    paySdk = this.wpm ? this.wpm : this.wpm = new WechatPayMweb();\n\t\t    break;\n      case 'WechatPay_Js':\n        paySdk = this.wpj ? this.wpj : this.wpj = new WechatPayJs();\n        break;\n      case 'Alipay_LegacyExpress':\n        paySdk = this.ale ? this.ale : this.ale = new AlipayLegacyExpress();\n        break;\n      case 'Alipay_LegacyWap':\n        paySdk = this.alw ? this.alw : this.alw = new AlipayLegacyWap();\n        break;\n      case 'Lianlian_Wap':\n        paySdk = this.llwp ? this.llwp : this.llwp = new LianlianpayWap();\n        break;\n      case 'Lianlian_Web':\n        paySdk = this.llwb ? this.llwb : this.llwb = new LianlianpayWeb();\n        break;\n    }\n\n    paySdk.options = Object.assign({\n      'showConfirmModal': 1\n    }, options);\n\n    paySdk.pay(params);\n  }\n\n  getGateway(payment, isMobile, openid) {\n    let gateway = '';\n    switch (payment) {\n      case 'wechat':\n        if (openid > 0) {\n          gateway = 'WechatPay_Js';\n        } else if(isMobile){\n\t        gateway = 'WechatPay_MWeb';\n        }else {\n          gateway = 'WechatPay_Native';\n        }\n        break;\n\n      case 'alipay':\n        if (isMobile) {\n          gateway = 'Alipay_LegacyWap';\n        } else {\n          gateway = 'Alipay_LegacyExpress';\n        }\n        break;\n\n      case 'lianlianpay':\n        if (isMobile) {\n          gateway = 'Lianlian_Wap';\n        } else {\n          gateway = 'Lianlian_Web';\n        }\n        break;\n    }\n\n    return gateway;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/pay/sdk.js"],"sourceRoot":""}