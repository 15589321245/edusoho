{"version":3,"sources":["app/Resources/static-src/app/js/question-manage/type/form-base.js"],"names":["alert","QuestionFormBase","$form","titleFieldId","analysisFieldId","validator","titleEditorToolBarName","console","log","_init","attachmentActions","_initEvent","_initValidate","on","submitForm","event","submitType","$","currentTarget","data","find","val","self","form","button","submit","validate","onkeyup","rules","required","difficulty","stem","score","number","max","min","messages","$target","editor","CKEDITOR","replace","toolbar","filebrowserImageUploadUrl","height","getData","toolbarName","_titleEditorToolBarName"],"mappings":";;;;;;;;AACA;;;;;;;;AADAA,MAAM,IAAN;;AAEAA,MAAM,KAAN;;IACMC,gB;AACJ,4BAAYC,KAAZ,EAAkB;AAAA;;AAChB,SAAKA,KAAL,GAAaA,KAAb;AACA,SAAKC,YAAL,GAAoB,qBAApB;AACA,SAAKC,eAAL,GAAuB,yBAAvB;AACA,SAAKC,SAAL,GAAiB,IAAjB;AACA,SAAKC,sBAAL,GAA8B,SAA9B;AACAC,YAAQC,GAAR,CAAY,KAAZ;AACA,SAAKC,KAAL;AACCF,YAAQC,GAAR,CAAY,KAAZ;AACD,SAAKE,iBAAL,GAAyB,gCAAsBR,KAAtB,CAAzB;AACAK,YAAQC,GAAR,CAAY,KAAZ;AACD;;;;4BAEO;AACN,WAAKG,UAAL;AACA,WAAKC,aAAL;AACD;;;iCAEY;AAAA;;AACX,WAAKV,KAAL,CAAWW,EAAX,CAAc,OAAd,EAAsB,oBAAtB,EAA2C;AAAA,eAAO,MAAKC,UAAL,CAAgBC,KAAhB,CAAP;AAAA,OAA3C;AACD;;;+BAEUA,K,EAAO;AAChB,UAAIC,aAAaC,EAAEF,MAAMG,aAAR,EAAuBC,IAAvB,CAA4B,YAA5B,CAAjB;AACA,WAAKjB,KAAL,CAAWkB,IAAX,CAAgB,mBAAhB,EAAqCC,GAArC,CAAyCL,UAAzC;AACA,UAAIM,OAAO,IAAX;;AAEA,UAAG,KAAKjB,SAAL,CAAekB,IAAf,EAAH,EAAyB;AACvBN,UAAEF,MAAMG,aAAR,EAAuBM,MAAvB,CAA8B,SAA9B;AACAF,aAAKpB,KAAL,CAAWuB,MAAX;AACD;AACF;;;oCAEe;AACd,UAAIpB,YAAY,KAAKH,KAAL,CAAWwB,QAAX,CAAoB;AAChCC,iBAAS,KADuB;AAEhCC,eAAO;AACL,kCAAwB;AACtBC,sBAAU;AADY,WADnB;AAILC,sBAAY;AACVD,sBAAU;AADA,WAJP;AAOLE,gBAAM;AACJF,sBAAU;AADN,WAPD;AAULG,iBAAO;AACLH,sBAAU,IADL;AAELI,oBAAO,IAFF;AAGLC,iBAAI,GAHC;AAILC,iBAAI;AAJC;AAVF,SAFyB;AAmBhCC,kBAAU;AACR,kCAAwB,OADhB;AAERN,sBAAa;AAFL;AAnBsB,OAApB,CAAhB;AAwBA,WAAKzB,SAAL,GAAiBA,SAAjB;AACD;;;sCAEiB;AAChB,UAAIgC,UAAUpB,EAAE,MAAI,KAAKd,YAAX,CAAd;AACA,UAAImC,SAASC,SAASC,OAAT,CAAiB,KAAKrC,YAAtB,EAAoC;AAC/CsC,iBAAS,KAAKnC,sBADiC;AAE/CoC,mCAA2BL,QAAQlB,IAAR,CAAa,gBAAb,CAFoB;AAG/CwB,gBAAQN,QAAQM,MAAR;AAHuC,OAApC,CAAb;;AAMAL,aAAOzB,EAAP,CAAW,QAAX,EAAqB,YAAM;AACzBwB,gBAAQhB,GAAR,CAAYiB,OAAOM,OAAP,EAAZ;AACD,OAFD;AAGD;;;yCAEoB;AACnB,UAAIP,UAAUpB,EAAE,MAAI,KAAKb,eAAX,CAAd;AACA,UAAIkC,SAASC,SAASC,OAAT,CAAiB,KAAKpC,eAAtB,EAAuC;AAClDqC,iBAAS,KAAKnC,sBADoC;AAElDoC,mCAA2BL,QAAQlB,IAAR,CAAa,gBAAb,CAFuB;AAGlDwB,gBAAQN,QAAQM,MAAR;AAH0C,OAAvC,CAAb;;AAMAL,aAAOzB,EAAP,CAAW,QAAX,EAAqB,YAAM;AACzBwB,gBAAQhB,GAAR,CAAYiB,OAAOM,OAAP,EAAZ;AACD,OAFD;AAGD;;;sBAE0BC,W,EAAa;AACtC,WAAKC,uBAAL,GAA+BD,WAA/B;AACD,K;wBAE4B;AAC3B,aAAO,KAAKC,uBAAZ;AACD;;;;;;kBAGY7C,gB","file":"form-base.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["alert('ol');\nimport AttachmentActions from '../../attachment/widget/attachment-actions';\nalert('ol2');\nclass QuestionFormBase {\n  constructor($form){\n    this.$form = $form;\n    this.titleFieldId = 'question-stem-field';\n    this.analysisFieldId = 'question-analysis-field';\n    this.validator = null;\n    this.titleEditorToolBarName = 'Minimal';\n    console.log('ol3');\n    this._init();\n     console.log('ol4');\n    this.attachmentActions = new AttachmentActions($form);\n    console.log('ol5');\n  }\n\n  _init() {\n    this._initEvent();\n    this._initValidate();\n  }\n\n  _initEvent() {\n    this.$form.on('click','[data-role=submit]',event=>this.submitForm(event));\n  }\n\n  submitForm(event) {\n    let submitType = $(event.currentTarget).data('submission');\n    this.$form.find('[name=submission]').val(submitType);\n    let self = this;\n\n    if(this.validator.form()){\n      $(event.currentTarget).button('loading');\n      self.$form.submit();\n    }\n  }\n\n  _initValidate() {\n    let validator = this.$form.validate({\n        onkeyup: false,\n        rules: {\n          '[data-role=\"target\"]': {\n            required: true,\n          },\n          difficulty: {\n            required: true,\n          },\n          stem: {\n            required: true,\n          },\n          score: {\n            required: true,\n            number:true,\n            max:999,\n            min:0\n          }\n        },\n        messages: {\n          '[data-role=\"target\"]': \"请选择从属\",\n          difficulty : \"请选择难度\"\n        }\n    });\n    this.validator = validator;\n  }\n\n  initTitleEditor() {\n    let $target = $('#'+this.titleFieldId);\n    let editor = CKEDITOR.replace(this.titleFieldId, {\n      toolbar: this.titleEditorToolBarName,\n      filebrowserImageUploadUrl: $target.data('imageUploadUrl'),\n      height: $target.height()\n    });\n\n    editor.on( 'change', () => {    \n      $target.val(editor.getData());\n    });\n  }\n\n  initAnalysisEditor() {\n    let $target = $('#'+this.analysisFieldId);\n    let editor = CKEDITOR.replace(this.analysisFieldId, {\n      toolbar: this.titleEditorToolBarName,\n      filebrowserImageUploadUrl: $target.data('imageUploadUrl'),\n      height: $target.height()\n    });\n\n    editor.on( 'change', () => {    \n      $target.val(editor.getData());\n    });\n  }\n\n  set titleEditorToolBarName(toolbarName) {\n    this._titleEditorToolBarName = toolbarName;\n  }\n \n  get titleEditorToolBarName() {\n    return this._titleEditorToolBarName;\n  }\n}\n\nexport default QuestionFormBase;"]}