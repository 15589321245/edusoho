{"version":3,"sources":["app/Resources/static-src/app/js/courseset-manage/base/index.js"],"names":["Base","init","initValidator","$form","$","validator","validate","onkeyup","rules","title","required","depends","val","trim","open_live_course_title","subtitle","messages","addMethod","value","element","params","test","Translator","trans","click","form","event","currentTarget","button","submit","select2","ajax","url","dataType","quietMillis","data","term","page","q","page_limit","results","each","index","item","push","id","name","initSelection","callback","split","formatSelection","formatResult","formatSearching","width","multiple","maximumSelectionSize","placeholder"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import 'select2';\nclass Base {\n  constructor() {\n    this.init();\n  }\n\n  init() {\n    this.initValidator();\n  }\n\n  initValidator () {\n    let $form = $('#courseset-form');\n    let validator = $form.validate({\n      onkeyup: false,\n      rules: {\n        title: {\n          required: {\n            depends: function () {\n              $(this).val($.trim($(this).val()));\n              return true;\n            }\n          },\n          open_live_course_title: true\n        },\n        subtitle: {\n          required: {\n            depends: function () {\n              $(this).val($.trim($(this).val()));\n              return false;\n            }\n          }\n        }\n      },\n      messages: {\n        title: \"请输入有效的课程标题（直播公开课标题暂不支持<、>、\\\"、&、‘、’、”、“字符）\"\n      }\n    });\n\n    $.validator.addMethod(\"open_live_course_title\", function (value, element, params) {\n      if ($('#courseSetType').val() === 'liveOpen' && !/^[^(<|>|'|\"|&|‘|’|”|“)]*$/.test(value)) {\n        return false;\n      } else {\n        return true;\n      }\n    }, Translator.trans('直播公开课标题暂不支持<、>、\\\"、&、‘、’、”、“字符'));\n\n    $('#courseset-base-submit').click(event => {\n      if (validator.form()) {\n        $(event.currentTarget).button('loading');\n        $form.submit();\n      }\n    });\n  }\n\n  initSelect2() {\n    $('#tags').select2({\n      ajax: {\n        url: '/tag/match_jsonp#',\n        dataType: 'json',\n        quietMillis: 100,\n        data: function (term, page) {\n          return {\n            q: term,\n            page_limit: 10\n          };\n        },\n        results: function (data) {\n          var results = [];\n          $.each(data, function (index, item) {\n            results.push({\n              id: item.name,\n              name: item.name\n            });\n          });\n          return {\n            results: results\n          };\n        }\n      },\n      initSelection: function (element, callback) {\n        var data = [];\n        $(element.val().split(\",\")).each(function () {\n          data.push({\n            id: this,\n            name: this\n          });\n        });\n        callback(data);\n      },\n      formatSelection: function (item) {\n        return item.name;\n      },\n      formatResult: function (item) {\n        return item.name;\n      },\n      formatSearching: '搜索中...',\n      width: 'off',\n      multiple: true,\n      maximumSelectionSize: 20,\n      placeholder: Translator.trans('请输入标签'),\n      width: 'off',\n      multiple: true,\n      createSearchChoice: function () {\n        return null;\n      },\n      maximumSelectionSize: 20\n    });\n  }\n\n}\n\nnew Base();\n"]}