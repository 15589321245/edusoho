{% extends 'TopxiaAdminBundle:OpenCourseAnalysis:layout.html.twig' %}

{% block form %}
	<form id="user-search-form" class="form-inline well well-sm" action="" method="get" novalidate="">
	     <div class="form-group ">
	      <label for="startDate">起始日期</label>
	      <input class="form-control" type="text" id="startTime" name="startTime" value="{{dateRange.startTime}}" placeholder="起始时间">
	      <label for="endDate">截止日期</label>
	      <input class="form-control" type="text" id="endTime" name="endTime" value="{{dateRange.endTime}}" placeholder="结束时间">
	     </div>
	 	<button class="btn btn-default btn-data-range" type="button" id="btn-yesterday-range" data-start="{{dateRange.yesterdayStart}}" data-end="{{dateRange.yesterdayEnd}}">昨天</button>
	 	<button class="btn btn-default btn-data-range" type="button" id="btn-lastWeek-range" data-start="{{dateRange.lastWeekStart}}" data-end="{{dateRange.lastWeekEnd}}">最近七天</button>
		<button class="btn btn-default btn-data-range" type="button" id="btn-lastMonth-range" data-start="{{dateRange.lastMonthStart}}" data-end="{{dateRange.lastMonthEnd}}">最近30天</button>
	  	<button class="btn btn-primary" type="submit">搜索</button>
	</form>
{% endblock form %}
	
{% block analysis_content %}
	 <div class="">
	 	<div  class= "" >
			<a class="btn btn-default" href="{{path('admin_opencourse_analysis_referer_summary')}}" role="button">汇总</a>
			<a class="btn btn-default active" href="{{path('admin_opencourse_analysis_referer_summary_list')}}" role="button">明细</a>
	 	</div>

		<div >
			<table class="table table-hover">
				<thead>
					<tr>
						<th width="40%">课程名称</th>
						<th>访问数</th>
						<th>转化详情</th>
						<th>购买转化数</th>
						<th>购买转化率</th>
					</tr>
				</thead>
				<tbody>
					{% for refererlog in refererlogDatas %}
						<tr>
							<th scope="row">{{openCourses[refererlog.targetId].title }}</th>
							<th>{{refererlog.count}}</th>
							<th><a href="javascript:;" data-toggle="modal" data-target="#modal" data-url="{{path('admin_opencourse_analysis_referer_detail',{id:refererlog.targetId, startTime:dateRange.startTime,endTime:dateRange.endTime})}}">来源和转化详情</a></th>
							<th>{{refererlog.orderCount}}</th>
							<th>{{refererlog.percent}}</th>
						</tr>
						{% else %} 
						  <tr><td colspan="20"><div class="empty">暂无记录</div></td></tr>
       				{% endfor %}
				</tbody>
			</table>
		</div>
		{{web_macro.paginator(paginator)}}
	</div>
{% endblock %}