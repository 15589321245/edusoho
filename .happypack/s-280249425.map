{"version":3,"sources":["app/Resources/static-src/app/js/player/local-video-player.js"],"names":["videoSwf","require","LocalVideoPlayer","options","player","setup","techOrder","agentInWhiteList","mediaType","that","element","loop","flash","swf","controlBar","liveDisplay","dimensions","src","url","on","set","message","Translator","trans","Notify","danger","e","$","target","hasClass","hide","emit","_onEnded","window","applicationCache","play","pause","currentTime","duration","time","setCurrentTime","paused","dispose"],"mappings":"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","file":"local-video-player.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import videojs from 'video.js'\nimport Emitter from \"component-emitter\";\nlet videoSwf = require('video.js/dist/video-js/video-js.swf');\n\nclass LocalVideoPlayer extends Emitter {\n  constructor(options) {\n    super();\n    this.options = options;\n    this.player = {};\n    this.setup();\n  }\n\n  setup() {\n    var techOrder = ['flash', 'html5'];\n    if (this.options.agentInWhiteList || this.options.mediaType == 'audio') {\n      techOrder = ['html5', 'flash'];\n    }\n    var that = this;\n    var player = videojs(this.options.element, {\n      techOrder: techOrder,\n      loop: false,\n      flash: {\n        swf: videoSwf\n      },\n      controlBar: {\n        liveDisplay: false\n      }\n    });\n\n    player.dimensions('100%', '100%');\n    player.src(this.options.url);\n\n    player.on('error', error => {\n      this.set(\"hasPlayerError\", true);\n      var message = Translator.trans('您的浏览器不能播放当前视频。');\n      Notify.danger(message, 60);\n    });\n\n    player.on('fullscreenchange', function(e) {\n      if ($(e.target).hasClass('vjs-fullscreen')) {\n        $(\"#site-navbar\").hide();\n      }\n    });\n\n    player.on('ended', (e) => {\n      this.emit('ended', e);\n      this._onEnded(e);\n    });\n\n    player.on('timeupdate', (e) => {\n      this.emit('timechange', e);\n    });\n\n    player.on('loadedmetadata', (e) => {\n      that.emit('ready', e);\n    });\n\n    player.on(\"play\", (e) => {\n      that.emit(\"playing\", e);\n    });\n\n    player.on(\"pause\", (e) => {\n      that.emit(\"paused\", e);\n    });\n\n    this.player = player;\n  }\n\n  checkHtml5() {\n    if (window.applicationCache) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n\n  play() {\n    this.player.play();\n  }\n\n  _onEnded(e) {\n    this.player.pause();\n    this.player.currentTime(0);\n  }\n\n\n  getCurrentTime() {\n    return this.player.currentTime();\n  }\n\n\n  getDuration() {\n    return this.player.duration();\n  }\n\n\n  setCurrentTime(time) {\n    this.player.currentTime(time);\n    return this;\n  }\n\n\n  replay() {\n    this.setCurrentTime(0).play();\n    return this;\n  }\n\n\n  isPlaying() {\n    return !this.player.paused();\n  }\n\n  destroy() {\n    this.player.dispose();\n  }\n}\nexport default LocalVideoPlayer;\n"]}