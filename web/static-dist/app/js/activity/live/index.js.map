{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity/live/index.js","webpack:///./app/Resources/static-src/app/js/activity/live/live.js"],"names":["window","liveShow","LiveShow","interval","emitter","startEvent","finishByReplay","countdownEvent","self","$","on","triggerUrl","data","post","res","emit","started","then","console","log","catch","error","$countdown","length","timeRemain","_countdown","iId","setInterval","days","Math","floor","modulo","hours","minutes","seconds","context","text","clearInterval"],"mappings":";;;;;;;AAAA;;;;;;AACAA,QAAOC,QAAP,GAAkB,oBAAlB,C;;;;;;;;;;;;;;;ACDA;;;;;;;;KACqBC,Q;AACnB,yBAAc;AAAA;;AACZ,cAAKC,QAAL,GAAgB,CAAhB;AACA,cAAKC,OAAL,GAAe,+BAAf;AACA,cAAKC,UAAL;AACA,cAAKC,cAAL;AACA,cAAKC,cAAL;AACD;;;;0CAEgB;AACb,iBAAIC,OAAO,IAAX;AACAC,eAAE,YAAF,EAAgBC,EAAhB,CAAmB,OAAnB,EAA4B,YAAU;AACpC,qBAAIC,aAAaF,EAAE,IAAF,EAAQG,IAAR,CAAa,QAAb,CAAjB;AACAH,mBAAEI,IAAF,CAAOF,UAAP,EAAmB,UAASG,GAAT,EAAa;AAC5BN,0BAAKJ,OAAL,CAAaW,IAAb,CAAkB,QAAlB;AACH,kBAFD;AAGD,cALD;AAMH;;;sCAEY;AACT,iBAAIP,OAAO,IAAX;AACAC,eAAE,gBAAF,EAAoBC,EAApB,CAAuB,OAAvB,EAAgC,YAAY;AACxC,qBAAI,CAACF,KAAKQ,OAAV,EAAmB;AACf,0BAAKA,OAAL,GAAe,IAAf;AACAR,0BAAKJ,OAAL,CAAaW,IAAb,CAAkB,OAAlB,EAA2B,EAA3B,EAA+BE,IAA/B,CAAoC,YAAM;AACtCC,iCAAQC,GAAR,CAAY,YAAZ;AACH,sBAFD,EAEGC,KAFH,CAES,UAACC,KAAD,EAAW;AAChBH,iCAAQG,KAAR,CAAcA,KAAd;AACH,sBAJD;AAKH;AACJ,cATD;AAUH;;;0CAEgB;AAAA;;AACf,iBAAIC,aAAab,EAAE,YAAF,CAAjB;AACA,iBAAIa,WAAWC,MAAX,IAAqB,CAAzB,EAA4B;;AAE5B,kBAAKC,UAAL,GAAkBF,WAAWV,IAAX,CAAgB,YAAhB,CAAlB;AACA,kBAAKa,UAAL,CAAgBH,UAAhB,EAA4B,KAAKnB,QAAjC;;AAEA,kBAAKuB,GAAL,GAAWC,YAAY,YAAK;AAC1B,uBAAKF,UAAL,CAAgBH,UAAhB,EAA4B,MAAKnB,QAAjC;AACD,cAFU,EAER,KAAKA,QAAL,GAAgB,IAFR,CAAX;AAGD;;;oCACYmB,U,EAAYnB,Q,EAAS;AAC5B,iBAAIqB,aAAa,KAAKA,UAAtB;AACA,iBAAII,OAAOC,KAAKC,KAAL,CAAWN,cAAc,KAAK,EAAL,GAAU,EAAxB,CAAX,CAAX;AACA,iBAAIO,SAASP,cAAc,KAAK,EAAL,GAAU,EAAxB,CAAb;AACA,iBAAIQ,QAAQH,KAAKC,KAAL,CAAWC,UAAU,KAAK,EAAf,CAAX,CAAZ;AACAA,sBAASA,UAAU,KAAK,EAAf,CAAT;AACA,iBAAIE,UAAUJ,KAAKC,KAAL,CAAWC,SAAS,EAApB,CAAd;AACA,iBAAIG,UAAUH,SAAS,EAAvB;AACA,iBAAII,UAAU,EAAd;AACAA,wBAAWP,OAAOA,OAAO,GAAd,GAAoB,EAA/B;AACAO,wBAAWH,QAAQA,QAAQ,GAAhB,GAAsB,EAAjC;AACAG,wBAAWF,UAAUA,UAAU,GAApB,GAA0B,EAArC;AACAE,wBAAWD,UAAUA,UAAU,GAApB,GAA0B,EAArC;AACA,kBAAKV,UAAL,GAAkBA,aAAarB,QAA/B;AACAmB,wBAAWc,IAAX,CAAgBD,OAAhB;AACA,iBAAI,KAAKX,UAAL,IAAiB,CAArB,EAAwB;AACpBF,4BAAWc,IAAX,CAAgB,QAAhB;AACApC,wBAAOqC,aAAP,CAAqB,KAAKX,GAA1B;AACH;AACJ;;;;;;mBA/DgBxB,Q","file":"app/js/activity/live/index.js","sourcesContent":["import LiveShow from './live';\nwindow.liveShow = new LiveShow();\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/live/index.js","import ActivityEmitter from \"../activity-emitter\";\nexport default class LiveShow {\n  constructor() {\n    this.interval = 1;\n    this.emitter = new ActivityEmitter();\n    this.startEvent();\n    this.finishByReplay();\n    this.countdownEvent();\n  }\n\n  finishByReplay() {\n      let self = this;\n      $('.js-replay').on('click', function(){\n        let triggerUrl = $(this).data('finish');\n        $.post(triggerUrl, function(res){\n            self.emitter.emit('finish');\n        });\n      });\n  }\n\n  startEvent() {\n      let self = this;\n      $(\".js-start-live\").on(\"click\", function () {\n          if (!self.started) {\n              this.started = true;\n              self.emitter.emit('start', {}).then(() => {\n                  console.log('live.start');\n              }).catch((error) => {\n                  console.error(error);\n              });\n          }\n      });\n  }\n\n  countdownEvent() {\n    let $countdown = $('#countdown');\n    if ($countdown.length == 0) return;\n\n    this.timeRemain = $countdown.data('timeRemain');\n    this._countdown($countdown, this.interval);\n\n    this.iId = setInterval(()=> {\n      this._countdown($countdown, this.interval);\n    }, this.interval * 1000);\n  }\n    _countdown($countdown, interval){\n        let timeRemain = this.timeRemain;\n        let days = Math.floor(timeRemain / (60 * 60 * 24));\n        let modulo = timeRemain % (60 * 60 * 24);\n        let hours = Math.floor(modulo / (60 * 60));\n        modulo = modulo % (60 * 60);\n        let minutes = Math.floor(modulo / 60);\n        let seconds = modulo % 60;\n        let context = '';\n        context += days ? days + '天' : '';\n        context += hours ? hours + '时' : '';\n        context += minutes ? minutes + '分' : '';\n        context += seconds ? seconds + '秒' : '';\n        this.timeRemain = timeRemain - interval;\n        $countdown.text(context);\n        if (this.timeRemain<=0) {\n            $countdown.text('直播已经开始');\n            window.clearInterval(this.iId);\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity/live/live.js"],"sourceRoot":""}