{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"names":["Exercise","$form","$element","validator2","_setValidateRule","_init","_initEvent","_inItStep2form","fix","$step2_form","$","validate","rules","title","required","maxlength","trim","course_title","itemCount","positiveInteger","min","max","range","difficulty","remote","url","data","type","dataType","async","val","courseId","length","lessonId","JSON","stringify","types","each","push","messages","Translator","trans","$step3_form","validator","onkeyup","finishCondition","addMethod","value","element","optional","test","format","click","form","checkQuestionNum","change","post","text","i","n","questionNum"],"mappings":"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","file":"app/js/activity-manage/exercise/index.js","sourcesContent":["import SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nclass Exercise {\n  constructor($form) {\n    this.$element = $form;\n    this.validator2 = null;\n    this._setValidateRule();\n    this._init();\n    this._initEvent();\n    \n  }\n\n  _init() {\n    this._inItStep2form();\n    this.fix();\n  }\n\n  _initEvent() {\n  }\n\n  _inItStep2form() {\n    let $step2_form = $(\"#step2-form\");\n\n    this.validator2 = $step2_form.validate({\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n          course_title: true,\n        },\n        itemCount: {\n          required: true,\n          positiveInteger: true,\n          min: 1,\n          max: 9999\n        },\n        range: {\n          required: true,\n        },\n        difficulty: {\n          required: true\n        },\n        'questionTypes[]': {\n          required: true,\n          remote: {\n            url: $('[name=\"checkQuestion\"]').data('checkUrl'),\n            type: \"post\",\n            dataType: \"json\",\n            async: false,\n            data: {\n              itemCount: function () {\n                return $('[name=\"itemCount\"]').val();\n              },\n              range: function () {\n                let range = {}\n                let courseId = $('[name=\"range[courseId]\"]').val();\n                range.courseId = courseId;\n                if ($('[name=\"range[lessonId]\"]').length > 0) {\n                  let lessonId = $('[name=\"range[lessonId]\"]').val();\n                  range.lessonId = lessonId;\n                }\n\n                return JSON.stringify(range);\n              },\n              difficulty: function () {\n                return $('[name=\"difficulty\"]').val();\n              },\n              types: function () {\n                let types = [];\n                $('[name=\"questionTypes\\[\\]\"]:checked').each(function () {\n                  types.push($(this).val());\n                });\n                return types;\n              }\n            }\n          }\n        }\n      },\n      messages: {\n        required: Translator.trans(\"activity.exercise_manage.title_required_error_hint\"),\n        range: Translator.trans(\"activity.exercise_manage.title_range_error_hint\"),\n        itemCount: {\n          required: Translator.trans('activity.exercise_manage.item_count_required_error_hint'),\n          positiveInteger: Translator.trans('activity.exercise_manage.item_count_positive_integer_error_hint'),\n          min: Translator.trans('activity.exercise_manage.item_count_min_error_hint'),\n          max: Translator.trans('activity.exercise_manage.item_count_max_error_hint')\n        },\n        difficulty: Translator.trans(\"activity.exercise_manage.difficulty_required_error_hint\"),\n        'questionTypes[]': {\n          required: Translator.trans(\"activity.exercise_manage.question_required_error_hint\"),\n          remote: Translator.trans(\"activity.exercise_manage.question_remote_error_hint\")\n        },\n      }\n    });\n\n    $step2_form.data('validator', this.validator2);\n  }\n\n  _inItStep3form() {\n    var $step3_form = $(\"#step3-form\");\n    var validator = $step3_form.validate({\n      onkeyup: false,\n      rules: {\n        finishCondition: {\n          required: true,\n        },\n      },\n      messages: {\n        finishCondition: Translator.trans(\"activity.exercise_manage.finish_detail_required_error_hint\"),\n      }\n    });\n    $step3_form.data('validator', validator);\n  }\n\n  _setValidateRule() {\n    $.validator.addMethod(\"positiveInteger\", function (value, element) {\n      return this.optional(element) || /^[1-9]\\d*$/.test(value);\n    }, $.validator.format(Translator.trans(\"activity.exercise_manage.item_count_positive_integer_error_hint\")));\n\n  }\n\n  fix() {\n    $('.js-question-type').click(() => {\n      this.validator2.form();\n    })\n  }\n}\n\nnew Exercise($('#step2-form'));\nnew SelectLinkage($('[name=\"range[courseId]\"]'), $('[name=\"range[lessonId]\"]'));\n\ncheckQuestionNum();\n\n$('[name=\"range[courseId]\"]').change(function () {\n  checkQuestionNum();\n})\n\n$('[name=\"range[lessonId]\"]').change(function () {\n  checkQuestionNum();\n})\n\n$('[name=\"difficulty\"]').change(function () {\n  checkQuestionNum();\n})\n\nfunction checkQuestionNum() {\n  let url = $('[name=\"range[courseId]\"]').data('checkNumUrl');\n  let courseId = $('[name=\"range[courseId]\"]').val();\n  let lessonId = $('[name=\"range[lessonId]\"]').val();\n  let difficulty = $('[name=\"difficulty\"]').val();\n\n  $.post(url, { courseId: courseId, lessonId: lessonId, difficulty: difficulty }, function (data) {\n    $('[role=\"questionNum\"]').text(0);\n\n    $.each(data, function (i, n) {\n      $(\"[type='\" + i + \"']\").text(n.questionNum);\n    });\n  })\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"sourceRoot":""}