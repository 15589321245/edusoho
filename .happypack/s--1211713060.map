{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/help.js"],"names":["sortablelist","list","$list","$","data","sortable","get","post","ids","response","lessonNum","chapterNum","unitNum","find","each","$item","hasClass","text","trigger","taskSortable","length","element","ajax","closeCourse","on","evt","$target","currentTarget","confirm","Translator","trans","warn","message","success","location","reload","deleteCourse","publishCourse","target","deleteTask","parents","remove","publishTask","event","parentLi","closest","addClass","removeClass","unpublishTask","showSettings","$this","siblings","hide","stop","slideDown","TabChange","click","updateTaskNum","container","$container","listernScroll","$header","headerTop","offset","top","window","scroll","scrollTop","testpaperCard_top"],"mappings":"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","file":"help.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport sortList from 'common/sortable';\n\nexport const sortablelist = (list) => {\n  let $list = $(list);\n  var data = $list.sortable(\"serialize\").get();\n  $.post($list.data('sortUrl'), { ids: data }, (response) => {\n    let lessonNum = 0,\n      chapterNum = 0,\n      unitNum = 0;\n    $list.find('.task-manage-item').each(function () {\n      var $item = $(this);\n      if ($item.hasClass('js-task-manage-item')) {\n        lessonNum++;\n        $item.find('.number').text(lessonNum);\n      } else if ($item.hasClass('task-manage-unit')) {\n        unitNum++;\n        $item.find('.number').text(unitNum);\n      } else if ($item.hasClass('task-manage-chapter')) {\n        chapterNum++;\n        unitNum = 0;\n        $item.find('.number').text(chapterNum);\n      }\n    });\n    $list.trigger('finished');\n  });\n}\n\nexport const taskSortable = (list) => {\n  if ($(list).length) {\n    sortList({\n      element: list,\n      ajax: false,\n    }, (data) => {\n      sortablelist(list);\n    });\n  }\n}\n\nexport const closeCourse = () => {\n  $('body').on('click', '.js-close-course', function (evt) {\n    let $target = $(evt.currentTarget);\n    if (!confirm(Translator.trans('是否确定关闭该教学计划？'))) {\n      return;\n    }\n\n    $.post($target.data('check-url'), function (data) {\n\n      if (data.warn) {\n        if (!confirm(Translator.trans(data.message))) {\n          return;\n        }\n      }\n\n      $.post($target.data('url'), function (data) {\n        if (data.success) {\n          notify('success', '关闭成功');\n          location.reload();\n        } else {\n          notify('danger', '关闭失败：' + data.message);\n        }\n      });\n    });\n  });\n};\n\nexport const deleteCourse = () => {\n  $('body').on('click', '.js-delete-course', function (evt) {\n    if (!confirm(Translator.trans('是否确定删除该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.currentTarget).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        location.reload();\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishCourse = () => {\n  $('body').on('click', '.js-publish-course', function (evt) {\n    if (!confirm(Translator.trans('是否确定发布该教学计划？'))) {\n      return;\n    }\n    $.post($(evt.target).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '发布成功');\n        location.reload();\n      } else {\n        notify('danger', '发布失败：' + data.message, 5000);\n      }\n    });\n  });\n};\n\nexport const deleteTask = () => {\n  $('body').on('click', '.delete-item', function (evt) {\n    if ($(evt.currentTarget).data('type') == 'task') {\n      if (!confirm(Translator.trans('是否确定删除该任务吗？'))) {\n        return;\n      }\n    } else if ($(evt.currentTarget).data('type') == 'chapter') {\n      if (!confirm(Translator.trans('是否确定删除该章节吗？'))) {\n        return;\n      }\n    }\n    $.post($(evt.currentTarget).data('url'), function (data) {\n      if (data.success) {\n        notify('success', '删除成功');\n        $(evt.target).parents('.task-manage-item').remove();\n        sortablelist('#sortable-list');\n      } else {\n        notify('danger', '删除失败：' + data.message);\n      }\n    });\n  });\n};\n\nexport const publishTask = () => {\n  $('body').on('click', '.publish-item', (event) => {\n    $.post($(event.target).data('url'), function (data) {\n      if (data.success) {\n        var parentLi = $(event.target).closest('.task-manage-item');\n        notify('success', '发布成功');\n        $(parentLi).find('.publish-item').addClass('hidden')\n        $(parentLi).find('.delete-item').addClass('hidden')\n        $(parentLi).find('.unpublish-item').removeClass('hidden')\n        $(parentLi).find('.publish-status').addClass('hidden')\n      } else {\n        notify('danger', '发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const unpublishTask = () => {\n  $('body').on('click', '.unpublish-item', (event) => {\n    $.post($(event.target).data('url'), function (data) {\n      if (data.success) {\n        var parentLi = $(event.target).closest('.task-manage-item');\n        notify('success', '取消发布成功');\n        $(parentLi).find('.publish-item').removeClass('hidden')\n        $(parentLi).find('.delete-item').removeClass('hidden')\n        $(parentLi).find('.unpublish-item').addClass('hidden')\n        $(parentLi).find('.publish-status').removeClass('hidden')\n      } else {\n        notify('danger', '取消发布失败：' + data.message);\n      }\n    });\n  })\n};\n\nexport const showSettings = () => {\n  $(\"#sortable-list\").on('mouseenter', '.js-task-manage-item', (event) => {\n    let $this = $(event.currentTarget);\n    $this.siblings(\".js-task-manage-item.active\").removeClass('active').find('.js-settings-list').hide();\n    if (!$this.hasClass('active')) {\n      $this.addClass('active').find('.js-settings-list').stop().slideDown(500);\n    }\n  });\n};\n\nexport const TabChange = () => {\n  $('[data-role=\"tab\"]').click(function (event) {\n    let $this = $(this);\n    $($this.data('tab-content')).removeClass(\"hidden\").siblings('[data-role=\"tab-content\"]').addClass('hidden');\n  });\n};\n\nexport const updateTaskNum = (container) => {\n  let $container = $(container);\n  $container.on('finished',function(){\n    $('#task-num').text($(container).find('i[data-role=\"task\"]').length);\n  })\n}\n\nexport const listernScroll = () => {\n  let $header = $('js-task-list-header');\n  let headerTop = $header.offset().top;\n\t$(window).scroll(function(event) {\n\t\t\tlet scrollTop = $(window).scrollTop();\n\t\t\tif (scrollTop >= testpaperCard_top) {\n\t\t\t\t$header.addClass('affix')\n\t\t\t} else {\n\t\t\t\t$header.removeClass('affix');\n\t\t\t}\n\t});\n}\n\n"]}