{% extends 'layout.html.twig' %}
{% do script(['libs/jquery-validation.js', 'libs/iframe-resizer-contentWindow.js', '//service-cdn.qiqiuyun.net/js-sdk/uploader/sdk-v1.js', 'libs/perfect-scrollbar.js', 'app/js/open-course-manage/lesson-modal-form/index.js']) %}

{% set lesson = lesson|default(null) %}

{% block body %}
  <form class="form-horizontal" id="lesson-create-form">
  
    <div class="form-group" style="display:none;">
      <div class="col-md-2 control-label"><label>{{'my.teaching.open_course.lesson.modal.lesson_type'|trans}}</label></div>
      <div class="col-md-9 controls">
        <div class="radios">
          <label><input type="radio" name="type" value="video" checked="checked" /> {{'my.teaching.open_course.lesson.video'|trans}}</label>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-2 control-label">
      <label for="title" class="control-label-required">{{ 'my.teaching.open_course.lesson.modal.lesson_title'|trans }}</label>
      </div>
      <div class="col-sm-10">
        <input id="title" class="form-control" type="text" name="title" value="{{ lesson.title|default('') }}">
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-2 control-label">
        <label for="ext_mediaSource" class="style control-label-required">{{ 'my.teaching.open_course.lesson.video'|trans }}</label>
      </div>
      <div class="col-sm-10">
        {% include 'file-chooser/file-choose.html.twig' with {mediaType: 'video', fileType:'video', file: lesson.file|default(null), link: lesson.mediaSource|default(null) } %}
        <input type="hidden" id="mediaSource" name="mediaSource"
              value="{{ lesson.mediaSource|default(null) }}">
      </div>
    </div>

    <div class="form-group for-video-type" id="lesson-length-form-group">
      <div class="col-sm-2 control-label for-video-type">
        <label class="control-label-required">{{ 'my.teaching.open_course.lesson.modal.video_length'|trans }}</label>
      </div>
      <div class="col-sm-10">
        <input class="form-control width-150 js-length" id="minute" type="text" name="minute"
              value="{{ lesson.minute|default(null) }}">
        <span class="mhs">{{ 'site.default.minute'|trans }}</span>
        <input
            class="form-control width-150 js-length" id="second" type="text" name="second"
            value="{{ lesson.second|default(null) }}">
        <span class="mhs">{{ 'site.default.second'|trans }}</span>
        <input type="hidden" id="mediaId" name="mediaId" value="{{ lesson.mediaId|default(null) }}">
        <input type="hidden" id="mediaUri" name="mediaUri" value="{{ lesson.mediaUri|default(null) }}">
        <input type="hidden" id="length" name="length" value="{{ lesson.length|default(0) }}">
      </div>
    </div>

    {% if setting('storage.upload_mode', 'local') == 'cloud' and lesson.mediaSource|default('self') == 'self' %}
      <div class="form-group for-video-subtitle" id="video-subtitle-form-group">
        <div class="col-sm-2 control-label for-video-subtitle">
          <label class="control-label">{{ 'my.teaching.open_course.lesson.modal.media_dialog'|trans }}</label>
        </div>

        <div class="col-sm-10 controls js-subtitle-list" data-dialog-url="{{ path('media_subtitle_manage_dialog') }}">
          <p style="margin-top:6px;color:#a1a1a1">{{ 'my.teaching.open_course.lesson.modal.upload.tips'|trans }}</p>
        </div>
        <div class="col-sm-offset-2 help-block">
          <p style="margin-left:10px;">{{ 'my.teaching.open_course.lesson.modal.media_dialog.help_block'|trans|raw }}</p>
        </div>

        <input id="ext_mediaId_for_subtitle" class="form-control" type="hidden" value={{ lesson.mediaId|default(null) }}>
      </div>
    {% endif %}

    
    <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
  </form>
{% endblock %}