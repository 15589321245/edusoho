define("chineserp-jquery/1.0.0/chineserp-jquery",["jquery/1.10.1/jquery","chineserp/1.0.0/chineserp"],function(i){var e=i("jquery/1.10.1/jquery"),t=i("chineserp/1.0.0/chineserp"),n=function(i,n){this.el=i,this.options=e.extend({remote:"",picked:"",visible:10,animate:0},n||{}),this.picker=null,this.options.picked=String(this.options.picked),this.options.visible=parseInt(this.options.visible,10)||10,this.options.animate=parseInt(this.options.animate,10)||0,this.data={regions:[],collections:[]},this.el.on("initializing.rp",e.proxy(this._onInitializing,this)),this.el.on("initialized.rp",e.proxy(this._onInitialized,this)),e(document).on("keydown",e.proxy(this._onCloserClick,this)),new t.RegionPicker({remote:this.options.remote,initialized:e.proxy(this._preInitialize,this)})};n.prototype={constructor:n,_preInitialize:function(i){this.picker=i,this.el.trigger("initializing.rp",[this]),this.picker.pick(this.options.picked,e.proxy(function(i,e){this.data.regions=i,this.data.collections=e,this.el.trigger("initialized.rp",[this])},this))},_onInitializing:function(){this.renderer=e('<div id="region-picker" style="position:absolute;display:none;"></div>').append('<a href="javascript:;" class="region-picker-closer" title="cancel">&#215;</a>').append('<div class="regions"></div>').appendTo("body"),this.renderer.on("rendered",".region-list",e.proxy(this._onListRendered,this)),this.renderer.on("reveal",e.proxy(this._render,this)),this.renderer.on("picked",".region-list li",e.proxy(this._onItemPicked,this)),this.renderer.on("click",".region-list li",e.proxy(this._onItemClick,this)),this.renderer.on("click",".region-picker-closer",e.proxy(this._onCloserClick,this))},_onInitialized:function(){this.el.on("click",e.proxy(this._onClick,this))},_onClick:function(i){if(i.preventDefault(),"none"===this.renderer.css("display")){var e=this.el.offset();this.renderer.css({top:e.top+this.el.outerHeight(!0),left:e.left}).fadeIn(this.options.animate).trigger("reveal")}},_onItemClick:function(i){var t=e(i.currentTarget),n=t.attr("data-id");i.preventDefault(),this.el.trigger("loading.rp",this),this.picker.pick(n,e.proxy(function(e,t){this.data.regions=e,this.data.collections=t,this.el.trigger("loaded.rp",[this.data,this]);var r=e[e.length-1]&&n===e[e.length-1].i;r?(this.el.trigger("picked.rp",[e,this]),this._onCloserClick(i)):this.renderer.trigger("reveal")},this))},_onItemPicked:function(i,e,t,n){i.stopPropagation();var r=t-this.options.visible+1;r>=0&&e.animate({scrollTop:(r+1)*n},Math.max(1.5*this.options.animate,200))},_onCloserClick:function(i){("click"===i.type||"keydown"===i.type&&27===i.which)&&(i.stopPropagation(),"none"!==this.renderer.css("display")&&this.renderer.fadeOut(this.options.animate))},_onListRendered:function(i,t){var n=e(i.currentTarget),r=e("li:first",n).outerHeight(!0);n.height(this.options.visible*r),e("li",n).each(function(i){e(this).attr("data-id")===t.i&&e(this).addClass("picked").trigger("picked",[n,i,r])})},_render:function(){for(var i=e(".regions",this.renderer).empty(),t=0;t<this.data.collections.length;t++)e('<ul class="region-list"></ul>').append(this._renderItems(this.data.collections[t])).appendTo(i).trigger("rendered",[this.data.regions[t]])},_renderItems:function(i){for(var t,n=[],r=0;r<i.length;r++)t=i[r],n.push(e('<li data-id="'+t.i+'">'+t.n+"</li>").fadeIn(this.options.animate));return n}},e.fn.regionPicker=function(i){return this.each(function(){var t=e(this),r=t.data("regionpicker");if(!r){var s=e.extend(t.data(),i||{});t.data("regionpicker",r=new n(t,s))}})}});