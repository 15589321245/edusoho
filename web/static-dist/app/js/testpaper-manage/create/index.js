webpackJsonp(["app/js/testpaper-manage/create/index"],[function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_sortable=__webpack_require__("8f840897d9471c8c1fbd"),_sortable2=_interopRequireDefault(_sortable),TestpaperForm=function(){function TestpaperForm($form){_classCallCheck(this,TestpaperForm),this.$form=$form,this.$description=this.$form.find('[name="description"]'),this.validator=null,this._initEvent(),this._initEditor(),this._initValidate(),this._initSortList()}return _createClass(TestpaperForm,[{key:"_initEvent",value:function(){var _this=this;this.$form.on("click",'[data-role="submit"]',function(event){return _this._submit(event)})}},{key:"_initEditor",value:function(){var _this2=this,editor=CKEDITOR.replace(this.$description.attr("id"),{toolbar:"Simple",filebrowserImageUploadUrl:this.$description.data("imageUploadUrl"),height:100});editor.on("change",function(){_this2.$description.val(editor.getData())})}},{key:"_initValidate",value:function(){this.validator=this.$form.validate({rules:{name:{required:!0},description:{required:!0,maxlength:500},limitedTime:{min:0,max:1e4,digits:!0},mode:{required:!0},range:{required:!0}},messages:{name:"请输入试卷名称",description:"请输入试卷描述",mode:"请选择生成方式",range:"请选择出题范围"}}),this.$form.find(".testpaper-question-option-item").each(function(){var self=$(this);self.find('[data-role="count"]').rules("add",{min:0,max:function(){return parseInt(self.find('[role="questionNum"]').text())},digits:!0}),self.find('[data-role="score"]').rules("add",{min:0,max:100,digits:!0}),self.find('[data-role="missScore"]').length>0&&self.find('[data-role="missScore"]').rules("add",{min:0,max:function(){return parseInt(self.find('[data-role="score"]').val())},digits:!0})})}},{key:"_initSortList",value:function(){(0,_sortable2["default"])({element:"#testpaper-question-options",itemSelector:".testpaper-question-option-item",handle:".question-type-sort-handler",isAjax:!1})}},{key:"_submit",value:function(event){var status=this.validator.form();status&&this.$form.submit()}}]),TestpaperForm}();new TestpaperForm($("#testpaper-form"))}]);