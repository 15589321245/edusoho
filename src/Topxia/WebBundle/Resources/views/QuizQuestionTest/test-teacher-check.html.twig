{% extends 'TopxiaWebBundle::layout.html.twig' %}

{% set script_controller = 'quiz-question/test-teacher-check' %}

{% set role = 'teacher' %}

{% block content %}
<style type="text/css">
	.affix.questionBar {
		top: 0;
		width: inherit;
		padding-right: 30px;
		z-index: 1000;
	}
	.affix.answerCard {
		top: 10px;
		width: inherit;
		padding-right: 30px;
	}
	.affix.answerCard .panel {
		width: 24%;
		float: right;
	}

	.questionBar {
		margin-bottom: 15px;
	}
	.questionBar ul {
		background-color: #f5f5f5;
		border:1px solid #e3e3e3;
	}

	.answerCard {
		width: 24%;
		float: right;
	}

	.answerCard .panel-body a.btn {
		float: left;
		margin: 1px;
		width: 26px;
		height: 26px;
		padding: 0;
		text-align: center;
		line-height: 27px;
		color: #999;
	}

	.answerCard .panel-body a.btn.right {
		background-color: #47a447;
	}

	.answerCard .panel-body a.btn.wrong {
		background-color: #d2322d;
	}

	.answerCard .panel-body a.btn.noAnswer {
		background-color: #f5f5f5;
	}

	.choice .panel-body {
		padding: 0 0px;
	}
	.choice .panel-body ul {
		margin: 10px 0;
	}
	.choice li {
		height: 30px;
		line-height: 30px;
		padding: 0 15px;
	}
	.choice li:hover {
		background-color: #f5f5f5;
		cursor: pointer;
	}
	.choice input[type="checkbox"] {
		cursor: pointer;
	}

	.panel-title {
		word-wrap: break-word; 
		word-break: normal; 
		display:inline-block;
	}
	.panel-footer {
		min-height: 50px;
	}
	.panel-footer a.btn {
		box-shadow: 0 0 0;
	}

	.done {
		background-color: #f5f5f5;
	}
	.have-pro {
		border: 2px solid #428bca;
	}

</style>

<div class="page-header">
  <h1>{{ paper.name }}<small>{{ paper.description }}</small></h1>
</div>
<div class="panel panel-default">
	<div class="panel-body">
		<div class="media">
			<div class="pull-left well" style="width:20%">
				<h2>{{ paperResult.score - accuracy.essay.score }} 分</h2>
				<small>客观题总分：{{ paper.score - accuracy.essay.totalScore }}</small>
			</div>
			<div class="media-body">
				<table class="table table-hover table-condensed">
					<thead>
						<th></th>
						<th>选择题 ({{ accuracy.single_choice.all + accuracy.choice.all }})</th>
						<th>判断题 ({{ accuracy.determine.all }})</th>
						<th>填空题 ({{ accuracy.fill.all }})</th>
					</thead>
					<tbody>
						<tr>
							<td>答对</td>
							<td>{{ accuracy.single_choice.right + accuracy.choice.right }}</td>
							<td>{{ accuracy.determine.right }}</td>
							<td>{{ accuracy.fill.right }}</td>
						</tr>
						<tr>
							<td>答错</td>
							<td>{{ accuracy.single_choice.wrong + accuracy.choice.wrong }}</td>
							<td>{{ accuracy.determine.wrong }}</td>
							<td>{{ accuracy.fill.all - accuracy.fill.right }}</td>
						</tr>
						<tr>
							<td>未答</td>
							<td>{{ accuracy.single_choice.noAnswer + accuracy.choice.noAnswer }}</td>
							<td>{{ accuracy.determine.noAnswer }}</td>
							<td>{{ accuracy.fill.noAnswer }}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<div class="panel-footer">
		<span class="text-info text-lg">以下为主观题，总分为 {{ accuracy.essay.totalScore }}。请批阅。</span>
	</div>
</div>

<div class="answerCard" data-spy="affix" data-offset-top="530">
	<div class="panel panel-default">
		<div class="panel-body">
			{% set index = 1 %}
			{% for question in questions.single_choice %}
				{% set index = index + 1 %}
			{% endfor %}

			{% for question in questions.choice %}
				{% set index = index + 1 %}
			{% endfor %}

			{% for question in questions.determine %}
				{% set index = index + 1 %}
			{% endfor %}

			{% for question in questions.fill %}
				{% set index = index + 1 %}
			{% endfor %}

			{% for question in questions.essay %}
				<a href="#question{{ question.id }}" class="btn btn-default {{ question.testResult.status }}">{{ index }}</a>
				{% set index = index + 1 %}
			{% endfor %}

			{% for question in questions.material %}
				{% for question in question.questions %}
					{% if question.questionType == 'essay' %}
						<a href="#question{{ question.id }}" class="btn btn-default {{ question.testResult.status }}">{{ index }}</a>
					{% endif %}
					{% set index = index + 1 %}
				{% endfor %}
			{% endfor %}

		</div>
		<div class="panel-footer">
			<button class="btn btn-success btn-block" id="postPaper" data-url="{{ path('course_manage_test_teacher_check', { id: id }) }}" data-goto="{{ path('course_manage_list_teacher_test', {status:'reviewing'}) }}">提交</button>
		</div>
	</div>
</div>


<div class="row">
	<div class="col-md-9">
		<div data-spy="scroll" data-target=".questionBar">
			<form class="form-horizontal" id="essayForm">
				{% include 'TopxiaWebBundle:QuizQuestionTest:do-test.html.twig' %}
			</form>
		</div>

	</div>
	<div class="col-md-3">
	</div>

</div>
{% endblock %}