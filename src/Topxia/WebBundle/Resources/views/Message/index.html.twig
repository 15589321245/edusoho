{% extends 'TopxiaWebBundle::layout.html.twig' %}

{% block title %}私信 - {{ parent() }}{% endblock %}
{% set nav = 'message' %}

{% block content %}


<div class="page">
<div class="row">
  <div class="col-lg-12 mbl ptm">

    <div>
         <a class="btn btn-primary pull-right" href="{{ path('message_send') }}">发送私信</a>
    </div>

    {% if conversations is empty %}
    一个私信都没有，
    <a class="text-success" href="{{ path('message_send') }}">现在就去写个吧！</a>
    {% else %}
    <ul class="media-list">
      {% for conversation in conversations %}
        {% set fromUser = users[conversation.fromId] %}
        <li class="media">
          {{ web_macro.user_avatar(fromUser, 'pull-left media-object') }}
          
          <div class="media-body">
            <h4 class="media-heading">
              {% if conversation.latestMessageUserId == app.user.id %}
                发给
              {% endif  %}
              {{ web_macro.user_link(fromUser) }}:
            </h4>
            {{conversation.latestMessageContent}}
            {% if conversation.unreadNum > 0 %}
             <span class="text-warning">({{conversation.unreadNum}}条未读)</span>
             {% endif %}

            <div class="text-muted clearfix">
              <span class="pull-left">{{ conversation.latestMessageTime|smart_time }}</span>
              <span class="pull-right">共{{ conversation.messageNum }}条</span>
            </div>

            <a class="btn btn-small btn-info" id="read-conversation" href="{{ path('message_conversation_show',
            {conversationId:conversation.id })}} ">阅读</a>
            <a class="btn btn-small btn-danger" id="delete-conversation" href="{{ path('message_conversation_delete',
            {conversationId:conversation.id })}} " >删除全部私信</a>
          </div>
        </li>
      {% endfor %}
    </ul>

    </div>
    


    {% endif %}
  </div>
</div>

</div>
{{ web_macro.paginator(paginator) }}
{% endblock %}