webpackJsonp(["app/js/open-course-manage/replay-lesson/index"],{0:function(n,t){n.exports=jQuery},efb8be413205284ff940:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("8f840897d9471c8c1fbd"),a=e.n(s),r=e("b334fd7e4c5a19234db2"),o=e.n(r),i=function(n,t){$.post(t.data("sortUrl"),{ids:n},function(n){var e=chapterNum=unitNum=0;t.find(".item-lesson, .item-chapter").each(function(){var n=$(this);n.hasClass("item-lesson")?(e++,n.find(".number").text(e)):n.hasClass("item-chapter-unit")?(unitNum++,n.find(".number").text(unitNum)):n.hasClass("item-chapter")&&(chapterNum++,unitNum=0,n.find(".number").text(chapterNum))})})},d=$("#course-item-list");a()({element:"#course-item-list",itemSelector:".item-lesson, .item-chapter"},function(n){i(n,d)}),d.on("click",".delete-lesson-btn",function(n){if(confirm(Translator.trans("删除课时的同时会删除课时的资料、测验。您真的要删除该课时吗？"))){var t=$(n.currentTarget),e=function(){return t.parents(".item-chapter")[0]},s=function(){e()?t.parents(".item-chapter").remove():t.parents(".item-lesson").remove()};$.post($(this).data("url"),function(n){s(),i(d),o()("success",Translator.trans("课时已删除！"))},"json")}}),d.on("click",".delete-chapter-btn",function(n){var t=$(this).data("chapter"),e=$(this).data("part");if(confirm(Translator.trans("您真的要删除该%chapter_name%%part_name%吗？",{chapter_name:t,part_name:e}))){var s=$(n.currentTarget);$.post($(this).data("url"),function(n){s.parents(".item-chapter").remove(),i(d),o()("success"+t+e+Translator.trans("已删除！"))},"json")}}),d.on("click",".replay-lesson-btn",function(n){confirm(Translator.trans("您真的要录制回放吗？"))&&$.post($(this).data("url"),function(n){if(n.error)10019==n.code?o()("danger",Translator.trans("录制失败，直播时您没有进行录制！")):1403==n.code?o()("danger",Translator.trans("尚未生成回放文件!")):o()("danger",Translator.trans("录制失败！"));else{var t="#"+$(n).attr("id");$(t).replaceWith(n),o()("success",Translator.trans("课时已录制！"))}})}),d.on("click",".publish-lesson-btn",function(n){$(n.currentTarget);$.post($(this).data("url"),function(n){var t="#"+$(n).attr("id");$(t).find(".item-content .unpublish-warning").remove(),$(t).find(".item-actions .publish-lesson-btn").parent().addClass("hidden").removeClass("show"),$(t).find(".item-actions .unpublish-lesson-btn").parent().addClass("show").removeClass("hidden"),$(t).find(".item-actions .delete-lesson-btn").parent().addClass("hidden").removeClass("show"),$(t).find(".btn-link").tooltip(),o()("success",Translator.trans("课时发布成功！"))})}),d.on("click",".unpublish-lesson-btn",function(n){$(n.currentTarget);$.post($(this).data("url"),function(n){var t="#"+$(n).attr("id");0==$(t).find(".item-content").find(".unpublish-warning").length&&($(t).find(".item-content").append('<span class="unpublish-warning text-warning">('+Translator.trans("未发布")+")</span>"),$(t).find(".item-actions .publish-lesson-btn").parent().addClass("show").removeClass("hidden"),$(t).find(".item-actions .unpublish-lesson-btn").parent().addClass("hidden").removeClass("show"),$(t).find(".item-actions .delete-lesson-btn").parent().addClass("show").removeClass("hidden"),$(t).find(".btn-link").tooltip(),o()("success",Translator.trans("课时已取消发布！")))})}),d.on("click",".delete-exercise-btn",function(n){if(confirm(Translator.trans("您真的要删除该课时练习吗？"))){$(n.currentTarget);$.post($(this).data("url"),function(n){o()("success",Translator.trans("练习已删除！")),window.location.reload()},"json")}}),d.on("click",".delete-homework-btn",function(n){if(confirm(Translator.trans("您真的要删除该课时作业吗？"))){$(n.currentTarget);$.post($(this).data("url"),function(n){o()("success",Translator.trans("作业已删除！")),window.location.reload()},"json")}}),$("#course-item-list .item-actions .btn-link").tooltip(),$("#course-item-list .fileDeletedLesson").tooltip(),$(".dropdown-menu").parent().on("shown.bs.dropdown",function(){"block"==$(this).find(".dropdown-menu-more").css("display")?($(this).parent().find(".dropdown-menu-more").mouseout(function(){$(this).parent().find(".dropdown-menu-more").hide()}),$(this).parent().find(".dropdown-menu-more").mouseover(function(){$(this).parent().find(".dropdown-menu-more").show()})):$(this).parent().find(".dropdown-menu-more").show()}),$(".dropdown-menu").parent().on("hide.bs.dropdown",function(){$(this).find(".dropdown-menu-more").show()}),function(){var n=$(".lesson-manage-panel").data("file-status-url");$.get(n,"",function(n){if(n&&0!=n.length)for(var t=0;t<n.length;t++){var e=n[t];"waiting"==e.convertStatus||"doing"==e.convertStatus?$("li[data-file-id="+e.id+"]").find('span[data-role="mediaStatus"]').append("<span class='text-warning'>"+Translator.trans("正在文件格式转换")+"</span>"):"error"==e.convertStatus?$("li[data-file-id="+e.id+"]").find('span[data-role="mediaStatus"]').append("<span class='text-danger'>"+Translator.trans("文件格式转换失败")+"</span>"):"success"==e.convertStatus&&($("li[data-file-id="+e.id+"]").find(".mark-manage").show(),$("li[data-file-id="+e.id+"]").find(".mark-manage-divider").show())}})}(),$(".js-lesson-batch-btn-popover").popover({html:!0,trigger:"hover",delay:{show:200,hide:1e3},placement:"top",template:'<div class="popover tata-popover tata-popover-lg" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:function(){return $(this).find(".popover-content").html()}})}},["efb8be413205284ff940"]);