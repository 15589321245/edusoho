{% extends 'WebBundle:CourseSetManage:layout.html.twig' %}
{% block title %}{{ '教学计划管理'|trans }} - {{ parent() }}{% endblock %}

{% set side_nav = 'task' %}
{% do script(['libs/jquery-sortable.js','web/task-manage/index.js']) %}


{% block main %}
  <div class="panel panel-default panel-col lesson-manage-panel">
    <div class="panel-heading">
      <a href="{{path('courseset_manage_courses', {courseSetId: courseSet.id})}}">{{'教学计划列表'|trans}}</a>/{{course.title}}
      <button class="btn btn-success btn-sm pull-right">发布计划</button>
    </div>
    <div class="panel-body">
      <!-- TODO  删除返回的课程数据，为任务加章节数据 -->
      <ul class="nav nav-pills mbl">
        <li class="active"><a href="javascript:;">计划任务</a></li>
        <li class="">
          <a href="{{path('courseset_manage_course_info', {courseSetId: courseSet.id, courseId: course.id})}}">计划设置</a>
        </li>
        <li class="">
          <a href="{{path('courseset_manage_course_marketing', {courseSetId: courseSet.id, courseId: course.id})}}">营销设置</a>
        </li>
        <li class="">
          <a href="{{path('courseset_manage_course_teachers', {courseSetId: courseSet.id, courseId: course.id})}}">教师设置</a>
        </li>
        <li class="">
          <a href="{{path('courseset_manage_course_students', {courseSetId: courseSet.id, courseId: course.id})}}">学员管理</a>
        </li>
      </ul>
      <div class="task-list-header clearfix">
        任务总数：<span class="color-warning space">{{tasks|length}}</span> 日均约需完成：<span class="color-warning">2.5</span> 个任务
        <div class="pull-right">
          <button class="btn btn-info btn-sm" id="lesson-create-btn" data-toggle="modal" data-target="#modal" data-backdrop="static" data-keyboard="false" data-url="{{ path('course_manage_task_create', {courseId:1}) }}"><i class="es-icon es-icon-anonymous-iconfont"></i> 任务 </button>
          <div class="btn-group">
            <button type="button" class="btn btn-sm btn-success dropdown-toggle" data-toggle="dropdown">
              <i class="es-icon es-icon-anonymous-iconfont"></i>
              {{ setting('default.chapter_name')|default('章'|trans) }}/{{ setting('default.part_name')|default('节'|trans) }}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <li>
                <a href="#" id="chapter-create-btn" data-toggle="modal" data-target="#modal" data-backdrop="static" data-keyboard="false" data-url="{{ path('course_manage_chapter_create', {id:course.id}) }}">
                  <i class="es-icon es-icon-anonymous-iconfont"></i>
                  {{'添加%chapter_name%'|trans({'%chapter_name%': setting('default.chapter_name')|default('章'|trans)})}}
                </a>
              </li>
              <li>
                <a href="#" id="chapter-create-btn" data-toggle="modal" data-target="#modal" data-backdrop="static" data-keyboard="false" data-url="{{ path('course_manage_chapter_create', {id:course.id, type:'unit'}) }}">
                  <i class="es-icon es-icon-anonymous-iconfont"></i>
                  {{'添加%part_name%'|trans({'%part_name%': setting('default.part_name')|default('节')})}}
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <ul class="task-manage-list sortable-list" id="sortable-list">
        <li class="task-manage-item task-manage-chapter clearfix">
          <div class="item-content">
            </i>第<span class="number">1</span>章：11
          </div>
          <div class="item-actions">
            <span class="dropdown">
              <a class="dropdown-toggle dropdown-more btn btn-gray" id="dropdown-more" data-toggle="dropdown" href="#"><i class="es-icon es-icon-addcircle mrs"></i>添加
              </a>
              <ul class="dropdown-menu pull-right dropdown-menu-more" role="menu" style="margin-top:12px;min-width:144px" aria-labelledby="dLabel" style="display:none;">
                <li>
                  <a>添加节</a>
                </li>
                <li>
                  <a>添加任务</a>
                </li>
              </ul>
            </span>
            <a class="btn btn-gray">
              <i class="es-icon es-icon-edit mrs"></i>编辑
            </a>
            <a class="btn btn-gray delete-chapter-btn">
              <i class="es-icon es-icon-delete mrs"></i>删除
            </a>
          </div>
        </li>
        <li class="task-manage-item task-manage-unit clearfix">
          <div class="item-content">
            </i>第<span class="number">1</span>节：111
          </div>
          <div class="item-actions">
            <a class="btn btn-gray">
              <i class="es-icon es-icon-addcircle mrs"></i>添加
            </a>
            <a class="btn btn-gray">
              <i class="es-icon es-icon-edit mrs"></i>编辑
            </a>
            <a class="btn btn-gray">
              <i class="es-icon es-icon-delete mrs"></i>删除
            </a>
          </div>
        </li>
        {% for task in tasks %}
          {% include 'WebBundle:TaskManage:list-item.html.twig' with {task:task} %}
        {% endfor %}
      </ul>
    </div>
  </div>
{% endblock %}



