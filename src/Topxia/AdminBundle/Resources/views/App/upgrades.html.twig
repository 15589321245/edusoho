{% extends 'TopxiaAdminBundle:App:layout.html.twig' %}

{% block title %}更新 - {{ parent() }}{% endblock %}

{% set script_controller = 'app/upgrades' %}
{% set menu = 'center' %}
{% set tab_menus = permissions('admin_app_center_show',"tab") %}
{% set submenu = 'upgrades' %}

{% block main %}
  <div class="mbl">
    {% include 'TopxiaAdminBundle::tab.html.twig' with {menus : tab_menus , type : submenu} %}
  </div>

{% if status|default(null) %}
  <div class="alert alert-danger">AccessKey或者SecretKey设置不正确，会影响到系统正常的运行，<a href="{{path('admin_setting_cloud')}}">请修改设置。</a></div>
{% else %}
{% if apps %}
  <table class="table table-striped table-hover">
    <thead>

    </thead>
    <tbody>
      {% for app in apps %}
        <tr>
          <td>
            <img src="http://open.edusoho.com/files/product/{{ app.icon }}" class="app-img pull-left mrl mtm"/>
          </td>

         <td width="26%">
            <div class="mtm ">
              <a href="#" class=""> <h4><strong class="text-primary">{{ app.name }}</strong></h4></a> {% if version_compare(app.package.edusohoMinVersion, version, ">") %}<div class="text-danger">需要主系统版本为{{app.package.edusohoMinVersion}}以上才能更新</div>{% endif %}
           </div>

          <!-- <div class="info mtm mbm clearfix"> -->
            <div class="left-info pull-left">
 
            <div class="text-muted"><small>开发者：{{ app.developerName }}</small></div>
            
            <div class="class-rating mtm">
              <span class="text-muted">版本：{{ app.package.toVersion }}</span>
            </div>
            
            <div class="middle-info">
              <div class="text-muted">最后更新：{{ app.package.createdTime|date('Y-m-d') }}</div>
            </div>

            <!-- </div> -->
            </div>

          </td>

          <td>
            <div class="middle-info pull-left text-muted" style="margin-top:40px;width:90%;">更新日志： {{ app.package.description|plain_text(80) }} <a href="javascript:;" class="text-warning description-more" data-content="{{ app.package.description }}"><br>查看详情  &raquo; </a>
            </div>
          </td>

          <td>
            <a href="#" data-toggle="modal" data-target="#modal" data-url="{{ path('admin_app_package_update_modal', {id:app.package.id, type:'upgrade'}) }}" class="btn btn-primary {% if version_compare(app.package.edusohoMinVersion, version, ">") %}disabled{% endif %} mrl" data-keyboard="false" data-backdrop="static" style="margin-top:40px;" >更新</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
当前已是最新版本!
{% endif %}
{% endif %}
{% endblock %}