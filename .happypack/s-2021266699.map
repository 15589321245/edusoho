{"version":3,"sources":["app/Resources/static-src/app/js/admin/index-modal/index.js"],"names":["$modal","$","parents","$table","on","confirm","ids","push","data","ajaxDelete","click","find","each","value","Notify","danger","url","userIds","post","response","i","userId","remove","member_count","member_count_text","parseInt","text","length","success","datetimepicker","format","autoclose","minView","val","substring","html","load","modal","$panel"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["// define(function(require, exports, module) {\n//     require(\"jquery.bootstrap-datetimepicker\");\n//     var Notify = require('common/bootstrap-notify');\n\n\n// exports.run = function() {\nimport notify from \"common/notify\";\n\nvar $modal = $('#member-cancel-form').parents('.modal');\nvar $table = $('#member-table');\n\n$('#member-table').on('click', '.delete-member', function () {\n\n  if (!confirm('真的要取消该会员吗?')) {\n    return;\n  }\n\n  var ids = [];\n  ids.push($(this).data('id'));\n\n  ajaxDelete($(this).data('url'), ids);\n\n});\n\n$('.js-batch-delete-btn').click(function () {\n  var ids = [];\n  $('#table-list-panel').find('[data-role=batch-item]:checked').each(function () {\n    ids.push(this.value);\n  });\n  if (ids == \"\") {\n    Notify.danger('请先选择你要取消的会员!');\n    return;\n  }\n\n  if (!confirm('真的要取消这些会员吗?')) {\n    return;\n  }\n\n  ajaxDelete($(this).data('url'), ids);\n\n})\n\nfunction ajaxDelete(url, userIds) {\n\n  $.post(url, { userIds: userIds }, function (response) {\n    if (response) {\n      $.each(userIds, function (i, userId) {\n        $('#member-table-tr-' + userId).remove();\n      })\n\n      var member_count = $('.member_count'),\n        member_count_text = parseInt($('.member_count').text());\n      member_count.text(member_count_text - userIds.length);\n      Notify.success('操作成功!');\n    }\n\n  });\n}\n\nif ($(\"#startDate\").length > 0) {\n  $(\"#startDate\").datetimepicker({\n    format: 'yyyy-mm-dd',\n    autoclose: true,\n    minView: 'month',\n  }).on('changeDate', function () {\n    $(\"#endDate\").datetimepicker('setStartDate', $(\"#startDate\").val().substring(0, 16));\n  });\n\n  $(\"#startDate\").datetimepicker('setEndDate', $(\"#endDate\").val().substring(0, 16));\n}\n\nif ($(\"#endDate\").length > 0) {\n  $(\"#endDate\").datetimepicker({\n    format: 'yyyy-mm-dd',\n    autoclose: true,\n    minView: 'month',\n  }).on('changeDate', function () {\n    $(\"#startDate\").datetimepicker('setEndDate', $(\"#endDate\").val().substring(0, 16));\n  });\n\n  $(\"#endDate\").datetimepicker('setStartDate', $(\"#startDate\").val().substring(0, 16));\n}\n\n$('.item-vip-edit').click(function () {\n  var url = $(this).data('url');\n  var userIds = $(this).data('id');\n\n  $('#modal').html('');\n  $('#modal').load(url, { userIds: userIds });\n  $('#modal').modal('show');\n})\n\nvar $panel = $('#table-list-panel');\n// require('../../../../topxiaweb/js/util/batch-select')($panel);\n\n$('.js-batch-edit-btn').click(function () {\n  var ids = [];\n  $('#table-list-panel').find('[data-role=batch-item]:checked').each(function () {\n    ids.push(this.value);\n  });\n  if (ids == \"\") {\n    Notify.danger('请先选择你要编辑的会员!');\n    return;\n  }\n\n  $('#modal').html('');\n  $('#modal').load($(this).data('url'), { userIds: ids });\n  $('#modal').modal('show');\n})\n    // };\n\n// });"]}