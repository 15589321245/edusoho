{% extends 'TopxiaWebBundle::bootstrap-modal-layout.html.twig' %}

{% set modal_class = 'modal-lg' %}
{% set lesson = lesson|default(null) %}


{% block title %}
  {% if lesson %}编辑课时{{ lesson.number }}{% else %}添加课时{% endif %}
{% endblock %}

{% block body %}
  <link rel="stylesheet" media="screen" href="{{ asset('bundles/topxiaweb/css/ztree.css') }}" />
  <link rel="stylesheet" media="screen" href="{{ asset('bundles/topxiaweb/css/tag-chooser-2.css') }}" />

<form id="course-lesson-form" data-course-id="{{course.id}}" class="form-horizontal" method="post" 
  {% if lesson %}
    action="{{ path('course_manage_lesson_edit', {courseId:course.id, lessonId:lesson.id}) }}" data-lesson-id="{{lesson.id}}"
  {% else %}
    action="{{ path('course_manage_lesson_create', {id:course.id}) }}"
  {% endif %}
  >

{% if lesson|default(null) is null %}
<div class="form-group">
  <label for="lesson-type" class="col-sm-2 control-label">类型</label>
  <div class="col-sm-8 controls">
    <div class="radios" id="lesson-type">
        <label>
            <input type="radio" name="type" value="courseware" checked>课件
        </label>

        <label>
            <input type="radio" name="type" value="essay">文章
        </label>

        <label>
            <input type="radio" name="type" value="testpaper">试卷
        </label>
    </div>
  </div>
</div>
{% endif %}

<div class="form-group">
    <label for="title" class="col-sm-2 control-label">标题</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" id="title" name="title" value="{{ lesson.title|default('') }}" placeholder="请输入标题">
    </div>
</div>

{% set type = lesson.type|default(null) %}

<div class="courseware-chooser-module hide">
  {% include 'CustomWebBundle:CourseLessonManage:courseware-chooser.html.twig' %}
</div>

<div class="essay-chooser-module hide">
  {% include 'CustomWebBundle:CourseLessonManage:essay-chooser.html.twig' %}
</div>

<div class="testpaper-chooser-module hide">
  {% include 'CustomWebBundle:CourseLessonManage:testpaper-chooser.html.twig' %}
</div>

<input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
<input type="hidden" name="courseId" value="{{ course.id|default(0) }}">
<input type="hidden" name="categoryId" value="{{ category.id|default(0) }}">
<input type="hidden" data-role="lesson-type" value="{{ lesson.type|default(null) }}">
</form>

<script>
  app.load('course-manage/lesson-modal2')
</script>

{% endblock %}
{% block footer %}
    <button type="button" class="btn btn-link" data-dismiss="modal" id="cancel-btn">取消</button>
    <button id="lesson-operate-btn" data-loading-text="正在提交" type="submit" class="btn btn-primary" data-toggle="form-submit" data-target="#course-lesson-form">{% if lesson %}保存{% else %}添加{% endif %}</button>
{% endblock %}

{% set hideFooter = true %}