{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/marketing/index.js"],"names":["Marketing","init","$","perfectScrollbar","$form","validator","validate","onkeyup","rules","originPrice","required","val","positive_currency","tryLookLength","console","log","digits","min","max","tryLookLimit","buyExpiryTime","messages","date","addMethod","value","element","params","Date","getTime","now","Translator","trans","on","event","$li","toggleClass","$input","find","prop","is","stopPropagation","closest","removeClass","addClass","datetimepicker","format","language","minView","autoclose","endDate","click","$item","currentTarget","$values","values","JSON","parse","hasClass","splice","indexOf","text","push","stringify","evt","form","submit"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["\nimport { TabChange } from '../help';\n\nclass Marketing {\n  constructor() {\n    this.init();\n  }\n\n  init() {\n    $('.js-task-price-setting').perfectScrollbar();\n    let $form = $('#course-marketing-form');\n    $('.js-task-price-setting').perfectScrollbar();\n    TabChange();\n    let validator = $form.validate({\n      onkeyup: false,\n      rules: {\n        originPrice: {\n          required: function () {\n            return $(\"[name=isFree]:checked\").val() == 0;\n          },\n          positive_currency: function () {\n            return $(\"[name=isFree]:checked\").val() == 0;\n          },\n        },\n        tryLookLength: {\n          required: function () {\n             console.log('tryLookLength');\n            console.log($('input[name=\"tryLookable\"]:checked').val() == 1);\n            return $(\"[name=tryLookable]:checked\").val() == 1;\n          },\n          digits: true,\n          min: 1,\n          max: 10\n        },\n        tryLookLimit: {\n          digits: true\n        },\n        buyExpiryTime: {\n          required: function () {\n            console.log('buyExpiryTime');\n            console.log($('input[name=\"enableBuyExpiryTime\"]:checked').val() == 1);\n            return $('input[name=\"enableBuyExpiryTime\"]:checked').val() == 1;\n          },\n        }\n      },\n      messages: {\n        buyExpiryTime: {\n          required: '请选择有效的购买截止日期',\n          date: '请选择有效的购买截止日期'\n        }\n      }\n    });\n\n    $.validator.addMethod(\n      \"feature\",\n      function (value, element, params) {\n        return value && (new Date(value).getTime()) > Date.now();\n      },\n      Translator.trans('购买截止时间需在当前时间之后')\n    );\n\n    $('.js-task-price-setting').on('click', 'li', function (event) {\n      let $li = $(this).toggleClass('open');\n      let $input = $li.find('input');\n      $input.prop(\"checked\", !$input.is(\":checked\"))\n    });\n\n    $('.js-task-price-setting').on('click', 'input', function (event) {\n      event.stopPropagation();\n      let $input = $(this);\n      $input.closest('li').toggleClass('open');\n    });\n\n    $('input[name=\"isFree\"]').on('change', function (event) {\n      if ($('input[name=\"isFree\"]:checked').val() == 0) {\n        $('.js-is-free').removeClass('hidden');\n      } else {\n        $('.js-is-free').addClass('hidden');\n      }\n    });\n\n    $('input[name=\"enableBuyExpiryTime\"]').on('change', function (event) {\n      console.log(\"11\");\n      if ($('input[name=\"enableBuyExpiryTime\"]:checked').val() == 0) {\n        $('#buyExpiryTime').addClass('hidden');\n      } else {\n        $('#buyExpiryTime').removeClass('hidden');\n      }\n    });\n\n\n\n    $('input[name=\"buyExpiryTime\"]').datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: \"zh\",\n      minView: 2, //month\n      autoclose: true,\n      endDate: new Date(Date.now() + 86400 * 365 * 100 * 1000)\n    });\n    $('input[name=\"buyExpiryTime\"]').datetimepicker('setStartDate', new Date(Date.now() + 86400 * 1000));\n\n    $('input[name=\"tryLookable\"]').on('change', function (event) {\n      console.log('tryLook : ', $('input[name=\"tryLookable\"]:checked').val());\n      if ($('input[name=\"tryLookable\"]:checked').val() == 1) {\n        $('.js-enable-try-look').removeClass('hidden');\n        $('#tryLookLength').val('1');\n      } else {\n        $('.js-enable-try-look').addClass('hidden');\n      }\n    });\n\n    $('.js-service-item').click(function (event) {\n      let $item = $(event.currentTarget);\n      let $values = $('#course_services').val();\n      if (!$values) {\n        values = [];\n      }\n      $values = JSON.parse($values);\n      if ($item.hasClass('label-primary')) {\n        $item.removeClass('label-primary');\n        $item.addClass('label-default');\n        $values.splice($values.indexOf($item.text()), 1);\n      } else {\n        $item.removeClass('label-default');\n        $item.addClass('label-primary');\n        $values.push($item.text());\n      }\n      $('#course_services').val(JSON.stringify($values));\n    });\n\n    $('#course-submit').click(function (evt) {\n      console.log('clicj');\n      if (validator.form()) {\n        $form.submit();\n      }\n    });\n  }\n}\n\nnew Marketing();"]}