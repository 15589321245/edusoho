{% extends 'TopxiaAdminBundle:Sale:layout.html.twig' %}

{% block title %}优惠码管理 - {{ parent() }}{% endblock %}

{% set menu = 'admin_offsale_off' %}

{% set script_controller = 'sale/offsale' %}

{% block main %}
<div class="page-header">
  <button class="btn btn-info btn-sm pull-right" id="add-offsale-btn" data-toggle="modal" data-target="#modal" data-url="{{ path('admin_sale_offsale_create')}}">新增优惠码</button>
  <h1>优惠码管理</h1>
</div>

<form id="message-search-form" class="form-inline well well-sm" action="" method="get" novalidate>

  <div class="form-group">
   
    <select class="form-control" name="saleType">
        {{ select_options(dict('offsaleType'), app.request.query.get('saleType'), '码类型') }}
      </select>
  </div>
  
  <div class="form-group">
    <input class="form-control" type="text" placeholder="码编号" name="promoCode" value="{{ app.request.get('promoCode') }}"></div>
  
  <div class="form-group">
    <input class="form-control" type="text" placeholder="适用商品" name="prodName" value="{{ app.request.get('prodName') }}"></div>

  <div class="form-group">
    <input class="form-control" type="text" placeholder="渠道" name="nickName" value="{{ app.request.get('nickName') }}"></div>

  <button class="btn btn-primary">搜索</button>
</form>

<div id="offsale-table-container">
  <table class="table table-striped table-hover" id="offsale-table">
    <thead>
      <tr >
        <th width="2%">
          <input type="checkbox" data-role="batch-select"></th>
        <th width="8%">码类型</th>
        <th width="10%">码编号</th>
        <th width="8%">所属渠道</th>
        <th width="8%">佣金比例</th>
       

        <th width="8%">优惠(元)</th>       
        <th width="15%">适用商品</th>
       
       
        <th width="10%">有效期</th>
              
        <th width="15%">优惠码描述</th>

       
        <th  width="15%">使用情况</th>
      </tr>
    </thead>
    <tbody>
      {% for offsale in offsales %}
        {% set orders = orderss[offsale.promoCode]|default(null) %}
        {% set partner = partners[offsale.partnerId]|default(null) %}

        {% include 'TopxiaAdminBundle:Sale:offsale-tr.html.twig' %}
       
      {% else %}
      <tr>
        <td colspan="10">
          <div class="empty">无记录</div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div>
    <label class="checkbox-inline">
      <input type="checkbox" data-role="batch-select">全选</label>
    <button class="btn btn-default btn-sm mlm" data-role="batch-delete"  data-name="优惠码" data-url="{{ path('admin_sale_offsale_delete_batch') }}">删除</button>
  </div>
</div>
{{ web_macro.paginator(paginator) }}
{% endblock %}