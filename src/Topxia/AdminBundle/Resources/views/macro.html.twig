{% macro user_link(user, class) %}
  {% if user %}
		<a {% if class %}class="{{ class }}"{% endif %} href="javascript:;" role="show-user" data-toggle="modal" data-target="#modal" data-url="{{ url('admin_user_show', {id:user.id}) }}">{{ user.nickname }}</a>
	{% else %}
	  <span class="text-muted">用户已删除</span>
	{% endif %}
{% endmacro %}

{% macro bytesToSize(bytes) %}
	{% spaceless %}
	    
	    {% set kilobyte = 1024 %}
	    {% set megabyte = kilobyte * 1024 %}
	    {% set gigabyte = megabyte * 1024 %}
	    {% set terabyte = gigabyte * 1024 %}

	    {% if bytes < kilobyte %}
	        {{ bytes ~ ' B' }}
	    {% elseif bytes < megabyte %}
	        {{ (bytes / kilobyte)|number_format(2, '.') ~ ' KB' }}
	    {% elseif bytes < gigabyte %}
	        {{ (bytes / megabyte)|number_format(2, '.') ~ ' MB' }}
	    {% elseif bytes < terabyte %}
	        {{ (bytes / gigabyte)|number_format(2, '.') ~ ' GB' }}
	    {% else %}
	        {{ (bytes / terabyte)|number_format(2, '.') ~ ' TB' }}
	    {% endif %}

	{% endspaceless %}
{% endmacro %}

{% macro header_menu(menus,nav) %}
	<ul class="nav navbar-nav">
      {% for menu in menus %}
          {% set param = {} %}
          {% set router_name = menu.router_name %}

            {% if menu.router_params|default(null) %}
            {% set router_params = menu.router_params %}
          
              {% if menu.router_params_context|default(false) %}
                {% for key,router_param in router_params %}

                {% set router_param = router_param|split('.') %}
                {% set object = router_param[0] %}
                {% set value = router_param[1] %}
                {% set item = setItem(key,_context[object][value]) %}
                {% set param = param|merge(item) %}
                
                {% endfor %}

              <li {% if nav == menu.active|default('-1') %}class="active"{% endif %} ><a href="{{path(router_name,param)}}">{{menu.name}}</a></li>
              {% else %}
               <li {% if nav == menu.active|default('-1') %}class="active"{% endif %}><a href="{{path(router_name,router_params)}}">{{menu.name}}</a></li>
              {% endif %}

           
            {% else %}
            <li {% if nav == menu.active|default('-1') %}class="active"{% endif %}><a href="{{path(router_name)}}">{{menu.name}}</a></li>
            {% endif %}
          
          {% endfor %}
   	</ul>
{% endmacro %}