{% extends 'TopxiaWebBundle::bootstrap-modal-layout.html.twig' %}

{% set modalSize = 'large' %}

{% block title %}{{'学员备注'|trans}}{% endblock %}
{% block body %}

<form id="expiryday-set-form" class="form-horizontal" method="post" action="{{ path('classroom_manage_student_expiry_date', { classroomId:classroom.id, userId:user.id }) }}">
  {% if classroom.status == 'published' %}
    <div class="row form-group">
      <div class="col-md-2 control-label">
        <label for="classroom-title">{{'班级标题'|trans}}</label>
      </div>
      <div class="col-md-7 controls">
        <div style="margin-top: 7px;">
          {{ classroom.title }}
          </div>
      </div>
    </div>

    <div class="row form-group">
      <div class="col-md-2 control-label">
        <label for="student-nickname">{% if setting('default.user_name') %}{{ setting('default.user_name')|default('学员'|trans) }}{% else %}{{'学员'|trans}}{% endif %}{{'用户名'|trans}}</label>
      </div>
      <div class="col-md-7 controls">
        <div style="margin-top: 7px;">
          {{ user.nickname|default() }}
          </div>
        </div>
    </div>

    <div class="row form-group">
      <div class="col-md-2 control-label">
        <label for="set-more-expiryday">{{'有效期'|trans}}</label>
      </div>
      <div class="col-md-7 controls">
        <input type="text" id="classroom_expiryDay" name="expiryDay" required="required" {% if deadline %}value="{{ deadline|date('Y-m-d') }}"{% endif %}class="form-control width-input width-input-large">
        <div class="help-block">
        {{ '设置该值后，%user_name%只能在截止日期前进行课程的学习，系统默认会在截止时间前10天提醒学员。'|trans({'%user_name%': setting('default.user_name')|default('学员'|trans)}) }}
        </div>
      </div>
      <input type="hidden" name="expiryMode" value="date">
    </div>
    <input type="hidden" name="memberId" value="{{ user.id }}">
  {% else %}
    <div class="empty">{{dict_text('classroomStatus', classroom.status)}}{{'班级不能增加'|trans}}{% if setting('default.user_name') %}{{ setting('default.user_name')|default('学员'|trans) }}{% else %}{{'学员'|trans}}{% endif %}{{'有效期，请班级发布后再增加。'|trans}}</div>
  {% endif %}
</form>

{% endblock %}

{% block footer %}
  <button type="submit" id="student-save" data-loading-text="正在保存..."class="btn btn-primary pull-right" data-toggle="form-submit" data-target="#expiryday-set-form">{{'保存'|trans}}</button>
  <button type="button" class="btn btn-link pull-right" data-dismiss="modal">{{'取消'|trans}}</button>
<script>app.load('classroombundle/controller/classroom/expiry-date')</script>
{% endblock %}
