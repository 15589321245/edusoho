{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/video/index.js"],"names":["Video","$","on","event","openUI","val","_inItStep3from","$step3_forom","validator","data","validate","rules","required","positive_integer","max","min","messages","_inItStep2form","$step2_form","groups","date","title","maxlength","trim","minute","second","second_range","blur","form","parseInt","fileChooser","subtitleDialog","onSelectFile","closeUI","file","length","Math","round","source","id","uri","render","children","removeClass","target","value","addClass"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import FileChooser from '../../file-chooser/file-choose';\nimport SubtitleDialog from './subtitle/dialog';\n\nclass Video {\n  constructor() {\n\n  }\n\n  \n}\n\n\n\n$('#iframe-content').on('click', '.js-choose-trigger', (event) => {\n  FileChooser.openUI();\n  $('[name=\"ext[mediaSource]\"]').val(null);\n});\n\nfunction _inItStep3from() {\n\n  var $step3_forom = $('#step3-form');\n  var validator = $step3_forom.data('validator');\n\n  $step3_forom.validate({\n    rules: {\n      'ext[finishDetail]': {\n        required: true,\n        positive_integer: true,\n        max: 300,\n        min: 1,\n      }\n    },\n    messages: {\n      'ext[finishDetail]': {\n        required: '请输入时长',\n      }\n    }\n  });\n  $step3_forom.data('validator', validator);\n}\nfunction _inItStep2form() {\n  var $step2_form = $('#step2-form');\n  var validator = $step2_form.data('validator');\n  $step2_form.validate({\n    groups: {\n      date: 'minute second'\n    },\n    rules: {\n      title: {\n        required: true,\n        maxlength: 50,\n        trim: true,\n      },\n      minute: 'required unsigned_integer',\n      second: 'required second_range',\n      'ext[mediaSource]': 'required',\n      'ext[finishDetail]': 'unsigned_integer'\n    },\n    messages: {\n      minute: {\n        required: '请输入时长',\n      },\n      second: {\n        required: '请输入时长',\n        second_range: '秒数只能在0-59之间',\n      },\n      'ext[mediaSource]': \"请上传或选择%display%\",\n    }\n  });\n  $step2_form.data('validator', validator);\n}\n\n_inItStep2form();\n\n\n$(\".js-length\").blur(function () {\n  let validator = $(\"#step2-form\").data('validator');\n  if (validator && validator.form()) {\n    const minute = parseInt($('#minute').val()) | 0;\n    const second = parseInt($('#second').val()) | 0;\n    $(\"#length\").val(minute * 60 + second);\n  }\n});\n\nconst fileChooser = new FileChooser();\n//字幕组件\nconst subtitleDialog = new SubtitleDialog('.js-subtitle-list');\n\n\nconst onSelectFile = file => {\n  FileChooser.closeUI();\n  if (file.length && file.length > 0) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#length\").val(minute * 60 + second);\n  }\n\n  $('[name=\"ext[mediaSource]\"]').val(file.source);\n  if (file.source == 'self') {\n    $(\"#ext_mediaId\").val(file.id);\n    $(\"#ext_mediaUri\").val('');\n  } else {\n    $(\"#ext_mediaUri\").val(file.uri);\n    $(\"#ext_mediaId\").val(0);\n  }\n\n  //渲染字幕\n  subtitleDialog.render(file);\n};\n\n// 完成条件是观看时长的情况\nif($(\"#finish-condition\").children('option:selected').val() === 'time') {\n  $('.viewLength').removeClass('hidden');\n  _inItStep3from();\n}\n\n$(\"#finish-condition\").on('change', function (event) {\n  if (event.target.value == 'time') {\n    $('.viewLength').removeClass('hidden');\n    _inItStep3from();\n  } else {\n    $('.viewLength').addClass('hidden');\n    $('input[name=\"ext[finishDetail]\"]').rules('remove')\n  }\n})\n\nfileChooser.on('select', onSelectFile);\n"]}