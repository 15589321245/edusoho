{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/create/index.js"],"names":["Creator","init","$","popover","html","initValidator","checkBoxChange","$form","validator","validate","groups","date","rules","title","required","trim","deadline","val","after_now_date","expiryDays","positive_integer","max_year","expiryStartDate","before_date","expiryEndDate","after_date","messages","Translator","trans","click","evt","form","isInitIntro","currentTarget","button","submit","initDatePicker","listLength","find","length","console","log","intro","isCourseListIntro","on","event","removeClass","addClass","$id","$picker","datetimepicker","format","language","minView","autoclose","endDate","Date","now"],"mappings":";;;;AAAA;;;;;;;;IAEMA,O;AACJ,qBAAc;AAAA;;AACZ,SAAKC,IAAL;AACA;AACD;;;;2BAEM;AACLC,QAAE,yBAAF,EAA6BC,OAA7B,CAAqC;AACnCC,cAAM;AAD6B,OAArC;AAGA,WAAKC,aAAL;AACA,WAAKC,cAAL;AACD;;;oCAEe;AAAA;;AACd,UAAIC,QAAQL,EAAE,qBAAF,CAAZ;AACA,UAAIM,YAAYD,MAAME,QAAN,CAAe;AAC7BC,gBAAQ;AACNC,gBAAM;AADA,SADqB;AAI7BC,eAAO;AACLC,iBAAO;AACLC,sBAAU,IADL;AAELC,kBAAM;AAFD,WADF;AAKLC,oBAAU;AACRF,sBAAU,oBAAM;AACd,qBAAOZ,EAAE,kCAAF,EAAsCe,GAAtC,OAAgD,MAAhD,IAA0Df,EAAE,oCAAF,EAAwCe,GAAxC,OAAkD,UAAnH;AACD,aAHO;AAIRC,4BAAgB;AAJR,WALL;AAWLC,sBAAY;AACVL,sBAAU,oBAAM;AACd,qBAAOZ,EAAE,kCAAF,EAAsCe,GAAtC,OAAgD,MAAhD,IAA0Df,EAAE,oCAAF,EAAwCe,GAAxC,OAAkD,MAAnH;AACD,aAHS;AAIVG,8BAAkB,4BAAM;AACtB,qBAAOlB,EAAE,kCAAF,EAAsCe,GAAtC,OAAgD,MAAhD,IAA0Df,EAAE,oCAAF,EAAwCe,GAAxC,OAAkD,MAAnH;AACD,aANS;AAOVI,sBAAU;AAPA,WAXP;AAoBLC,2BAAiB;AACfR,sBAAU,oBAAM;AACd,qBAAOZ,EAAE,kCAAF,EAAsCe,GAAtC,OAAgD,MAAvD;AACD,aAHc;AAIfN,kBAAM,IAJS;AAKfO,4BAAgB,IALD;AAMfK,yBAAa;AANE,WApBZ;AA4BLC,yBAAe;AACbV,sBAAU,oBAAM;AACd,qBAAOZ,EAAE,kCAAF,EAAsCe,GAAtC,OAAgD,MAAvD;AACD,aAHY;AAIbN,kBAAM,IAJO;AAKbc,wBAAY;AALC;AA5BV,SAJsB;AAwC7BC,kBAAU;AACRb,iBAAOc,WAAWC,KAAX,CAAiB,aAAjB,CADC;AAERT,sBAAY;AACVL,sBAAU;AADA,WAFJ;AAKRE,oBAAU;AACRF,sBAAU;AADF,WALF;AAQRQ,2BAAiB;AACfR,sBAAU;AADK,WART;AAWRU,yBAAe;AACbV,sBAAU;AADG;AAXP;AAxCmB,OAAf,CAAhB;;AAyDAZ,QAAE,gBAAF,EAAoB2B,KAApB,CAA2B,UAACC,GAAD,EAAQ;AACjC,YAAItB,UAAUuB,IAAV,EAAJ,EAAsB;AACpB,gBAAKC,WAAL;AACA9B,YAAE4B,IAAIG,aAAN,EAAqBC,MAArB,CAA4B,SAA5B;AACA3B,gBAAM4B,MAAN;AACD;AACF,OAND;;AAQA,WAAKC,cAAL,CAAoB,kBAApB,EAAuC5B,SAAvC;AACA,WAAK4B,cAAL,CAAoB,gBAApB,EAAqC5B,SAArC;AACA,WAAK4B,cAAL,CAAoB,WAApB,EAAgC5B,SAAhC;AACD;;;kCAEa;AACZ,UAAI6B,aAAanC,EAAE,qBAAF,EAAyBoC,IAAzB,CAA8B,UAA9B,EAA0CC,MAA3D;AACA,UAAGF,cAAc,CAAjB,EAAoB;AAClBG,gBAAQC,GAAR,CAAYJ,UAAZ;AACA,YAAIK,QAAQ,qBAAZ;AACAA,cAAMC,iBAAN;AACD;AAEF;;;qCAEgB;AACfzC,QAAE,4BAAF,EAAgC0C,EAAhC,CAAmC,QAAnC,EAA6C,UAAUC,KAAV,EAAiB;AAC5D,YAAI3C,EAAE,oCAAF,EAAwCe,GAAxC,MAAiD,UAArD,EAAiE;AAC9Df,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC;AACA5C,YAAE,oBAAF,EAAwB6C,QAAxB,CAAiC,QAAjC;AACF,SAHD,MAGO;AACL7C,YAAE,oBAAF,EAAwB6C,QAAxB,CAAiC,QAAjC;AACC7C,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC;AACF;AACF,OARD;;AAUA5C,QAAE,0BAAF,EAA8B0C,EAA9B,CAAiC,QAAjC,EAA2C,UAAUC,KAAV,EAAiB;AAC1D,YAAI3C,EAAE,kCAAF,EAAsCe,GAAtC,MAA+C,MAAnD,EAA2D;AACzDf,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACA7C,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B;AACD,SAHD,MAGO,IAAG5C,EAAE,kCAAF,EAAsCe,GAAtC,MAA+C,MAAlD,EAA0D;AAC/Df,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACA7C,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B;AACD,SAHM,MAGC;AACN5C,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACA7C,YAAE,cAAF,EAAkB4C,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACD;AACF,OAXD;;AAaA7C,QAAE,yBAAF,EAA6B0C,EAA7B,CAAgC,QAAhC,EAA0C,UAAUC,KAAV,EAAiB;AACzD,YAAI3C,EAAE,iCAAF,EAAqCe,GAArC,MAA8C,UAAlD,EAA8D;AAC5Df,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC,EAA8CC,QAA9C,CAAuD,QAAvD;AACA7C,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC;AACD,SAHD,MAGO;AACL5C,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC,EAA8CC,QAA9C,CAAuD,QAAvD;AACA7C,YAAE,oBAAF,EAAwB4C,WAAxB,CAAoC,QAApC;AACD;AACF,OARD;AASD;;;mCAEcE,G,EAAIxC,S,EAAW;AAC5B,UAAIyC,UAAU/C,EAAE8C,GAAF,CAAd;AACAC,cAAQC,cAAR,CAAuB;AACrBC,gBAAQ,YADa;AAErBC,kBAAU,IAFW;AAGrBC,iBAAS,CAHY,EAGT;AACZC,mBAAW,IAJU;AAKrBC,iBAAS,IAAIC,IAAJ,CAASA,KAAKC,GAAL,KAAa,QAAQ,GAAR,GAAc,EAAd,GAAmB,IAAzC;AALY,OAAvB,EAMGb,EANH,CAMM,MANN,EAMc,YAAM;AAClBpC,kBAAUuB,IAAV;AACD,OARD;AASAkB,cAAQC,cAAR,CAAuB,cAAvB,EAAuC,IAAIM,IAAJ,EAAvC;AACD;;;;;;AAGH,IAAIxD,OAAJ","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import Intro from 'app/js/courseset-manage/intro';\n\nclass Creator {\n  constructor() {\n    this.init();\n    // this.isInitIntro();\n  }\n\n  init() {\n    $('[data-toggle=\"popover\"]').popover({\n      html: true,\n    });\n    this.initValidator();\n    this.checkBoxChange();\n  }\n\n  initValidator() {\n    let $form = $(\"#course-create-form\");\n    let validator = $form.validate({\n      groups: {\n        date: 'expiryStartDate expiryEndDate'\n      },\n      rules: {\n        title: {\n          required: true,\n          trim: true,\n        },\n        deadline: {\n          required: () => {\n            return $('input[name=\"expiryMode\"]:checked').val() === 'days' && $('input[name=\"deadlineType\"]:checked').val() === 'end_date' ;\n          },\n          after_now_date: true,\n        },\n        expiryDays: {\n          required: () => {\n            return $('input[name=\"expiryMode\"]:checked').val() === 'days' && $('input[name=\"deadlineType\"]:checked').val() === 'days' ;\n          },\n          positive_integer: () => {\n            return $('input[name=\"expiryMode\"]:checked').val() === 'days' && $('input[name=\"deadlineType\"]:checked').val() === 'days' ;\n          },\n          max_year: true,\n        },\n        expiryStartDate: {\n          required: () => {\n            return $('input[name=\"expiryMode\"]:checked').val() === 'date';\n          },\n          date: true,\n          after_now_date: true,\n          before_date: '#expiryEndDate'\n        },\n        expiryEndDate: {\n          required: () => {\n            return $('input[name=\"expiryMode\"]:checked').val() === 'date';\n          },\n          date: true,\n          after_date: '#expiryStartDate'\n        }\n      },\n      messages: {\n        title: Translator.trans('请输入教学计划课程标题'),\n        expiryDays: {\n          required: '请输入有效期天数'\n        },\n        deadline: {\n          required: '请输入截至日期'\n        },\n        expiryStartDate: {\n          required: '请输入开始日期'\n        },\n        expiryEndDate: {\n          required: '请输入结束日期'\n        }\n      }\n    });\n\n    $('#course-submit').click( (evt)=> {\n      if (validator.form()) {\n        this.isInitIntro();\n        $(evt.currentTarget).button('loading');\n        $form.submit();\n      }\n    });\n\n    this.initDatePicker('#expiryStartDate',validator);\n    this.initDatePicker('#expiryEndDate',validator);\n    this.initDatePicker('#deadline',validator);\n  }\n\n  isInitIntro() {\n    let listLength = $('#courses-list-table').find('tbody tr').length;\n    if(listLength == 1) {\n      console.log(listLength);\n      let intro = new Intro();\n      intro.isCourseListIntro();\n    }\n   \n  }\n\n  checkBoxChange() {\n    $('input[name=\"deadlineType\"]').on('change', function (event) {\n      if ($('input[name=\"deadlineType\"]:checked').val() == 'end_date') {\n         $('#deadlineType-date').removeClass('hidden');\n         $('#deadlineType-days').addClass('hidden');\n      } else {\n        $('#deadlineType-date').addClass('hidden');\n         $('#deadlineType-days').removeClass('hidden');\n      }\n    });\n\n    $('input[name=\"expiryMode\"]').on('change', function (event) {\n      if ($('input[name=\"expiryMode\"]:checked').val() == 'date') {\n        $('#expiry-days').removeClass('hidden').addClass('hidden');\n        $('#expiry-date').removeClass('hidden');\n      } else if($('input[name=\"expiryMode\"]:checked').val() == 'days') {\n        $('#expiry-date').removeClass('hidden').addClass('hidden');\n        $('#expiry-days').removeClass('hidden');\n      } else  {\n        $('#expiry-date').removeClass('hidden').addClass('hidden');\n        $('#expiry-days').removeClass('hidden').addClass('hidden');\n      }\n    });\n\n    $('input[name=\"learnMode\"]').on('change', function (event) {\n      if ($('input[name=\"learnMode\"]:checked').val() == 'freeMode') {\n        $('#learnLockModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnFreeModeHelp').removeClass('hidden');\n      } else {\n        $('#learnFreeModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnLockModeHelp').removeClass('hidden');\n      }\n    });\n  }\n\n  initDatePicker($id,validator) {\n    let $picker = $($id);\n    $picker.datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: \"zh\",\n      minView: 2, //month\n      autoclose: true,\n      endDate: new Date(Date.now() + 86400 * 365 * 10 * 1000)\n    }).on('hide', () => {\n      validator.form();\n    })\n    $picker.datetimepicker('setStartDate', new Date());\n  }\n}\n\nnew Creator();\n"]}