webpackJsonp(["app/js/course-manage/info/index"],{0:function(e,t){e.exports=jQuery},a1c4a43f5d1c99d74a21:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a("5fdcf1aea784583ca083"),d=n(o),u=a("33a776824bec073629e5"),l=n(u),s=a("26fa658edb0135ccf5db"),c=n(s),p=a("ae88c18278ce1387fd20"),m=n(p),f=a("b334fd7e4c5a19234db2"),g=n(f);new(function(){function e(){r(this,e),this.init()}return i(e,[{key:"init",value:function(){$("#maxStudentNum-field").length>0&&$.get($("#maxStudentNum-field").data("liveCapacityUrl")).done(function(e){$("#maxStudentNum-field").data("liveCapacity",e.capacity)}),this.initCkeidtor(),this.initValidator(),this.checkBoxChange(),this.changeAudioMode(),this.initDatePicker("#expiryStartDate"),this.initDatePicker("#expiryEndDate"),this.renderMultiGroupComponent("course-goals","goals"),this.renderMultiGroupComponent("intended-students","audiences")}},{key:"initCkeidtor",value:function(){CKEDITOR.replace("summary",{allowedContent:!0,toolbar:"Detail",filebrowserImageUploadUrl:$("#summary").data("imageUploadUrl")})}},{key:"changeAudioMode",value:function(){$("#audio-modal-id").on("change","input[name='enableAudio']",function(){"notAllowed"==$("#course-audio-mode").data("value")&&((0,g.default)("info",Translator.trans("course.audio.enable.biz.user")),$("[name='enableAudio']")[1].checked=!0,$("[name='enableAudio']")[0].checked=!1)})}},{key:"renderMultiGroupComponent",value:function(e,t){var a=$("#"+e).data("init-value");d.default.render(l.default.createElement(c.default,{dataSource:a,outputDataElement:t}),document.getElementById(e))}},{key:"initValidator",value:function(){var e=this,t=$("#course-info-form"),a=t.validate({currentDom:"#course-submit",groups:{date:"expiryStartDate expiryEndDate"},rules:{title:{maxlength:100,required:{depends:function(){return $(this).val($.trim($(this).val())),!0}}},maxStudentNum:{required:!0,live_capacity:!0,positive_integer:!0},expiryDays:{required:function(){return"date"!=$('input[name="expiryMode"]:checked').val()},digits:!0,max_year:!0},expiryStartDate:{required:function(){return"date"==$('input[name="expiryMode"]:checked').val()},date:!0,before_date:"#expiryEndDate"},expiryEndDate:{required:function(){return"date"==$('input[name="expiryMode"]:checked').val()},date:!0,after_date:"#expiryStartDate"}},messages:{title:{require:Translator.trans("course.manage.title_required_error_hint")},maxStudentNum:{required:Translator.trans("course.manage.max_student_num_error_hint")},expiryDays:{required:Translator.trans("course.manage.deadline_end_date_error_hint")},expiryStartDate:{required:Translator.trans("course.manage.expiry_start_date_error_hint"),before:Translator.trans("course.manage.expiry_days_error_hint")},expiryEndDate:{required:Translator.trans("course.manage.expiry_end_date_error_hint"),after:Translator.trans("course.manage.expiry_start_date_error_hint")}}});$.validator.addMethod("before",function(e,t,a){return"date"!==$('input[name="expiryMode"]:checked').val()||(!e||$(a).val()>e)},Translator.trans("course.manage.expiry_end_date_error_hint")),$.validator.addMethod("after",function(e,t,a){return"date"!==$('input[name="expiryMode"]:checked').val()||(!e||$(a).val()<e)},Translator.trans("course.manage.expiry_start_date_error_hint")),$("#course-submit").click(function(){a.form()&&(e.publishAddMessage(),t.submit())})}},{key:"publishAddMessage",value:function(){m.default.publish({channel:"courseInfoMultiInput",topic:"addMultiInput"})}},{key:"initDatePicker",value:function(e){var t=$(e);t.datetimepicker({format:"yyyy-mm-dd",language:document.documentElement.lang,minView:2,autoclose:!0,endDate:new Date(Date.now()+31536e7)}),t.datetimepicker("setStartDate",new Date)}},{key:"checkBoxChange",value:function(){$('input[name="expiryMode"]').on("change",function(e){"date"==$('input[name="expiryMode"]:checked').val()?($("#expiry-days").removeClass("hidden").addClass("hidden"),$("#expiry-date").removeClass("hidden")):($("#expiry-date").removeClass("hidden").addClass("hidden"),$("#expiry-days").removeClass("hidden"))})}}]),e}()),jQuery.validator.addMethod("max_year",function(e,t){return this.optional(t)||e<1e5},Translator.trans("course.manage.max_year_error_hint")),jQuery.validator.addMethod("live_capacity",function(e,t){var a=parseInt($(t).data("liveCapacity"));if(e>a){var n=Translator.trans("course.manage.max_capacity_hint",{capacity:a});$(t).parent().siblings(".js-course-rule").find("p").html(n)}else $(t).parent().siblings(".js-course-rule").find("p").html("");return!0})},d5edd94aba2c5d017a51:function(e,t,a){var n=a("d5edd94aba2c5d017a5d");"string"==typeof n&&(n=[[e.i,n,""]]);var r={insertAt:"top",hmr:!0};r.transform=void 0;a("3296c0d42e5b7cde21ad")(n,r);n.locals&&(e.exports=n.locals)},d5edd94aba2c5d017a5d:function(e,t,a){t=e.exports=a("e7f1add7f34e416618de")(void 0),t.push([e.i,".multi-group {\n  position: relative;\n}\n.multi-group .multi-list {\n  margin-bottom: 0;\n}\n.multi-group .list-group {\n  margin-bottom: 20px;\n}\n.multi-group .list-group .list-group-item {\n  padding: 10px 40px;\n  cursor: move;\n}\n.multi-group .list-group .drag-icon-btn,\n.multi-group .list-group .move-icon-btn {\n  position: absolute;\n}\n.multi-group .list-group .drag-icon-btn {\n  left: 10px;\n  top: 14px;\n}\n.multi-group .list-group .move-icon-btn {\n  right: 10px;\n  top: 10px;\n}\n.multi-group .list-group .move-icon-btn i {\n  font-size: 14px;\n}\n.multi-group .list-group .placeholder {\n  margin-bottom: 0;\n}\n.multi-group .list-group .label-name {\n  width: 160px;\n}\n",""])}},["a1c4a43f5d1c99d74a21"]);