webpackJsonp(["app/js/auth/captcha-modal/index"],{0:function(t,e){t.exports=jQuery},"0282bb17fb83bfbfed9b":function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("b334fd7e4c5a19234db2"),r=function(t){return t&&t.__esModule?t:{default:t}}(i),c=function(){function t(e){n(this,t),this.$element=$(e.element),this.validator=0,this.url=e.url?e.url:"",this.smsType=e.smsType?e.smsType:"",this.captchaNum=e.captchaNum?e.captchaNum:"captcha_num",this.captcha=!!e.captcha&&e.captcha,this.captchaValidated=!!e.captchaValidated&&e.captchaValidated,this.dataTo=e.dataTo?e.dataTo:"mobile",this.setup()}return s(t,[{key:"preSmsSend",value:function(){return!0}},{key:"setup",value:function(){this.captcha&&this.smsSend()}},{key:"postData",value:function(t,e){var a=this,n=function t(){var e=$("#js-time-left").html();$("#js-time-left").html(e-1),e-1>0?(a.$element.removeClass("disabled"),a.$element.addClass("disabled"),setTimeout(t,1e3)):($("#js-time-left").html(""),$("#js-fetch-btn-text").html(Translator.trans("获取短信验证码")),a.$element.removeClass("disabled"))};return a.$element.addClass("disabled"),$.post(t,e,function(t){void 0!==t.ACK&&"ok"==t.ACK?($("#js-time-left").html("120"),$("#js-fetch-btn-text").html(Translator.trans("秒后重新获取")),(0,r.default)("success",Translator.trans("发送短信成功")),n()):void 0!==t.error?(0,r.default)("danger",t.error):(0,r.default)("danger",Translator.trans("发送短信失败，请联系管理员"))}),this}},{key:"smsSend",value:function(){if($("#js-time-left").html().length>0)return!1;var t=this.url,e={};return e.to=$('[name="'+this.dataTo+'"]').val(),e.sms_type=this.smsType,!(this.captcha&&(e.captcha_num=$('[name="'+this.captchaNum+'"]').val(),!this.captchaValidated))&&(e=$.extend(e,e),this.preSmsSend()&&this.postData(t,e),this)}}]),t}();e.default=c},"1934f3cb54a74b8f6029":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("601020d4b7c53037d8f9"),s=a.n(n),i="",r="";$('input[name="set_bind_emailOrMobile"]').length>0?(i="set_bind_emailOrMobile",r="sms_registration"):$('input[name="mobile"]').length>0?(i="mobile",r=$("#password-reset-by-mobile-form").length>0?"sms_forget_password":$("#settings-find-pay-password-form").length>0?"sms_forget_pay_password":"sms_bind"):(i=null==$('[name="verifiedMobile"]').val()?"emailOrMobile":"verifiedMobile",r="sms_registration"),$("#captcha-form").find("#getcode_num").attr("src",$("#getcode_num").data("url")+"?"+Math.random());new s.a($("#captcha-form"),i,r,"captcha_num")},"601020d4b7c53037d8f9":function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("0282bb17fb83bfbfed9b"),r=function(t){return t&&t.__esModule?t:{default:t}}(i),c=function(){function t(e,a,s,i){n(this,t),this.$element=e,this.dataTo=a,this.smsType=s,this.captchaNum=i,this.CaptchaValidator=null,this.init()}return s(t,[{key:"init",value:function(){var t=this;this.$element.on("click","#getcode_num",function(e){return t.changeCaptcha(e)}),$(".js-captcha-btn").click(function(e){return t.submitForm(e)}),this.initValidator()}},{key:"changeCaptcha",value:function(t){var e=$(t.currentTarget);e.attr("src",e.data("url")+"?"+Math.random())}},{key:"submitForm",value:function(){this.CaptchaValidator.form()&&this.$element.submit()}},{key:"initValidator",value:function(){var t=this;this._captchaValidated=!1,this.CaptchaValidator=this.$element.validate({onkeyup:!1,onfocusout:!1,rules:{captcha_num:{required:!0,alphanumeric:!0}},messages:{captcha_num:{required:Translator.trans("请输入验证码")}},submitHandler:function(e){$.get(t.$element.attr("action"),{value:$("#captcha_num_modal").val()},function(e){if(e.success){t.$element.parents(".modal").modal("hide"),t._captchaValidated=!0;new r.default({element:".js-sms-send",url:$(".js-sms-send").data("smsUrl"),smsType:t.smsType,dataTo:t.dataTo,captchaNum:t.captchaNum,captcha:!0,captchaValidated:t._captchaValidated,preSmsSend:function(){return!0}});$(".js-sms-send").off("click")}else t._captchaValidated=!1,t.$element.find("#getcode_num").attr("src",$("#getcode_num").data("url")+"?"+Math.random()),t.$element.find(".help-block").html('<span class="color-danger">'+Translator.trans("验证码错误")+"</span>"),t.$element.find(".help-block").show()},"json")}}),$("#captcha_num_modal").keydown(function(e){13==e.keyCode&&t.CaptchaValidator.form()})}}]),t}();e.default=c}},["1934f3cb54a74b8f6029"]);