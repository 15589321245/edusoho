{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/audio/index.js"],"names":["Audio","$","inItStep2form","autoValidatorLength","initfileChooser","$step2_form","validator","data","validate","groups","nameGroup","rules","title","required","maxlength","trim","minute","second","messages","unsigned_integer","second_range","blur","form","parseInt","val","fileChooser","onSelectFile","file","length","Math","round","source","id","uri","on"],"mappings":";;;;AAAA;;;;AACA;;;;;;IAEMA,K;AACJ,mBAAc;AAAA;;AACZ,oCAAgBC,EAAE,uBAAF,CAAhB;AACA,SAAKC,aAAL;AACA,SAAKC,mBAAL;AACA,SAAKC,eAAL;AACD;;;;oCAEe;AACd,UAAIC,cAAcJ,EAAE,aAAF,CAAlB;AACA,UAAIK,YAAYD,YAAYE,IAAZ,CAAiB,WAAjB,CAAhB;;AAEAF,kBAAYG,QAAZ,CAAqB;AACnBC,gBAAQ;AACNC,qBAAW;AADL,SADW;AAInBC,eAAO;AACLC,iBAAO;AACLC,sBAAU,IADL;AAELC,uBAAW,EAFN;AAGLC,kBAAM;AAHD,WADF;AAMLC,kBAAQ,4CANH;AAOLC,kBAAQ,wCAPH;AAQL,0BAAgB;AARX,SAJY;AAcnBC,kBAAU;AACRF,kBAAQ;AACNH,sBAAU,OADJ;AAENM,8BAAkB;AAFZ,WADA;AAKRF,kBAAQ;AACNJ,sBAAU,OADJ;AAENO,0BAAc,YAFR;AAGND,8BAAkB;AAHZ,WALA;AAUR,0BAAgB;AAVR;AAdS,OAArB;AA4BD;;;0CAEqB;AACpBlB,QAAE,YAAF,EAAgBoB,IAAhB,CAAqB,YAAY;AAC/B,YAAIf,YAAYL,EAAE,aAAF,EAAiBM,IAAjB,CAAsB,WAAtB,CAAhB;AACA,YAAID,aAAaA,UAAUgB,IAAV,EAAjB,EAAmC;AACjC,cAAMN,SAASO,SAAStB,EAAE,SAAF,EAAauB,GAAb,EAAT,IAA+B,CAA9C;AACA,cAAMP,SAASM,SAAStB,EAAE,SAAF,EAAauB,GAAb,EAAT,IAA+B,CAA9C;AACAvB,YAAE,SAAF,EAAauB,GAAb,CAAiBR,SAAS,EAAT,GAAcC,MAA/B;AACD;AACF,OAPD;AAQD;;;sCAEiB;;AAEhB,UAAMQ,cAAc,0BAApB;;AAEA,UAAMC,eAAe,SAAfA,YAAe,OAAQ;AAC3B;AACA,YAAIC,KAAKC,MAAT,EAAiB;AACf,cAAIZ,SAASO,SAASI,KAAKC,MAAL,GAAc,EAAvB,CAAb;AACA,cAAIX,SAASY,KAAKC,KAAL,CAAWH,KAAKC,MAAL,GAAc,EAAzB,CAAb;AACA3B,YAAE,SAAF,EAAauB,GAAb,CAAiBR,MAAjB;AACAf,YAAE,SAAF,EAAauB,GAAb,CAAiBP,MAAjB;AACAhB,YAAE,SAAF,EAAauB,GAAb,CAAiBR,SAAS,EAAT,GAAcC,MAA/B;AACD;AACDhB,UAAE,uBAAF,EAA2BuB,GAA3B,CAA+BG,KAAKI,MAApC;AACA,YAAIJ,KAAKI,MAAL,IAAe,MAAnB,EAA2B;AACzB9B,YAAE,cAAF,EAAkBuB,GAAlB,CAAsBG,KAAKK,EAA3B;AACA/B,YAAE,eAAF,EAAmBuB,GAAnB,CAAuB,EAAvB;AACD,SAHD,MAGO;AACLvB,YAAE,cAAF,EAAkBuB,GAAlB,CAAsB,EAAtB;AACAvB,YAAE,eAAF,EAAmBuB,GAAnB,CAAuBG,KAAKM,GAA5B;AACD;AACF,OAjBD;;AAmBAR,kBAAYS,EAAZ,CAAe,QAAf,EAAyBR,YAAzB;AACD","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import FileChooser from '../../file-chooser/file-choose';\nimport { chooserUiOpen, chooserUiClose, showChooserType } from '../widget/chooser-ui.js';\n\nclass Audio {\n  constructor() {\n    showChooserType($('[name=\"ext[mediaId]\"]'));\n    this.inItStep2form();\n    this.autoValidatorLength();\n    this.initfileChooser();\n  }\n\n  inItStep2form() {\n    var $step2_form = $('#step2-form');\n    var validator = $step2_form.data('validator');\n\n    $step2_form.validate({\n      groups: {\n        nameGroup: 'minute second'\n      },\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n        },\n        minute: 'required unsigned_integer unsigned_integer',\n        second: 'required second_range unsigned_integer',\n        'ext[mediaId]': 'required'\n      },\n      messages: {\n        minute: {\n          required: '请输入时长',\n          unsigned_integer: '时长必须大于0'\n        },\n        second: {\n          required: '请输入时长',\n          second_range: '秒只能在0-59之间',\n          unsigned_integer: '时长必须大于0'\n        },\n        'ext[mediaId]': '请上传或选择%display%'\n      }\n    });\n\n  }\n\n  autoValidatorLength() {\n    $(\".js-length\").blur(function () {\n      let validator = $(\"#step2-form\").data('validator');\n      if (validator && validator.form()) {\n        const minute = parseInt($('#minute').val()) | 0;\n        const second = parseInt($('#second').val()) | 0;\n        $(\"#length\").val(minute * 60 + second);\n      }\n    });\n  }\n\n  initfileChooser() {\n\n    const fileChooser = new FileChooser();\n\n    const onSelectFile = file => {\n      chooserUiClose();\n      if (file.length) {\n        let minute = parseInt(file.length / 60);\n        let second = Math.round(file.length % 60);\n        $(\"#minute\").val(minute);\n        $(\"#second\").val(second);\n        $(\"#length\").val(minute * 60 + second);\n      }\n      $('[name=\"ext[mediaId]\"]').val(file.source);\n      if (file.source == 'self') {\n        $(\"#ext_mediaId\").val(file.id);\n        $(\"#ext_mediaUri\").val('');\n      } else {\n        $(\"#ext_mediaId\").val('');\n        $(\"#ext_mediaUri\").val(file.uri);\n      }\n    }\n\n    fileChooser.on('select', onSelectFile);\n  }\n\n}\n\n\n\n\n\n\n\n\n\n"]}