{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/index.js"],"names":["initItem","dataSourceUi","value","item","itemId","label","seq","length","outputValue","push","removeItem","i","splice","updateItemSeq","data","datas","temps","j","MultiInput","props","event","id","currentTarget","attributes","state","setState","sortItem","addItem","dataSource","map","index","outputSets","sortable","listClassName","inputName","searchable","addable","blurIsAdd","outputDataElement","list","getList","getOutputSets","showAddBtnGroup","JSON","stringify","propTypes","multiInputClassName","PropTypes","string","array","isRequired","bool","shape","enable","url","checkBoxName","defaultProps","childContextTypes","func"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;AAEA,SAASA,QAAT,CAAkBC,YAAlB,EAAgCC,KAAhC,EAAuC;AACrC,MAAIC,OAAO;AACTC,YAAQ,4BADC;AAETC,WAAOH,KAFE;AAGTI,SAAKL,aAAaM,MAAb,GAAsB,CAHlB;AAITC,iBAAaN;AAJJ,GAAX;AAMAD,eAAaQ,IAAb,CAAkBN,IAAlB;AACD;;AAED,SAASO,UAAT,CAAoBT,YAApB,EAAkCG,MAAlC,EAA0C;AACxC,OAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAIV,aAAaM,MAAjC,EAAyCI,GAAzC,EAA8C;AAC5C,QAAIV,aAAaU,CAAb,EAAgBP,MAAhB,IAA0BA,MAA9B,EAAsC;AACpCH,mBAAaW,MAAb,CAAoBD,CAApB,EAAuB,CAAvB;AACAA;AACD,KAHD,MAGO;AACLV,mBAAaU,CAAb,EAAgBL,GAAhB,GAAsBK,IAAI,CAA1B;AACD;AACF;AACF;;AAED,SAASE,aAAT,CAAuBC,IAAvB,EAA6BC,KAA7B,EAAoC;AAClC,MAAIC,QAAQ,EAAZ;AACA,OAAK,IAAIL,IAAI,CAAb,EAAgBA,IAAIG,KAAKP,MAAzB,EAAiCI,GAAjC,EAAsC;AACpC,SAAK,IAAIM,IAAI,CAAb,EAAgBA,IAAIF,MAAMR,MAA1B,EAAkCU,GAAlC,EAAuC;AACrC,UAAIH,KAAKH,CAAL,KAAWI,MAAME,CAAN,EAASb,MAAxB,EAAgC;AAC9BW,cAAME,CAAN,EAASX,GAAT,GAAeK,IAAI,CAAnB;AACAK,cAAMP,IAAN,CAAWM,MAAME,CAAN,CAAX;AACD;AACF;AACF;AACD,SAAOD,KAAP;AACD;;IAEoBE,U;;;AACnB,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA,wHACXA,KADW;;AAAA,UAqBnBT,UArBmB,GAqBN,UAACU,KAAD,EAAW;AACtB,UAAIC,KAAKD,MAAME,aAAN,CAAoBC,UAApB,CAA+B,cAA/B,EAA+CrB,KAAxD;AACAQ,iBAAW,MAAKc,KAAL,CAAWvB,YAAtB,EAAoCoB,EAApC;AACA,YAAKI,QAAL,CAAc;AACZxB,sBAAc,MAAKuB,KAAL,CAAWvB;AADb,OAAd;AAGD,KA3BkB;;AAAA,UA6BnByB,QA7BmB,GA6BR,UAACX,KAAD,EAAW;AACpB,YAAKS,KAAL,CAAWvB,YAAX,GAA0BY,cAAcE,KAAd,EAAqB,MAAKS,KAAL,CAAWvB,YAAhC,CAA1B;AACA,YAAKwB,QAAL,CAAc;AACZxB,sBAAc,MAAKuB,KAAL,CAAWvB;AADb,OAAd;AAGD,KAlCkB;;AAAA,UAoCnB0B,OApCmB,GAoCT,UAACzB,KAAD,EAAQY,IAAR,EAAiB;AACzBd,eAAS,MAAKwB,KAAL,CAAWvB,YAApB,EAAkCC,KAAlC;AACA,YAAKuB,QAAL,CAAc;AACZxB,sBAAc,MAAKuB,KAAL,CAAWvB;AADb,OAAd;AAGD,KAzCkB;;AAAA;AAElB;;;;yCAEoB;AAAA;;AACnB,WAAKuB,KAAL,GAAa;AACXvB,sBAAc;AADH,OAAb;AAGA,WAAKkB,KAAL,CAAWS,UAAX,CAAsBC,GAAtB,CAA0B,UAAC1B,IAAD,EAAO2B,KAAP,EAAiB;AACzC9B,iBAAS,OAAKwB,KAAL,CAAWvB,YAApB,EAAkCE,IAAlC;AACD,OAFD;AAGD;;;sCAEiB;AAChB,aAAO;AACLO,oBAAY,KAAKA,UADZ;AAELgB,kBAAU,KAAKA,QAFV;AAGLC,iBAAS,KAAKA;AAHT,OAAP;AAKD;;;oCAwBe;AACd;AACA,UAAII,aAAa,EAAjB;AACA,WAAKP,KAAL,CAAWvB,YAAX,CAAwB4B,GAAxB,CAA4B,UAAC1B,IAAD,EAAO2B,KAAP,EAAiB;AAC3CC,mBAAWtB,IAAX,CAAgBN,KAAKK,WAArB;AACD,OAFD;AAGA,aAAOuB,UAAP;AAED;;;8BAES;AAAA,mBACuC,KAAKZ,KAD5C;AAAA,UACAa,QADA,UACAA,QADA;AAAA,UACUC,aADV,UACUA,aADV;AAAA,UACyBC,SADzB,UACyBA,SADzB;;AAER,aAAQ,gDAAM,UAAUF,QAAhB,EAA0B,WAAWE,SAArC,EAAgD,eAAeD,aAA/D,EAA8E,cAAc,KAAKT,KAAL,CAAWvB,YAAvG,GAAR;AACD;;;6BAEQ;AAAA,oBACsD,KAAKkB,KAD3D;AAAA,UACCgB,UADD,WACCA,UADD;AAAA,UACaC,OADb,WACaA,OADb;AAAA,UACsBC,SADtB,WACsBA,SADtB;AAAA,UACiCC,iBADjC,WACiCA,iBADjC;;AAEP,UAAIC,OAAO,KAAKC,OAAL,EAAX;AACA,UAAIT,aAAa,KAAKU,aAAL,EAAjB;AACA,aACE;AAAA;AAAA,UAAK,WAAU,aAAf;AACGF,YADH;AAEG,aAAKpB,KAAL,CAAWuB,eAAX,IAA8B,sDAAY,YAAYP,UAAxB,EAAoC,SAASC,OAA7C,EAAsD,WAAWC,SAAjE,GAFjC;AAGE,iDAAO,MAAK,QAAZ,EAAqB,MAAMC,iBAA3B,EAA8C,OAAOK,KAAKC,SAAL,CAAeb,UAAf,CAArD;AAHF,OADF;AAOD;;;;;;kBAtEkBb,U;;;AAyErBA,WAAW2B,SAAX,GAAuB;AACrBC,uBAAqB,gBAAMC,SAAN,CAAgBC,MADhB;AAErBf,iBAAe,gBAAMc,SAAN,CAAgBC,MAFV;AAGrBpB,cAAY,gBAAMmB,SAAN,CAAgBE,KAAhB,CAAsBC,UAHb;AAIrBlB,YAAU,gBAAMe,SAAN,CAAgBI,IAJL;AAKrBf,WAAS,gBAAMW,SAAN,CAAgBI,IALJ;AAMrBd,aAAW,gBAAMU,SAAN,CAAgBI,IANN;AAOrBhB,cAAY,gBAAMY,SAAN,CAAgBK,KAAhB,CAAsB;AAChCC,YAAQ,gBAAMN,SAAN,CAAgBI,IADQ;AAEhCG,SAAK,gBAAMP,SAAN,CAAgBC;AAFW,GAAtB,CAPS;AAWrBN,mBAAiB,gBAAMK,SAAN,CAAgBI,IAXZ;AAYrBjB,aAAW,gBAAMa,SAAN,CAAgBC,MAZN;AAarBO,gBAAc,gBAAMR,SAAN,CAAgBC,MAbT;AAcrBV,qBAAmB,gBAAMS,SAAN,CAAgBC,MAdd,EAAvB;;AAiBA9B,WAAWsC,YAAX,GAA0B;AACxBV,uBAAqB,aADG;AAExBb,iBAAe,EAFS;AAGxBL,cAAY,EAHY;AAIxBI,YAAU,IAJc;AAKxBI,WAAS,IALe;AAMxBC,aAAW,KANa;AAOxBF,cAAY;AACVkB,YAAQ,KADE;AAEVC,SAAK;AAFK,GAPY;AAWxBZ,mBAAiB,IAXO;AAYxBR,aAAW,EAZa;AAaxBqB,gBAAc,UAbU;AAcxBjB,qBAAmB,cAdK,EAA1B;;AAiBApB,WAAWuC,iBAAX,GAA+B;AAC7B/C,cAAY,gBAAMqC,SAAN,CAAgBW,IADC;AAE7BhC,YAAU,gBAAMqB,SAAN,CAAgBW,IAFG;AAG7B/B,WAAS,gBAAMoB,SAAN,CAAgBW;AAHI,CAA/B","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport List from './list';\nimport InputGroup from './input-group';\nimport { getRandomString } from './part';\nimport '!style!css!less!./style.less';\n\nfunction initItem(dataSourceUi, value) {\n  let item = {\n    itemId: getRandomString(),\n    label: value,\n    seq: dataSourceUi.length + 1,\n    outputValue: value\n  };\n  dataSourceUi.push(item);\n}\n\nfunction removeItem(dataSourceUi, itemId) {\n  for (let i = 0; i < dataSourceUi.length; i++) {\n    if (dataSourceUi[i].itemId == itemId) {\n      dataSourceUi.splice(i, 1);\n      i--;\n    } else {\n      dataSourceUi[i].seq = i + 1;\n    }\n  }\n}\n\nfunction updateItemSeq(data, datas) {\n  let temps = [];\n  for (let i = 0; i < data.length; i++) {\n    for (let j = 0; j < datas.length; j++) {\n      if (data[i] == datas[j].itemId) {\n        datas[j].seq = i + 1;\n        temps.push(datas[j]);\n      }\n    }\n  }\n  return temps;\n}\n\nexport default class MultiInput extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentWillMount() {\n    this.state = {\n      dataSourceUi: [],\n    }\n    this.props.dataSource.map((item, index) => {\n      initItem(this.state.dataSourceUi, item);\n    })\n  }\n\n  getChildContext() {\n    return {\n      removeItem: this.removeItem,\n      sortItem: this.sortItem,\n      addItem: this.addItem,\n    }\n  }\n\n  removeItem = (event) => {\n    let id = event.currentTarget.attributes[\"data-item-id\"].value;\n    removeItem(this.state.dataSourceUi, id);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  sortItem = (datas) => {\n    this.state.dataSourceUi = updateItemSeq(datas, this.state.dataSourceUi);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  addItem = (value, data) => {\n    initItem(this.state.dataSourceUi, value);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  getOutputSets() {\n    //应该优化成表单数据进行填充\n    let outputSets = [];\n    this.state.dataSourceUi.map((item, index) => {\n      outputSets.push(item.outputValue);\n    })\n    return outputSets;\n\n  }\n\n  getList() {\n    const { sortable, listClassName, inputName } = this.props;\n    return (<List sortable={sortable} inputName={inputName} listClassName={listClassName} dataSourceUi={this.state.dataSourceUi}></List>);\n  }\n\n  render() {\n    const { searchable, addable, blurIsAdd, outputDataElement} = this.props;\n    let list = this.getList();\n    let outputSets = this.getOutputSets();\n    return (\n      <div className=\"multi-group\">\n        {list}\n        {this.props.showAddBtnGroup && <InputGroup searchable={searchable} addable={addable} blurIsAdd={blurIsAdd} />}\n        <input type='hidden' name={outputDataElement} value={JSON.stringify(outputSets)} />\n      </div>\n    );\n  }\n}\n\nMultiInput.propTypes = {\n  multiInputClassName: React.PropTypes.string,\n  listClassName: React.PropTypes.string,\n  dataSource: React.PropTypes.array.isRequired,\n  sortable: React.PropTypes.bool,\n  addable: React.PropTypes.bool,\n  blurIsAdd: React.PropTypes.bool,\n  searchable: React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n  showAddBtnGroup: React.PropTypes.bool,\n  inputName: React.PropTypes.string,\n  checkBoxName: React.PropTypes.string,\n  outputDataElement: React.PropTypes.string,//带删除字段\n};\n\nMultiInput.defaultProps = {\n  multiInputClassName: 'multi-group',\n  listClassName: '',\n  dataSource: [],\n  sortable: true,\n  addable: true,\n  blurIsAdd: false,\n  searchable: {\n    enable: false,\n    url: '',\n  },\n  showAddBtnGroup: true,\n  inputName: '',\n  checkBoxName: 'visible_',\n  outputDataElement: 'hidden-input',//带删除字段\n};\n\nMultiInput.childContextTypes = {\n  removeItem: React.PropTypes.func,\n  sortItem: React.PropTypes.func,\n  addItem: React.PropTypes.func,\n};\n\n\n"]}