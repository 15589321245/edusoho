{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/input-group.js"],"names":["InputGroup","props","state","itemName","searched","resultful","searchResult","console","log","context","subscribeMessage","subscribe","channel","topic","callback","handleAdd","name","data","addItem","setState","event","value","currentTarget","searchable","enable","length","setTimeout","url","itemData","handleNameChange","onFocus","blurAdd","selectChange","addable","contextTypes","PropTypes","func","bool","shape","string"],"mappings":"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","file":"input-group.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport { trim } from '../../unit';\nimport { send } from '../../server';\nimport Options from './options';\nimport postal from 'postal';\n\nexport default class InputGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      itemName: \"\",\n      searched: true,\n      resultful: false,\n      searchResult: [],\n    }\n\n    console.log(this.context);\n\n    \n    this.subscribeMessage();\n  }\n\n  subscribeMessage() {\n    postal.subscribe({\n      channel: \"courseInfoMultiInput\",\n      topic: \"addMultiInput\",\n      callback: () => {\n        console.log('add');\n        this.handleAdd();\n      }\n    });\n  }\n\n  selectChange(name, data) {\n    if (data) {\n      this.context.addItem(name, data);\n    }\n    this.setState({\n      itemName: '',\n    });\n  }\n\n  onFocus(event) {\n    //在这种情况下，重新开启搜索功能；\n    this.setState({\n      searched: true,\n    })\n  }\n\n  handleNameChange(event) {\n    // let value = trim(event.currentTarget.value);\n    let value = event.currentTarget.value;\n    this.setState({\n      itemName: value,\n      searchResult: [],\n      resultful: false,\n    });\n\n    if (this.context.searchable.enable && value.length > 0 && this.state.searched) {\n      setTimeout(() => {\n        send(this.context.searchable.url + value, searchResult => {\n          if (this.state.itemName.length > 0) {\n            console.log({ 'searchResult': searchResult });\n            this.setState({\n              searchResult: searchResult,\n              resultful: true,\n            });\n          }\n        });\n      }, 100)\n    }\n  }\n\n  handleAdd() {\n    if (trim(this.state.itemName).length > 0) {\n      this.context.addItem(this.state.itemName, this.state.itemData);\n    }\n    this.setState({\n      itemName: '',\n      searchResult: [],\n      resultful: false,\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"input-group\">\n        <input className=\"form-control\" value={this.state.itemName} onChange={event => this.handleNameChange(event)} onFocus={event => this.onFocus(event)} onBlur={event => this.blurAdd(event)} />\n        {this.context.searchable.enable && this.state.resultful && <Options searchResult={this.state.searchResult} selectChange={(event, name) => this.selectChange(event, name)} resultful={this.state.resultful} />}\n        {this.context.addable && <span className=\"input-group-btn\"><a className=\"btn btn-default\" onClick={() => this.handleAdd()}>添加</a></span>}\n      </div>\n    );\n  }\n}\n\nInputGroup.contextTypes = {\n  addItem: React.PropTypes.func,\n  addable: React.PropTypes.bool,\n  searchable:  React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n};\n"]}