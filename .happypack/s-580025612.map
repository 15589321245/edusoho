{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/create/index.js"],"names":["jQuery","validator","addMethod","value","element","optional","Creator","init","_initDatePicker","$","on","event","val","removeClass","addClass","$form","validate","onkeyup","groups","date","rules","title","required","expiryDays","digits","max_year","expiryStartDate","before","expiryEndDate","after","messages","Translator","trans","params","click","evt","form","currentTarget","button","submit","$id","$picker","datetimepicker","format","language","minView","autoclose","endDate","Date","now"],"mappings":";;;;AAAA;;AACA;;;;AAGAA,OAAOC,SAAP,CAAiBC,SAAjB,CAA2B,UAA3B,EAAuC,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AAC/D,SAAO,KAAKC,QAAL,CAAcD,OAAd,KAA0BD,QAAQ,MAAzC;AACD,CAFD,EAEG,mBAFH;;IAWMG,O;AACJ,qBAAc;AAAA;;AACZ,SAAKC,IAAL;AACD;;;;2BAEM;AACL;AACA,WAAKC,eAAL,CAAqB,kBAArB;AACA,WAAKA,eAAL,CAAqB,gBAArB;AACA;;AAEAC,QAAE,0BAAF,EAA8BC,EAA9B,CAAiC,QAAjC,EAA2C,UAASC,KAAT,EAAe;AACxD,YAAGF,EAAE,kCAAF,EAAsCG,GAAtC,MAA+C,MAAlD,EAAyD;AACvDH,YAAE,cAAF,EAAkBI,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACAL,YAAE,cAAF,EAAkBI,WAAlB,CAA8B,QAA9B;AACD,SAHD,MAGK;AACHJ,YAAE,cAAF,EAAkBI,WAAlB,CAA8B,QAA9B,EAAwCC,QAAxC,CAAiD,QAAjD;AACAL,YAAE,cAAF,EAAkBI,WAAlB,CAA8B,QAA9B;AACD;AACF,OARD;;AAUAJ,QAAE,yBAAF,EAA6BC,EAA7B,CAAgC,QAAhC,EAA0C,UAASC,KAAT,EAAe;AACvD,YAAGF,EAAE,iCAAF,EAAqCG,GAArC,MAA8C,UAAjD,EAA4D;AAC1DH,YAAE,oBAAF,EAAwBI,WAAxB,CAAoC,QAApC,EAA8CC,QAA9C,CAAuD,QAAvD;AACAL,YAAE,oBAAF,EAAwBI,WAAxB,CAAoC,QAApC;AACD,SAHD,MAGK;AACHJ,YAAE,oBAAF,EAAwBI,WAAxB,CAAoC,QAApC,EAA8CC,QAA9C,CAAuD,QAAvD;AACAL,YAAE,oBAAF,EAAwBI,WAAxB,CAAoC,QAApC;AACD;AACF,OARD;;AAUA,UAAIE,QAAQN,EAAE,qBAAF,CAAZ;AACA;AACA,UAAIR,YAAYc,MAAMC,QAAN,CAAe;AAC7BC,iBAAS,KADoB;AAE7BC,gBAAQ;AACNC,gBAAM;AADA,SAFqB;AAK7BC,eAAO;AACLC,iBAAO;AACLC,sBAAU;AADL,WADF;AAILC,sBAAY;AACVD,sBAAU,uBADA;AAEVE,oBAAQ,IAFE;AAGVC,sBAAU;AAHA,WAJP;AASLC,2BAAiB;AACfJ,sBAAU,uBADK;AAEfH,kBAAM,IAFS;AAGfQ,oBAAQ;AAHO,WATZ;AAcLC,yBAAe;AACbN,sBAAU,uBADG;AAEbH,kBAAM,IAFO;AAGbU,mBAAO;AAHM;AAdV,SALsB;AAyB7BC,kBAAU;AACRT,iBAAOU,WAAWC,KAAX,CAAiB,aAAjB,CADC;AAERN,2BAAiB;AACfJ,sBAAUS,WAAWC,KAAX,CAAiB,SAAjB,CADK;AAEfL,oBAAQI,WAAWC,KAAX,CAAiB,aAAjB;AAFO,WAFT;AAMRJ,yBAAe;AACbN,sBAAUS,WAAWC,KAAX,CAAiB,SAAjB,CADG;AAEbH,mBAAOE,WAAWC,KAAX,CAAiB,aAAjB;AAFM;AANP;AAzBmB,OAAf,CAAhB;;AAsCAvB,QAAER,SAAF,CAAYC,SAAZ,CACE,QADF,EAEE,UAASC,KAAT,EAAgBC,OAAhB,EAAyB6B,MAAzB,EAAiC;AAC/B,YAAIxB,EAAE,kCAAF,EAAsCG,GAAtC,OAAgD,MAApD,EAA4D;AAC1D,iBAAO,IAAP;AACD;AACD,eAAOT,SAASM,EAAEwB,MAAF,EAAUrB,GAAV,MAAmBT,KAAnC;AACD,OAPH,EAQE4B,WAAWC,KAAX,CAAiB,aAAjB,CARF;;AAWAvB,QAAER,SAAF,CAAYC,SAAZ,CACE,OADF,EAEE,UAASC,KAAT,EAAgBC,OAAhB,EAAyB6B,MAAzB,EAAiC;AAC/B,YAAIxB,EAAE,kCAAF,EAAsCG,GAAtC,OAAgD,MAApD,EAA4D;AAC1D,iBAAO,IAAP;AACD;AACD,eAAOT,SAASM,EAAEwB,MAAF,EAAUrB,GAAV,MAAmBT,KAAnC;AACD,OAPH,EAQE4B,WAAWC,KAAX,CAAiB,aAAjB,CARF;;AAWAvB,QAAE,gBAAF,EAAoByB,KAApB,CAA0B,UAASC,GAAT,EAAc;AACtC,YAAIlC,UAAUmC,IAAV,EAAJ,EAAsB;AACpB3B,YAAE0B,IAAIE,aAAN,EAAqBC,MAArB,CAA4B,SAA5B;AACAvB,gBAAMwB,MAAN;AACD;AACF,OALD;AAMD;;;oCAEeC,G,EAAK;AACnB,UAAIC,UAAUhC,EAAE+B,GAAF,CAAd;AACAC,cAAQC,cAAR,CAAuB;AACrBC,gBAAQ,YADa;AAErBC,kBAAU,IAFW;AAGrBC,iBAAS,CAHY,EAGT;AACZC,mBAAW,IAJU;AAKrBC,iBAAS,IAAIC,IAAJ,CAASA,KAAKC,GAAL,KAAa,QAAM,GAAN,GAAU,GAAV,GAAc,IAApC;AALY,OAAvB;AAOAR,cAAQC,cAAR,CAAuB,cAAvB,EAAuC,IAAIM,IAAJ,EAAvC;AACD;;;;;;AAGH,IAAI1C,OAAJ","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import { TabChange } from '../help';\nimport { initTooltips } from 'common/utils';\n \n\njQuery.validator.addMethod(\"max_year\", function (value, element) {\n  return this.optional(element) || value < 100000;\n}, \"有效期最大值不能超过99,999天\");\n\n\n\n\n\n\n\n\nclass Creator {\n  constructor() {\n    this.init();\n  }\n\n  init() {\n    //init UI\n    this._initDatePicker('#expiryStartDate');\n    this._initDatePicker('#expiryEndDate');\n    TabChange();\n\n    $('input[name=\"expiryMode\"]').on('change', function(event){\n      if($('input[name=\"expiryMode\"]:checked').val() == 'date'){\n        $('#expiry-days').removeClass('hidden').addClass('hidden');\n        $('#expiry-date').removeClass('hidden');\n      }else{\n        $('#expiry-date').removeClass('hidden').addClass('hidden');\n        $('#expiry-days').removeClass('hidden');\n      }\n    }); \n\n    $('input[name=\"learnMode\"]').on('change', function(event){\n      if($('input[name=\"learnMode\"]:checked').val() == 'freeMode'){\n        $('#learnLockModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnFreeModeHelp').removeClass('hidden');\n      }else{\n        $('#learnFreeModeHelp').removeClass('hidden').addClass('hidden');\n        $('#learnLockModeHelp').removeClass('hidden');\n      }\n    }); \n\n    let $form = $(\"#course-create-form\");\n    //init validator\n    let validator = $form.validate({\n      onkeyup: false,\n      groups: {\n        date: 'expiryStartDate expiryEndDate'\n      },\n      rules: {\n        title: {\n          required: true\n        },\n        expiryDays: {\n          required: '#expiryByDays:checked',\n          digits: true,\n          max_year: true\n        },\n        expiryStartDate: {\n          required: '#expiryByDate:checked',\n          date: true,\n          before: '#expiryEndDate'\n        },\n        expiryEndDate: {\n          required: '#expiryByDate:checked',\n          date: true,\n          after: '#expiryStartDate'\n        }\n      },\n      messages: {\n        title: Translator.trans('请输入教学计划课程标题'),\n        expiryStartDate: {\n          required: Translator.trans('请输入开始日期'),\n          before: Translator.trans('开始日期应早于结束日期')\n        },\n        expiryEndDate: {\n          required: Translator.trans('请输入结束日期'),\n          after: Translator.trans('结束日期应晚于开始日期')\n        }\n      }\n    });\n\n    $.validator.addMethod(\n      \"before\",\n      function(value, element, params) {\n        if ($('input[name=\"expiryMode\"]:checked').val() !== 'date') {\n          return true;\n        }\n        return value && $(params).val() >= value;\n      },\n      Translator.trans('开始日期应早于结束日期')\n    );\n\n    $.validator.addMethod(\n      \"after\",\n      function(value, element, params) {\n        if ($('input[name=\"expiryMode\"]:checked').val() !== 'date') {\n          return true;\n        }\n        return value && $(params).val() <= value;\n      },\n      Translator.trans('结束日期应晚于开始日期')\n    );\n\n    $('#course-submit').click(function(evt) {\n      if (validator.form()) {\n        $(evt.currentTarget).button('loading');\n        $form.submit();\n      }\n    });\n  }\n\n  _initDatePicker($id) {\n    let $picker = $($id);\n    $picker.datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: \"zh\",\n      minView: 2, //month\n      autoclose: true,\n      endDate: new Date(Date.now() + 86400*365*100*1000)\n    });\n    $picker.datetimepicker('setStartDate', new Date());\n  }\n}\n\nnew Creator();\n"]}