{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/audio/index.js"],"names":["jQuery","validator","addMethod","value","element","optional","test","console","log","parseInt","$","val","_inItStep2form","$step2_form","data","validate","groups","nameGroup","rules","title","required","maxlength","minute","second","messages","time_length","time_range","blur","form","fileChooser","onSelectFile","file","length","Math","round","source","id","uri","on"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import FileChooser from '../../file-chooser/file-choose';\nimport {chooserUiOpen, chooserUiClose, showChooserType} from '../widget/chooser-ui.js';\n\njQuery.validator.addMethod(\"unsigned_integer\", function (value, element) {\n  return this.optional(element) || /^([1-9]\\d*|0)$/.test(value);\n}, \"必须为非负整数\");\n\njQuery.validator.addMethod(\"time_range\", function (value, element) {\n  console.log(value, this.optional(element), /^([0-9]|[012345][0-9]|59)$/.test(value));\n  return this.optional(element) || /^([0-9]|[012345][0-9]|59)$/.test(value);\n}, \"只能在0-59之间\");\n\njQuery.validator.addMethod(\"time_length\", function (value, element) {\n  return parseInt($(\"#minute\").val()) + parseInt($(\"#second\").val()) > 0\n}, \"时长不能等于0\");\n\n\nshowChooserType($('[name=\"ext[mediaId]\"]'));\n\n\nfunction _inItStep2form() {\n  var $step2_form = $('#step2-form');\n  var validator = $step2_form.data('validator');\n\n  $step2_form.validate({\n    groups: {\n      nameGroup: 'minute second'\n    },\n    rules: {\n      title: {\n        required: true,\n        maxlength: 50,\n      },\n      minute: 'required unsigned_integer time_length',\n      second: 'required time_range time_length',\n      'ext[mediaId]': 'required'\n    },\n    messages: {\n      minute: {\n        required: '请输入时长',\n        time_length: '时长必须大于0'\n      },\n      second: {\n        required: '请输入时长',\n        time_range: '秒只能在0-59之间',\n        time_length: '时长必须大于0'\n      },\n      'ext[mediaId]': '请上传或选择%display%'\n    }\n  });\n\n}\n\n_inItStep2form();\n\n$(\".js-length\").blur(function () {\n  let validator = $(\"#step2-form\").data('validator');\n  if (validator && validator.form()) {\n    const minute = parseInt($('#minute').val()) | 0;\n    const second = parseInt($('#second').val()) | 0;\n    $(\"#media-length\").val(minute * 60 + second);\n  }\n});\n\nconst fileChooser = new FileChooser();\n\nconst onSelectFile = file => {\n  chooserUiClose();\n  if (file.length) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#media-length\").val(minute * 60 + second);\n  }\n  $('[name=\"ext[mediaId]\"]').val(file.source);\n  if (file.source == 'self') {\n    $(\"#ext_mediaId\").val(file.id);\n    $(\"#ext_mediaUri\").val('');\n  } else {\n    $(\"#ext_mediaId\").val('');\n    $(\"#ext_mediaUri\").val(file.uri);\n  }\n}\n\nfileChooser.on('select', onSelectFile);\n"]}