{"version":3,"sources":["app/Resources/static-src/app/js/activity/video/index.js"],"names":["VideoPlay","player","emitter","$","length","_playerSwf","_playVideo","swf_dom","embedSWF","data","wmode","allowFullScreen","messenger","name","project","children","type","on","msg","playing","_onFinishLearnTask","currentTime","emit","then","console","log","catch","error","videoplay","play"],"mappings":";;qjBAAA;;;;;AAGA;;;;AACA;;;;AACA;;;;;;;;IACMA,S;AACJ,uBAAc;AAAA;;AACZ,SAAKC,MAAL,GAAc,EAAd;AACA,SAAKC,OAAL,GAAe,+BAAf;AACD;;;;2BAEM;AACL,UAAIC,EAAE,aAAF,EAAiBC,MAArB,EAA6B;AAC3B,aAAKC,UAAL;AACD,OAFD,MAEO;AACL,aAAKC,UAAL;AACD;AACF;;;iCAEY;AACX,UAAMC,UAAU,YAAhB;AACA,4BAAUC,QAAV,CAAmBL,EAAE,MAAMI,OAAR,EAAiBE,IAAjB,CAAsB,KAAtB,CAAnB,EACEF,OADF,EACW,MADX,EACmB,MADnB,EAC2B,OAD3B,EACoC,IADpC,EAC0C,IAD1C,EACgD;AAC5CG,eAAO,QADqC;AAE5CC,yBAAiB;AAF2B,OADhD;AAKD;;;iCAEY;AAAA;;AACX,UAAIC,YAAY,wBAAgB;AAC9BC,cAAM,QADwB;AAE9BC,iBAAS,eAFqB;AAG9BC,kBAAU,EAHoB;AAI9BC,cAAM;AAJwB,OAAhB,CAAhB;;AAOAJ,gBAAUK,EAAV,CAAa,OAAb,EAAsB,UAACC,GAAD,EAAS;AAC7B,cAAKjB,MAAL,CAAYkB,OAAZ,GAAsB,KAAtB;AACA,cAAKC,kBAAL,CAAwBF,GAAxB;AACD,OAHD;;AAKAN,gBAAUK,EAAV,CAAa,SAAb,EAAwB,UAACC,GAAD,EAAS;AAC/B,cAAKjB,MAAL,CAAYkB,OAAZ,GAAsB,IAAtB;AACD,OAFD;;AAIAP,gBAAUK,EAAV,CAAa,QAAb,EAAuB,UAACC,GAAD,EAAS;AAC9B,cAAKjB,MAAL,CAAYkB,OAAZ,GAAsB,KAAtB;AACD,OAFD;;AAIAP,gBAAUK,EAAV,CAAa,YAAb,EAA2B,UAACC,GAAD,EAAS;AAClC,cAAKjB,MAAL,CAAYoB,WAAZ,GAA0BH,IAAIG,WAA9B;AACD,OAFD;AAGD;;;uCAEkBH,G,EAAK;AACtB,WAAKhB,OAAL,CAAaoB,IAAb,CAAkB,QAAlB,EAA4B,EAAEb,MAAMS,GAAR,EAA5B,EAA2CK,IAA3C,CAAgD,YAAM;AACpDC,gBAAQC,GAAR,CAAY,cAAZ;AACD,OAFD,EAEGC,KAFH,CAES,UAACC,KAAD,EAAW;AAClBH,gBAAQG,KAAR,CAAcA,KAAd;AACD,OAJD;AAKD;;;;;;AAIH,IAAIC,YAAY,IAAI5B,SAAJ,EAAhB;AACA4B,UAAUC,IAAV","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["/**\n * Created by Simon on 08/11/2016.\n */\nimport swfobject from 'es-swfobject';\nimport EsMessenger from '../../../common/messenger';\nimport ActivityEmitter from '../../activity/activity-emitter';\nclass VideoPlay {\n  constructor() {\n    this.player = {};\n    this.emitter = new ActivityEmitter();\n  }\n\n  play() {\n    if ($('#swf-player').length) {\n      this._playerSwf();\n    } else {\n      this._playVideo();\n    }\n  }\n\n  _playerSwf() {\n    const swf_dom = 'swf-player';\n    swfobject.embedSWF($('#' + swf_dom).data('url'),\n      swf_dom, '100%', '100%', \"9.0.0\", null, null, {\n        wmode: 'opaque',\n        allowFullScreen: 'true'\n      });\n  }\n\n  _playVideo() {\n    var messenger = new EsMessenger({\n      name: 'parent',\n      project: 'PlayerProject',\n      children: [],\n      type: 'parent'\n    });\n\n    messenger.on(\"ended\", (msg) => {\n      this.player.playing = false;\n      this._onFinishLearnTask(msg);\n    });\n\n    messenger.on(\"playing\", (msg) => {\n      this.player.playing = true;\n    });\n\n    messenger.on(\"paused\", (msg) => {\n      this.player.playing = false;\n    });\n\n    messenger.on(\"timechange\", (msg) => {\n      this.player.currentTime = msg.currentTime;\n    })\n  }\n\n  _onFinishLearnTask(msg) {\n    this.emitter.emit('finish', { data: msg }).then(() => {\n      console.log('vidoe.finish');\n    }).catch((error) => {\n      console.error(error);\n    });\n  }\n\n\n}\nlet videoplay = new VideoPlay();\nvideoplay.play();\n"]}