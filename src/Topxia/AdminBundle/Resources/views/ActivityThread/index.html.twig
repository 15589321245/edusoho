{% extends 'TopxiaAdminBundle:Activity:layout.html.twig' %}

{% block title %}提问管理 - {{ parent() }}{% endblock %}

{% set script_controller = 'activity/threads' %}

{% set menu = 'thread' %}

{% block main %}

<div class="page-header clearfix">
  <h1 class="pull-left">提问管理</h1>
</div>

<div class="well well-sm">
  <form class="form-inline">
    <div class="form-group">
      <input class="form-control" type="text" placeholder="作者昵称" name="author" value="{{ app.request.get('author') }}">
    </div>

    <span class="divider"></span>

    <div class="form-group">
      <select class="form-control" name="keywordType">
        {{ select_options({title:'标题', content: '内容', activityId:'活动编号'}, app.request.get('keywordType')) }}
      </select>
    </div>

    <div class="form-group">
      <input class="form-control" type="text" placeholder="关键词" name="keyword" value="{{ app.request.get('keyword') }}">
    </div>

    <button class="btn btn-primary" type="submit">搜索</button>
  </form>
</div>

  <div id="thread-table-container">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th width="5%"><input type="checkbox" data-role="batch-select"></th>
          <th width="60%">帖子</th>
          <th width="10%">回复</th>
          <th width="15%">作者</th>
          <th width="10%">操作</th>
        </tr>
      </thead>
      <body>
        {% for thread in threads %}
          {% set author = users[thread.userId]|default(null) %}
          {% set activity = activitys[thread.activityId]|default(null) %}
          <tr data-role="item">
            <td><input value="{{thread.id}}" type="checkbox" data-role="batch-item"> </td>
            <td>
             
             <strong>{{ thread.content }}</strong>


              <div class="text-sm mts">
                {% if activity %}
                  <a href="{{ path('activity_show', {id:activity.id}) }}" class="text-success" target="_blank">{{ activity.title }}</a>
                 
                {% endif %}
              </div>
         
            </td>
            <td><span class="text-sm">{{ thread.postNum }}</span></td>
            <td>
              {{ admin_macro.user_link(author) }} <br />
              <span class="text-muted text-sm">{{ thread.createdTime|date('Y-n-d H:i:s') }}</span>
            </td>
            <td><button class="btn btn-default btn-sm" data-role="item-delete" data-name="帖子" data-url="{{ path('admin_activity_thread_delete', {id:thread.id}) }}">删除</button></td>
          </tr>
        {% else %}
          <tr><td colspan="5"><div class="empty">无帖子记录</div></td></tr>
        {% endfor %}
      </body>
    </table>

    <div class="mbm">
        <label class="checkbox-inline"><input type="checkbox" data-role="batch-select"> 全选</label>
        <button class="btn btn-default btn-sm mlm" data-role="batch-delete" data-name="帖子" data-url="{{ path('admin_activity_thread_batch_delete') }}">删除</button>
    </div>

  </div>
    
  {{ web_macro.paginator(paginator) }}
{% endblock %}
