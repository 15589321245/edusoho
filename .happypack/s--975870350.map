{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 478d35d1ddae27796fef","webpack:///./src/index.js","webpack:///external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///external \"postal\"","webpack:///./src/postal-utils.js","webpack:///./src/packingSlips.js","webpack:///./src/state.js","webpack:///./src/handlers.js","webpack:///./src/filters.js","webpack:///./src/FederationClient.js"],"names":[],"mappings":"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","file":"postal.federation.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"postal\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"postal\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postalFedx\"] = factory(require(\"lodash\"), require(\"postal\"));\n\telse\n\t\troot[\"postalFedx\"] = factory(root[\"_\"], root[\"postal\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 478d35d1ddae27796fef\n **/","import _ from \"lodash\";\nimport postal from \"postal\";\nimport \"./postal-utils\";\nimport { packingSlips, getPackingSlip } from \"./packingSlips\";\nimport { state, disconnect, NO_OP, configure } from \"./state\";\nimport { handlers, onFederatedMsg } from \"./handlers\";\nimport filters, { matchesFilter, addFilter, removeFilter } from \"./filters\";\nimport FederationClient from \"./FederationClient\";\n\nconst fedx = postal.fedx = {\n\tFederationClient: FederationClient,\n\tpackingSlips: packingSlips,\n\thandlers: handlers,\n\tclients: state._clients,\n\ttransports: state._transports,\n\tfilters,\n\taddFilter,\n\tremoveFilter,\n\tcanSendRemote: function( channel, topic ) {\n\t\treturn matchesFilter( channel, topic, \"out\" );\n\t},\n\tconfigure: configure,\n\tgetPackingSlip,\n\tonFederatedMsg: onFederatedMsg,\n\tsendMessage: function( envelope ) {\n\t\tif ( !state._ready ) {\n\t\t\tstate._outboundQueue.push( arguments );\n\t\t\treturn;\n\t\t}\n\t\t_.each( this.transports, function( transport ) {\n\t\t\ttransport.sendMessage( envelope );\n\t\t} );\n\t},\n\tdisconnect: disconnect,\n\t_getTransports: function() {\n\t\treturn _.reduce( this.transports, function( memo, transport, name ) {\n\t\t\tmemo[name] = true;\n\t\t\treturn memo;\n\t\t}, {} );\n\t},\n\t/*\n\t\tsignalReady( callback );\n\t\tsignalReady( \"transportName\" );\n\t\tsignalReady( \"transportName\", callback );\n\t\tsignalReady( \"transportName\", targetInstance, callback ); <-- this is NEW\n\t\tsignalReady( { transportNameA: targetsForA, transportNameB: targetsForB, transportC: true }, callback);\n\t*/\n\tsignalReady: function( transport, target, callback ) {\n\t\tif ( !state._ready ) {\n\t\t\tstate._signalQueue.push( arguments );\n\t\t\treturn;\n\t\t}\n\t\tlet transports = this._getTransports();\n\t\tswitch ( arguments.length ) {\n\t\tcase 1:\n\t\t\tif ( typeof transport === \"function\" ) {\n\t\t\t\tcallback = transport;\n\t\t\t} else if ( typeof transport === \"string\" ) {\n\t\t\t\ttransports = {};\n\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t\tcallback = NO_OP;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tif ( typeof transport === \"string\" ) {\n\t\t\t\ttransports = {};\n\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t} else {\n\t\t\t\ttransports = transport;\n\t\t\t}\n\t\t\tcallback = target || NO_OP;\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\ttransports = {};\n\t\t\ttransports[transport] = [ target ];\n\t\t\tbreak;\n\t\t}\n\t\t_.each( transports, function( targets, name ) {\n\t\t\ttargets = typeof targets === \"boolean\" ? [] : targets;\n\t\t\tthis.transports[name].signalReady( targets, callback );\n\t\t}, this );\n\t}\n};\n\nexport default fedx;\n\nfunction processSignalQ( args ) {\n\tfedx.signalReady.apply( this, args );\n}\n\nfunction processOutboundQ( args ) {\n\tfedx.send.apply( this, args );\n}\n\nfunction processInboundQ( msg ) {\n\tfedx.onFederatedMsg.call( this, msg );\n}\n\npostal.addWireTap( function( data, envelope ) {\n\tif ( fedx.canSendRemote( envelope.channel, envelope.topic ) ) {\n\t\tfedx.sendMessage( envelope );\n\t}\n} );\n\npostal.subscribe( {\n\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\ttopic: \"instanceId.changed\",\n\tcallback: function() {\n\t\tstate._ready = true;\n\t\twhile ( state._signalQueue.length ) {\n\t\t\tprocessSignalQ( state._signalQueue.shift() );\n\t\t}\n\t\twhile ( state._outboundQueue.length ) {\n\t\t\tprocessOutboundQ( state._outboundQueue.shift() );\n\t\t}\n\t\twhile ( state._inboundQueue.length ) {\n\t\t\tprocessInboundQ( state._inboundQueue.shift() );\n\t\t}\n\t}\n} );\n\nif ( postal.instanceId() !== undefined ) {\n\tstate._ready = true;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"postal\"\n ** module id = 2\n ** module chunks = 0\n **/","import postal from \"postal\";\n\nif ( !postal.createUUID ) {\n\tpostal.createUUID = function() {\n\t\tlet s = [];\n\t\tconst hexDigits = \"0123456789abcdef\";\n\t\tfor ( let i = 0; i < 36; i++ ) {\n\t\t\ts[i] = hexDigits.substr( Math.floor( Math.random() * 0x10 ), 1 );\n\t\t}\n\t\ts[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n\t\t/* jshint ignore:start */\n\t\ts[19] = hexDigits.substr( ( s[19] & 0x3 ) | 0x8, 1 ); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\t\t/* jshint ignore:end */\n\t\ts[8] = s[13] = s[18] = s[23] = \"-\";\n\t\treturn s.join( \"\" );\n\t};\n}\nif ( !postal.instanceId ) {\n\tpostal.instanceId = ( function() {\n\t\tlet _id, _oldId;\n\t\treturn function( id ) {\n\t\t\tif ( id ) {\n\t\t\t\t_oldId = _id;\n\t\t\t\t_id = id;\n\t\t\t\tpostal.publish( {\n\t\t\t\t\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\t\t\t\t\ttopic: \"instanceId.changed\",\n\t\t\t\t\tdata: {\n\t\t\t\t\t\toldId: _oldId,\n\t\t\t\t\t\tnewId: _id\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn _id;\n\t\t};\n\t}() );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/postal-utils.js\n **/","import postal from \"postal\";\n\nexport function getPackingSlip( type /*, env */ ) {\n\tif ( Object.prototype.hasOwnProperty.call( packingSlips, type ) ) {\n\t\treturn packingSlips[ type ].apply( this, Array.prototype.slice.call( arguments, 1 ) );\n\t}\n}\n\nexport const packingSlips = {\n\tping: function() {\n\t\treturn {\n\t\t\ttype: \"federation.ping\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tticket: postal.createUUID()\n\t\t};\n\t},\n\tpong: function( ping ) {\n\t\treturn {\n\t\t\ttype: \"federation.pong\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tpingData: {\n\t\t\t\tinstanceId: ping.instanceId,\n\t\t\t\ttimeStamp: ping.timeStamp,\n\t\t\t\tticket: ping.ticket\n\t\t\t}\n\t\t};\n\t},\n\tmessage: function( env ) {\n\t\treturn {\n\t\t\ttype: \"federation.message\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tenvelope: env\n\t\t};\n\t},\n\tdisconnect: function() {\n\t\treturn {\n\t\t\ttype: \"federation.disconnect\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date()\n\t\t};\n\t},\n\tbundle: function( packingSlips ) {\n\t\treturn {\n\t\t\ttype: \"federation.bundle\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tpackingSlips: packingSlips\n\t\t};\n\t}\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/packingSlips.js\n **/","import _ from \"lodash\";\n\nconst _defaults = {\n\tenabled: true,\n\tfilterMode: \"whitelist\",\n\tfilterDirection: \"both\"\n};\n\nexport const NO_OP = function() {};\n\nexport let state = {\n\t_clients: [],\n\t_transports: {},\n\t_ready: false,\n\t_inboundQueue: [],\n\t_outboundQueue: [],\n\t_signalQueue: [],\n\t_config: _defaults\n};\n\nexport function configure( cfg ) {\n\tif ( cfg && cfg.filterMode && cfg.filterMode !== \"blacklist\" && cfg.filterMode !== \"whitelist\" ) {\n\t\tthrow new Error( \"postal.fedx filterMode must be 'blacklist' or 'whitelist'.\" );\n\t}\n\tif ( cfg ) {\n\t\tstate._config = _.defaults( cfg, _defaults );\n\t}\n\treturn state._config;\n}\n\nexport function disconnect( options ) {\n\toptions = options || {};\n\tlet trans = state._transports;\n\tif ( options.transport ) {\n\t\ttrans = {};\n\t\ttrans[options.transport] = state._transports[options.transport];\n\t}\n\t_.each( trans, function( t ) {\n\t\tt.disconnect( {\n\t\t\ttarget: options.target,\n\t\t\tinstanceId: options.instanceId,\n\t\t\tdoNotNotify: !!options.doNotNotify\n\t\t} );\n\t} );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/state.js\n **/","import { getPackingSlip } from \"./packingSlips\";\nimport { state, disconnect } from \"./state\";\nimport { matchesFilter } from \"./filters\";\nimport postal from \"postal\";\nimport _ from \"lodash\";\n\nexport const handlers = {\n\t\"federation.ping\": function( data /*, callback */ ) {\n\t\tdata.source.setInstanceId( data.packingSlip.instanceId );\n\t\tif ( data.source.handshakeComplete ) {\n\t\t\tdata.source.sendPong( data.packingSlip );\n\t\t} else {\n\t\t\tdata.source.sendBundle( [\n\t\t\tgetPackingSlip( \"pong\", data.packingSlip ),\n\t\t\tgetPackingSlip( \"ping\" )\n\t\t\t] );\n\t\t}\n\t},\n\t\"federation.pong\": function( data ) {\n\t\tdata.source.handshakeComplete = true;\n\t\tdata.source.setInstanceId( data.packingSlip.instanceId );\n\t\tif ( data.source.pings[data.packingSlip.pingData.ticket] ) {\n\t\t\tdata.source.pings[data.packingSlip.pingData.ticket].callback( {\n\t\t\t\tticket: data.packingSlip.pingData.ticket,\n\t\t\t\tinstanceId: data.packingSlip.instanceId,\n\t\t\t\tsource: data.source\n\t\t\t} );\n\t\t\tdata.source.pings[data.packingSlip.pingData.ticket] = undefined;\n\t\t}\n\t\tif ( !_.contains( state._clients, data.packingSlip.instanceId ) ) {\n\t\t\tstate._clients.push( data.packingSlip.instanceId );\n\t\t}\n\t\tpostal.publish( {\n\t\t\tchannel: \"postal.federation\",\n\t\t\ttopic: \"client.federated\",\n\t\t\tdata: {\n\t\t\t\tremoteId: data.source.instanceId,\n\t\t\t\tlocalId: postal.instanceId(),\n\t\t\t\ttransport: data.transport\n\t\t\t}\n\t\t} );\n\t},\n\t\"federation.disconnect\": function( data ) {\n\t\tstate._clients = _.without( state._clients, data.source.instanceId );\n\t\tdisconnect( {\n\t\t\ttransport: data.source.transportName,\n\t\t\tinstanceId: data.source.instanceId,\n\t\t\tdoNotNotify: true\n\t\t} );\n\t},\n\t\"federation.message\": function( data ) {\n\t\tconst env = data.packingSlip.envelope;\n\t\tif ( matchesFilter( env.channel, env.topic, \"in\" ) ) {\n\t\t\tenv.lastSender = data.packingSlip.instanceId;\n\t\t\tpostal.publish( env );\n\t\t}\n\t},\n\t\"federation.bundle\": function( data ) {\n\t\t_.each( data.packingSlip.packingSlips, function( slip ) {\n\t\t\tonFederatedMsg( _.extend( {}, data, {\n\t\t\t\tpackingSlip: slip\n\t\t\t} ) );\n\t\t} );\n\t}\n};\n\nexport function onFederatedMsg( data ) {\n\tif ( !state._ready ) {\n\t\tstate._inboundQueue.push( data );\n\t\treturn;\n\t}\n\tif ( Object.prototype.hasOwnProperty.call( handlers, data.packingSlip.type ) ) {\n\t\thandlers[data.packingSlip.type]( data );\n\t} else {\n\t\tthrow new Error( \"postal.federation does not have a message handler for '\" + data.packingSlip.type + \"'.\" );\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/handlers.js\n **/","import _ from \"lodash\";\nimport { state } from \"./state\";\nimport postal from \"postal\";\n\nconst filters = {\n\t\"in\": {}, // jscs:ignore disallowQuotedKeysInObjects\n\tout: {}\n};\n\nexport default filters;\n\nexport function addFilter( _filters ) {\n\t_filters = _.isArray( _filters ) ? _filters : [ _filters ];\n\t_.each( _filters, function( filter ) {\n\t\tfilter.direction = filter.direction || state._config.filterDirection;\n\t\t_.each( ( filter.direction === \"both\" ) ? [ \"in\", \"out\" ] : [ filter.direction ], function( dir ) {\n\t\t\tif ( !filters[ dir ][ filter.channel ] ) {\n\t\t\t\tfilters[ dir ][ filter.channel ] = [ filter.topic ];\n\t\t\t} else if ( !( _.include( filters[ dir ][ filter.channel ], filter.topic ) ) ) {\n\t\t\t\tfilters[ dir ][ filter.channel ].push( filter.topic );\n\t\t\t}\n\t\t} );\n\t} );\n}\n\nexport function removeFilter( _filters ) {\n\t_filters = _.isArray( _filters ) ? _filters : [ _filters ];\n\t_.each( _filters, function( filter ) {\n\t\tfilter.direction = filter.direction || state._config.filterDirection;\n\t\t_.each( ( filter.direction === \"both\" ) ? [ \"in\", \"out\" ] : [ filter.direction ], function( dir ) {\n\t\t\tif ( filters[ dir ][ filter.channel ] && _.include( filters[ dir ][ filter.channel ], filter.topic ) ) {\n\t\t\t\tfilters[ dir ][ filter.channel ] = _.without( filters[ dir ][ filter.channel ], filter.topic );\n\t\t\t}\n\t\t} );\n\t} );\n}\n\nexport function matchesFilter( channel, topic, direction ) {\n\tconst channelPresent = Object.prototype.hasOwnProperty.call( filters[direction], channel );\n\tconst topicMatch = ( channelPresent && _.any( filters[ direction ][ channel ], function( binding ) {\n\t\treturn postal.configuration.resolver.compare( binding, topic );\n\t} ) );\n\tconst blacklisting = state._config.filterMode === \"blacklist\";\n\treturn state._config.enabled && ( ( blacklisting && ( !channelPresent || ( channelPresent && !topicMatch ) ) ) || ( !blacklisting && channelPresent && topicMatch ) );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/filters.js\n **/","import { getPackingSlip } from \"./packingSlips\";\nimport { onFederatedMsg } from \"./handlers\";\nimport { state, NO_OP } from \"./state\";\nimport postal from \"postal\";\nimport _ from \"lodash\";\n\nexport default class FederationClient {\n\tconstructor( target, options, instanceId ) {\n\t\tthis.target = target;\n\t\tthis.options = options || {};\n\t\tthis.pings = {};\n\t\tthis.instanceId = instanceId;\n\t\tthis.handshakeComplete = false;\n\t}\n\n\tsendPing( callback ) {\n\t\tconst packingSlip = getPackingSlip( \"ping\" );\n\t\tthis.pings[packingSlip.ticket] = {\n\t\t\tticket: packingSlip.ticket,\n\t\t\tcallback: callback || NO_OP\n\t\t};\n\t\tthis.send( packingSlip );\n\t}\n\n\tsendPong( origPackingSlip ) {\n\t\tthis.send( getPackingSlip( \"pong\", origPackingSlip ) );\n\t}\n\n\tsendBundle( slips ) {\n\t\tthis.send( getPackingSlip( \"bundle\", slips ) );\n\t}\n\n\tsendMessage( envelope ) {\n\t\tif ( !this.handshakeComplete ) {\n\t\t\treturn;\n\t\t}\n\t\tenvelope.originId = envelope.originId || postal.instanceId();\n\t\tconst env = _.clone( envelope );\n\t\tif ( this.instanceId && this.instanceId !== env.lastSender &&\n\t\t( !env.knownIds || !env.knownIds.length ||\n\t\t( env.knownIds && !_.include( env.knownIds, this.instanceId ) ) )\n\t\t) {\n\t\t\tenv.knownIds = ( env.knownIds || [] ).concat( _.without( state._clients, this.instanceId ) );\n\t\t\tthis.send( getPackingSlip( \"message\", env ) );\n\t\t}\n\t}\n\n\tdisconnect() {\n\t\tthis.send( getPackingSlip( \"disconnect\" ) );\n\t}\n\n\tonMessage( packingSlip ) {\n\t\tif ( this.shouldProcess() ) {\n\t\t\tonFederatedMsg( {\n\t\t\t\ttransport: this.transportName,\n\t\t\t\tpackingSlip: packingSlip,\n\t\t\t\tsource: this\n\t\t\t} );\n\t\t}\n\t}\n\n\tshouldProcess() {\n\t\treturn true;\n\t}\n\n\tsend( /* msg */ ) {\n\t\tthrow new Error( \"An object deriving from FederationClient must provide an implementation for 'send'.\" );\n\t}\n\n\tsetInstanceId( id ) {\n\t\tthis.instanceId = id;\n\t}\n\n\tstatic extend( props, ctrProps ) {\n\t\tfunction FedXClient() {\n\t\t\tFederationClient.apply( this, arguments );\n\t\t}\n\n\t\tFedXClient.prototype = Object.create( FederationClient.prototype );\n\t\t_.extend( FedXClient.prototype, props );\n\t\t_.extend( FedXClient, ctrProps );\n\n\t\treturn FedXClient;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/FederationClient.js\n **/"],"sourceRoot":""}