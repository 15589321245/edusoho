{"version":3,"sources":["app/Resources/static-src/app/js/attachment/index.js"],"names":["$uploader","$","uploader","UploaderSDK","id","attr","initUrl","data","finishUrl","accept","process","fileSingleSizeLimit","ui","on","file","length","minute","parseInt","second","Math","round","val","$metas","$ids","$list","get","html","append","modal","siblings","hide","one","event","destroy"],"mappings":";;AAAA,IAAMA,YAAYC,EAAE,qBAAF,CAAlB;;AAEA,IAAIC,WAAW,IAAIC,WAAJ,CAAgB;AAC7BC,MAAIJ,UAAUK,IAAV,CAAe,IAAf,CADyB;AAE7BC,WAASN,UAAUO,IAAV,CAAe,SAAf,CAFoB;AAG7BC,aAAWR,UAAUO,IAAV,CAAe,WAAf,CAHkB;AAI7BE,UAAQT,UAAUO,IAAV,CAAe,QAAf,CAJqB;AAK7BG,WAASV,UAAUO,IAAV,CAAe,SAAf,CALoB;AAM7BI,uBAAqBX,UAAUO,IAAV,CAAe,qBAAf,CANQ;AAO7BK,MAAI;AAPyB,CAAhB,CAAf;;AAUAV,SAASW,EAAT,CAAY,aAAZ,EAA2B,UAACC,IAAD,EAAU;AACnC,MAAIA,KAAKC,MAAL,IAAeD,KAAKC,MAAL,GAAc,CAAjC,EAAoC;AAClC,QAAIC,SAASC,SAASH,KAAKC,MAAL,GAAc,EAAvB,CAAb;AACA,QAAIG,SAASC,KAAKC,KAAL,CAAWN,KAAKC,MAAL,GAAc,EAAzB,CAAb;AACAd,MAAE,SAAF,EAAaoB,GAAb,CAAiBL,MAAjB;AACAf,MAAE,SAAF,EAAaoB,GAAb,CAAiBH,MAAjB;AACAjB,MAAE,SAAF,EAAaoB,GAAb,CAAiBL,SAAS,EAAT,GAAcE,MAA/B;AACD;;AAED,MAAMI,SAASrB,EAAE,qBAAF,CAAf;AACA,MAAMsB,OAAOtB,EAAE,MAAMqB,OAAOf,IAAP,CAAY,UAAZ,CAAR,CAAb;AACA,MAAMiB,QAAQvB,EAAE,MAAMqB,OAAOf,IAAP,CAAY,WAAZ,CAAR,CAAd;;AAEAN,IAAEwB,GAAF,CAAM,sBAAsBX,KAAKV,EAA3B,GAAgC,OAAtC,EAA+C,UAAUsB,IAAV,EAAgB;AAC7DF,UAAMG,MAAN,CAAaD,IAAb;AACAH,SAAKF,GAAL,CAASP,KAAKV,EAAd;AACAH,MAAE,mBAAF,EAAuB2B,KAAvB,CAA6B,MAA7B;AACAJ,UAAMK,QAAN,CAAe,iBAAf,EAAkCC,IAAlC;AACD,GALD;AAMD,CAnBD;;AAqBA;AACA7B,EAAE,mBAAF,EAAuB8B,GAAvB,CAA2B,eAA3B,EAA4C,UAACC,KAAD,EAAW;AACrD9B,WAAS+B,OAAT;AACA/B,aAAW,IAAX;AACD,CAHD","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["const $uploader = $('#uploader-container');\n\nlet uploader = new UploaderSDK({\n  id: $uploader.attr('id'),\n  initUrl: $uploader.data('initUrl'),\n  finishUrl: $uploader.data('finishUrl'),\n  accept: $uploader.data('accept'),\n  process: $uploader.data('process'),\n  fileSingleSizeLimit: $uploader.data('fileSingleSizeLimit'),\n  ui: 'single'\n});\n\nuploader.on('file.finish', (file) => {\n  if (file.length && file.length > 0) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#length\").val(minute * 60 + second);\n  }\n\n  const $metas = $('[data-role=\"metas\"]');\n  const $ids = $('.' + $metas.data('idsClass'));\n  const $list = $('.' + $metas.data('listClass'));\n\n  $.get('/attachment/file/' + file.id + '/show', function (html) {\n    $list.append(html);\n    $ids.val(file.id);\n    $('#attachment-modal').modal('hide');\n    $list.siblings('.js-upload-file').hide();\n  })\n});\n\n//只执行一次\n$('#attachment-modal').one('hide.bs.modal', (event) => {\n  uploader.destroy();\n  uploader = null;\n});"]}