{"version":3,"sources":["app/Resources/static-src/app/js/admin/index-modal/index.js"],"names":["require","Notify","exports","run","$modal","$","parents","$table","on","confirm","ids","push","data","ajaxDelete","click","find","each","value","danger","url","userIds","post","response","i","userId","remove","member_count","member_count_text","parseInt","text","length","success","datetimepicker","format","autoclose","minView","val","substring","html","load","modal","$panel"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["// define(function(require, exports, module) {\n    require(\"jquery.bootstrap-datetimepicker\");\n    var Notify = require('common/bootstrap-notify');\n\n\n    exports.run = function() {\n\n        var $modal = $('#member-cancel-form').parents('.modal');\n        var $table = $('#member-table');\n\n        $('#member-table').on('click', '.delete-member', function(){\n\n            if(!confirm('真的要取消该会员吗?')){\n                return ;\n            }\n\n            var ids = [];\n            ids.push($(this).data('id'));\n\n            ajaxDelete($(this).data('url'), ids);\n            \n        });\n\n        $('.js-batch-delete-btn').click(function(){\n            var ids = [];\n            $('#table-list-panel').find('[data-role=batch-item]:checked').each(function() {\n                ids.push(this.value);\n            });\n            if(ids == \"\"){\n                Notify.danger('请先选择你要取消的会员!');\n                return;\n            }\n\n            if(!confirm('真的要取消这些会员吗?')){\n                return ;\n            }\n\n            ajaxDelete($(this).data('url'), ids);\n\n        })\n\n        function ajaxDelete(url, userIds) {\n            \n            $.post(url, {userIds:userIds}, function(response){\n                if (response) {\n                    $.each(userIds, function(i,userId){\n                        $('#member-table-tr-'+userId).remove();\n                    })\n\n                    var member_count = $('.member_count'),\n                        member_count_text = parseInt($('.member_count').text());\n                    member_count.text(member_count_text - userIds.length);\n                    Notify.success('操作成功!');\n                }\n                \n            });\n        }\n        \n        if ($(\"#startDate\").length > 0) {\n            $(\"#startDate\").datetimepicker({\n                format: 'yyyy-mm-dd',\n                autoclose: true,\n                minView: 'month',\n            }).on('changeDate',function(){\n                $(\"#endDate\").datetimepicker('setStartDate',$(\"#startDate\").val().substring(0,16));\n            });\n\n            $(\"#startDate\").datetimepicker('setEndDate',$(\"#endDate\").val().substring(0,16));\n        }\n        \n        if ($(\"#endDate\").length > 0) {\n            $(\"#endDate\").datetimepicker({\n                format: 'yyyy-mm-dd',\n                autoclose: true,\n                minView: 'month',\n            }).on('changeDate',function(){\n                $(\"#startDate\").datetimepicker('setEndDate',$(\"#endDate\").val().substring(0,16));\n            });\n\n            $(\"#endDate\").datetimepicker('setStartDate',$(\"#startDate\").val().substring(0,16));\n        }\n\n        $('.item-vip-edit').click(function(){\n            var url = $(this).data('url');\n            var userIds = $(this).data('id');\n\n            $('#modal').html('');\n            $('#modal').load(url,{userIds:userIds});\n            $('#modal').modal('show');\n        })\n\n        var $panel = $('#table-list-panel');\n        require('../../../../topxiaweb/js/util/batch-select')($panel);\n\n        $('.js-batch-edit-btn').click(function(){\n            var ids = [];\n            $('#table-list-panel').find('[data-role=batch-item]:checked').each(function() {\n                ids.push(this.value);\n            });\n            if(ids == \"\"){\n                Notify.danger('请先选择你要编辑的会员!');\n                return;\n            }\n\n            $('#modal').html('');\n            $('#modal').load($(this).data('url'),{userIds:ids});\n            $('#modal').modal('show');\n        })\n    };\n\n// });"]}