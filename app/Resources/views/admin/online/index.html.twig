{% extends 'admin/layout.html.twig' %}

{% set menu = 'admin_user_manage' %}

{% block content %}

    <form id="message-search-form" class="form-inline well well-sm" action="" method="get" novalidate>
        <input type="hidden" name="type" value="{{ app.request.query.get('type') }}">
        <div class="form-group">
            <input class="form-control" type="text" placeholder="{{'用户名'|trans}}" name="name" value="{{ app.request.query.get('name') }}">
        </div>

        <button class="btn btn-primary">{{'搜索'|trans}}</button>

    </form>
    {% if onlines %}
        <table id="table" class="table table-striped table-hover">
            <thead>
            <tr>
                <th>{{'用户名'|trans}}</th>
                <th>{{'操作系统'|trans}}</th>
                <th>{{'终端'|trans}}</th>
                <th>{{'来源'|trans}}</th>
                <th>{{'客户端ip'|trans}}</th>
                <th>{{'最后访问时间'|trans}}</th>
            </tr>
            </thead>
            <tbody>
            {% for online in onlines %}
                <tr id="online-table-tr-{{ online.id }}">
                    <td>
                        {{ users[online.user_id]['nickname']|default('--') }}
                    </td>
                    <td>
                        {{ parse_user_agent(online.user_agent).os.name }}: {{ parse_user_agent(online.user_agent).os.version }}
                    </td>
                    <td>
                        {{ parse_user_agent(online.user_agent).client.name }}: {{ parse_user_agent(online.user_agent).client.version }}
                    </td>
                    <td>
                        {{ online.source }}
                    </td>
                    <td>
                        {{ online.ip }}
                    </td>
                    <td>
                        {{ online.active_time|date('Y-n-d H:i:s') }}
                    </td>
                </tr>
            {% endfor %}
            </tbody>

        </table>
    {% else %}
        <div class="empty">{{'暂无在线信息!'|trans}}</div>
    {% endif %}
    {{ admin_macro.paginator(paginator) }}
{% endblock %}