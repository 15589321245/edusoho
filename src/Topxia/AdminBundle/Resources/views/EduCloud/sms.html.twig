{% extends 'TopxiaAdminBundle:EduCloud:edu-cloud-layout.html.twig' %}

{% block title %}云短信 - 教育云 - {{ parent() }}{% endblock %}

{% set menu = 'sms' %}
{# {% set menu = '' %} #}
{% set script_controller = 'educloud/sms-setting' %}

{% block main %}
  <div class="page-header"><h1>云短信</h1></div>

    {% if smsStatus.status == 'error' %}
	  	您还未开通云短信服务 &nbsp; &nbsp;
	  	<span class="btn btn-default btn-sm" data-toggle="modal" data-target="#modal" data-url="{{path('admin_edu_cloud_apply_for_sms')}}" > &nbsp;申请开通云短信&nbsp; </span>
    {% endif %}

	{% if smsStatus.status == 'auditing' %}
		<br>
		短信内容：【 {{ setting('cloud_sms.sms_school_name')|default('') }} 】您的验证码是：123456<br>
		审核时间：审核需24小时，期间短信验证功能仍可以正常使用<br>
		短信价格：0.07元/条<br>
		云短信状态:
		<strong>
		    审核中		    
		</strong>
		<br>
	{% endif %}

	{% if smsStatus.status == 'failed' %}
		因为申请的网校名称不符合规范，您新申请的网校名称“{{setting('cloud_sms.sms_school_name')|default('')}}”未通过审核。
		<span class="btn btn-default btn-sm" data-toggle="modal" data-target="#modal" data-url="{{path('admin_edu_cloud_apply_for_sms')}}" > &nbsp;申请开通云短信&nbsp; </span>
	{% endif %}

	{% if smsStatus.status == 'passed' %}
		<form class="form-horizontal" method="post" id="sms-form" novalidate="">
			<fieldset>
				<legend>短信设置</legend>
				<div class="form-group">
	      			<div class="col-md-3 control-label">
	        			<label class="pull-right">短信功能</label>
	      			</div>

	      			<div class="controls col-md-8 radios">
	        			<label>
	        				<input type="radio" name="sms_enabled" value="1"
	        				{% if (setting('cloud_sms.sms_enabled')|default('')) == '1' %}
	        					checked="checked"
	        				{% endif %}
	        				> 
	        				开启
	        			</label>
	        			<label>
	        				<input type="radio" name="sms_enabled" value="0" 
	        				{% if (setting('cloud_sms.sms_enabled')|default('')) != '1' %}
	        					checked="checked"
	        				{% endif %}
	        				> 
	        				关闭
	        			</label>
	      			</div>
	    		</div>

	    		<div class="form-group">
	      			<div class="col-md-3 control-label">
	        			<label for="name" class="pull-right">网校名称</label>
	      			</div>
		      		<div class="col-md-7 controls">
		        		<input type="text" id="name" name="sms-school-name" class="form-control js-school-name" value="{{setting('cloud_sms.sms_school_name')|default('')}}" readonly="readonly">
		        		<p class="help-block"></p>
		        		<p>短信内容：“【<span id="js-sms-school-name">{{setting('cloud_sms.sms_school_name')|default('')}}</span>】您的验证码是：123456,此短信30分钟内有效”</p>
		      		</div>
		      		<div class="col-md-2" style="padding-top: 5px;padding-left: 5px;">
		      			<span class="btn btn-xs btn-default js-alter-school-name" data-toggle="modal" data-target="#modal" data-url="{{path('admin_edu_cloud_apply_for_sms')}}">修改</span>
		      		</div>
	    		</div>	

	    		<div class="js-usage" 
	    		{% if (setting('cloud_sms.sms_enabled')|default('')) != '1' %}
	    			style="display:none;" 
	    		{% endif %}
	    		>
		    		<legend>短信验证</legend>
		    		<div class="form-group">
		      			<div class="col-md-3 control-label">
		        			<label class="pull-right">使用场景</label>
		      			</div>

		      			<div class="controls col-md-8 radios checkboxes">
		        			<label>
						    	<input name="sms_registration" type="checkbox"
						    	{% if (setting('cloud_sms.sms_registration')|default('')) == 'on' %}
						    		checked
						    	{% endif %}
						    	> 用户注册时
						    </label>
						    <br>
						    <label>
						    	<input name="sms_find_password" type="checkbox"
						    	{% if (setting('cloud_sms.sms_find_password')|default('')) == 'on' %}
						    		checked
						    	{% endif %}
						    	> 忘记密码时
						    </label>
						    <br>
						    <label>
						    	<input name="sms_user_pay" type="checkbox"
						    	{% if (setting('cloud_sms.sms_user_pay')|default('')) == 'on' %}
						    		checked
						    	{% endif %}
						    	> 账户支付时
						    </label>
						    <br>
						    <label>
						    	<input name="sms_find_pay_password" type="checkbox"
						    	{% if (setting('cloud_sms.sms_find_pay_password')|default('')) == 'on' %}
						    		checked
						    	{% endif %}
						    	> 忘记支付密码时
						    </label>
		      			</div>
		    		</div>
	    		</div>
			</fieldset>
			<div class="form-group">
				<div class="controls col-md-offset-3 col-md-8">
	      			<button type="submit" class="btn btn-primary">提交</button>
	    		</div>
    		</div>
    		<input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
		</form>
		{{ web_macro.flash_messages() }}
	{% endif %}

{% endblock %}