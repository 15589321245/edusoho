{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/exercise/index.js"],"names":["Exercise","$form","$element","_setValidateRule","_init","_initEvent","_inItStep2form","$step2_form","$","validator","validate","onkeyup","rules","title","required","maxlength","trim","itemCount","positiveInteger","min","max","range","difficulty","remote","url","data","type","dataType","async","val","courseId","length","lessonId","JSON","stringify","types","each","push","messages","$step3_form","finishCondition","addMethod","value","element","optional","test","format"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nclass Exercise {\n\tconstructor($form) {\n\t\tthis.$element = $form;\n\t\tthis._setValidateRule();\n    this._init();\n    this._initEvent();\n  }\n\n  _init() {\n    this._inItStep2form();\n  }\n\n  _initEvent() {\n  }\n\n  _inItStep2form() {\n    let $step2_form = $(\"#step2-form\");\n    let validator = $step2_form.validate({\n        onkeyup: false,\n        rules: {\n          title: {\n            required:true,\n            maxlength: 50,\n            trim: true,\n          },\n          itemCount: {\n            required: true,\n            positiveInteger:true,\n            min: 1,\n            max: 9999\n          },\n          range:{\n          \trequired:true,\n          },\n          difficulty:{\n          \trequired:true\n          },\n          'questionTypes[]':{\n            required:true,\n            remote: {    \n              url: $('[name=\"checkQuestion\"]').data('checkUrl'),   \n              type: \"post\",    \n              dataType: \"json\", \n              async: false,      \n              data: {    \n                itemCount: function() {    \n                  return $('[name=\"itemCount\"]').val();    \n                },\n                range: function() {\n                  let range = {}\n                  let courseId = $('[name=\"range[courseId]\"]').val();\n                  range.courseId = courseId;\n                  if ($('[name=\"range[lessonId]\"]').length > 0) {\n                    let lessonId = $('[name=\"range[lessonId]\"]').val();\n                    range.lessonId = lessonId;\n                  }\n                  \n                  return JSON.stringify(range);\n                },\n                difficulty: function() {\n                  return $('[name=\"difficulty\"]').val();\n                },\n                types: function () {\n                  let types = [];\n                  $('[name=\"questionTypes\\[\\]\"]:checked').each(function(){\n                    types.push($(this).val());\n                  });\n                  return types;\n                }\n              }    \n            }    \n          }\n        },\n        messages: {\n          required:\"请填写标题\",\n          range: \"题目来源\",\n          itemCount: {\n            required: '请填写题目个数',\n            positiveInteger: '请输入正整数',\n            min: '题目个数无效',\n            max: '题目个数过大'\n          },\n          difficulty: \"请选择难易程度\",\n          'questionTypes[]': {\n            required:\"请选择题型\",\n            remote:\"题目数量不足\"\n          },\n        }\n    });\n\n    /*if (validator.form()) {\n      $('input[namae=\"checkQuestion\"]').rules('add',{\n        required:true,\n        remote:{\n          url: $('input[namae=\"checkQuestion\"]').data('checkUrl'),     \n          type: 'post',               \n          dataType: 'json',           \n          data: $step2_form.serialize(),\n          success:function(response){\n            console.log(response);\n          }\n        }\n      })\n    }*/\n\n    $step2_form.data('validator',validator);\n  }\n\n  _inItStep3form() {\n    var $step3_form = $(\"#step3-form\");\n    var validator = $step3_form.validate({\n        onkeyup: false,\n        rules: {\n            finishCondition: {\n                required: true,\n            },\n        },\n        messages: {\n            finishCondition: \"请输完成条件\",\n        }\n    });\n    $step3_form.data('validator',validator);\n  }\n\n  _setValidateRule() {\n    $.validator.addMethod(\"positiveInteger\",function(value,element){  \n\t\t  return this.optional( element ) || /^[1-9]\\d*$/.test(value);\n\t\t}, $.validator.format(\"必须为正整数\"));\n\n  }\n}\n\nnew Exercise($('#step2-form'));\nnew SelectLinkage($('[name=\"range[courseId]\"]'),$('[name=\"range[lessonId]\"]'));"]}