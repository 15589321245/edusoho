{"version":3,"sources":["app/Resources/static-src/app/js/admin/index-modal/index.js"],"names":["$modal","$","parents","$table","on","confirm","ids","push","data","ajaxDelete","click","find","each","value","Notify","danger","url","userIds","post","response","i","userId","remove","member_count","member_count_text","parseInt","text","length","success","datetimepicker","format","autoclose","minView","val","substring","html","load","modal","$panel"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["// define(function(require, exports, module) {\n//     require(\"jquery.bootstrap-datetimepicker\");\n//     var Notify = require('common/bootstrap-notify');\n\n\n    // exports.run = function() {\nimport notify from \"\";\n        var $modal = $('#member-cancel-form').parents('.modal');\n        var $table = $('#member-table');\n\n        $('#member-table').on('click', '.delete-member', function(){\n\n            if(!confirm('真的要取消该会员吗?')){\n                return ;\n            }\n\n            var ids = [];\n            ids.push($(this).data('id'));\n\n            ajaxDelete($(this).data('url'), ids);\n            \n        });\n\n        $('.js-batch-delete-btn').click(function(){\n            var ids = [];\n            $('#table-list-panel').find('[data-role=batch-item]:checked').each(function() {\n                ids.push(this.value);\n            });\n            if(ids == \"\"){\n                Notify.danger('请先选择你要取消的会员!');\n                return;\n            }\n\n            if(!confirm('真的要取消这些会员吗?')){\n                return ;\n            }\n\n            ajaxDelete($(this).data('url'), ids);\n\n        })\n\n        function ajaxDelete(url, userIds) {\n            \n            $.post(url, {userIds:userIds}, function(response){\n                if (response) {\n                    $.each(userIds, function(i,userId){\n                        $('#member-table-tr-'+userId).remove();\n                    })\n\n                    var member_count = $('.member_count'),\n                        member_count_text = parseInt($('.member_count').text());\n                    member_count.text(member_count_text - userIds.length);\n                    Notify.success('操作成功!');\n                }\n                \n            });\n        }\n        \n        if ($(\"#startDate\").length > 0) {\n            $(\"#startDate\").datetimepicker({\n                format: 'yyyy-mm-dd',\n                autoclose: true,\n                minView: 'month',\n            }).on('changeDate',function(){\n                $(\"#endDate\").datetimepicker('setStartDate',$(\"#startDate\").val().substring(0,16));\n            });\n\n            $(\"#startDate\").datetimepicker('setEndDate',$(\"#endDate\").val().substring(0,16));\n        }\n        \n        if ($(\"#endDate\").length > 0) {\n            $(\"#endDate\").datetimepicker({\n                format: 'yyyy-mm-dd',\n                autoclose: true,\n                minView: 'month',\n            }).on('changeDate',function(){\n                $(\"#startDate\").datetimepicker('setEndDate',$(\"#endDate\").val().substring(0,16));\n            });\n\n            $(\"#endDate\").datetimepicker('setStartDate',$(\"#startDate\").val().substring(0,16));\n        }\n\n        $('.item-vip-edit').click(function(){\n            var url = $(this).data('url');\n            var userIds = $(this).data('id');\n\n            $('#modal').html('');\n            $('#modal').load(url,{userIds:userIds});\n            $('#modal').modal('show');\n        })\n\n        var $panel = $('#table-list-panel');\n        // require('../../../../topxiaweb/js/util/batch-select')($panel);\n\n        $('.js-batch-edit-btn').click(function(){\n            var ids = [];\n            $('#table-list-panel').find('[data-role=batch-item]:checked').each(function() {\n                ids.push(this.value);\n            });\n            if(ids == \"\"){\n                Notify.danger('请先选择你要编辑的会员!');\n                return;\n            }\n\n            $('#modal').html('');\n            $('#modal').load($(this).data('url'),{userIds:ids});\n            $('#modal').modal('show');\n        })\n    // };\n\n// });"]}