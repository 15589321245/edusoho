webpackJsonp(["app/js/activity/video/index"],[function(e,n,t){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),o=t("4f23a1491e3b8ecc3024"),l=a(o),c=t("06597b47670159844043"),u=a(c),s=t("da32dea28c2b82c7aab1"),d=a(s);t("9c4b140442602e4b111b");var f=function(){function e(n){i(this,e),this.player={},this.intervalId=null,this.recorder=n,this.emitter=new d.default}return r(e,[{key:"play",value:function(){$("#swf-player").length?this._playerSwf():this._playVideo(),this.record()}},{key:"record",value:function(){var e=this;this.intervalId=setInterval(function(){e.recorder.addVideoPlayerCounter(e.emitter,e.player)},1e3)}},{key:"getPlay",value:function(){return this.player}},{key:"_playerSwf",value:function(){var e="swf-player";l.default.embedSWF($("#"+e).data("url"),e,"100%","100%","9.0.0",null,null,{wmode:"opaque",allowFullScreen:"true"})}},{key:"_playVideo",value:function(){var e=this,n=new u.default({name:"partner",project:"PlayerProject",children:[],type:"parent"});n.on("ended",function(n){e.player.playing=!1,e._onFinishLearnTask(n)}),n.on("playing",function(n){e.player.playing=!0}),n.on("paused",function(n){e.player.playing=!1}),n.on("timechange",function(n){e.player.currentTime=n.currentTime})}},{key:"_onFinishLearnTask",value:function(e){var n=this;this.emitter.emit("finish",{data:e}).then(function(){clearInterval(n.intervalId)}).catch(function(e){})}}]),e}(),y=function(){function e(n){i(this,e),this.container=n,this.interval=120}return r(e,[{key:"addVideoPlayerCounter",value:function(e,n){var t=$(this.container),a=t.data("id"),i=store.get("activity_id_"+a+"_playing_counter");return i||(i=0),!(!n||!n.playing)&&(i>=this.interval?(e.emit("watching",{watchTime:this.interval}).then(function(){var e=$("#video-content").data("watchUrl");$.post(e,function(e){e&&"error"==e.status&&window.location.reload()})}).catch(function(e){}),i=0):n.playing&&i++,void store.set("activity_id_"+a+"_playing_counter",i))}}]),e}(),p=new y("#video-content"),h=new f(p);h.play()}]);