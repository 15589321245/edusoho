{"version":3,"sources":["app/Resources/static-src/app/js/classroom-manage/set-info/index.js"],"names":["initEditor","initValidator","toggleExpiryValue","$","val","change","app","arguments","classroomStatus","expiryValue","match","data","addClass","removeClass","$esBlock","text","editor_classroom_about","CKEDITOR","replace","allowedContent","toolbar","filebrowserImageUploadUrl","filebrowserFlashUploadUrl","select2","treeview","dropdownAutoWidth","treeviewInitState","placeholderOption","validator","validate","rules","title","required","click","form","expiryMode","elementRemoveRules","datetimepicker","elementAddRules","getExpiryModeDaysRules","language","autoclose","format","minView","endDate","Date","now","getExpiryModeDateRules","positive_currency","messages","after_now_date","$element","options"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport 'common/select2';\nimport 'app/js/classroom-manage/classroom-create';\n\ninitEditor();\ninitValidator();\ntoggleExpiryValue($(\"[name=expiryMode]:checked\").val());\n\n$(\"[name='expiryMode']\").change(function () {\n  if (app.arguments.classroomStatus == 'published') {\n    return false;\n  }\n  var expiryValue = $(\"[name='expiryValue']\").val();\n  if (expiryValue) {\n    if (expiryValue.match(\"-\")) {\n      $(\"[name='expiryValue']\").data('date', $(\"[name='expiryValue']\").val());\n    } else {\n      $(\"[name='expiryValue']\").data('days', $(\"[name='expiryValue']\").val());\n    }\n    $(\"[name='expiryValue']\").val('')\n  }\n  if ($(this).val() == 'none') {\n    $('.expiry-value-js').addClass('hidden');\n  } else {\n    $('.expiry-value-js').removeClass('hidden');\n    var $esBlock = $('.expiry-value-js > .controls > .help-block');\n    $esBlock.text($esBlock.data($(this).val()));\n    toggleExpiryValue($(this).val());\n  }\n});\n\nfunction initEditor() {\n  let editor_classroom_about = CKEDITOR.replace('about', {\n    allowedContent: true,\n    toolbar: 'Detail',\n    filebrowserImageUploadUrl: $('#about').data('imageUploadUrl'),\n    filebrowserFlashUploadUrl: $('#about').data('flashUploadUrl')\n  });\n\n  $('[data-role=\"tree-select\"], [name=\"categoryId\"]').select2({\n    treeview: true,\n    dropdownAutoWidth: true,\n    treeviewInitState: 'collapsed',\n    placeholderOption: 'first'\n  });\n}\n\nfunction initValidator() {\n  let validator = $('#classroom-set-form').validate({\n    rules: {\n      title: {\n        required: true,\n      }\n    },\n  });\n\n  $('#classroom-save').click(() => {\n    validator.form();\n  })\n}\n\nfunction toggleExpiryValue(expiryMode) {\n  if (!$(\"[name='expiryValue']\").val()) {\n    $(\"[name='expiryValue']\").val($(\"[name='expiryValue']\").data(expiryMode));\n  }\n  elementRemoveRules($(\"[name='expiryValue']\"));\n  switch (expiryMode) {\n    case 'days':\n      $('[name=\"expiryValue\"]').datetimepicker('remove');\n      $(\".expiry-value-js .controls > span\").removeClass('hidden');\n      elementAddRules($('[name=\"expiryValue\"]'),getExpiryModeDaysRules());\n      break;\n    case 'date':\n      $(\".expiry-value-js .controls > span\").addClass('hidden');\n      $(\"#classroom_expiryValue\").datetimepicker({\n        language: 'zh-CN',\n        autoclose: true,\n        format: 'yyyy-mm-dd',\n        minView: 'month',\n        endDate: new Date(Date.now() + 86400 * 365 * 10 * 1000)\n      });\n      $(\"#classroom_expiryValue\").datetimepicker('setStartDate', new Date);\n       elementAddRules($('[name=\"expiryValue\"]'),getExpiryModeDateRules());\n      break;\n    default:\n      break;\n  }\n}\n\nfunction getExpiryModeDaysRules() {\n  return {\n    required: true,\n    positive_currency: true,\n    messages: {\n      required: '请输入有效期天数',\n    }\n  }\n}\n\nfunction getExpiryModeDateRules() {\n  return {\n    required: true,\n    data: true,\n    after_now_date: true,\n    messages: {\n      required: '请输入截至日期',\n      \n    }\n  }\n}\n\nfunction elementAddRules($element, options) {\n  $element.rules(\"add\", options);\n}\n\nfunction elementRemoveRules($element) {\n  $element.rules('remove');\n}\n\n"]}