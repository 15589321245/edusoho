{% extends 'layout.html.twig' %}
{% do script(['libs/ltc-sdk-client.js', 'app/js/task-manage/finish/index.js']) %}
{% set bodyClass = 'task-iframe-body' %}
{% block body %}
  <div class="tab-content" id="iframe-content">
  {% set selectTips = {'time': 'activity_manage.finish_select_tips_time', 'end': 'activity_manage.finish_select_tips_end'} %}
  {% set defaultCondition = conditions[0] %}

    <div class="tab-pane js-course-tasks-pane active">
        <form class="form-horizontal" id="step3-form" >
          <div class="form-group">
            <div class="col-sm-2 control-label">
              <label for="condition-select">
                {{ 'course.plan_task.activity_manage.finished_condition'|trans }}
              </label>
            </div>
            <div class="col-sm-4 {% if conditions|length == 1 %}form-control-static{% endif %}">
            {% if conditions|length == 1 %}
              {{ selectTips[defaultCondition['type']]|default(defaultCondition['describe']|default(''))|trans }}
              <input type="hidden" id="finish-type" value="{{ defaultCondition['type'] }}" name="finishType">
            {% else %}
              <select id="finish-type" name="finishType" class="form-control">
                {% for condition in conditions %}
                  <option data-value="{{ condition.value|default('') }}" value="{{ condition.type }}" {% if activity.finishType|default(defaultCondition.type) == condition.type|default() %} selected {% endif %}>
                    {{ selectTips[condition['type']]|default(condition['describe']|default(''))|trans }}
                  </option>
                {% endfor %}
              </select>
            {% endif %}
            </div>
          </div>
          <div class="" id="conditions" >
            <div id="conditions-time" class="form-group" {% if activity['finishType']|default(defaultCondition['type']) != 'time' %} style="display: none;"{% endif %}>
              <div class="col-sm-2 control-label">
                <label for="watchTime">
                  至少观看
                </label>
              </div>
              <div class="col-sm-4">
                <input class="form-control" id="watchTime" type="text" value="{% if activity['finishType']|default() == 'time' %}{{ activity['finishData']|default() }}{% elseif defaultCondition['type'] == 'time' %}{{ activity['value']|default('1') }}{% endif %}">
              </div>
              <div class="col-sm-4">
                <p class="form-control-static">
                  分
                </p>
              </div>
            </div>
          </div>
          <input type="hidden" id="finish-data" name="finishData" value="{{ activity['finishData']|default(defaultCondition['value']|default()) }}">
        </form>
    </div>
  </div>
{% endblock %}