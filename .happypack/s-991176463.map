{"version":3,"sources":["app/Resources/static-src/app/js/activity-manage/live/index.js"],"names":["Live","props","_init","_extendValidator","_initStep2Form","$","validator","addMethod","value","element","params","now","Date","getTime","valuedata","console","log","Translator","trans","time","result","parseInt","replace","editor","CKEDITOR","toolbar","filebrowserImageUploadUrl","data","filebrowserFlashUploadUrl","allowedContent","height","on","val","getData","$step2_form","validate","onkeyup","rules","title","required","maxlength","trim","startTime","DateAndTime","after","length","digits","max","min","remark","_dateTimePicker","$starttime","datetimepicker","format","language","autoclose","endDate","form"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import { initEditor } from '../editor'\n\nclass Live {\n  constructor(props) {\n    this._init();\n  }\n  _init() {\n    this._extendValidator();\n    this._initStep2Form();\n  }\n\n  _extendValidator() {\n    $.validator.addMethod(\n      \"after\",\n      function (value, element, params) {\n        var now = new Date().getTime();\n        let valuedata   = new Date(value).getTime();\n\n        console.log(now);\n        console.log(valuedata> now);\n\n        console.log(now);\n        \n        return value && new Date(value) > now;\n      },\n      Translator.trans('开始时间应晚于当前时间')\n    );\n  }\n\n  convertTimeToInt(time){\n\t\tvar result = null;\n\t\tif(time != null && time != \"\"){\n    \t\tresult = parseInt(time.replace(/-/g,\"\").replace(/:/g,\"\"),10);\n\t\t}\n\t\treturn result;\n\t}\n\n  _initEditorContent() {\n    var editor = CKEDITOR.replace('text-content-field', {\n      toolbar: 'Full',\n      filebrowserImageUploadUrl: $('#text-content-field').data('imageUploadUrl'),\n      filebrowserFlashUploadUrl: $('#text-content-field').data('flashUploadUrl'),\n      allowedContent: true,\n      height: 300\n    });\n    editor.on('change', () => {\n      $('[name=\"remark\"]').val(editor.getData());\n    });\n    editor.on('blur', () => {\n      $('[name=\"remark\"]').val(editor.getData());\n    });\n  }\n\n  _initStep2Form() {\n    var $step2_form = $(\"#step2-form\");\n    var validator = $step2_form.data('validator', validator);\n    validator = $step2_form.validate({\n      onkeyup: false,\n      rules: {\n        title: {\n          required: true,\n          maxlength: 50,\n          trim: true,\n        },\n        startTime: {\n          required: true,\n          DateAndTime: true,\n          after: true\n        },\n        length: {\n          required: true,\n          digits: true,\n          max: 300,\n          min: 1\n        },\n        remark: {\n          maxlength: 1000\n        },\n      },\n    });\n    initEditor($('[name=\"remark\"]'), validator);\n    this._dateTimePicker(validator);\n  }\n\n\n\n  _dateTimePicker(validator) {\n    let $starttime = $('#startTime');\n    $starttime.datetimepicker({\n      format: 'yyyy-mm-dd hh:ii',\n      language: \"zh\",\n      autoclose: true,\n      endDate: new Date(Date.now() + 86400 * 365 * 100 * 1000)\n    }).on('hide',()=>{\n      validator.form();\n    })\n    $starttime.datetimepicker('setStartDate', new Date());\n  }\n}\n\nnew Live();\n"]}