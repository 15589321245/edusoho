{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/input-group.js"],"names":["InputGroup","props","state","itemName","searched","resultful","searchResult","searchable","enable","addable","searchableUrl","url","subscribeMessage","postal","subscribe","channel","topic","callback","console","log","handleAdd","name","data","context","addItem","setState","event","value","currentTarget","length","setTimeout","itemData","blurIsAdd","handleNameChange","onFocus","blurAdd","selectChange","contextTypes","PropTypes","func"],"mappings":";;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;AACA;;;;;;;;;;IAEqBA,U;;;AACnB,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA,wHACXA,KADW;;AAEjB,UAAKC,KAAL,GAAa;AACXC,gBAAU,EADC;AAEXC,gBAAU,IAFC;AAGXC,iBAAW,KAHA;AAIXC,oBAAa;AAJF,KAAb;AAMA,UAAKC,UAAL,GAAkB,MAAKN,KAAL,CAAWM,UAAX,CAAsBC,MAAxC;AACA,UAAKC,OAAL,GAAe,MAAKR,KAAL,CAAWQ,OAA1B;AACA,UAAKC,aAAL,GAAqB,MAAKT,KAAL,CAAWM,UAAX,CAAsBI,GAA3C;AACA,UAAKC,gBAAL;AAXiB;AAYlB;;;;uCAEkB;AACjBC,aAAOC,SAAP,CAAiB;AACbC,iBAAS,sBADI;AAEbC,eAAO,eAFM;AAGbC,kBAAU,oBAAW;AACjBC,kBAAQC,GAAR,CAAY,KAAZ;AACA,eAAKC,SAAL;AACH;AANY,OAAjB;AAQD;;;iCAEYC,I,EAAKC,I,EAAM;AACtB,UAAGA,IAAH,EAAS;AACP,aAAKC,OAAL,CAAaC,OAAb,CAAqBH,IAArB,EAA0BC,IAA1B;AACD;AACD,WAAKG,QAAL,CAAc;AACZtB,kBAAU;AADE,OAAd;AAGD;;;4BAEOuB,K,EAAO;AACb;AACA,WAAKD,QAAL,CAAc;AACZrB,kBAAU;AADE,OAAd;AAGD;;;qCAEiBsB,K,EAAM;AAAA;;AACtB,UAAIC,QAAQ,gBAAKD,MAAME,aAAN,CAAoBD,KAAzB,CAAZ;AACA,WAAKF,QAAL,CAAc;AACZtB,kBAAUwB,KADE;AAEZrB,sBAAc,EAFF;AAGZD,mBAAU;AAHE,OAAd;;AAMA,UAAG,KAAKE,UAAL,IAAmBoB,MAAME,MAAN,GAAe,CAAlC,IAAuC,KAAK3B,KAAL,CAAWE,QAArD,EAA+D;AAC7D0B,mBAAW,YAAI;AACb,4BAAK,OAAKpB,aAAL,GAAmBiB,KAAxB,EAA8B,wBAAc;AAC1C,gBAAG,OAAKzB,KAAL,CAAWC,QAAX,CAAoB0B,MAApB,GAA2B,CAA9B,EAAiC;AAC/BX,sBAAQC,GAAR,CAAY,EAAC,gBAAgBb,YAAjB,EAAZ;AACA,qBAAKmB,QAAL,CAAc;AACZnB,8BAAcA,YADF;AAEZD,2BAAY;AAFA,eAAd;AAID;AACF,WARD;AASD,SAVD,EAUE,GAVF;AAWD;AACF;;;gCAEY;AACX,UAAG,KAAKH,KAAL,CAAWC,QAAX,CAAoB0B,MAApB,GAA2B,CAA9B,EAAiC;AAC/B,aAAKN,OAAL,CAAaC,OAAb,CAAqB,KAAKtB,KAAL,CAAWC,QAAhC,EAAyC,KAAKD,KAAL,CAAW6B,QAApD;AACD;AACD,WAAKN,QAAL,CAAc;AACZtB,kBAAS,EADG;AAEZG,sBAAa,EAFD;AAGZD,mBAAW;AAHC,OAAd;AAKD;;;8BAES;AACR,UAAG,KAAKJ,KAAL,CAAW+B,SAAd,EAAyB;AACvBd,gBAAQC,GAAR,CAAY,IAAZ;AACD;AACF;;;6BAEQ;AAAA;;AACP,aACE;AAAA;AAAA,UAAK,WAAU,aAAf;AACE,iDAAO,WAAU,cAAjB,EAAgC,OAAO,KAAKjB,KAAL,CAAWC,QAAlD,EAA4D,UAAU;AAAA,mBAAS,OAAK8B,gBAAL,CAAsBP,KAAtB,CAAT;AAAA,WAAtE,EAA6G,SAAW;AAAA,mBAAO,OAAKQ,OAAL,CAAaR,KAAb,CAAP;AAAA,WAAxH,EAAoJ,QAAQ;AAAA,mBAAO,OAAKS,OAAL,CAAaT,KAAb,CAAP;AAAA,WAA5J,GADF;AAEI,aAAKnB,UAAL,IAAmB,KAAKL,KAAL,CAAWG,SAA9B,IAA2C,mDAAS,cAAe,KAAKH,KAAL,CAAWI,YAAnC,EAAiD,cAAe,sBAACoB,KAAD,EAAOL,IAAP;AAAA,mBAAc,OAAKe,YAAL,CAAkBV,KAAlB,EAAwBL,IAAxB,CAAd;AAAA,WAAhE,EAA6G,WAAW,KAAKnB,KAAL,CAAWG,SAAnI,GAF/C;AAGI,aAAKI,OAAL,IAAgB;AAAA;AAAA,YAAM,WAAU,iBAAhB;AAAkC;AAAA;AAAA,cAAG,WAAU,iBAAb,EAA+B,SAAS;AAAA,uBAAI,OAAKW,SAAL,EAAJ;AAAA,eAAxC;AAAA;AAAA;AAAlC;AAHpB,OADF;AAOD;;;;;;kBA1FkBpB,U;;;AA6FrBA,WAAWqC,YAAX,GAA0B;AACxBb,WAAQ,gBAAMc,SAAN,CAAgBC;AADA,CAA1B","file":"input-group.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport { trim } from '../../unit';\nimport { send } from '../../server';\nimport Options from './options';\nimport 'postal';\n\nexport default class InputGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      itemName: \"\",\n      searched: true,\n      resultful: false,\n      searchResult:[],\n    }\n    this.searchable = this.props.searchable.enable;\n    this.addable = this.props.addable;\n    this.searchableUrl = this.props.searchable.url;\n    this.subscribeMessage();\n  }\n\n  subscribeMessage() {\n    postal.subscribe({\n        channel: \"courseInfoMultiInput\",\n        topic: \"addMultiInput\",\n        callback: function() {\n            console.log('add');\n            this.handleAdd();\n        }\n    });\n  }\n\n  selectChange(name,data) {\n    if(data) {\n      this.context.addItem(name,data);\n    }\n    this.setState({\n      itemName: '',\n    });\n  }\n\n  onFocus(event) {\n    //在这种情况下，重新开启搜索功能；\n    this.setState({\n      searched: true,\n    })\n  }\n\n  handleNameChange (event){\n    let value = trim(event.currentTarget.value);\n    this.setState({\n      itemName: value,\n      searchResult: [],\n      resultful:false,\n    });\n\n    if(this.searchable && value.length > 0 && this.state.searched) {\n      setTimeout(()=>{\n        send(this.searchableUrl+value,searchResult=>{\n          if(this.state.itemName.length>0) {\n            console.log({'searchResult': searchResult});\n            this.setState({\n              searchResult: searchResult,\n              resultful : true,\n            });\n          }\n        });\n      },100)\n    }\n  }\n\n  handleAdd()  {\n    if(this.state.itemName.length>0) {\n      this.context.addItem(this.state.itemName,this.state.itemData);\n    }\n    this.setState({\n      itemName:'',\n      searchResult:[],\n      resultful: false,\n    })\n  }\n\n  blurAdd() {\n    if(this.props.blurIsAdd) {\n      console.log('ok');\n    }\n  }\n\n  render (){\n    return (\n      <div className=\"input-group\">\n        <input className=\"form-control\" value={this.state.itemName} onChange={event => this.handleNameChange(event)} onFocus = {event=>this.onFocus(event)} onBlur={event=>this.blurAdd(event)} />\n        { this.searchable && this.state.resultful && <Options searchResult ={this.state.searchResult} selectChange ={(event,name)=>this.selectChange(event,name)} resultful={this.state.resultful}/> }\n        { this.addable && <span className=\"input-group-btn\"><a className=\"btn btn-default\" onClick={()=>this.handleAdd()}>添加</a></span> }\n      </div>\n    );\n  }\n}\n\nInputGroup.contextTypes = {\n  addItem:React.PropTypes.func,\n};\n"]}