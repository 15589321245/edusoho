{"version":3,"sources":["app/Resources/static-src/app/js/course-manage/info/index.js"],"names":["renderMultiGroupComponent","elementId","name","datas","$","data","render","document","getElementById","_initDatePicker","CKEDITOR","replace","allowedContent","toolbar","filebrowserImageUploadUrl","on","event","val","removeClass","addClass","jQuery","validator","addMethod","value","element","optional","$form","validate","onkeyup","currentDom","groups","date","rules","title","required","expiryDays","digits","max_year","expiryStartDate","before","expiryEndDate","after","messages","Translator","trans","params","click","evt","form","submit","$id","$picker","datetimepicker","format","language","minView","autoclose","Date"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import {TabChange} from '../help';\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport MultiInput from 'app/common/component/multi-input';\nimport sortList from 'common/sortable';\n\nfunction renderMultiGroupComponent(elementId,name){\n  let datas = $('#'+elementId).data('init-value');\n  ReactDOM.render( <MultiInput dataSource= {datas} outputDataElement={name} />,\n    document.getElementById(elementId)\n);\n}\n\nrenderMultiGroupComponent('course-goals', 'goals');\nrenderMultiGroupComponent('intended-students', 'audiences');\n\n\n_initDatePicker('#expiryStartDate');\n_initDatePicker('#expiryEndDate');\n\nTabChange();\n\nCKEDITOR.replace('summary', {\n  allowedContent: true,\n  toolbar: 'Detail',\n  filebrowserImageUploadUrl: $('#summary').data('imageUploadUrl')\n});\n\n$('input[name=\"expiryMode\"]').on('change', function (event) {\n  if ($('input[name=\"expiryMode\"]:checked').val() == 'date') {\n    $('#expiry-days').removeClass('hidden').addClass('hidden');\n    $('#expiry-date').removeClass('hidden');\n  } else {\n    $('#expiry-date').removeClass('hidden').addClass('hidden');\n    $('#expiry-days').removeClass('hidden');\n  }\n});\n\njQuery.validator.addMethod(\"max_year\", function (value, element) {\n  return this.optional(element) || value < 100000;\n}, \"有效期最大值不能超过99,999天\");\n\n\nlet $form = $('#course-info-form');\nlet validator = $form.validate({\n  onkeyup: false,\n  currentDom: '#course-submit',\n  groups: {\n    date: 'expiryStartDate expiryEndDate'\n  },\n  rules: {\n    title: {\n      required: true\n    },\n    expiryDays: {\n      required: '#expiryByDays:checked',\n      digits: true,\n      max_year: true\n    },\n    expiryStartDate: {\n      required: '#expiryByDate:checked',\n      date: true,\n      before: '#expiryEndDate'\n    },\n    expiryEndDate: {\n      required: '#expiryByDate:checked',\n      date: true,\n      after: '#expiryStartDate'\n    }\n  },\n  messages: {\n    title: Translator.trans('请输入教学计划课程标题'),\n    expiryDays: {\n      required: Translator.trans('请输入学习有效期'),\n    },\n    expiryStartDate: {\n      required: Translator.trans('请输入开始日期'),\n      before: Translator.trans('开始日期应早于结束日期')\n    },\n    expiryEndDate: {\n      required: Translator.trans('请输入结束日期'),\n      after: Translator.trans('结束日期应晚于开始日期')\n    }\n  }\n});\n\n$.validator.addMethod(\n  \"before\",\n  function (value, element, params) {\n    if ($('input[name=\"expiryMode\"]:checked').val() !== 'date') {\n      return true;\n    }\n    return !value || $(params).val() > value;\n  },\n  Translator.trans('开始日期应早于结束日期')\n);\n\n$.validator.addMethod(\n  \"after\",\n  function (value, element, params) {\n    if ($('input[name=\"expiryMode\"]:checked').val() !== 'date') {\n      return true;\n    }\n    return !value || $(params).val() < value;\n  },\n  Translator.trans('结束日期应晚于开始日期')\n);\n\n$('#course-submit').click(function (evt) {\n  if (validator.form()) {\n    $form.submit();\n  }\n});\n\nfunction _initDatePicker($id) {\n  let $picker = $($id);\n  $picker.datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: \"zh\",\n    minView: 2, //month\n    autoclose: true\n  });\n  $picker.datetimepicker('setStartDate', new Date());\n}"]}