{"version":3,"sources":["webpack:///./app/Resources/static-src/app/common/component/question-picker/index.js?2873","webpack:///./app/Resources/static-src/app/common/component/question-subjective/index.js?1160**","webpack:///./app/Resources/static-src/app/js/activity-manage/homework/picker/index.js"],"names":["QuestionPicker","$questionPickerBody","$questionAppendForm","$questionPickerModal","closest","_initEvent","find","on","searchQuestion","event","pickItem","questionPreview","pagination","$batchSelectSave","$","window","parent","document","batchSelectSave","$btn","currentTarget","get","attr","html","preventDefault","$this","$form","serialize","$target","replace","parseInt","data","questionId","questionIds","push","pickItemPost","url","post","replaceWith","remove","$tbody","length","append","removeClass","_refreshSeqs","modal","open","show","each","index","item","seq","$tr","hasClass","val","questionSubjectiveRemask","$element","hasSubjective","$subjectiveRemask","type","console","log","Translator","trans"],"mappings":"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","file":"app/js/activity-manage/homework/picker/index.js","sourcesContent":["import { questionSubjectiveRemask } from '../question-subjective';\n\nexport default class QuestionPicker {\n  constructor($questionPickerBody, $questionAppendForm) {\n    this.$questionPickerBody = $questionPickerBody;\n    this.$questionPickerModal = this.$questionPickerBody.closest('.modal');\n    this.$questionAppendForm = $questionAppendForm;\n    this._initEvent();\n  }\n\n  _initEvent() { \n    this.$questionPickerBody.find('[data-role=\"search-btn\"]').on('click', event=>this.searchQuestion(event));\n    this.$questionPickerBody.find('[data-role=\"picked-item\"]').on('click', event=>this.pickItem(event));\n    this.$questionPickerBody.find('[data-role=\"preview-btn\"]').on('click', event=>this.questionPreview(event));\n    this.$questionPickerBody.find('.pagination a').on('click', event=>this.pagination(event));\n\n    let $batchSelectSave = $('[data-role=\"batch-select-save\"]',window.parent.document);\n    $batchSelectSave.on('click',event=>this.batchSelectSave(event));\n  }\n\n\n  pagination(event) {\n    let $btn  =  $(event.currentTarget);\n    $.get($btn.attr('href'),html=> {\n      this.$questionPickerModal.html(html);\n    });\n    return false;\n  }\n\n  searchQuestion(event) {\n    event.preventDefault();\n    let $this = $(event.currentTarget);\n    let $form = $this.closest('form');\n    $.get($form.attr('action'), $form.serialize(), html => {\n      this.$questionPickerModal.html(html);\n    });\n  }\n\n  pickItem(event) {\n    let $target = $(event.currentTarget);\n    let replace = parseInt($target.data('replace'));\n    let questionId = $target.data('questionId');\n    let questionIds = [];\n    questionIds.push(questionId);\n    \n    this.pickItemPost($target.data('url'),questionIds,replace);\n  }\n\n  pickItemPost(url, questionIds, replace=null) {\n    \n    $.post(url, {questionIds:questionIds}, html=> {\n      if (replace) {\n        this.$questionAppendForm.find('tr[data-id=\"'+replace+'\"]').replaceWith(html);\n        this.$questionAppendForm.find('tr[data-parent-id=\"'+replace+'\"]').remove();\n      } else {\n        let $tbody = this.$questionAppendForm.find('tbody:visible');\n         //fix Firefox\n        if($tbody.length <= 0  ) {\n          $tbody = this.$questionAppendForm.find('tbody');\n        }\n        $tbody.append(html).removeClass('hide');\n      }\n      this._refreshSeqs();\n      questionSubjectiveRemask(this.$questionAppendForm);\n      this.$questionPickerModal.modal('hide');\n    });\n  }\n\n  questionPreview(event) {\n    window.open($(event.currentTarget).data('url'), '_blank',\"directories=0,height=580,width=820,scrollbars=1,toolbar=0,status=0,menubar=0,location=0\");\n  }\n\n  batchSelectSave(event) {\n    let $target = $(event.currentTarget);\n    let questionIds = [];\n    let url = $target.data('url');\n\n\n    if (this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').length == 0 ) {\n      $('.js-choice-notice',window.parent.document).show();\n      return;\n    }\n\n    this.$questionPickerBody.find('[data-role=\"batch-item\"]:checked').each(function(index,item){\n      let questionId = $(this).data('questionId');\n      questionIds.push(questionId);\n    })\n\n    this.pickItemPost(url, questionIds,null);\n  }\n\n  _refreshSeqs() {\n    let seq = 1;\n    this.$questionAppendForm.find('tbody tr').each(function(index,item) {\n      let $tr = $(item);\n      \n      if (!$tr.hasClass('have-sub-questions')) { \n        $tr.find('td.seq').html(seq);\n          seq ++;\n      }\n    });\n    this.$questionAppendForm.find('[name=\"questionLength\"]').val((seq - 1) > 0 ? (seq - 1) : null );\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-picker/index.js","export let questionSubjectiveRemask = ($element) => {\n  let hasSubjective = false;\n   let html = '';\n  let $subjectiveRemask = $(\".js-subjective-remask\");\n\n  $element.find('tbody tr').each(function() {\n    let type = $(this).data('type');\n    console.log(type);\n    if (type == 'essay') {\n      hasSubjective = true;\n    }\n  });\n  console.log(hasSubjective);\n  if(hasSubjective || $element.find('tbody tr').length == 0) {\n    $subjectiveRemask.html('');\n    return;\n  }\n\n  console.log($subjectiveRemask);\n\n  if($subjectiveRemask.data('type') == 'homework') {\n    html = Translator.trans('activity.homework_manage.objective_question_hint');\n  }\n  else {\n    html = Translator.trans('activity.homework_manage.pass_objective_question_hint');\n  }\n  $subjectiveRemask.html(html).removeClass('hidden');\n}\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/common/component/question-subjective/index.js","import QuestionPicker from 'app/common/component/question-picker';\nimport BatchSelect from 'app/common/widget/batch-select';\nimport SelectLinkage from 'app/js/question-manage/widget/select-linkage.js';\n\nlet $questionPickerBody = $('#question-picker-body',window.parent.document);\nnew QuestionPicker($questionPickerBody , $('#step2-form'));\nnew BatchSelect($questionPickerBody);\n\nnew SelectLinkage($('[name=\"courseId\"]',window.parent.document),$('[name=\"lessonId\"]',window.parent.document));\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/activity-manage/homework/picker/index.js"],"sourceRoot":""}