{% extends 'TopxiaWebBundle::layout.html.twig' %}

{% block title %}创建{% if type == 'normal' %}课程{% elseif type =='periodic' %}周期课程{% else %}直播课程{% endif %} - {{ parent() }}{% endblock %}

{% set script_controller = 'moocwebbundle/controller/course/create' %}

{% block content %}
<div class="row">
  <div class="col-md-offset-2 col-md-8">
    <div class="panel panel-default panel-page">
      <div class="panel-heading"><h2>创建{% if type == 'normal' %}课程{% elseif type =='periodic' %}周期课程{% else %}直播课程{% endif %}</h2></div>
      
      {% if not app.user.largeAvatar or not app.user.title or not userProfile.about %}
      <div class="panel-body">
        <h5><strong>请先完成以下设置，才能创建课程：</strong></h5>
        <form class="form-horizontal" id="user-profile-form" action="{{ path('settings') }}">
          <div class="form-group">
            <div class="col-md-2 control-label"><label for="user_title" class="required">用户头衔</label></div>
            <div class="col-md-8 controls">
              <input type="text" id="user_title" name="title" required="required" class="form-control"
                     data-widget-cid="widget-1" data-explain=""  value="{{ app.user.title }}">
              <div class="help-block" style="display:none;"></div>
            </div>
          </div>

          <div class="form-group">
            <div class="col-md-2 control-label"><label for="profile_about" class="required">自我介绍</label></div>
            <div class="col-md-8 controls">
              <textarea name="profile[about]" rows="10" id="profile_about" class="form-control" data-image-upload-url="{{ path('editor_upload', {token:upload_token('user')}) }}">{{ app.user.title }}</textarea>
            </div>
          </div>

          <div class="form-group">
            <div class="col-md-2 control-label"><label for="course_title" class="required">设置头像</label></div>
            <div class="col-md-8 controls">
              <img src="{{ filepath(app.user.largeAvatar, 'avatar.png') }}">
              <div class="help-block" style="display:none;"></div>
            </div>
          </div>

          <div class="form-group">
            <div class="col-md-2 control-label"></div>
            <div class="controls col-md-8 controls">
              <a id="upload-picture-btn" class="btn btn-primary webuploader-container" data-upload-token="" data-goto-url="/settings/avatar/crop" data-widget-cid="widget-0"><div class="webuploader-pick">上传新头像</div><div id="rt_rt_1aad786v61ecs5tbdts1vna1gos1" style="position: absolute; top: 8px; left: 24px; width: 70px; height: 20px; overflow: hidden; bottom: auto; right: auto;"><input type="file" name="file" class="webuploader-element-invisible" accept="image/*"><label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label></div></a>
            </div>
          </div>
          
          <div class="row">
          <div class="col-md-7 col-md-offset-2">
            <button id="profile-save-btn" data-submiting-text="正在保存" type="submit" class="btn btn-primary">保存</button>
          </div>
          </div>

          <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
        </form>
      </div>
      {% else %}
        <form id="course-create-form" class="form-horizontal" method="post">

          {{ web_macro.flash_messages() }}

          <div class="form-group">
            <div class="col-md-2 control-label"><label for="course_title" class="required">标题</label></div>
            <div class="col-md-8 controls">
              <input type="text" id="course_title" name="title" required="required" class="form-control" data-widget-cid="widget-1" data-explain="">
              <div class="help-block" style="display:none;"></div>
            </div>
          </div>

          <div class="form-group">
            <label class="col-md-2 control-label">限制加入</label>
              <div class="col-md-8 controls radios">
                {{ radios('buyable', {'0':'开启', '1':'关闭'}, course.buyable|default(1) ) }}
               <div class="help-block">开启限制加入后，学员不能主动加入，需教师从后台导入</div>
            </div>
          </div>
          
          <div class="form-group">
            <div class="col-md-offset-2 col-md-8 controls">
              <input id="course-create-btn" data-submiting-text="正在创建" class="btn btn-fat btn-primary" type="submit" value="创建">
            </div>
          </div>

          {% if not setting('copyright.owned') %}
          <div class="form-group">
            <div class="col-md-offset-2 col-md-8 controls">
              <p class="mtl"><a href="http://www.qiqiuyu.com/course/22" class="text-muted" target="_blank">如何创建课程？</a></p>
            </div>
          </div>
          {% endif %}

          <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
          <input type="hidden" name="type" value="{{ type }}">

        </form>

      {% endif %}
    </div>

  </div>

</div>
{% endblock %}