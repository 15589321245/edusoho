{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/cashier/coin.js?8973","webpack:///./app/Resources/static-src/app/js/cashier/mobile/index.js"],"names":["Coin","$coinContainer","cashierForm","$container","cashierFrom","maxCoinInput","data","initEvent","self","on","$this","$","event","currentTarget","inputCoinNum","val","isNaN","hidePasswordInput","showPasswordInput","calcPayPrice","find","rules","required","passwordCheck","closest","show","hide","CashierForm","$form","validator","validate","initCoin","$coin","length","coin","coinAmount","post","text","resp","hasClass","addClass","siblings","removeClass","attr","valid","submit"],"mappings":"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","file":"app/js/cashier/mobile/index.js","sourcesContent":["export default class Coin {\n  constructor($coinContainer, cashierForm) {\n    this.$container = $coinContainer;\n    this.cashierFrom = cashierForm;\n    this.maxCoinInput = this.$container.data('maxAllowCoin') > this.$container.data('coinBalance') ? this.$container.data('coinBalance') : this.$container.data('maxAllowCoin');\n    this.initEvent();\n  }\n\n  validate() {\n\n  }\n\n  initEvent() {\n    let self = this;\n    this.$container.on('blur', '.js-coin-amount', event => {\n      let $this = $(event.currentTarget);\n      let inputCoinNum = $this.val();\n      if(isNaN(inputCoinNum) || inputCoinNum <= 0){\n        $this.val(0);\n        self.hidePasswordInput();\n      }\n\n      if ($this.val() > self.maxCoinInput) {\n        $this.val(self.maxCoinInput);\n      }\n\n      if ($this.val() > 0) {\n        self.showPasswordInput();\n        self.cashierFrom.calcPayPrice($this.val());\n      }\n\n    });\n\n  }\n\n  showPasswordInput() {\n    this.$container.find('[name=\"payPassword\"]').rules('add', { required: true, passwordCheck: true});\n    this.$container.find('.js-pay-password').closest('div').show();\n  }\n\n  hidePasswordInput() {\n    this.$container.find('[name=\"payPassword\"]').rules('remove','required passwordCheck');\n    this.$container.find('.js-pay-password').closest('div').hide();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/coin.js","import Coin from 'app/js/cashier/coin';\nimport notify from 'common/notify';\n\nclass CashierForm {\n  constructor($form) {\n    this.$container = $form;\n\n    this.validator = this.$container.validate();\n\n    this.initEvent();\n    this.initCoin();\n  }\n\n  initCoin() {\n    let $coin = $('#coin-use-section');\n    if ($coin.length > 0) {\n      this.coin = new Coin($coin, this);\n    }\n  }\n\n  calcPayPrice(coinAmount) {\n\n    let self = this;\n    $.post(this.$container.data('priceUrl'), {\n      coinAmount: coinAmount\n    }, resp => {\n      self.$container.find('.js-pay-price').text(resp.data);\n    });\n\n\n  }\n\n  initEvent() {\n    // 支付方式切换\n    this.$container.on('click', '.check', event => {\n      let $this = $(event.currentTarget);\n      if (!$this.hasClass('active') && !$this.hasClass('disabled')) {\n        $this.addClass('active').siblings().removeClass('active');\n        $(\"input[name='payment']\").val($this.attr(\"id\"));\n      }\n    });\n\n    let $form = this.$container;\n    $form.on('click', '.js-pay-btn', event => {\n      if ($form.valid()) {\n        $form.submit();\n      }\n\n    });\n  }\n}\n\n\nnew CashierForm($('#cashier-form'));\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/cashier/mobile/index.js"],"sourceRoot":""}