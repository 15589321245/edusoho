{% extends 'TopxiaWebBundle::layout.html.twig' %}

{% block title %} 支付中心 - {{ parent() }}{% endblock %}


{% block content %}

<div class="container order-pay pay-center">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 ptl">
      <div class="panel panel-default panel-page">
        <div class="panel-heading">
          {% if setting("payment.enabled")|default(true) and setting("payment.alipay_enabled")|default(true) %}
          {{ web_macro.flash_messages() }}
          {% endif %}
          <h4>{{order.title}} 
            <span style="color:#999;font-size:12px">订单号：{{order.sn}}</span>
          </h4>
        </div>
        <hr/>
        <div class="panel-body">
          {% if not (setting("payment.enabled")|default(true) and setting("payment.alipay_enabled")|default(true)) %}
          <div class="alert alert-info">{{ setting('payment.disabled_message')|default('尚未开启支付模块，无法完成支付。')|raw }}</div>
          {% else %}
          <form method="post" action="{{path('pay_center_pay')}}">
            <input type="hidden" name="orderId" value="{{order.id}}"/>
            
            <input type="hidden" name="_csrf_token" value="{{ csrf_token('site') }}">
            <div class="row">

              {% if order.targetType == "course" %}
              <div class="form-group">
                <div class="col-md-7 ">
                  {% if order.coupon %}
                  <div class="check">
                    <span>已使用优惠码</span>
                    <span class="icon"></span>
                  </div>
                  {% else %}
                  <div class="uncheck">
                    <span>未使用优惠码</span>
                    <span class="icon"></span>
                  </div>
                  {% endif %}
                </div>
              </div>
              {% endif %}
              
            	<div class="form-group">
                <div class="col-md-7">
                  <div class="pay-type-lable">支付方式</div>
                  {% for payment, options in payments %}
                  <div class="check">
                    <img src="{{ asset('assets/img/order/alipay.gif') }}" width="100px"/>
                    <span class="icon"></span>
                  </div>
                  {% endfor %}
                </div>
              </div>
            </div>
            <hr/>
            <div class="form-group pay pay-amount">
              <div>实付金额：
                <span>￥{{order.amount}}</span>
              </div>

              <div>
                <button class="pay-button btn btn-fat btn-primary btn-lg"  type="submit">去支付</button>

                <div class="help">下单后，请在40小时内完成支付。<br>超出40小时再支付可能导致购买失败，需重新下单购买。</div>
              </div>
            </div>
          </form>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}