{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/index.js"],"names":["initItem","dataSourceUi","value","item","itemId","label","seq","length","outputValue","push","removeItem","i","splice","updateItemSeq","data","datas","temps","j","MultiInput","props","event","id","currentTarget","attributes","state","setState","sortItem","addItem","dataSource","map","index","outputSets","sortable","listClassName","searchable","addable","outputDataElement","list","getList","getOutputSets","JSON","stringify","propTypes","multiInputClassName","PropTypes","string","array","isRequired","bool","shape","enable","url","showAddBtnGroup","defaultProps","childContextTypes","func"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport List from './list';\nimport InputGroup from './input-group';\nimport { getRandomString } from './part';\nimport '!style!css!less!./style.less';\n\nfunction initItem(dataSourceUi,value) {\n  let item = {\n    itemId: getRandomString(),\n    label: value,\n    seq: dataSourceUi.length + 1,\n    outputValue: value\n  };\n  dataSourceUi.push(item);\n}\n\nfunction removeItem(dataSourceUi,itemId) {\n  for(let i = 0; i< dataSourceUi.length ;i++) {\n    if(dataSourceUi[i].itemId==itemId) {\n      dataSourceUi.splice(i, 1);\n      i--;\n    }else {\n      dataSourceUi[i].seq = i+1;\n    }\n  }\n}\n\nfunction updateItemSeq(data,datas) {\n  let temps = [];\n  for(let i = 0;i<data.length ; i++) {\n    for(let j = 0; j<datas.length;j++) {\n      if(data[i] == datas[j].itemId) {\n        datas[j].seq= i+1;\n        temps.push(datas[j]);\n      }\n    }\n  }\n  return temps;\n}\n\nexport default class MultiInput extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentWillMount() {\n    this.state = {\n      dataSourceUi: [],\n    }\n    this.props.dataSource.map((item,index)=>{\n      initItem(this.state.dataSourceUi,item);\n    })\n  }\n\n  getChildContext() {\n    return {\n      removeItem: this.removeItem,\n      sortItem: this.sortItem,\n      addItem: this.addItem,\n    }\n  }\n\n  removeItem = (event) => {\n    let id = event.currentTarget.attributes[\"data-item-id\"].value;\n    removeItem(this.state.dataSourceUi,id);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  sortItem = (datas) => {\n    this.state.dataSourceUi = updateItemSeq(datas,this.state.dataSourceUi);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n\n  addItem = (value,data) => {\n    initItem(this.state.dataSourceUi,value);\n    this.setState({\n      dataSourceUi: this.state.dataSourceUi,\n    });\n  }\n  \n  getOutputSets() {\n    //应该优化成表单数据进行填充\n    let outputSets = [];\n    this.state.dataSourceUi.map((item,index)=>{\n      outputSets.push(item.outputValue);\n    }) \n    return outputSets;\n\n  }\n\n  getList() {\n    const { sortable,listClassName } = this.props;\n    return (<List sortable={ sortable } listClassName={ listClassName } dataSourceUi = {this.state.dataSourceUi}></List>);\n  }\n\n  render (){\n    const { searchable, addable, outputDataElement} = this.props;\n    let list =  this.getList();\n    let outputSets = this.getOutputSets();\n    return (\n      <div className=\"multi-group\">\n        {list}\n        <InputGroup searchable = { searchable } addable = { addable } />\n        <input type='hidden' name={outputDataElement} value={JSON.stringify(outputSets)} />\n      </div>\n    );\n  }\n}\n\nMultiInput.propTypes = {\n  multiInputClassName: React.PropTypes.string,\n  listClassName: React.PropTypes.string,\n  dataSource: React.PropTypes.array.isRequired,\n  sortable: React.PropTypes.bool, \n  addable:React.PropTypes.bool,\n  searchable: React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n  showAddBtnGroup: React.PropTypes.bool,\n};\n\nMultiInput.defaultProps = {\n  multiInputClassName:'multi-group',\n  listClassName:'',\n  dataSource: [],//必须是数组\n  sortable: true,\n  addable: true,\n  searchable: {\n    enable: false,\n    url: '',\n  },//必须是bool\n  showAddBtnGroup: true,\n  outputDataElement:'hidden-input',//必须是string,\n};\n\nMultiInput.childContextTypes = {\n  removeItem: React.PropTypes.func,\n  sortItem: React.PropTypes.func,\n  addItem: React.PropTypes.func,\n};\n\n\n"]}