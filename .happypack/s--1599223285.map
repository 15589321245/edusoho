{"version":3,"sources":["app/Resources/static-src/app/common/component/multi-input/input-group.js"],"names":["InputGroup","props","state","itemName","searched","resultful","searchResult","searchable","context","enable","searchableUrl","url","subscribeMessage","subscribe","channel","topic","callback","console","log","handleAdd","name","data","addItem","setState","event","value","currentTarget","length","setTimeout","itemData","handleNameChange","onFocus","blurAdd","selectChange","addable","contextTypes","PropTypes","func","bool","shape","string"],"mappings":"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","file":"input-group.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import React, { Component } from 'react';\nimport { trim } from '../../unit';\nimport { send } from '../../server';\nimport Options from './options';\nimport postal from 'postal';\n\nexport default class InputGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      itemName: \"\",\n      searched: true,\n      resultful: false,\n      searchResult: [],\n    }\n\n    this.searchable = this.context.searchable.enable;\n    this.searchableUrl = this.context.searchable.url;\n    this.subscribeMessage();\n  }\n\n  subscribeMessage() {\n    postal.subscribe({\n      channel: \"courseInfoMultiInput\",\n      topic: \"addMultiInput\",\n      callback: () => {\n        console.log('add');\n        this.handleAdd();\n      }\n    });\n  }\n\n  selectChange(name, data) {\n    if (data) {\n      this.context.addItem(name, data);\n    }\n    this.setState({\n      itemName: '',\n    });\n  }\n\n  onFocus(event) {\n    //在这种情况下，重新开启搜索功能；\n    this.setState({\n      searched: true,\n    })\n  }\n\n  handleNameChange(event) {\n    // let value = trim(event.currentTarget.value);\n    let value = event.currentTarget.value;\n    this.setState({\n      itemName: value,\n      searchResult: [],\n      resultful: false,\n    });\n\n    if (this.searchable && value.length > 0 && this.state.searched) {\n      setTimeout(() => {\n        send(this.searchableUrl + value, searchResult => {\n          if (this.state.itemName.length > 0) {\n            console.log({ 'searchResult': searchResult });\n            this.setState({\n              searchResult: searchResult,\n              resultful: true,\n            });\n          }\n        });\n      }, 100)\n    }\n  }\n\n  handleAdd() {\n    if (trim(this.state.itemName).length > 0) {\n      this.context.addItem(this.state.itemName, this.state.itemData);\n    }\n    this.setState({\n      itemName: '',\n      searchResult: [],\n      resultful: false,\n    })\n  }\n\n  render() {\n    console.log(this.context);\n    return (\n      <div className=\"input-group\">\n        <input className=\"form-control\" value={this.state.itemName} onChange={event => this.handleNameChange(event)} onFocus={event => this.onFocus(event)} onBlur={event => this.blurAdd(event)} />\n        {this.searchable && this.state.resultful && <Options searchResult={this.state.searchResult} selectChange={(event, name) => this.selectChange(event, name)} resultful={this.state.resultful} />}\n        {this.context.addable && <span className=\"input-group-btn\"><a className=\"btn btn-default\" onClick={() => this.handleAdd()}>添加</a></span>}\n      </div>\n    );\n  }\n}\n\nInputGroup.contextTypes = {\n  addItem: React.PropTypes.func,\n  addable: React.PropTypes.bool,\n  searchable:  React.PropTypes.shape({\n    enable: React.PropTypes.bool,\n    url: React.PropTypes.string,\n  }),\n};\n"]}