{% extends 'old-bootstrap-modal-layout.html.twig' %}

{% block title %}
  {{ '退款详情'|trans }}
{% endblock %}

{% block body %}
  <table class="table cd-table table-striped order-refund-detail-table">
    <tr>
      <td width="25%">{{'退款号'|trans}}</td>
      <td width="75%">{{ orderRefund.sn }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '退款人'|trans }}</td>
      <td width="75%">
        <strong>
          {{ web_macro.user_link(applyUser) }}
        </strong>
      </td>
    </tr>
    <tr>
      <td width="25%">{{ '退款申请时间'|trans }}</td>
      <td width="75%">{{ orderRefund.created_time|date('Y-n-d H:i:s') }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '退款理由'|trans }}</td>
      <td width="75%">{{ orderRefund.reason|trans }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '订单号'|trans }}</td>
      <td width="75%">{{ order.sn }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '商品名称'|trans }}</td>
      <td width="75%">{{ order.title }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '应付价格'|trans }}</td>
      <td width="75%"><span class="color-warning">{{ order.pay_amount|fen_to_yuan(0) }}</span> {{ 'site.currency.CNY'|trans }}</td>
    </tr>
    <tr>
      <td width="25%" class="text-muted" style="text-align: right">{{ 'user.account.my_coin.pay_coin'|trans({'%coin_name%' : setting('coin.coin_name')|default("finance.coin"|trans)}) }}</td>
      <td width="75%"><span class="color-warning">
      {{ order.paid_coin_amount|fen_to_yuan(0) }}</span>
        (等于 <span class="color-warning">{{ (order.pay_amount - order.paid_cash_amount)|fen_to_yuan(0) }}</span> {{ 'site.currency.CNY'|trans }})
      </td>
    </tr>
    <tr>
      <td width="25%" class="text-muted" style="text-align: right">{{ '实付现金'|trans }}</td>
      <td width="75%"><span class="color-warning">{{ order.paid_cash_amount|fen_to_yuan(0) }}</span> {{ 'site.currency.CNY'|trans }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '付款时间'|trans }}</td>
      <td width="75%">{{ order.pay_time|date('Y-n-d H:i:s') }}</td>
    </tr>
    <tr>
      <td width="25%">{{ '处理状态'|trans }}</td>
      <td width="75%">{{ dict_text('refundStatus', orderRefund.status) }}</td>
    </tr>

    {% if orderRefund.status in ['refunded', 'refused'] %}
      <tr>
        <td width="25%">{{ '处理时间'|trans }}</td>
        <td width="75%">{% if orderRefund.status in ['refunded', 'refused'] %}{{ orderRefund.deal_time|date('Y-n-d H:i:s') }}{% else %}--{% endif %}</td>
      </tr>
      {% if orderRefund.status in ['refunded'] %}
        <tr>
          <td width="25%">{{ '退款总额'|trans }}</td>
          <td width="75%"><span class="color-warning">{{ orderRefund.amount|fen_to_yuan(0) }}</span> {{ 'site.currency.CNY'|trans }}</td>
        </tr>
        <tr>
          <td width="25%" class="text-muted" style="text-align: right">{{ 'user.account.my_coin.refunded_coin'|trans({'%coin_name%' : setting('coin.coin_name')|default("finance.coin"|trans)}) }}</td>
          <td width="75%">
            <span class="color-warning">{{ orderRefund.refund_coin_amount|fen_to_yuan(0) }}</span>
          </td>
        </tr>
        <tr>
          <td width="25%" class="text-muted" style="text-align: right">{{ '已退现金'|trans }}</td>
          <td width="75%"><span class="color-warning">{{ orderRefund.refund_cash_amount|fen_to_yuan(0) }}</span> {{ 'site.currency.CNY'|trans }}</td>
        </tr>
      {% endif %}
      <tr>
        <td width="25%">{{ '反馈信息'|trans }}</td>
        <td width="75">{{ orderRefund.deal_reason }}</td>
      </tr>
      <tr>
        <td width="25%">{{ '处理人'|trans }}</td>
        <td width="75%">
          <strong>
            {{ web_macro.user_link(dealUser) }}
          </strong>
        </td>
      </tr>
    {% endif %}

  </table>
{% endblock %}

{% block footer %}
  <button type="button" class="btn btn-primary" data-dismiss="modal">{{ 'form.btn.close'|trans }}</button>
{% endblock %}

