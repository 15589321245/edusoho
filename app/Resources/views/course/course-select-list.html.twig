{% import "macro.html.twig" as web_macro %}
<style>
.course-wide-list .enabled:hover{
    background: #eee;
    border-color: #ddd;
}

.course-wide-list .enabled{
    cursor: default;
    background: #eee;
}

</style>
<table class="table table-striped">
  <thead>
    <tr>
      <th width="10%" ><input class="course-item-cbx" style="float:left;" type="checkbox" ></th>
      <th width="30%">课程名称</th>
      <th width="30%">教学计划名称</th>
      <th>教师名称</th>
      <th>价格</th>
    </tr>
  </thead>
  <tbody>
    {% if courseSets|default(null) %}
    {% for courseSet in courseSets %}
    <tr>
      <td class="vertical-middle" data-id="{{courseSet.id}}">
        <input class="course-item-cbx" style="float:left;" type="checkbox" name="course-{{courseSet.id}}">
      </td>
      <td>
        <a class="pull-left mr5" href="{{ path('course_set_show',{id:courseSet.id}) }}" target="_blank">
          <img class="course-picture" src="{{ filepath(courseSet.cover['middle']|default(null), 'courseSet.png') }}" alt="{{ courseSet.title }}" width="100">
        </a>
        <div class="mlm">
          <a href="{{ path('course_set_show',{id:courseSet.id}) }}">{{ courseSet.title }}</a>
        </div>
      </td>
      <td>
        {% if courseSet.courses|length == 1 %}
          {% for course in courseSet.courses %}
            {{course.title}}
          {% endfor %}
          <select class="form-control js-course-select width-150 hidden" id="course-select-{{courseSet.id}}" style="width:80%;display: inline-block;">
            {% if courseSet.courses %}
              {% for course in courseSet.courses %}
                  {{course.title}}
                  <option value="{{course.id}}">{{course.title}}</option>
              {% endfor %}
            {% endif %}
          </select>
        {% else %}
          <select class="form-control js-course-select width-150" id="course-select-{{courseSet.id}}" style="width:80%;display: inline-block;">
            {% if courseSet.courses %}
              {% for course in courseSet.courses %}
                  {{course.title}}
                  <option value="{{course.id}}">{{course.title}}</option>
              {% endfor %}
            {% endif %}
          </select>
          <a class="color-gray" data-toggle="tooltip" data-trigger="hover" data-placement="top" title="课程下包含多个教学计划，请选择需要复制的教学计划！"><i class="es-icon es-icon-help"></i></a>
        {% endif %}
      </td>
      <td>
        {% set teacher = users[courseSet.creator]|default(null) %}
        {% if teacher %}
          <div class="teacher">
            <a class="teacher-nickname ellipsis" target="_blank"  href="{{ path('user_show', {id:teacher.id}) }}">{{ teacher.nickname }}</a>
          </div>
        {% endif %}
      </td>
      <td>
        {% if setting('coin.coin_enabled') and setting('coin.price_type') == 'Coin' %}
          <span class="course-price" style="display:inline">
            {% if courseSet.price|default(0) > 0 %}
               {{'价格：'|trans}} {{ courseSet.price * setting('coin.cash_rate')}}{{setting('coin.coin_name')}}
            {% else %}
              {{'免费'|trans}}
            {% endif %}
          </span>
        {% else %}
          <span class="course-price">
            {% if courseSet.price|default(0) > 0 %}
               {{'价格 : %price%元'|trans({'%price%': courseSet.price })}}
            {% else %}
              {{'免费'|trans}}
            {% endif %}
          </span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
    {% endif %}
  </tbody>
</table>
<label class="ml10"><input type="checkbox" class="ml10"/>全选</label>
{#<ul class="course-wide-list test">
  {% if courseSets|default(null) %}
  {% for courseSet in courseSets %}
  <li class="course-item clearfix" data-id="{{courseSet.id}}" >
    <input class="course-item-cbx" style="float:left;" type="checkbox" name="course-{{courseSet.id}}">
    <a class="course-picture-link" href="{{ path('course_set_show',{id:courseSet.id}) }}" target="_blank">
      <img class="course-picture" src="{{ filepath(courseSet.cover['middle']|default(null), 'courseSet.png') }}" alt="{{ courseSet.title }}">
    </a>
    <div class="course-body">
      <div style="float:right;" class="text-muted mrm mls">
        {% if setting('coin.coin_enabled') and setting('coin.price_type') == 'Coin' %}
          <span class="course-price" style="display:inline">
            {% if courseSet.price|default(0) > 0 %}
               {{'价格：'|trans}} {{ courseSet.price * setting('coin.cash_rate')}}{{setting('coin.coin_name')}}
            {% else %}
              {{'免费'|trans}}
            {% endif %}
          </span>
        {% else %}
          <span class="course-price">
            {% if courseSet.price|default(0) > 0 %}
               {{'价格 : %price%元'|trans({'%price%': courseSet.price })}}
            {% else %}
              {{'免费'|trans}}
            {% endif %}
          </span>
        {% endif %}

        {% if setting('course.show_student_num_enabled', '1') == 1 %}
          <span class="divider"></span>
          <span class="text-muted mrm mls"><strong>{{ courseSet.studentNum }}</strong>{{ default.user_name|default('学员'|trans) }}</span>
        {% endif %}

      </div>

      <h4 class="course-title"><a href="{{ path('course_show',{id:courseSet.id}) }}" target="_blank">{{ courseSet.title }}</a>
      {% if courseSet.serializeMode=='serialize' %}
        <span class="label label-success ">{{'更新中'|trans}}</span>
      {% elseif courseSet.serializeMode=='finished' %}
        <span class="label label-warning ">{{'已完结'|trans}}</span>
      {% endif %}

      {% if courseSet.type == 'live' %}
          {% set lesson = course['lesson']|default(null) %}
          {% if lesson and "now"|date("U") >= lesson.startTime and "now"|date("U") <= lesson.endTime %}
            <span class="label label-warning">{{'正在直播中'|trans}}</span>
          {% else %}
            <span class="label label-success">{{'直播'|trans}}</span>
          {% endif %}
      {% endif %}
      </h4>

      {% if courseSet.type == 'live' %}
        {% set lesson = courseSet.lesson|default(null) %}
        {% if lesson %}
          <div class="live-course-lesson mbm">
            <span class="text-success fsm mrm">{{ lesson.startTime|date('n月j日 H:i'|trans) }} ~ {{ lesson.endTime|date('n月j日 H:i'|trans) }}</span>
            <span class="text-muted fsm mrm">{{'第%number%课时'|trans({'%number%': lessom.number})}}</span>
          </div>
        {% endif %}
      {% else %}
        <div class="course-about ellipsis">{{ courseSet.summary|raw }}</div>
      {% endif %}

      <div class="course-footer clearfix">
        {% set teacher = users[courseSet.creator]|default(null) %}
        {% if teacher %}
          <div class="teacher">
            <a href="{{ path('user_show', {id:teacher.id}) }}" target="_blank"><img src="{{ filepath(teacher.smallAvatar, 'courseSet.png') }}" class="teacher-avatar"></a>
            <a class="teacher-nickname ellipsis" target="_blank"  href="{{ path('user_show', {id:teacher.id}) }}">{{ teacher.nickname }}</a>
            <span class="teacher-title ellipsis">{{ teacher.title }}</span>
          </div>
        {% endif %}
        <div class="pull-right">
          <select class="form-control js-course-select" id="course-select-{{courseSet.id}}">
            {% if courseSet.courses %}
              {% for course in courseSet.courses %}
                <option value="{{course.id}}">{{course.title}}</option>
              {% endfor %}
            {% endif %}
          </select>
        </div>
        <div class="course-metas-{{courseSet.id}}" style="display:none;">
          <span class="glyphicon glyphicon-ok pull-right" style="z-index:100;color:#02b980;font-size:30px;"></span>
        </div>

      </div>
    </div>
  </li>
  {% endfor %}
  {% else %}
  <div class="empty">{{'找不到相关课程！'|trans}}</div>
  {% endif %}
</ul>#}

{% if type|default('') == 'ajax_pagination' %}
{{ web_macro.ajax_paginator(paginator) }}
{% else %}
{{ web_macro.paginator(paginator) }}
{% endif %}