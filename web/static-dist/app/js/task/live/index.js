webpackJsonp(["app/js/task/live/index"],[function(t,r,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(r,n,a){return n&&t(r.prototype,n),a&&t(r,a),r}}(),o=n("da32dea28c2b82c7aab1"),i=a(o),l=function(){function t(){e(this,t),this.init()}return s(t,[{key:"init",value:function(){function t(){i+=u;var t=parseInt(s-i),p=parseInt(o-i),c=Math.floor(t/86400),T=t%86400,f=Math.floor(T/3600);T%=3600;var y=Math.floor(T/60),m=T%60,h=Translator.trans("老师们：");h+="<br>",1==n.ext.liveProvider?(h+="&nbsp;&nbsp;&nbsp;&nbsp;"+Translator.trans("录制直播课程时，需在直播课程间点击"),h+="<span style='color:red'>"+Translator.trans("录制面板")+"</span>",h+=Translator.trans("，录制完成后点击"),h+="<span style='color:red'>"+Translator.trans("暂停")+"</span>",h+=Translator.trans("结束录播，录播结束后在"),h+="<span style='color:red'>"+Translator.trans("录播管理")+"</span>",h+=Translator.trans("界面生成回放。"),h+="<br>"):(h+="&nbsp;&nbsp;&nbsp;&nbsp;",h+=Translator.trans("直播平台")+"<span style='color:red'>"+Translator.trans("下课后")+"</span>"+Translator.trans("且")+"<span style='color:red'>"+Translator.trans("直播时间")+"</span>"+Translator.trans("结束后，在课时管理的"),h+="<span style='color:red'>"+Translator.trans("录播管理")+"</span>",h+=Translator.trans("点击生成回放。"),h+="<br>");var g=r._getCountDown(c,f,y,m);0<t&&t<7200&&(d="<p>"+Translator.trans("直播将于%liveStartTime%开始，于%liveEndTime%结束，请在课前10分钟内提早进入。",{liveStartTime:"<strong>"+a+"</strong>",liveEndTime:"<strong>"+e+"</strong>"})+"</p>",n.isTeacher?(g=h+g,g="<p>"+g+"&nbsp;<a class='btn btn-primary js-start-live' href='javascript:;' onclick='liveShow.entryLiveRoom()'>"+Translator.trans("进入直播教室")+"</a><br><br></p>"):g="<p>"+g+"&nbsp;<a class='btn btn-primary js-start-live' href='javascript:;' onclick='liveShow.entryLiveRoom()'>"+Translator.trans("进入直播教室")+"</a><br><br></p>"),t<=0&&(clearInterval(b),d="<p>"+Translator.trans("直播已经开始，直播将于%liveEndTime%结束。",{liveEndTime:"<strong>"+e+"</strong>"})+"</p>",n.isTeacher?(g=h,g+="<p><a class='btn btn-primary js-start-live' href='javascript:;' onclick='liveShow.entryLiveRoom()'>"+Translator.trans("进入直播教室")+"</a><br><br></p>"):g="<p><a class='btn btn-primary js-start-live' href='javascript:;' onclick='liveShow.entryLiveRoom()'>"+Translator.trans("进入直播教室")+"</a><br><br></p>"),p<=0&&(d="<p style='margin: 10px 0 0 10px; font-weight: bold; font-size: 1.5em;'>"+Translator.trans("直播已经结束")+"</p>",g="","videoGenerated"==v?(g+="<button class='btn btn-primary live-video-play-btn' data-lesson-id='"+n.id+"'>查看回放</button>&nbsp;&nbsp;",$("body").on("click",".live-video-play-btn",function(){return 0==n.ext.liveId||$.inArray("liveMediaError",n)!=-1&&""!=n.liveMediaError?void Notify.danger("抱歉，视频文件不存在，暂时无法学习。"):($("#lesson-live-content").hide(),$("#lesson-video-content").html(""),void self._videoPlay(n))})):n.replays&&n.replays.length>0&&$.each(n.replays,function(t,r){g+="<a class='btn btn-primary' href='"+r.url+"' target='_blank'>"+r.title+"</a>&nbsp;&nbsp;"}));var w=d+'<div style="padding:15px 15px 15px 30px; border-bottom:1px dashed #ccc; height: auto;">'+l+"</div><br>"+g;$("#lesson-live-content").find(".lesson-content-text-body").html(w),u++}var r=this,n=JSON.parse($("#activity-data").text()),a=n.startTimeFormat,e=n.endTimeFormat,s=parseInt(n.startTime),o=parseInt(n.endTime),i=parseInt(n.nowDate),l=$("#activity-summary").text(),p=n.fromCourseId,c=n.id,v=null,d="<p>"+Translator.trans("直播将于%liveStartTime%开始，于%liveEndTime%结束，请在课前10分钟内提早进入。",{liveStartTime:"<strong>"+a+"</strong>",liveEndTime:"<strong>"+e+"</strong>"})+"</p>",b=void 0;b&&clearInterval(b);var u=0;this.entry_url=location.protocol+"//"+location.hostname+"/course/"+p+"/activity/"+c+"/live_entry",t(),o>i&&(b=setInterval(t,1e3)),$("#lesson-live-content").show(),$("#lesson-live-content").scrollTop(0),r.started=!1}},{key:"entryLiveRoom",value:function(){var t=this;if(!t.started){t.started=!0;var r=new i.default;r.emit("start",{}).then(function(){}).catch(function(t){})}window.open(t.entry_url,"_blank")}},{key:"_getCountDown",value:function(t,r,n,a){var e=Translator.trans("还剩: ");return e+=t?"<strong class='text-info'>"+t+"</strong>"+Translator.trans("天"):"",e+=r?"<strong class='text-info'>"+r+"</strong>"+Translator.trans("小时"):"",e+=n?"<strong class='text-info'>"+n+"</strong>"+Translator.trans("分钟"):"",e+=a?"<strong class='text-info'>"+a+"</strong>"+Translator.trans("秒"):""}}]),t}();window.liveShow=new l}]);