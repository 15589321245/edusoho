{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/attachment/index.js"],"names":["$modal","$","$uploader","find","uploader","UploaderSDK","id","attr","initUrl","data","finishUrl","accept","process","fileSingleSizeLimit","ui","locale","document","documentElement","lang","on","type","message","file","length","minute","parseInt","second","Math","round","val","$metas","currentTarget","$ids","$list","get","html","append","modal","siblings","hide","one","event","destroy"],"mappings":";;;;;;AAAA;;;;;;AAEA,KAAIA,SAASC,EAAE,mBAAF,CAAb;AACA,KAAIC,YAAYF,OAAOG,IAAP,CAAY,qBAAZ,CAAhB;;AAEA,KAAIC,WAAW,IAAIC,WAAJ,CAAgB;AAC7BC,OAAIJ,UAAUK,IAAV,CAAe,IAAf,CADyB;AAE7BC,YAASN,UAAUO,IAAV,CAAe,SAAf,CAFoB;AAG7BC,cAAWR,UAAUO,IAAV,CAAe,WAAf,CAHkB;AAI7BE,WAAQT,UAAUO,IAAV,CAAe,QAAf,CAJqB;AAK7BG,YAASV,UAAUO,IAAV,CAAe,SAAf,CALoB;AAM7BI,wBAAqBX,UAAUO,IAAV,CAAe,qBAAf,CANQ;AAO7BK,OAAI,QAPyB;AAQ7BC,WAAQC,SAASC,eAAT,CAAyBC;AARJ,EAAhB,CAAf;;AAWAd,UAASe,EAAT,CAAY,OAAZ,EAAqB,UAASC,IAAT,EAAe;AAClC,yBAAO,QAAP,EAAiBA,KAAKC,OAAtB;AACD,EAFD;;AAIAjB,UAASe,EAAT,CAAY,aAAZ,EAA2B,UAACG,IAAD,EAAU;AACnC,OAAIA,KAAKC,MAAL,IAAeD,KAAKC,MAAL,GAAc,CAAjC,EAAoC;AAClC,SAAIC,SAASC,SAASH,KAAKC,MAAL,GAAc,EAAvB,CAAb;AACA,SAAIG,SAASC,KAAKC,KAAL,CAAWN,KAAKC,MAAL,GAAc,EAAzB,CAAb;AACAtB,OAAE,SAAF,EAAa4B,GAAb,CAAiBL,MAAjB;AACAvB,OAAE,SAAF,EAAa4B,GAAb,CAAiBH,MAAjB;AACAzB,OAAE,SAAF,EAAa4B,GAAb,CAAiBL,SAAS,EAAT,GAAcE,MAA/B;AACD;;AAED,OAAMI,SAAS7B,EAAE,qBAAF,CAAf;AACA,OAAM8B,gBAAgBD,OAAOrB,IAAP,CAAY,eAAZ,CAAtB;;AAEA,OAAIuB,OAAO/B,EAAE,MAAM6B,OAAOrB,IAAP,CAAY,UAAZ,CAAR,CAAX;AACA,OAAIwB,QAAQhC,EAAE,MAAM6B,OAAOrB,IAAP,CAAY,WAAZ,CAAR,CAAZ;AACA,OAAIsB,iBAAiB,EAArB,EAAyB;AACvBC,YAAO/B,EAAE,gBAAc8B,aAAd,GAA4B,GAA9B,EAAmC5B,IAAnC,CAAwC,MAAM2B,OAAOrB,IAAP,CAAY,UAAZ,CAA9C,CAAP;AACAwB,aAAQhC,EAAE,gBAAc8B,aAAd,GAA4B,GAA9B,EAAmC5B,IAAnC,CAAwC,MAAM2B,OAAOrB,IAAP,CAAY,WAAZ,CAA9C,CAAR;AACD;;AAEDR,KAAEiC,GAAF,CAAM,sBAAsBZ,KAAKhB,EAA3B,GAAgC,OAAtC,EAA+C,UAAU6B,IAAV,EAAgB;AAC7DF,WAAMG,MAAN,CAAaD,IAAb;AACAH,UAAKH,GAAL,CAASP,KAAKhB,EAAd;AACAN,YAAOqC,KAAP,CAAa,MAAb;AACAJ,WAAMK,QAAN,CAAe,iBAAf,EAAkCC,IAAlC;AACD,IALD;AAMD,EAzBD;;AA2BA;AACAvC,QAAOwC,GAAP,CAAW,eAAX,EAA4B,UAACC,KAAD,EAAW;AACrCrC,YAASsC,OAAT;AACAtC,cAAW,IAAX;AACD,EAHD,E","file":"app/js/attachment/index.js","sourcesContent":["import notify from \"common/notify\";\n\nlet $modal = $('#attachment-modal');\nlet $uploader = $modal.find('#uploader-container');\n\nlet uploader = new UploaderSDK({\n  id: $uploader.attr('id'),\n  initUrl: $uploader.data('initUrl'),\n  finishUrl: $uploader.data('finishUrl'),\n  accept: $uploader.data('accept'),\n  process: $uploader.data('process'),\n  fileSingleSizeLimit: $uploader.data('fileSingleSizeLimit'),\n  ui: 'single',\n  locale: document.documentElement.lang\n});\n\nuploader.on('error', function(type) {\n  notify('danger', type.message);\n});\n\nuploader.on('file.finish', (file) => {\n  if (file.length && file.length > 0) {\n    let minute = parseInt(file.length / 60);\n    let second = Math.round(file.length % 60);\n    $(\"#minute\").val(minute);\n    $(\"#second\").val(second);\n    $(\"#length\").val(minute * 60 + second);\n  }\n\n  const $metas = $('[data-role=\"metas\"]');\n  const currentTarget = $metas.data('currentTarget');\n\n  let $ids = $('.' + $metas.data('idsClass'));\n  let $list = $('.' + $metas.data('listClass'));\n  if (currentTarget != '') {\n    $ids = $('[data-role='+currentTarget+']').find('.' + $metas.data('idsClass'));\n    $list = $('[data-role='+currentTarget+']').find('.' + $metas.data('listClass'));\n  }\n\n  $.get('/attachment/file/' + file.id + '/show', function (html) {\n    $list.append(html);\n    $ids.val(file.id);\n    $modal.modal('hide');\n    $list.siblings('.js-upload-file').hide();\n  })\n});\n\n//只执行一次\n$modal.one('hide.bs.modal', (event) => {\n  uploader.destroy();\n  uploader = null;\n});\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/attachment/index.js"],"sourceRoot":""}