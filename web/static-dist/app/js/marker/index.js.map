{"version":3,"sources":["webpack:///./app/Resources/static-src/app/js/marker/drag.js","webpack:///./app/Resources/static-src/app/js/marker/index.js","webpack:///./app/Resources/static-src/app/js/marker/manage.js","webpack:///./app/Resources/static-src/app/js/marker/messenger.js","webpack:///./app/Resources/static-src/app/js/marker/video.js"],"names":["Tool","Drag","element","initMarkerArry","_video_time","messenger","editbox","scalebox","timepartnum","markers_array","Array","addScale","mergeScale","updateScale","deleteScale","updateSeq","$element","$","courseId","data","init","initSortable","initeditbox","initMarker","lisentresize","initPlayer","initEvent","on","itemDraggable","event","itemRmove","stopEvent","slideScale","hoverScale","previewMouseDown","_self","changeleft","$editbox_list","css","getleft","currentTime","document","window","getSelection","removeAllRanges","selection","empty","left","pageX","width","times","gettime","sendToChild","id","time","off","_obj","sortable","group","drop","delay","handle","onDrop","$item","container","_super","hasClass","$_scale","closest","find","length","sortList","html","children","drag","$list","num","each","text","$marker","seq","$marker_item","markerJson","attr","extend","isresize","$_editbox","time2Sec","_partnum","_parttime","i","$new_scale_default","clone","removeClass","removeAttr","sec2Time","Math","round","before","$scale_blue","$new_scale_blue","second","$scale_blue_time","questionMarkers","$scale_blue_item","j","$new_scale_blue_item","questionId","console","log","end","stem","replace","after","remove","push","newSortList","resize","_width","_totaltime","parseInt","_left","itemSelector","maskShow","_updateSeq","serialize","parent","isContainer","isValidTarget","addClass","show","e","marker_array","$merge_marker","_mover_left","_move_time","$dragingitem","currentTarget","$scale_red","$scale_red_details","$dragingitemcopy","abs","$moveeditem","appendTo","_addScale","$scale_blue_list","append","stopPropagation","$this","$marker_question","_deleteScale","$moveitem","_oldleft","_mergeScale","_updateScale","offset","$merg_marker","marker_questions_num","$scale","formSelect","markerSelect","mediaLength","url","param","markerId","post","undefined","$merg_emarker","sourceMarkerId","targetMarkerId","merg_id","splice","questionIds","Manage","options","$form","initData","count","body","clientHeight","response","popover","get","initIntro","initDrag","set","expires","path","$img","img","createElement","imgheight","height","top","src","onQuestionPreview","onMoreQuestion","onCloseHelp","onFormSubmit","onChangeSelect","onFormAutoSubmit","keyCode","preventDefault","validator","validate","form","modal","target","hide","getpage","lastpage","val","animate","scrollTop","ajax","type","cache","async","success","markersMeta","videoTime","name","project","getElementById","videoHtml","playerUrl"],"mappings":"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","file":"app/js/marker/index.js","sourcesContent":["import * as Tool from 'common/utils';\n\nclass Drag {\n  constructor({\n    element,\n    initMarkerArry = [],\n    _video_time = '18',\n    messenger = {},\n    editbox = '.editbox',\n    scalebox = '.js-scalebox',\n    timepartnum = '6',\n    markers_array = new Array(),\n    \n    addScale,\n    mergeScale,\n    updateScale,\n    deleteScale,\n    updateSeq\n  }) {\n    this.$element = $(element);\n    this.initMarkerArry = initMarkerArry;\n    this.markers_array = markers_array;\n    this._video_time = _video_time;\n    this.messenger = messenger;\n    this.editbox = editbox;\n    this.timepartnum = timepartnum;\n\n    this.courseId = this.$element.data(\"course-id\");\n\n    this.addScale = addScale;\n    this.mergeScale = mergeScale;\n    this.updateScale = updateScale;\n    this.deleteScale = deleteScale;\n    this.updateSeq = updateSeq;\n\n    this.init();\n  }\n\n  init() {\n    this.initSortable();\n    this.initeditbox(false);\n    this.initMarker(this.initMarkerArry);\n    this.lisentresize();\n    this.initPlayer();\n\n    this.initEvent();\n  }\n\n  initEvent() {\n    this.$element.on('mousedown', '.gruop-lesson-list .drag', event => this.itemDraggable(event));\n    this.$element.on('click', '.lesson-list [data-role=\"question-remove\"]', event => this.itemRmove(event));\n    this.$element.on('click', '#subject-lesson-list .item-lesson', event => this.stopEvent(event));\n    this.$element.on('mousedown', '.scale-blue', event => this.slideScale(event));\n    this.$element.on('mouseenter', '.scale-blue', event => this.hoverScale(event));\n    // this.$element.on('mousedown', '.scale-blue .item-lesson', event => this.previewQuestion(event));\n    this.$element.on('mousedown', '.js-question-preview', event => this.previewMouseDown(event));\n  }\n\n  initPlayer() {\n    let messenger = this.messenger;\n    let _self = this;\n    let changeleft = true;\n    let $editbox_list = $('#editbox-lesson-list');\n    messenger.on(\"timechange\", function (data) {\n      if (changeleft) {\n        $('.scale-white').css('left', _self.getleft(data.currentTime));\n      }\n    });\n    $('.scale-white').on('mousedown', function (event) {\n      changeleft = false;\n      $(document).on('mousemove.playertime', function (event) {\n        window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\n        let left = event.pageX > ($editbox_list.width() + 20) ? ($editbox_list.width() + 20) : event.pageX && event.pageX <= 20 ? 20 : event.pageX;\n        $('.scale-white').css('left', left);\n        let times = _self.gettime(left);\n        messenger.sendToChild({id: 'viewerIframe'}, 'setCurrentTime', {time: times});\n      }).on('mouseup.playertime', function (event) {\n        $(document).off('mousemove.playertime');\n        $(document).off('mousedown.playertime');\n        changeleft = true;\n        // messenger.sendToChild({ id: 'viewerIframe' }, 'setPlayerPlay');\n      });\n    });\n  }\n\n  initSortable() {\n    let _obj = this;\n    $(\"#subject-lesson-list\").sortable({\n        group: 'no-drop',\n        drop: false,\n        delay: 500,\n        handle: '.drag',\n        onDrop($item, container, _super) {\n          if ($item.hasClass('item-lesson')) {\n            _super($item, container);\n            let $_scale = $item.closest('.scale.blue');\n            if ($_scale.find('.lesson-list .item-lesson').length > 0) {\n              _obj.sortList($_scale.find('.lesson-list'));\n              _obj.addScale($_scale, $_scale.find('.time').html(), $_scale.css(\"left\"), $_scale.find('.lesson-list').children().length);\n            }\n          }\n        }\n    });\n    \n    $(\"#editbox-lesson-list\").sortable({\n        group: 'no-drop',\n        drag: false\n    });\n  }\n\n  sortList($list) {\n    let num = 1;\n    $list.find('.item-lesson').each(function () {\n      $(this).find('[data-role=\"sqe-number\"]').text(num);\n      num ++;\n    });\n  }\n\n  addScale($marker, time, seq, markers_array) {\n    let $marker_item = $marker.find('li' + ':last');\n    let markerJson = {\n        \"id\": $marker.attr('id'),\n        \"second\": time,\n        \"questionMarkers\": [{\n            \"id\": $marker_item.attr('id'),\n            \"seq\": seq,\n            \"questionId\": $marker_item.attr('question-id')\n        }]\n    }\n    $.extend(this.addScale(markerJson, $marker, markers_array));\n  }\n\n  initeditbox(isresize) {\n    let _self = this,\n      $_editbox = $(_self.editbox);\n    if (isresize) {\n      $_editbox.find('.scale.scale-default:visible').each(function () {\n        $(this).css('left', _self.getleft(Tool.time2Sec($(this).find('[data-role=\"scale-time\"]').text())));\n      });\n      $_editbox.find('.scale.scale-blue:visible').each(function () {\n        $(this).css('left', _self.getleft(Tool.time2Sec($(this).find('[data-role=\"scale-blue-time\"]').text())));\n      });\n    } else {\n      let _partnum = _self.timepartnum;\n      let _parttime = _self._video_time / _partnum;\n      for (let i = 0; i <= _partnum; i++) {\n        let $new_scale_default = $('[data-role=\"scale-default\"]').clone().css('left', _self.getleft(_parttime * i)).removeClass('hidden').removeAttr('data-role');\n\n        $new_scale_default.find('[data-role=\"scale-time\"]').text(Tool.sec2Time(Math.round(_parttime * i)));\n        $('[data-role=\"scale-default\"]').before($new_scale_default);\n      }\n    }\n  }\n\n  initMarker(initMarkerArry) {\n    if (initMarkerArry.length > 0) {\n      let $scale_blue = $('[data-role=\"scale-blue\"]');\n      for (let i = 0; i < initMarkerArry.length; i++) {\n        let $new_scale_blue = $scale_blue.clone().css('left', this.getleft(initMarkerArry[i].second)).removeAttr('data-role').removeClass('hidden').attr('id', initMarkerArry[i].id);\n        \n        let $scale_blue_time = $new_scale_blue.find('[data-role=\"scale-blue-time\"]').text(Tool.sec2Time(initMarkerArry[i].second));\n        let questionMarkers = initMarkerArry[i].questionMarkers;\n        let $scale_blue_item = $new_scale_blue.find('[data-role=\"scale-blue-item\"]');\n\n        for (let j = 0; j < questionMarkers.length; j++) {\n          let $new_scale_blue_item = $scale_blue_item.clone().removeAttr('data-role').attr({ 'question-id': questionMarkers[j].questionId, 'id': questionMarkers[j].id});\n\n          console.log('new_scale_blue_item',  $new_scale_blue_item)\n\n          $new_scale_blue_item\n            .data('url', `/course/${this.courseId}/question/${questionMarkers[j].questionId}/marker/preview`)\n            .find('[data-role=\"sqe-number\"]').text(j + 1).end()\n            .find('[data-role=\"question-type\"]').text('单选题').end()\n            .find('[data-role=\"question-info\"]').text(questionMarkers[j].stem.replace(/<.*?>/ig, \"\"));\n          \n          $scale_blue_item.before($new_scale_blue_item);\n        }\n        \n        $scale_blue.after($new_scale_blue);\n        $scale_blue_item.remove();\n        this.markers_array.push({id: initMarkerArry[i].id, time: initMarkerArry[i].second});\n      }\n      this.newSortList($(this.scalebox).find('[data-role=\"scale-blue-list\"]'));\n    }\n  }\n\n  lisentresize() {\n    let _self = this;\n    $(window).resize(function () {\n      _self.initeditbox(true);\n    });\n  }\n\n  getleft(time) {\n    let _width = $('#editbox-lesson-list').width();\n    let _totaltime = parseInt(this._video_time);\n    let _left = time * _width / _totaltime;\n    return _left + 20;\n  }\n\n  newSortList($list) {\n    let _self = this;\n    $list.sortable({\n      delay: 500,\n      itemSelector: '.item-lesson',\n      onDrop: function ($item, container, _super) {\n        _super($item, container);\n        _self.maskShow(false);\n        let $scale_blue = $item.closest('.scale-blue');\n        let markerJson = {\n          \"id\": '',\n          \"questionMarkers\": []\n        };\n        markerJson.id = $scale_blue.attr('id');\n        _self.sortList($scale_blue.find('[data-role=\"scale-blue-list\"]'));\n        \n        $scale_blue.find(\"li\").each(function () {\n          let questionMarkers = {\n            'id': $(this).attr('id'),\n            'seq': $(this).find('[data-role=\"sqe-number\"]').html()\n          };\n          markerJson.questionMarkers.push(questionMarkers);\n        });\n        _self._updateSeq($scale_blue, markerJson);\n        $scale_blue.removeClass('moveing');\n      },\n      serialize: function (parent, children, isContainer) {\n        return isContainer ? children : parent.attr('id');\n      },\n      isValidTarget: function ($item, container) {\n        _self.maskShow(true);\n        $item.closest('.scale-blue').addClass('moveing');\n        return true;\n      }\n    });\n  }\n\n  maskShow(show) {\n    (show) ? $('[data-role=\"player-mask\"]').removeClass('hidden') : $('[data-role=\"player-mask\"]').addClass('hidden');\n  }\n\n  gettime(left) {\n    return Math.round((left - 20) * this._video_time / $('#editbox-lesson-list').width());\n  }\n\n  itemDraggable(e) {\n    var _self = this,\n      marker_array = [],\n      $merge_marker = null,\n      _mover_left = null,\n      _move_time = null;\n\n    var $dragingitem = $(e.currentTarget),\n      $editbox_list = $('#editbox-lesson-list'),\n      $scale_red = $('[data-role=\"scale-red\"]'),\n      $scale_red_details = $scale_red.find('[data-role=\"scale-red-details\"]'),\n      $dragingitemcopy = $dragingitem.clone().removeClass('drag').addClass('disdragg');\n\n    $dragingitem.after($dragingitemcopy);\n    _self.maskShow(true);\n\n    //查询现有的时间刻度：数组保存现有的所有时间刻度 markers_array\n    $(document).on('mousemove.dragitem', function (event) {\n      if ($editbox_list.find('.placeholder').length <= 0) {\n        $scale_red.addClass('hidden');\n        $editbox_list.removeClass('highlight');\n        return;\n      }\n      //显示红线\n      $editbox_list.addClass('highlight');\n\n      _mover_left = event.pageX > ($editbox_list.width() + 20) ? ($editbox_list.width() + 20) : event.pageX && event.pageX <= 20 ? 20 : event.pageX;\n      _move_time = _self.gettime(_mover_left);\n      $scale_red_details.text(Tool.sec2Time(_move_time));\n      $scale_red.removeClass('hidden').css('left', _mover_left);\n\n      //markers_array靠近的元素提示合并,\n      if (_self.markers_array.length > 0) {\n        $('.scale-blue').removeClass('highlight');\n        marker_array = [];\n        $merge_marker = null;\n        for (let i in _self.markers_array) {\n          if (Math.abs(_self.markers_array[i].time - _move_time) <= 5) {\n            marker_array = [{\n                id: _self.markers_array[i].id,\n                time: _self.markers_array[i].time\n            }];\n            //靠近的元素刻度线高亮条件ID\n            $merge_marker = $('.scale-blue[id=' + _self.markers_array[i].id + ']').addClass('highlight');\n            return;\n          }\n        }\n      }\n    }).on('mouseup.dragitem', function (event) {\n      $(document).off('mousemove.dragitem');\n      $(document).off('mouseup.dragitem');\n      _self.maskShow(false);\n      $scale_red.addClass('hidden');\n      $editbox_list.removeClass('highlight');\n      //未拖动\n      var $moveeditem = $editbox_list.find('.item-lesson');\n      if ($moveeditem.length <= 0) {\n        $scale_red.addClass('hidden');\n        $editbox_list.removeClass('highlight');\n        $dragingitemcopy.remove();\n        return;\n      }\n      //标记已存在，新增题目\n      if (marker_array.length > 0) {\n        var $list = $merge_marker.find('[data-role=\"scale-blue-list\"]');\n        $moveeditem.appendTo($list).find('[data-role=\"sqe-number\"]').text($list.children().length);\n        _self._addScale($merge_marker, marker_array[0].time, $list.children().length, _self.markers_array);\n        $merge_marker.removeClass('highlight');\n        _self.newSortList($list);\n      } else { //新增标记和题目\n        var $scale_blue = $('[data-role=\"scale-blue\"]'),\n          $new_scale_blue = $scale_blue.clone().css('left', _mover_left).removeAttr('data-role'),\n          $scale_blue_list = $new_scale_blue.find('[data-role=\"scale-blue-list\"]'),\n          $scale_blue_time = $new_scale_blue.find('[data-role=\"scale-blue-time\"]').text(Tool.sec2Time(_move_time));\n        $scale_blue_list.children().remove();\n        $scale_blue_list.append($moveeditem);\n        $scale_blue.after($new_scale_blue);\n        _self._addScale($new_scale_blue, _move_time, 1, _self.markers_array);\n      }\n    });\n  }\n\n  itemRmove(e) {\n    e.stopPropagation();\n    let $this = $(e.currentTarget);\n    let $list = $this.closest('[data-role=\"scale-blue-list\"]'),\n        $marker_question = $this.closest('li'),\n        $marker = $this.closest('.scale-blue');\n    this._deleteScale($marker, $marker_question, $list.children().length, this.markers_array);\n  }\n\n  stopEvent(e) {\n    e.stopPropagation();\n  }\n\n  slideScale(e) {\n    let _self = this,\n        marker_array = [],\n        $merge_marker = null,\n        _mover_left = null,\n        _move_time = null;\n\n    let $moveitem = $(e.currentTarget),\n        $editbox_list = $('#editbox-lesson-list'),\n        _oldleft = $moveitem.css('left');\n    _self.maskShow(true);\n    $('.marker-manage').addClass('slideing');\n    $moveitem.addClass('moveing');\n    $(document).on('mousemove.slide', function (event) {\n        window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();\n        _mover_left = event.pageX > ($editbox_list.width() + 20) ? ($editbox_list.width() + 20) : event.pageX && event.pageX <= 20 ? 20 : event.pageX;\n        _move_time = Math.round((_mover_left - 20) * _self._video_time / $editbox_list.width());\n        $moveitem.css('left', _mover_left);\n        $moveitem.find('[data-role=\"scale-blue-time\"]').text(Tool.sec2Time(_move_time));\n\n        if (_self.markers_array.length > 0) {\n            $('.scale-blue').removeClass('highlight');\n            marker_array = [];\n            $merge_marker = null;\n            for (let i in _self.markers_array) {\n                if (Math.abs(_self.markers_array[i].time - _move_time) <= 5 && $moveitem.attr('id') != _self.markers_array[i].id) {\n                    marker_array = [{\n                        id: _self.markers_array[i].id,\n                        time: _self.markers_array[i].time\n                    }];\n                    //靠近的元素刻度线高亮条件ID\n                    $merge_marker = $('.scale-blue[id=' + _self.markers_array[i].id + ']').addClass('highlight');\n                    return;\n                }\n            }\n        }\n    }).on('mouseup.slide', function (event) {\n        $(document).off('mousemove.slide');\n        $(document).off('mouseup.slide');\n        _self.maskShow(false);\n        $moveitem.removeClass('moveing');\n        $('.marker-manage').removeClass('slideing');\n        if (marker_array.length > 0) {\n            var $list = $merge_marker.find('[data-role=\"scale-blue-list\"]');\n            $list.append($moveitem.find('[data-role=\"scale-blue-list\"]').children());\n            _self.sortList($list);\n            $merge_marker.removeClass('highlight');\n            _self._mergeScale($moveitem, $merge_marker, _self.markers_array);\n        } else {\n            //新增\n            _self._updateScale($moveitem, _move_time);\n        }\n    })\n  }\n\n  hoverScale(e) {\n    let $this = $(e.currentTarget);\n    if ($this.offset().left - 20 < 110) {\n      $this.find('.scale-details').css('margin-left', '-' + ($this.offset().left - 20) + 'px');\n    } else {\n      $this.find('.scale-details').css('margin-left', '-110px');\n    }\n  }\n\n  // previewQuestion(e) {\n  //   e.stopPropagation();\n  //   let $this = $(e.currentTarget), url = $this.data('url');\n  //   if (url) {\n  //     let imgUrl = app.config.loading_img_path;\n  //     let $target = $($this.data('target'));\n  //     let $loadingImg = \"<img src='\" + imgUrl + \"' class='modal-loading' style='z-index:1041;width:60px;height:60px;position:absolute;top:50%;left:50%;margin-left:-30px;margin-top:-30px;'/>\";\n  //     $target.html($loadingImg);\n  //     $target.load(url);\n  //   }\n  // }\n\n  previewMouseDown(e) {\n    //阻止默认事件，父层的拖动\n    e.stopPropagation();\n  }\n\n  _addScale($marker, time, seq, markers_array) {\n    let $marker_item = $marker.find('li' + ':last');\n    let markerJson = {\n      \"id\": $marker.attr('id'),\n      \"second\": time,\n      \"questionMarkers\": [{\n        \"id\": $marker_item.attr('id'),\n        \"seq\": seq,\n        \"questionId\": $marker_item.attr('question-id')\n      }]\n    }\n    $.extend(this.addScale(markerJson, $marker, markers_array));\n  }\n\n  _mergeScale($marker, $merg_marker, markers_array) {\n    // 合并时后台去处理顺序，被合并数按序号依次增加\n    let markerJson = {\n      \"id\": $marker.attr('id'),\n      \"merg_id\": $merg_marker.attr('id')\n    }\n    $.extend(this.mergeScale(markerJson, $marker, $merg_marker, markers_array));\n  }\n\n  _updateScale($marker, time) {\n    let markerJson = {\n      \"id\": $marker.attr('id'),\n      \"second\": time,\n    }\n    $.extend(this.updateScale(markerJson, $marker));\n  }\n\n  _deleteScale($marker, $marker_question, marker_questions_num, markers_array) {\n    console.log('id', $marker, $marker.attr('id'))\n    let markerJson = {\n      \"id\": $marker.attr('id'),\n      \"questionMarkers\": [{\n        \"id\": $marker_question.attr('id'),\n        \"seq\": $marker_question.find('[data-role=\"sqe-number\"]').html(),\n        \"questionId\": $marker_question.attr('question-id')\n      }]\n    };\n    $.extend(this.deleteScale(markerJson, $marker, $marker_question, marker_questions_num, markers_array));\n  }\n\n  _updateSeq($scale, markerJson) {\n    $.extend(this.updateSeq($scale, markerJson));\n  }\n  \n}\n\nexport default Drag;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/marker/drag.js","import Manage from './manage';\n\nnew Manage({\n  formSelect: '.js-mark-form',\n  markerSelect: '.js-marker-manage-content'\n});\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/marker/index.js","import './video';\nimport messenger from './messenger';\nimport Drag from './drag';\nimport Cookies from 'js-cookie';\n\nlet drag = (initMarkerArry, mediaLength, messenger) => {\n  let drag = new Drag({\n    element: '#task-dashboard',\n    initMarkerArry: initMarkerArry,\n    _video_time: mediaLength,\n    messenger: messenger,\n    addScale(markerJson, $marker, markers_array) {\n      var url = $('.js-pane-question-content').data('queston-marker-add-url');\n      var param = {\n        markerId: markerJson.id,\n        second: markerJson.second,\n        questionId: markerJson.questionMarkers[0].questionId,\n        seq: markerJson.questionMarkers[0].seq\n      };\n      $.post(url, param, function (data) {\n        if (data.id == undefined) {\n          return;\n        }\n        //新增时间刻度\n        if (markerJson.id == undefined) {\n          $marker.attr('id', data.markerId);\n          markers_array.push({id: data.markerId, time: markerJson.second});\n          //排序\n        }\n        $marker.removeClass('hidden');\n        $marker.find('.item-lesson[question-id=' + markerJson.questionMarkers[0].questionId + ']').attr('id', data.id);\n      });\n      return markerJson;\n    },\n    mergeScale(markerJson, $marker, $merg_emarker, markers_array) {\n      var url = $('.js-pane-question-content').data('marker-merge-url');\n      $.post(url, {\n        sourceMarkerId: markerJson.id,\n        targetMarkerId: markerJson.merg_id\n      }, function (data) {\n        $marker.remove();\n        for (let i in markers_array) {\n          if (markers_array[i].id == markerJson.id) {\n            markers_array.splice(i, 1);\n            break;\n          }\n        }\n      });\n      return markerJson;\n    },\n    updateScale(markerJson, $marker) {\n      var url = $('.js-pane-question-content').data('marker-update-url');\n      var param = {\n        id: markerJson.id,\n        second: markerJson.second\n      };\n      if(markerJson.second){\n        $.post(url, param, function (data) {\n        });\n      }else{\n        console.log('do not need upgrade scale...');\n      }\n      return markerJson;\n    },\n    deleteScale(markerJson, $marker, $marker_question, marker_questions_num, markers_array) {\n      var url = $('.js-pane-question-content').data('queston-marker-delete-url');\n      $.post(url, {\n        questionId: markerJson.questionMarkers[0].id\n      }, function (data) {\n        $marker_question.remove();\n        console.log(markerJson.questionMarkers[0].questionId, 'questionId');\n        $('#subject-lesson-list').find('.item-lesson[question-id=' + markerJson.questionMarkers[0].questionId + ']').removeClass('disdragg').addClass('drag');\n        if ($marker.find('[data-role=\"scale-blue-list\"]').children().length <= 0) {\n          $marker.remove();\n          for (let i in markers_array) {\n            if (markers_array[i].id == $marker.attr('id')) {\n              markers_array.splice(i, 1);\n              break;\n            }\n          }\n        } else {\n          //剩余排序\n          console.log('drag', drag)\n          drag.sortList($marker.find('[data-role=\"scale-blue-list\"]'));\n        }\n      });\n    },\n    updateSeq($scale, markerJson) {\n      if (markerJson == undefined || markerJson.questionMarkers == undefined || markerJson.questionMarkers.length == 0) {\n        return;\n      }\n\n      let url = $('.js-pane-question-content').data('queston-marker-sort-url');\n      let param = new Array();\n\n      for (let i = 0; i < markerJson.questionMarkers.length; i++) {\n        param.push(markerJson.questionMarkers[i].id);\n      }\n\n      $.post(url, {questionIds: param});\n    }\n  })\n\n  return drag;\n}\n\nclass Manage {\n  constructor(options) {\n    this.$form = $(options.formSelect);\n    this.$marker = $(options.markerSelect);\n    this.init();\n  }\n\n  init() {\n    this.initData();\n    this.initEvent();\n  }\n\n  initData() {\n    let count = parseInt((document.body.clientHeight - 350) / 50) > 0 ? parseInt((document.body.clientHeight - 350) / 50) : 1;\n    \n    $.post(this.$form.attr('action'), this.$form.serialize() + '&pageSize=' + count, (response) => {\n      $('#subject-lesson-list').html(response);\n      $('[data-toggle=\"popover\"]').popover();\n      if (!Cookies.get(\"MARK-MANGE-GUIDE\")) {\n        this.initIntro();\n      } else {\n        this.initDrag();\n        $('#step-1').removeClass('introhelp-icon-help');\n      }\n      Cookies.set(\"MARK-MANGE-GUIDE\", 'true', {expires: 360, path: \"/\"});\n      this.$form.data('pageSize', count);\n    });\n  }\n\n  initIntro() {\n    $('.js-introhelp-overlay').removeClass('hidden');\n    $('.show-introhelp').addClass('show');\n\n    var $img = $('.js-introhelp-img img'),\n        img = document.createElement('img'),\n        imgheight = $(window).height() - $img.offset().top - 80;\n        \n    img.src = $img.attr('src');\n    let left = imgheight * img.width / img.height / 2 + 50;\n    $img.height(imgheight);\n    $('.js-introhelp-img').css('margin-left', '-' + left + 'px');\n  }\n\n  initEvent() {\n    this.$marker.on('click', '.js-question-preview', event => this.onQuestionPreview(event));\n    this.$marker.on('click', '.js-more-questions', event => this.onMoreQuestion(event));\n    this.$marker.on('click', '.js-close-introhelp', event => this.onCloseHelp(event));\n    this.$marker.on('click', '#mark-form-submit', event => this.onFormSubmit(event));\n    this.$marker.on('change', '#mark-form-target', event => this.onChangeSelect(event));\n    this.$marker.on('keydown', '#mark-form-keyword', event => this.onFormAutoSubmit(event));\n  }\n\n  onFormAutoSubmit(event) {\n    if (event.keyCode == 13) {\n      event.preventDefault()\n      this.onFormSubmit(event);\n    }\n  }\n\n  onFormSubmit(e) {\n    let validator = this.$form.validate();\n\n    if (validator.form()) {\n      let count = this.$form.data('pageSize');\n      $.post(this.$form.attr('action'), this.$form.serialize() + '&pageSize=' + count, function (response) {\n        $('#subject-lesson-list').html(response);\n      });\n    }\n  }\n\n  onChangeSelect(e) {\n    this.onFormSubmit(e);\n  }\n\n  onQuestionPreview(e) {\n    $.get($(e.currentTarget).data('url'), function (response) {\n      $('.modal').modal('show');\n      $('.modal').html(response);\n    })\n  }\n\n  onMoreQuestion(e) {\n    let target = $('select[name=target]');\n    let $this = $(e.currentTarget).hide().parent().addClass('loading'),\n        $list = $('#subject-lesson-list').css('max-height', $('#subject-lesson-list').height()),\n        getpage = parseInt($this.data('current-page')) + 1,\n        lastpage = $this.data('last-page');\n\n    $.post($this.data('url') + getpage, {'target': target.val(), 'pageSize': this.$form.data('pageSize')}, function (response) {\n      $this.remove();\n      $list.append(response).animate({scrollTop: 40 * ($list.find('.item-lesson').length + 1)});\n      if (getpage == lastpage) {\n        $('.js-more-questions').parent().remove();\n      }\n    });\n  }\n\n  onCloseHelp(e) {\n    let $this = $(e.currentTarget);\n    $this.closest('.show-introhelp').removeClass('show-introhelp');\n    if ($('.show-introhelp').height() <= 0) {\n      $('.js-introhelp-overlay').addClass('hidden');\n      this.initDrag();\n    }\n  }\n\n  initDrag() {\n    let initMarkerArry = [];\n    let mediaLength = 30;\n\n    $.ajax({\n      type: \"get\",\n      url: $('.js-pane-question-content').data('marker-metas-url'),\n      cache: false,\n      async: false,\n      success: function (data) {\n        initMarkerArry = data.markersMeta;\n        mediaLength = data.videoTime;\n      }\n    });\n    drag(initMarkerArry, mediaLength, messenger)\n  }\n}\n\nexport default Manage;\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/marker/manage.js","import EsMessenger from 'app/common/messenger';\n\nlet messenger = new EsMessenger({\n  name: 'parent',\n  project: 'PlayerProject',\n  children: [document.getElementById('viewerIframe')],\n  type: 'parent'\n});\n\nexport default messenger;\n\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/marker/messenger.js","let videoHtml = $('#task-dashboard');\nlet playerUrl = videoHtml.data(\"media-player\");\nlet html = '<iframe src=\\'' + playerUrl + '\\' name=\\'viewerIframe\\' id=\\'viewerIframe\\' width=\\'100%\\'allowfullscreen webkitallowfullscreen height=\\'100%\\' style=\\'border:0px\\'></iframe>';\n$(\"#task-video-content\").html(html);\n\n\n// WEBPACK FOOTER //\n// ./app/Resources/static-src/app/js/marker/video.js"],"sourceRoot":""}