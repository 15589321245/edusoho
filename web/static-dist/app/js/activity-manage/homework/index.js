webpackJsonp(["app/js/activity-manage/homework/index"],{a12be7d90ead2917b889:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),n=function(){function t(e){i(this,t),this.$homeworkModal=$("#modal",window.parent.document),this.$questionPickedModal=$("#attachment-modal",window.parent.document),this.$element=e,this.$step2_form=this.$element.find("#step2-form"),this.$step3_form=this.$element.find("#step3-form"),this.validator2=null,this.init()}return o(t,[{key:"init",value:function(){this.initEvent(),this.setValidateRule(),this.inItStep2form()}},{key:"initEvent",value:function(){var t=this;this.$element.on("click",'[data-role="pick-item"]',function(e){return t.showPickQuestion(e)}),this.$questionPickedModal.on("shown.bs.modal",function(){t.$homeworkModal.hide()}),this.$questionPickedModal.on("hidden.bs.modal",function(){t.$homeworkModal.show(),t.$questionPickedModal.html(""),t.validator2&&t.validator2.form()})}},{key:"initCkeditor",value:function(t){var e=CKEDITOR.replace("homework-about-field",{toolbar:"Task",filebrowserImageUploadUrl:$("#homework-about-field").data("imageUploadUrl")});e.on("change",function(){$("#homework-about-field").val(e.getData())}),e.on("blur",function(){t.form()})}},{key:"showPickQuestion",value:function(t){var e=this;t.preventDefault();var i=$(t.currentTarget),o=[];$("#question-table-tbody").find('[name="questionIds[]"]').each(function(){o.push($(this).val())}),this.$questionPickedModal.modal().data("manager",this),$.get(i.data("url"),{excludeIds:o.join(",")},function(t){e.$questionPickedModal.html(t)})}},{key:"inItStep2form",value:function(){var t=this.$step2_form.validate({onkeyup:!1,rules:{title:{required:!0,maxlength:50,trim:!0,course_title:!0},description:{required:!0},content:"required",questionLength:{required:!0}},messages:{questionLength:"请选择题目"}});this.validator2=t,this.initCkeditor(t),this.$step2_form.data("validator",t)}},{key:"setValidateRule",value:function(){$.validator.addMethod("arithmeticFloat",function(t,e){return this.optional(e)||/^[0-9]+(\.[0-9]?)?$/.test(t)},$.validator.format("必须为正数，保留一位小数")),$.validator.addMethod("positiveInteger",function(t,e){return this.optional(e)||/^[1-9]\d*$/.test(t)},$.validator.format("必须为正整数")),$.validator.addMethod("DateAndTime",function(t,e){var i=/^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29) ([0-1]{1}[0-9]{1})|(2[0-4]{1}):[0-5]{1}[0-9]{1}$/;return this.optional(e)||i.test(t)},$.validator.format("请输入正确的日期和时间,格式如XXXX-MM-DD hh:mm"))}}]),t}();e.default=n},0:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var n=i("de585ca0d3c2d0205c51"),a=o(n),r=i("1e0cf618bc778b8ab554"),d=o(r),l=i("a12be7d90ead2917b889"),u=o(l),s=$("#step2-form");new u.default($("#iframe-content")),new a.default(s),new d.default(s,$("#attachment-modal",window.parent.document))}});