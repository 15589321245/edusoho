webpackJsonp(["app/js/settings/avatar-crop-modal/index"],{c962afacd3de715604c6:function(t,e,r){e=t.exports=r("e7f1add7f34e416618de")(),e.push([t.id,"/*! Jcrop.min.css v2.0.4 - build: 20151117\n *  Copyright 2008-2015 Tapmodo Interactive LLC\n *  Free software under MIT License\n **/.jcrop-active{direction:ltr;text-align:left;box-sizing:border-box;-ms-touch-action:none}.jcrop-dragging{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.jcrop-selection{z-index:2}.jcrop-selection.jcrop-current{z-index:4}.jcrop-border{background:#fff url("+r("186c8a0bf2732d1ea26a")+");line-height:1px!important;font-size:0!important;overflow:hidden;position:absolute;filter:alpha(opacity=50)!important;opacity:.5!important}.jcrop-border.ord-e,.jcrop-border.ord-n,.jcrop-border.ord-w{top:0}.jcrop-border.ord-n,.jcrop-border.ord-s{width:100%;height:1px!important}.jcrop-border.ord-e,.jcrop-border.ord-w{height:100%;width:1px!important}.jcrop-border.ord-e{right:-1px}.jcrop-border.ord-n{top:-1px}.jcrop-border.ord-w{left:-1px}.jcrop-border.ord-s{bottom:-1px}.jcrop-selection{position:absolute}.jcrop-box{z-index:2;display:block;border:0;padding:0;margin:0;font-size:0}.jcrop-box,.jcrop-box:active,.jcrop-box:hover{background:0 0}.jcrop-box:focus{outline:1px dotted hsla(0,0%,50%,.65)}.jcrop-active,.jcrop-box{position:relative}.jcrop-box{width:100%;height:100%;cursor:move}.jcrop-handle{z-index:4;background-color:rgba(49,28,28,.58);border:1px solid #eee;width:9px;height:9px;font-size:0;position:absolute;filter:alpha(opacity=80)!important;opacity:.8!important}.jcrop-handle.ord-n{left:50%;margin-left:-5px;margin-top:-5px;top:0;cursor:n-resize}.jcrop-handle.ord-s{bottom:0;left:50%;margin-bottom:-5px;margin-left:-5px;cursor:s-resize}.jcrop-handle.ord-e{margin-right:-5px;margin-top:-5px;right:0;top:50%;cursor:e-resize}.jcrop-handle.ord-w{left:0;margin-left:-5px;margin-top:-5px;top:50%;cursor:w-resize}.jcrop-handle.ord-nw{left:0;margin-left:-5px;margin-top:-5px;top:0;cursor:nw-resize}.jcrop-handle.ord-ne{margin-right:-5px;margin-top:-5px;right:0;top:0;cursor:ne-resize}.jcrop-handle.ord-se{bottom:0;margin-bottom:-5px;margin-right:-5px;right:0;cursor:se-resize}.jcrop-handle.ord-sw{bottom:0;left:0;margin-bottom:-5px;margin-left:-5px;cursor:sw-resize}.jcrop-touch .jcrop-handle{z-index:4;background-color:rgba(49,28,28,.58);border:1px solid #eee;width:18px;height:18px;font-size:0;position:absolute;filter:alpha(opacity=80)!important;opacity:.8!important}.jcrop-touch .jcrop-handle.ord-n{left:50%;margin-left:-10px;margin-top:-10px;top:0;cursor:n-resize}.jcrop-touch .jcrop-handle.ord-s{bottom:0;left:50%;margin-bottom:-10px;margin-left:-10px;cursor:s-resize}.jcrop-touch .jcrop-handle.ord-e{margin-right:-10px;margin-top:-10px;right:0;top:50%;cursor:e-resize}.jcrop-touch .jcrop-handle.ord-w{left:0;margin-left:-10px;margin-top:-10px;top:50%;cursor:w-resize}.jcrop-touch .jcrop-handle.ord-nw{left:0;margin-left:-10px;margin-top:-10px;top:0;cursor:nw-resize}.jcrop-touch .jcrop-handle.ord-ne{margin-right:-10px;margin-top:-10px;right:0;top:0;cursor:ne-resize}.jcrop-touch .jcrop-handle.ord-se{bottom:0;margin-bottom:-10px;margin-right:-10px;right:0;cursor:se-resize}.jcrop-touch .jcrop-handle.ord-sw{bottom:0;left:0;margin-bottom:-10px;margin-left:-10px;cursor:sw-resize}.jcrop-dragbar{font-size:0;position:absolute}.jcrop-dragbar.ord-n,.jcrop-dragbar.ord-s{height:9px!important;width:100%}.jcrop-dragbar.ord-e,.jcrop-dragbar.ord-w{top:0;height:100%;width:9px!important}.jcrop-dragbar.ord-n{margin-top:-5px;cursor:n-resize;top:0}.jcrop-dragbar.ord-s{bottom:0;margin-bottom:-5px;cursor:s-resize}.jcrop-dragbar.ord-e{margin-right:-5px;right:0;cursor:e-resize}.jcrop-dragbar.ord-w{margin-left:-5px;cursor:w-resize}.jcrop-shades{position:relative;top:0;left:0}.jcrop-shades div{cursor:crosshair}.jcrop-noresize .jcrop-dragbar,.jcrop-noresize .jcrop-handle{display:none}.jcrop-nodrag .jcrop-shades div,.jcrop-selection.jcrop-nodrag .jcrop-box{cursor:default}.jcrop-light .jcrop-border{background:#fff;filter:alpha(opacity=70)!important;opacity:.7!important}.jcrop-light .jcrop-handle{background-color:#000;border-color:#fff}.jcrop-dark .jcrop-border{background:#000;filter:alpha(opacity=70)!important;opacity:.7!important}.jcrop-dark .jcrop-handle{background-color:#fff;border-color:#000}.solid-line .jcrop-border{background:#fff}.jcrop-thumb{position:absolute;overflow:hidden;z-index:5}.jcrop-active img,.jcrop-thumb canvas,.jcrop-thumb img{min-width:none;min-height:none;max-width:none;max-height:none}.jcrop-hl-active .jcrop-border{filter:alpha(opacity=20)!important;opacity:.2!important}.jcrop-hl-active .jcrop-handle{filter:alpha(opacity=10)!important;opacity:.1!important}.jcrop-hl-active .jcrop-selection:hover .jcrop-border{background-color:#ccc;filter:alpha(opacity=50)!important;opacity:.5!important}.jcrop-hl-active .jcrop-selection.jcrop-current .jcrop-border{background:gray url("+r("186c8a0bf2732d1ea26a")+");opacity:.35!important;filter:alpha(opacity=35)!important}.jcrop-hl-active .jcrop-selection.jcrop-current .jcrop-handle{filter:alpha(opacity=30)!important;opacity:.3!important}.jcrop-hl-active .jcrop-selection.jcrop-focus .jcrop-border{background:url("+r("186c8a0bf2732d1ea26a")+");opacity:.65!important;filter:alpha(opacity=65)!important}.jcrop-hl-active .jcrop-selection.jcrop-focus .jcrop-handle{filter:alpha(opacity=60)!important;opacity:.6!important}button.jcrop-box{background:0 0}",""])},e7f1add7f34e416618de:function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e];r[2]?t.push("@media "+r[2]+"{"+r[1]+"}"):t.push(r[1])}return t.join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},"3c059c9d674b4e8f63a9":function(t,e){!function(t){"use strict";var e=function(r,n){var i=navigator.userAgent.toLowerCase();this.opt=t.extend({},e.defaults,n||{}),this.container=t(r),this.opt.is_msie=/msie/.test(i),this.opt.is_ie_lt9=/msie [1-8]\./.test(i),this.container.addClass(this.opt.css_container),this.ui={},this.state=null,this.ui.multi=[],this.ui.selection=null,this.filter={},this.init(),this.setOptions(n),this.applySizeConstraints(),this.container.trigger("cropinit",this),this.opt.is_ie_lt9&&(this.opt.dragEventTarget=document.body)};t.extend(e,{component:{},filter:{},stage:{},registerComponent:function(t,r){e.component[t]=r},registerFilter:function(t,r){e.filter[t]=r},registerStageType:function(t,r){e.stage[t]=r},attach:function(e,r){var n=new t.Jcrop(e,r);return n},imgCopy:function(t){var e=new Image;return e.src=t.src,e},imageClone:function(r){return t.Jcrop.supportsCanvas?e.canvasClone(r):e.imgCopy(r)},canvasClone:function(e){var r=document.createElement("canvas"),n=r.getContext("2d");return t(r).width(e.width).height(e.height),r.width=e.naturalWidth,r.height=e.naturalHeight,n.drawImage(e,0,0,e.naturalWidth,e.naturalHeight),r},propagate:function(t,e,r){for(var n=0,i=t.length;n<i;n++)e.hasOwnProperty(t[n])&&(r[t[n]]=e[t[n]])},getLargestBox:function(t,e,r){return e/r>t?[r*t,r]:[e,e/t]},stageConstructor:function(r,n,i){var o=[];t.each(e.stage,function(t,e){o.push(e)}),o.sort(function(t,e){return t.priority-e.priority});for(var a=0,s=o.length;a<s;a++)if(o[a].isSupported(r,n)){o[a].create(r,n,function(t,e){"function"==typeof i&&i(t,e)});break}},supportsColorFade:function(){return t.fx.step.hasOwnProperty("backgroundColor")},wrapFromXywh:function(t){var e={x:t[0],y:t[1],w:t[2],h:t[3]};return e.x2=e.x+e.w,e.y2=e.y+e.h,e}});var r=function(){};t.extend(r,{isSupported:function(t,e){return!0},priority:100,create:function(t,e,n){var i=new r;i.element=t,n.call(this,i,e)},prototype:{attach:function(t){this.init(t),t.ui.stage=this},triggerEvent:function(e){return t(this.element).trigger(e),this},getElement:function(){return this.element},init:function(t){this.core=t}}}),e.registerStageType("Block",r);var i=function(){};i.prototype=new r,t.extend(i,{isSupported:function(t,e){if("IMG"==t.tagName)return!0},priority:90,create:function(e,r,n){t.Jcrop.component.ImageLoader.attach(e,function(o,a){var s=new i;s.element=t(e).wrap("<div />").parent(),s.element.width(o).height(a),s.imgsrc=e,"function"==typeof n&&n.call(this,s,r)})}}),e.registerStageType("Image",i);var o=function(){this.angle=0,this.scale=1,this.scaleMin=.2,this.scaleMax=1.25,this.offset=[0,0]};o.prototype=new i,t.extend(o,{isSupported:function(e,r){if(t.Jcrop.supportsCanvas&&"IMG"==e.tagName)return!0},priority:60,create:function(e,r,n){var i=t(e),a=t.extend({},r);t.Jcrop.component.ImageLoader.attach(e,function(t,r){var s=new o,t=i.width(),r=i.height();i.width(t).height(r).hide(),s.createCanvas(e,t,r),i.before(s.element),s.imgsrc=e,a.imgsrc=e,"function"==typeof n&&(n(s,a),s.redraw())})}}),t.extend(o.prototype,{setOffset:function(t,e){return this.offset=[t,e],this},setAngle:function(t){return this.angle=t,this},setScale:function(t){return this.scale=this.boundScale(t),this},boundScale:function(t){return t<this.scaleMin?t=this.scaleMin:t>this.scaleMax&&(t=this.scaleMax),t},createCanvas:function(e,r,n){this.width=r,this.height=n,this.canvas=document.createElement("canvas"),this.canvas.width=r,this.canvas.height=n,this.$canvas=t(this.canvas).width("100%").height("100%"),this.context=this.canvas.getContext("2d"),this.fillstyle="rgb(0,0,0)",this.element=this.$canvas.wrap("<div />").parent().width(r).height(n)},triggerEvent:function(t){return this.$canvas.trigger(t),this},clear:function(){return this.context.fillStyle=this.fillstyle,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this},redraw:function(){return this.context.save(),this.clear(),this.context.translate(parseInt(.5*this.width),parseInt(.5*this.height)),this.context.translate(this.offset[0]/this.core.opt.xscale,this.offset[1]/this.core.opt.yscale),this.context.rotate(this.angle*(Math.PI/180)),this.context.scale(this.scale,this.scale),this.context.translate(-parseInt(.5*this.width),-parseInt(.5*this.height)),this.context.drawImage(this.imgsrc,0,0,this.width,this.height),this.context.restore(),this.$canvas.trigger("cropredraw"),this},setFillStyle:function(t){return this.fillstyle=t,this}}),e.registerStageType("Canvas",o);var a=function(){this.minw=40,this.minh=40,this.maxw=0,this.maxh=0,this.core=null};t.extend(a.prototype,{tag:"backoff",priority:22,filter:function(t){var e=this.bound;return t.x<e.minx&&(t.x=e.minx,t.x2=t.w+t.x),t.y<e.miny&&(t.y=e.miny,t.y2=t.h+t.y),t.x2>e.maxx&&(t.x2=e.maxx,t.x=t.x2-t.w),t.y2>e.maxy&&(t.y2=e.maxy,t.y=t.y2-t.h),t},refresh:function(t){this.elw=t.core.container.width(),this.elh=t.core.container.height(),this.bound={minx:0+t.edge.w,miny:0+t.edge.n,maxx:this.elw+t.edge.e,maxy:this.elh+t.edge.s}}}),e.registerFilter("backoff",a);var s=function(){this.core=null};t.extend(s.prototype,{tag:"constrain",priority:5,filter:function(t,e){return"move"==e?(t.x<this.minx&&(t.x=this.minx,t.x2=t.w+t.x),t.y<this.miny&&(t.y=this.miny,t.y2=t.h+t.y),t.x2>this.maxx&&(t.x2=this.maxx,t.x=t.x2-t.w),t.y2>this.maxy&&(t.y2=this.maxy,t.y=t.y2-t.h)):(t.x<this.minx&&(t.x=this.minx),t.y<this.miny&&(t.y=this.miny),t.x2>this.maxx&&(t.x2=this.maxx),t.y2>this.maxy&&(t.y2=this.maxy)),t.w=t.x2-t.x,t.h=t.y2-t.y,t},refresh:function(t){this.elw=t.core.container.width(),this.elh=t.core.container.height(),this.minx=0+t.edge.w,this.miny=0+t.edge.n,this.maxx=this.elw+t.edge.e,this.maxy=this.elh+t.edge.s}}),e.registerFilter("constrain",s);var c=function(){this.core=null};t.extend(c.prototype,{tag:"extent",priority:12,offsetFromCorner:function(t,e,r){var n=e[0],i=e[1];switch(t){case"bl":return[r.x2-n,r.y,n,i];case"tl":return[r.x2-n,r.y2-i,n,i];case"br":return[r.x,r.y,n,i];case"tr":return[r.x,r.y2-i,n,i]}},getQuadrant:function(t){var e=t.opposite[0]-t.offsetx,r=t.opposite[1]-t.offsety;return e<0&&r<0?"br":e>=0&&r>=0?"tl":e<0&&r>=0?"tr":"bl"},filter:function(t,r,n){if("move"==r)return t;var i=t.w,o=t.h,a=n.state,s=this.limits,c=a?this.getQuadrant(a):"br";return s.minw&&i<s.minw&&(i=s.minw),s.minh&&o<s.minh&&(o=s.minh),s.maxw&&i>s.maxw&&(i=s.maxw),s.maxh&&o>s.maxh&&(o=s.maxh),i==t.w&&o==t.h?t:e.wrapFromXywh(this.offsetFromCorner(c,[i,o],t))},refresh:function(t){this.elw=t.core.container.width(),this.elh=t.core.container.height(),this.limits={minw:t.minSize[0],minh:t.minSize[1],maxw:t.maxSize[0],maxh:t.maxSize[1]}}}),e.registerFilter("extent",c);var h=function(){this.stepx=1,this.stepy=1,this.core=null};t.extend(h.prototype,{tag:"grid",priority:19,filter:function(t){var e={x:Math.round(t.x/this.stepx)*this.stepx,y:Math.round(t.y/this.stepy)*this.stepy,x2:Math.round(t.x2/this.stepx)*this.stepx,y2:Math.round(t.y2/this.stepy)*this.stepy};return e.w=e.x2-e.x,e.h=e.y2-e.y,e}}),e.registerFilter("grid",h);var l=function(){this.ratio=0,this.core=null};t.extend(l.prototype,{tag:"ratio",priority:15,offsetFromCorner:function(t,e,r){var n=e[0],i=e[1];switch(t){case"bl":return[r.x2-n,r.y,n,i];case"tl":return[r.x2-n,r.y2-i,n,i];case"br":return[r.x,r.y,n,i];case"tr":return[r.x,r.y2-i,n,i]}},getBoundRatio:function(t,r){var n=e.getLargestBox(this.ratio,t.w,t.h);return e.wrapFromXywh(this.offsetFromCorner(r,n,t))},getQuadrant:function(t){var e=t.opposite[0]-t.offsetx,r=t.opposite[1]-t.offsety;return e<0&&r<0?"br":e>=0&&r>=0?"tl":e<0&&r>=0?"tr":"bl"},filter:function(t,e,r){if(!this.ratio)return t;var n=(t.w/t.h,r.state),i=n?this.getQuadrant(n):"br";if(e=e||"se","move"==e)return t;switch(e){case"n":t.x2=this.elw,t.w=t.x2-t.x,i="tr";break;case"s":t.x2=this.elw,t.w=t.x2-t.x,i="br";break;case"e":t.y2=this.elh,t.h=t.y2-t.y,i="br";break;case"w":t.y2=this.elh,t.h=t.y2-t.y,i="bl"}return this.getBoundRatio(t,i)},refresh:function(t){this.ratio=t.aspectRatio,this.elw=t.core.container.width(),this.elh=t.core.container.height()}}),e.registerFilter("ratio",l);var u=function(){this.core=null};t.extend(u.prototype,{tag:"round",priority:90,filter:function(t){var e={x:Math.round(t.x),y:Math.round(t.y),x2:Math.round(t.x2),y2:Math.round(t.y2)};return e.w=e.x2-e.x,e.h=e.y2-e.y,e}}),e.registerFilter("round",u);var p=function(t,e){this.color=e||"black",this.opacity=t||.5,this.core=null,this.shades={}};t.extend(p.prototype,{tag:"shader",fade:!0,fadeEasing:"swing",fadeSpeed:320,priority:95,init:function(){var e=this;e.attached||(e.visible=!1,e.container=t("<div />").addClass(e.core.opt.css_shades).prependTo(this.core.container).hide(),e.elh=this.core.container.height(),e.elw=this.core.container.width(),e.shades={top:e.createShade(),right:e.createShade(),left:e.createShade(),bottom:e.createShade()},e.attached=!0)},destroy:function(){this.container.remove()},setColor:function(r,n){var i=this;if(r==i.color)return i;this.color=r;var o=e.supportsColorFade();return t.each(i.shades,function(t,e){i.fade&&!n&&o?e.animate({backgroundColor:r},{queue:!1,duration:i.fadeSpeed,easing:i.fadeEasing}):e.css("backgroundColor",r)}),i},setOpacity:function(e,r){var n=this;return e==n.opacity?n:(n.opacity=e,t.each(n.shades,function(t,i){!n.fade||r?i.css({opacity:e}):i.animate({opacity:e},{queue:!1,duration:n.fadeSpeed,easing:n.fadeEasing})}),n)},createShade:function(){return t("<div />").css({position:"absolute",backgroundColor:this.color,opacity:this.opacity}).appendTo(this.container)},refresh:function(t){var e=this.core,r=this.shades;this.setColor(t.bgColor?t.bgColor:this.core.opt.bgColor),this.setOpacity(t.bgOpacity?t.bgOpacity:this.core.opt.bgOpacity),this.elh=e.container.height(),this.elw=e.container.width(),r.right.css("height",this.elh+"px"),r.left.css("height",this.elh+"px")},filter:function(t,e,r){if(!r.active)return t;var n=this,i=n.shades;return i.top.css({left:Math.round(t.x)+"px",width:Math.round(t.w)+"px",height:Math.round(t.y)+"px"}),i.bottom.css({top:Math.round(t.y2)+"px",left:Math.round(t.x)+"px",width:Math.round(t.w)+"px",height:n.elh-Math.round(t.y2)+"px"}),i.right.css({left:Math.round(t.x2)+"px",width:n.elw-Math.round(t.x2)+"px"}),i.left.css({width:Math.round(t.x)+"px"}),n.visible||(n.container.show(),n.visible=!0),t}}),e.registerFilter("shader",p);var f=function(t){this.stage=t,this.core=t.core,this.cloneStagePosition()};f.prototype={cloneStagePosition:function(){var t=this.stage;this.angle=t.angle,this.scale=t.scale,this.offset=t.offset},getElement:function(){var e=this.stage;return t("<div />").css({position:"absolute",top:e.offset[0]+"px",left:e.offset[1]+"px",width:e.angle+"px",height:e.scale+"px"})},animate:function(t){var e=this;this.scale=this.stage.boundScale(this.scale),e.stage.triggerEvent("croprotstart"),e.getElement().animate({top:e.offset[0]+"px",left:e.offset[1]+"px",width:e.angle+"px",height:e.scale+"px"},{easing:e.core.opt.animEasing,duration:e.core.opt.animDuration,complete:function(){e.stage.triggerEvent("croprotend"),"function"==typeof t&&t.call(this)},progress:function(t){var r,n={},i=t.tweens;for(r=0;r<i.length;r++)n[i[r].prop]=i[r].now;e.stage.setAngle(n.width).setScale(n.height).setOffset(n.top,n.left).redraw()}})}},e.stage.Canvas.prototype.getAnimator=function(){return new f(this)},e.registerComponent("CanvasAnimator",f);var d=function(t){this.selection=t,this.core=t.core};d.prototype={getElement:function(){var e=this.selection.get();return t("<div />").css({position:"absolute",top:e.y+"px",left:e.x+"px",width:e.w+"px",height:e.h+"px"})},animate:function(t,e,r,n,i){var o=this;o.selection.allowResize(!1),o.getElement().animate({top:e+"px",left:t+"px",width:r+"px",height:n+"px"},{easing:o.core.opt.animEasing,duration:o.core.opt.animDuration,complete:function(){o.selection.allowResize(!0),i&&i.call(this)},progress:function(t){var e,r={},n=t.tweens;for(e=0;e<n.length;e++)r[n[e].prop]=n[e].now;var i={x:parseInt(r.left),y:parseInt(r.top),w:parseInt(r.width),h:parseInt(r.height)};i.x2=i.x+i.w,i.y2=i.y+i.h,o.selection.updateRaw(i,"se")}})}},e.registerComponent("Animator",d);var g=function(t,e,r){var n=this;n.x=t.pageX,n.y=t.pageY,n.selection=e,n.eventTarget=e.core.opt.dragEventTarget,n.orig=e.get(),e.callFilterFunction("refresh");var i=e.core.container.position();n.elx=i.left,n.ely=i.top,n.offsetx=0,n.offsety=0,n.ord=r,n.opposite=n.getOppositeCornerOffset(),n.initEvents(t)};g.prototype={getOppositeCornerOffset:function(){var t=this.orig,e=this.x-this.elx-t.x,r=this.y-this.ely-t.y;switch(this.ord){case"nw":case"w":return[t.w-e,t.h-r];case"sw":return[t.w-e,-r];case"se":case"s":case"e":return[-e,-r];case"ne":case"n":return[-e,t.h-r]}return[null,null]},initEvents:function(e){t(this.eventTarget).on("mousemove.jcrop",this.createDragHandler()).on("mouseup.jcrop",this.createStopHandler())},dragEvent:function(t){this.offsetx=t.pageX-this.x,this.offsety=t.pageY-this.y,this.selection.updateRaw(this.getBox(),this.ord)},endDragEvent:function(t){var e=this.selection;e.core.container.removeClass("jcrop-dragging"),e.element.trigger("cropend",[e,e.core.unscale(e.get())]),e.focus()},createStopHandler:function(){var e=this;return function(r){return t(e.eventTarget).off(".jcrop"),e.endDragEvent(r),!1}},createDragHandler:function(){var t=this;return function(e){return t.dragEvent(e),!1}},update:function(t,e){var r=this;r.offsetx=t-r.x,r.offsety=e-r.y},resultWrap:function(t){var e={x:Math.min(t[0],t[2]),y:Math.min(t[1],t[3]),x2:Math.max(t[0],t[2]),y2:Math.max(t[1],t[3])};return e.w=e.x2-e.x,e.h=e.y2-e.y,e},getBox:function(){var t=this,e=t.orig,r={x2:e.x+e.w,y2:e.y+e.h};switch(t.ord){case"n":return t.resultWrap([e.x,t.offsety+e.y,r.x2,r.y2]);case"s":return t.resultWrap([e.x,e.y,r.x2,t.offsety+r.y2]);case"e":return t.resultWrap([e.x,e.y,t.offsetx+r.x2,r.y2]);case"w":return t.resultWrap([e.x+t.offsetx,e.y,r.x2,r.y2]);case"sw":return t.resultWrap([t.offsetx+e.x,e.y,r.x2,t.offsety+r.y2]);case"se":return t.resultWrap([e.x,e.y,t.offsetx+r.x2,t.offsety+r.y2]);case"ne":return t.resultWrap([e.x,t.offsety+e.y,t.offsetx+r.x2,r.y2]);case"nw":return t.resultWrap([t.offsetx+e.x,t.offsety+e.y,r.x2,r.y2]);case"move":return r.nx=e.x+t.offsetx,r.ny=e.y+t.offsety,t.resultWrap([r.nx,r.ny,r.nx+e.w,r.ny+e.h])}}},e.registerComponent("DragState",g);var m=function(t){this.core=t};m.prototype={on:function(e,r){t(this).on(e,r)},off:function(e){t(this).off(e)},trigger:function(e){t(this).trigger(e)}},e.registerComponent("EventManager",m);var v=function(t,e,r){this.src=t,e||(e=new Image),this.element=e,this.callback=r,this.load()};t.extend(v,{attach:function(t,e){return new v(t.src,t,e)},prototype:{getDimensions:function(){var e=this.element;return t(e).width()?[t(e).width(),t(e).height()]:e.naturalWidth?[e.naturalWidth,e.naturalHeight]:e.width?[e.width,e.height]:null},fireCallback:function(){this.element.onload=null,"function"==typeof this.callback&&this.callback.apply(this,this.getDimensions())},isLoaded:function(){return this.element.complete},load:function(){var t=this,e=t.element;e.src=t.src,t.isLoaded()?t.fireCallback():t.element.onload=function(e){t.fireCallback()}}}}),e.registerComponent("ImageLoader",v);var x=function(t){this.core=t,this.init()};t.extend(x,{support:function(){if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)return!0},prototype:{init:function(){var e=this,r=t.Jcrop.component.DragState.prototype;r.touch||(e.initEvents(),e.shimDragState(),e.shimStageDrag(),r.touch=!0)},shimDragState:function(){var e=this;t.Jcrop.component.DragState.prototype.initEvents=function(r){"touch"==r.type.substr(0,5)?t(this.eventTarget).on("touchmove.jcrop.jcrop-touch",e.dragWrap(this.createDragHandler())).on("touchend.jcrop.jcrop-touch",this.createStopHandler()):t(this.eventTarget).on("mousemove.jcrop",this.createDragHandler()).on("mouseup.jcrop",this.createStopHandler())}},shimStageDrag:function(){this.core.container.addClass("jcrop-touch").on("touchstart.jcrop.jcrop-stage",this.dragWrap(this.core.ui.manager.startDragHandler()))},dragWrap:function(t){return function(e){return e.preventDefault(),e.stopPropagation(),"touch"==e.type.substr(0,5)&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,t(e))}},initEvents:function(){var t=this,e=t.core;e.container.on("touchstart.jcrop.jcrop-touch","."+e.opt.css_drag,t.dragWrap(e.startDrag()))}}}),e.registerComponent("Touch",x);var y=function(t){this.core=t,this.init()};t.extend(y,{defaults:{eventName:"keydown.jcrop",passthru:[9],debug:!1},prototype:{init:function(){t.extend(this,y.defaults),this.enable()},disable:function(){this.core.container.off(this.eventName)},enable:function(){var e=this,r=e.core;r.container.on(e.eventName,function(n){var i=n.shiftKey?16:2;if(t.inArray(n.keyCode,e.passthru)>=0)return!0;switch(n.keyCode){case 37:r.nudge(-i,0);break;case 38:r.nudge(0,-i);break;case 39:r.nudge(i,0);break;case 40:r.nudge(0,i);break;case 46:case 8:return r.requestDelete(),!1;default:e.debug}n.metaKey||n.ctrlKey||n.preventDefault()})}}}),e.registerComponent("Keyboard",y);var w=function(){};t.extend(w,{defaults:{minSize:[8,8],maxSize:[0,0],aspectRatio:0,edge:{n:0,s:0,e:0,w:0},bgColor:null,bgOpacity:null,last:null,state:null,active:!0,linked:!0,canDelete:!0,canDrag:!0,canResize:!0,canSelect:!0},prototype:{init:function(t){this.core=t,this.startup(),this.linked=this.core.opt.linked,this.attach(),this.setOptions(this.core.opt),t.container.trigger("cropcreate",[this])},attach:function(){},startup:function(){var e=this,r=e.core.opt;t.extend(e,w.defaults),e.filter=e.core.getDefaultFilters(),e.element=t("<div />").addClass(r.css_selection).data({selection:e}),e.frame=t("<button />").addClass(r.css_button).data("ord","move").attr("type","button"),e.element.append(e.frame).appendTo(e.core.container),e.core.opt.is_msie&&e.frame.css({opacity:0,backgroundColor:"white"}),e.insertElements(),e.frame.on("focus.jcrop",function(t){e.core.setSelection(e),e.element.trigger("cropfocus",e),e.element.addClass("jcrop-focus")}).on("blur.jcrop",function(t){e.element.removeClass("jcrop-focus"),e.element.trigger("cropblur",e)})},propagate:["canDelete","canDrag","canResize","canSelect","minSize","maxSize","aspectRatio","edge"],setOptions:function(t){return e.propagate(this.propagate,t,this),this.refresh(),this},refresh:function(){this.allowResize(),this.allowDrag(),this.allowSelect(),this.callFilterFunction("refresh"),this.updateRaw(this.get(),"se")},callFilterFunction:function(t,e){for(var r=0;r<this.filter.length;r++)this.filter[r][t]&&this.filter[r][t](this);return this},addFilter:function(t){t.core=this.core,this.hasFilter(t)||(this.filter.push(t),this.sortFilters(),t.init&&t.init(),this.refresh())},hasFilter:function(t){var e,r=this.filter;for(e=0;e<r.length;e++)if(r[e]===t)return!0},sortFilters:function(){this.filter.sort(function(t,e){return t.priority-e.priority})},clearFilters:function(){for(var t,e=this.filter,t=0;t<e.length;t++)e[t].destroy&&e[t].destroy();this.filter=[]},removeFilter:function(t){for(var e,r=this.filter,n=[],e=0;e<r.length;e++)r[e].tag&&r[e].tag==t||t===r[e]?r[e].destroy&&r[e].destroy():n.push(r[e]);this.filter=n},runFilters:function(t,e){for(var r=0;r<this.filter.length;r++)t=this.filter[r].filter(t,e,this);return t},endDrag:function(){this.state&&(t(document.body).off(".jcrop"),this.focus(),this.state=null)},startDrag:function(r,n){var i=this;i.core;return n=n||t(r.target).data("ord"),this.focus(),("move"!=n||!i.element.hasClass(i.core.opt.css_nodrag))&&(this.state=new e.component.DragState(r,this,n),!1)},allowSelect:function(t){return void 0===t&&(t=this.canSelect),t&&this.canSelect?this.frame.attr("disabled",!1):this.frame.attr("disabled","disabled"),this},allowDrag:function(t){var e=this,r=e.core.opt;return void 0==t&&(t=e.canDrag),t&&e.canDrag?e.element.removeClass(r.css_nodrag):e.element.addClass(r.css_nodrag),this},allowResize:function(t){var e=this,r=e.core.opt;return void 0==t&&(t=e.canResize),t&&e.canResize?e.element.removeClass(r.css_noresize):e.element.addClass(r.css_noresize),this},remove:function(){this.element.trigger("cropremove",this),this.element.remove()},toBack:function(){this.active=!1,this.element.removeClass("jcrop-current jcrop-focus")},toFront:function(){this.active=!0,this.element.addClass("jcrop-current"),this.callFilterFunction("refresh"),this.refresh()},redraw:function(t){return this.moveTo(t.x,t.y),this.resize(t.w,t.h),this.last=t,this},update:function(t,e){return this.updateRaw(this.core.scale(t),e)},updateRaw:function(t,e){return t=this.runFilters(t,e),this.redraw(t),this.element.trigger("cropmove",[this,this.core.unscale(t)]),this},animateTo:function(t,r){var n=new e.component.Animator(this),i=this.core.scale(e.wrapFromXywh(t));n.animate(i.x,i.y,i.w,i.h,r)},center:function(t){var e=this.get(),r=this.core,n=r.container.width(),i=r.container.height(),o=[(n-e.w)/2,(i-e.h)/2,e.w,e.h];return this[t?"setSelect":"animateTo"](o)},createElement:function(e,r){return t("<div />").addClass(e+" ord-"+r).data("ord",r)},moveTo:function(t,e){this.element.css({top:e+"px",left:t+"px"})},blur:function(){return this.element.blur(),this},focus:function(){return this.core.setSelection(this),this.frame.focus(),this},resize:function(t,e){this.element.css({width:t+"px",height:e+"px"})},get:function(){var t=this.element,e=t.position(),r=t.width(),n=t.height(),i={x:e.left,y:e.top};return i.x2=i.x+r,i.y2=i.y+n,i.w=r,i.h=n,i},insertElements:function(){var t,e=this,r=(e.core,e.element),n=e.core.opt,i=n.borders,o=n.handles,a=n.dragbars;for(t=0;t<a.length;t++)r.append(e.createElement(n.css_dragbars,a[t]));for(t=0;t<o.length;t++)r.append(e.createElement(n.css_handles,o[t]));for(t=0;t<i.length;t++)r.append(e.createElement(n.css_borders,i[t]))}}}),e.registerComponent("Selection",w);var b=function(e,r){t.extend(this,b.defaults,r||{}),this.manager=e,this.core=e.core};b.defaults={offset:[-8,-8],active:!0,minsize:[20,20]},t.extend(b.prototype,{start:function(r){var n=this.core;if(n.opt.allowSelect){if(n.opt.multi&&n.opt.multiMax&&n.ui.multi.length>=n.opt.multiMax)return!1;var i=t(r.currentTarget).offset(),o=r.pageX-i.left+this.offset[0],a=r.pageY-i.top+this.offset[1],s=n.ui.multi;if(!n.opt.multi)if(n.opt.multiCleanup){for(var c=0;c<s.length;c++)s[c].remove();n.ui.multi=[]}else n.removeSelection(n.ui.selection);n.container.addClass("jcrop-dragging");var h=n.newSelection().updateRaw(e.wrapFromXywh([o,a,1,1]));return h.element.trigger("cropstart",[h,this.core.unscale(h.get())]),h.startDrag(r,"se")}},end:function(t,e){this.drag(t,e);var r=this.sel.get();this.core.container.removeClass("jcrop-dragging"),r.w<this.minsize[0]||r.h<this.minsize[1]?this.core.requestDelete():this.sel.focus()}}),e.registerComponent("StageDrag",b);var A=function(t){this.core=t,this.ui=t.ui,this.init()};t.extend(A.prototype,{init:function(){this.setupEvents(),this.dragger=new b(this)},tellConfigUpdate:function(t){for(var e=0,r=this.ui.multi,n=r.length;e<n;e++)r[e].setOptions&&(r[e].linked||this.core.opt.linkCurrent&&r[e]==this.ui.selection)&&r[e].setOptions(t)},startDragHandler:function(){var t=this;return function(e){if(!e.button||t.core.opt.is_ie_lt9)return t.dragger.start(e)}},removeEvents:function(){this.core.event.off(".jcrop-stage"),this.core.container.off(".jcrop-stage")},shimLegacyHandlers:function(e){var r,n=this.core;t.each(n.opt.legacyHandlers,function(t,i){t in e&&(r=e[t],n.container.off(".jcrop-"+t).on(i+".jcrop.jcrop-"+t,function(t,e,i){r.call(n,i)}),delete e[t])})},setupEvents:function(){var t=this,e=t.core;e.event.on("configupdate.jcrop-stage",function(r){t.shimLegacyHandlers(e.opt),t.tellConfigUpdate(e.opt),e.container.trigger("cropconfig",[e,e.opt])}),this.core.container.on("mousedown.jcrop.jcrop-stage",this.startDragHandler())}}),e.registerComponent("StageManager",A);var C=function(){};t.extend(C,{defaults:{selection:null,fading:!0,fadeDelay:1e3,fadeDuration:1e3,autoHide:!1,width:80,height:80,_hiding:null},prototype:{recopyCanvas:function(){var t=this.core.ui.stage,e=t.context;this.context.putImageData(e.getImageData(0,0,t.canvas.width,t.canvas.height),0,0)},init:function(e,r){var n=this;this.core=e,t.extend(this,C.defaults,r),n.initEvents(),n.refresh(),n.insertElements(),n.selection?(n.renderSelection(n.selection),n.selectionTarget=n.selection.element[0]):n.core.ui.selection&&n.renderSelection(n.core.ui.selection),n.core.ui.stage.canvas&&(n.context=n.preview[0].getContext("2d"),n.core.container.on("cropredraw",function(t){n.recopyCanvas(),n.refresh()}))},updateImage:function(e){return this.preview.remove(),this.preview=t(t.Jcrop.imageClone(e)),this.element.append(this.preview),this.refresh(),this},insertElements:function(){this.preview=t(t.Jcrop.imageClone(this.core.ui.stage.imgsrc)),this.element=t("<div />").addClass("jcrop-thumb").width(this.width).height(this.height).append(this.preview).appendTo(this.core.container)},resize:function(t,e){this.width=t,this.height=e,this.element.width(t).height(e),this.renderCoords(this.last)},refresh:function(){this.cw=this.core.opt.xscale*this.core.container.width(),this.ch=this.core.opt.yscale*this.core.container.height(),this.last&&this.renderCoords(this.last)},renderCoords:function(t){var e=this.width/t.w,r=this.height/t.h;return this.preview.css({width:Math.round(e*this.cw)+"px",height:Math.round(r*this.ch)+"px",marginLeft:"-"+Math.round(e*t.x)+"px",marginTop:"-"+Math.round(r*t.y)+"px"}),this.last=t,this},renderSelection:function(t){return this.renderCoords(t.core.unscale(t.get()))},selectionStart:function(t){this.renderSelection(t)},show:function(){this._hiding&&clearTimeout(this._hiding),this.fading?this.element.stop().animate({opacity:1},{duration:80,queue:!1}):this.element.stop().css({opacity:1})},hide:function(){var t=this;t.fading?t._hiding=setTimeout(function(){t._hiding=null,t.element.stop().animate({opacity:0},{duration:t.fadeDuration,queue:!1})},t.fadeDelay):t.element.hide()},initEvents:function(){var t=this;t.core.container.on("croprotstart croprotend cropimage cropstart cropmove cropend",function(e,r,n){if(t.selectionTarget&&t.selectionTarget!==e.target)return!1;switch(e.type){case"cropimage":t.updateImage(n);break;case"cropstart":t.selectionStart(r);case"croprotstart":t.show();break;case"cropend":
t.renderCoords(n);case"croprotend":t.autoHide&&t.hide();break;case"cropmove":t.renderCoords(n)}})}}}),e.registerComponent("Thumbnailer",C);var j=function(){};j.prototype={init:function(e,r,n){r||(r=e.container),this.$btn=t(r),this.$targ=t(r),this.core=e,this.$btn.addClass("dialdrag").on("mousedown.dialdrag",this.mousedown()).data("dialdrag",this),t.isFunction(n)||(n=function(){}),this.callback=n,this.ondone=n},remove:function(){return this.$btn.removeClass("dialdrag").off(".dialdrag").data("dialdrag",null),this},setTarget:function(e){return this.$targ=t(e),this},getOffset:function(){var t=this.$targ,e=t.offset();return[e.left+t.width()/2,e.top+t.height()/2]},relMouse:function(t){var e=t.pageX-this.offset[0],r=t.pageY-this.offset[1],n=Math.atan2(r,e)*(180/Math.PI),i=Math.sqrt(Math.pow(e,2)+Math.pow(r,2));return[e,r,n,i]},mousedown:function(){function e(e){t(window).off(".dialdrag"),n.ondone.call(n,n.relMouse(e)),n.core.container.trigger("croprotend")}function r(t){n.callback.call(n,n.relMouse(t))}var n=this;return function(i){n.offset=n.getOffset();var o=n.relMouse(i);return n.angleOffset=-n.core.ui.stage.angle+o[2],n.distOffset=o[3],n.dragOffset=[o[0],o[1]],n.core.container.trigger("croprotstart"),t(window).on("mousemove.dialdrag",r).on("mouseup.dialdrag",e),n.callback.call(n,n.relMouse(i)),!1}}},e.registerComponent("DialDrag",j),e.defaults={edge:{n:0,s:0,e:0,w:0},setSelect:null,linked:!0,linkCurrent:!0,canDelete:!0,canSelect:!0,canDrag:!0,canResize:!0,eventManagerComponent:e.component.EventManager,keyboardComponent:e.component.Keyboard,dragstateComponent:e.component.DragState,stagemanagerComponent:e.component.StageManager,animatorComponent:e.component.Animator,selectionComponent:e.component.Selection,stageConstructor:e.stageConstructor,allowSelect:!0,multi:!1,multiMax:!1,multiCleanup:!0,animation:!0,animEasing:"swing",animDuration:400,fading:!0,fadeDuration:300,fadeEasing:"swing",bgColor:"black",bgOpacity:.5,applyFilters:["constrain","extent","backoff","ratio","shader","round"],borders:["e","w","s","n"],handles:["n","s","e","w","sw","ne","nw","se"],dragbars:["n","e","w","s"],dragEventTarget:window,xscale:1,yscale:1,boxWidth:null,boxHeight:null,css_nodrag:"jcrop-nodrag",css_drag:"jcrop-drag",css_container:"jcrop-active",css_shades:"jcrop-shades",css_selection:"jcrop-selection",css_borders:"jcrop-border",css_handles:"jcrop-handle jcrop-drag",css_button:"jcrop-box jcrop-drag",css_noresize:"jcrop-noresize",css_dragbars:"jcrop-dragbar jcrop-drag",legacyHandlers:{onChange:"cropmove",onSelect:"cropend"}},t.extend(e.prototype,{init:function(){this.event=new this.opt.eventManagerComponent(this),this.ui.keyboard=new this.opt.keyboardComponent(this),this.ui.manager=new this.opt.stagemanagerComponent(this),this.applyFilters(),t.Jcrop.supportsTouch&&new t.Jcrop.component.Touch(this),this.initEvents()},applySizeConstraints:function(){var r=this.opt,n=this.opt.imgsrc;if(n){var i=n.naturalWidth||n.width,o=n.naturalHeight||n.height,a=r.boxWidth||i,s=r.boxHeight||o;if(n&&(i>a||o>s)){var c=e.getLargestBox(i/o,a,s);t(n).width(c[0]).height(c[1]),this.resizeContainer(c[0],c[1]),this.opt.xscale=i/c[0],this.opt.yscale=o/c[1]}}if(this.opt.trueSize){var h=this.opt.trueSize[0],l=this.opt.trueSize[1],u=this.getContainerSize();this.opt.xscale=h/u[0],this.opt.yscale=l/u[1]}},initComponent:function(t){if(e.component[t]){var r=Array.prototype.slice.call(arguments),n=new e.component[t];return r.shift(),r.unshift(this),n.init.apply(n,r),n}},setOptions:function(e,r){return t.isPlainObject(e)||(e={}),t.extend(this.opt,e),this.opt.setSelect&&(this.ui.multi.length||this.newSelection(),this.setSelect(this.opt.setSelect),this.opt.setSelect=null),this.event.trigger("configupdate"),this},destroy:function(){this.opt.imgsrc?(this.container.before(this.opt.imgsrc),this.container.remove(),t(this.opt.imgsrc).removeData("Jcrop").show()):this.container.remove()},applyFilters:function(){for(var e,r=0,n=this.opt.applyFilters,i=n.length;r<i;r++)t.Jcrop.filter[n[r]]&&(e=new t.Jcrop.filter[n[r]]),e.core=this,e.init&&e.init(),this.filter[n[r]]=e},getDefaultFilters:function(){for(var t=[],e=0,r=this.opt.applyFilters,n=r.length;e<n;e++)this.filter.hasOwnProperty(r[e])&&t.push(this.filter[r[e]]);return t.sort(function(t,e){return t.priority-e.priority}),t},setSelection:function(t){for(var e=this.ui.multi,r=[],n=0;n<e.length;n++)e[n]!==t&&r.push(e[n]),e[n].toBack();return r.unshift(t),this.ui.multi=r,this.ui.selection=t,t.toFront(),t},getSelection:function(t){var e=this.ui.selection.get();return e},newSelection:function(t){return t||(t=new this.opt.selectionComponent),t.init(this),this.setSelection(t),t},hasSelection:function(t){for(var e=0;e<this.ui.multi;e++)if(t===this.ui.multi[e])return!0},removeSelection:function(t){for(var e,r=[],n=this.ui.multi,e=0;e<n.length;e++)t!==n[e]?r.push(n[e]):n[e].remove();return this.ui.multi=r},addFilter:function(t){for(var e=0,r=this.ui.multi,n=r.length;e<n;e++)r[e].addFilter(t);return this},removeFilter:function(t){for(var e=0,r=this.ui.multi,n=r.length;e<n;e++)r[e].removeFilter(t);return this},blur:function(){return this.ui.selection.blur(),this},focus:function(){return this.ui.selection.focus(),this},initEvents:function(){var t=this;t.container.on("selectstart",function(t){return!1}).on("mousedown","."+t.opt.css_drag,t.startDrag())},maxSelect:function(){this.setSelect([0,0,this.elw,this.elh])},nudge:function(t,e){var r=this.ui.selection,n=r.get();n.x+=t,n.x2+=t,n.y+=e,n.y2+=e,n.x<0?(n.x2=n.w,n.x=0):n.x2>this.elw&&(n.x2=this.elw,n.x=n.x2-n.w),n.y<0?(n.y2=n.h,n.y=0):n.y2>this.elh&&(n.y2=this.elh,n.y=n.y2-n.h),r.element.trigger("cropstart",[r,this.unscale(n)]),r.updateRaw(n,"move"),r.element.trigger("cropend",[r,this.unscale(n)])},refresh:function(){for(var t=0,e=this.ui.multi,r=e.length;t<r;t++)e[t].refresh()},blurAll:function(){for(var t=this.ui.multi,e=0;e<t.length;e++)t[e]!==sel&&n.push(t[e]),t[e].toBack()},scale:function(t){var e=this.opt.xscale,r=this.opt.yscale;return{x:t.x/e,y:t.y/r,x2:t.x2/e,y2:t.y2/r,w:t.w/e,h:t.h/r}},unscale:function(t){var e=this.opt.xscale,r=this.opt.yscale;return{x:t.x*e,y:t.y*r,x2:t.x2*e,y2:t.y2*r,w:t.w*e,h:t.h*r}},requestDelete:function(){if(this.ui.multi.length>1&&this.ui.selection.canDelete)return this.deleteSelection()},deleteSelection:function(){this.ui.selection&&(this.removeSelection(this.ui.selection),this.ui.multi.length&&this.ui.multi[0].focus(),this.ui.selection.refresh())},animateTo:function(t){return this.ui.selection&&this.ui.selection.animateTo(t),this},setSelect:function(t){return this.ui.selection&&this.ui.selection.update(e.wrapFromXywh(t)),this},startDrag:function(){var e=this;return function(r){var n=t(r.target),i=n.closest("."+e.opt.css_selection).data("selection"),o=n.data("ord");return e.container.trigger("cropstart",[i,e.unscale(i.get())]),i.startDrag(r,o),!1}},getContainerSize:function(){return[this.container.width(),this.container.height()]},resizeContainer:function(t,e){this.container.width(t).height(e),this.refresh()},setImage:function(e,r){var n=this,i=n.opt.imgsrc;return!!i&&void new t.Jcrop.component.ImageLoader(e,null,function(o,a){n.resizeContainer(o,a),i.src=e,t(i).width(o).height(a),n.applySizeConstraints(),n.refresh(),n.container.trigger("cropimage",[n,i]),"function"==typeof r&&r.call(n,o,a)})},update:function(t){this.ui.selection&&this.ui.selection.update(t)}}),t.fn.Jcrop=function(e,r){e=e||{};var n=this.eq(0).data("Jcrop"),i=Array.prototype.slice.call(arguments);return"api"==e?n:n&&"string"==typeof e?!!n[e]&&(i.shift(),n[e].apply(n,i),n):void this.each(function(){var n=t(this),i=n.data("Jcrop");return i?i.setOptions(e):(e.stageConstructor||(e.stageConstructor=t.Jcrop.stageConstructor),e.stageConstructor(this,e,function(e,i){var o=i.setSelect;o&&delete i.setSelect;var a=t.Jcrop.attach(e.element,i);"function"==typeof e.attach&&e.attach(a),n.data("Jcrop",a),o&&(a.newSelection(),a.setSelect(o)),"function"==typeof r&&r.call(a)})),this})};var S=function(t,e,r){function n(t){v.cssText=t}function i(t,e){return typeof t===e}function o(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var n in t){var i=t[n];if(!o(i,"-")&&v[i]!==r)return"pfx"!=e||i}return!1}function s(t,e,n){for(var o in t){var a=e[t[o]];if(a!==r)return n===!1?t[o]:i(a,"function")?a.bind(n||e):a}return!1}function c(t,e,r){var n=t.charAt(0).toUpperCase()+t.slice(1),o=(t+" "+b.join(n+" ")+n).split(" ");return i(e,"string")||i(e,"undefined")?a(o,e):(o=(t+" "+A.join(n+" ")+n).split(" "),s(o,e,r))}var h,l,u,p="2.7.1",f={},d=e.documentElement,g="modernizr",m=e.createElement(g),v=m.style,x={}.toString,y=" -webkit- -moz- -o- -ms- ".split(" "),w="Webkit Moz O ms",b=w.split(" "),A=w.toLowerCase().split(" "),C={svg:"http://www.w3.org/2000/svg"},j={},S=[],k=S.slice,E=function(t,r,n,i){var o,a,s,c,h=e.createElement("div"),l=e.body,u=l||e.createElement("body");if(parseInt(n,10))for(;n--;)s=e.createElement("div"),s.id=i?i[n]:g+(n+1),h.appendChild(s);return o=["&#173;",'<style id="s',g,'">',t,"</style>"].join(""),h.id=g,(l?h:u).innerHTML+=o,u.appendChild(h),l||(u.style.background="",u.style.overflow="hidden",c=d.style.overflow,d.style.overflow="hidden",d.appendChild(u)),a=r(h,t),l?h.parentNode.removeChild(h):(u.parentNode.removeChild(u),d.style.overflow=c),!!a},z=function(){function t(t,o){o=o||e.createElement(n[t]||"div"),t="on"+t;var a=t in o;return a||(o.setAttribute||(o=e.createElement("div")),o.setAttribute&&o.removeAttribute&&(o.setAttribute(t,""),a=i(o[t],"function"),i(o[t],"undefined")||(o[t]=r),o.removeAttribute(t))),o=null,a}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t}(),D={}.hasOwnProperty;u=i(D,"undefined")||i(D.call,"undefined")?function(t,e){return e in t&&i(t.constructor.prototype[e],"undefined")}:function(t,e){return D.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var r=k.call(arguments,1),n=function(){if(this instanceof n){var i=function(){};i.prototype=e.prototype;var o=new i,a=e.apply(o,r.concat(k.call(arguments)));return Object(a)===a?a:o}return e.apply(t,r.concat(k.call(arguments)))};return n}),j.canvas=function(){var t=e.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},j.canvastext=function(){return!(!f.canvas||!i(e.createElement("canvas").getContext("2d").fillText,"function"))},j.touch=function(){var r;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?r=!0:E(["@media (",y.join("touch-enabled),("),g,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){r=9===t.offsetTop}),r},j.draganddrop=function(){var t=e.createElement("div");return"draggable"in t||"ondragstart"in t&&"ondrop"in t},j.csstransforms=function(){return!!c("transform")},j.svg=function(){return!!e.createElementNS&&!!e.createElementNS(C.svg,"svg").createSVGRect},j.inlinesvg=function(){var t=e.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==C.svg},j.svgclippaths=function(){return!!e.createElementNS&&/SVGClipPath/.test(x.call(e.createElementNS(C.svg,"clipPath")))};for(var M in j)u(j,M)&&(l=M.toLowerCase(),f[l]=j[M](),S.push((f[l]?"":"no-")+l));return f.addTest=function(t,e){if("object"==typeof t)for(var n in t)u(t,n)&&f.addTest(n,t[n]);else{if(t=t.toLowerCase(),f[t]!==r)return f;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(d.className+=" "+(e?"":"no-")+t),f[t]=e}return f},n(""),m=h=null,f._version=p,f._prefixes=y,f._domPrefixes=A,f._cssomPrefixes=b,f.hasEvent=z,f.testProp=function(t){return a([t])},f.testAllProps=c,f.testStyles=E,f}(window,window.document);!function(){var t=new Image;t.onerror=function(){S.addTest("datauri",function(){return!1})},t.onload=function(){S.addTest("datauri",function(){return 1==t.width&&1==t.height})},t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}(),t.Jcrop=e,t.Jcrop.supportsCanvas=S.canvas,t.Jcrop.supportsCanvasText=S.canvastext,t.Jcrop.supportsDragAndDrop=S.draganddrop,t.Jcrop.supportsDataURI=S.datauri,t.Jcrop.supportsSVG=S.svg,t.Jcrop.supportsInlineSVG=S.inlinesvg,t.Jcrop.supportsSVGClipPaths=S.svgclippaths,t.Jcrop.supportsCSSTransforms=S.csstransforms,t.Jcrop.supportsTouch=S.touch}(jQuery)},0:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r("12695715cd021610570e"),s=n(a),c=r("b334fd7e4c5a19234db2"),h=n(c),l=function(){function t(e){i(this,t),this.element=e.element,this.avatarCrop=e.avatarCrop,this.saveBtn=e.saveBtn,this.init()}return o(t,[{key:"init",value:function(){var t=this.imageCrop();this.initEvent(t)}},{key:"initEvent",value:function(t){$(this.saveBtn).on("click",function(e){e.stopPropagation();var r=$(e.currentTarget);t.crop({imgs:{large:[200,200],medium:[120,120],small:[48,48]}}),r.button("loading")})}},{key:"imageCrop",value:function t(){var e=this,t=new s.default({element:this.avatarCrop,cropedWidth:200,cropedHeight:200});return t.afterCrop=function(t){var r=$(e.saveBtn),n=r.data("url");$.post(n,{images:t},function(t){"success"===t.status?($("#profile_avatar").val(t.avatar),$("#user-profile-form img").attr("src",t.avatar),$("#profile_avatar").blur(),$("#modal").modal("hide"),(0,h.default)("success",Translator.trans("site.upload_success_hint"))):((0,h.default)("danger",Translator.trans("upload_fail_retry_hint")),r.button("reset"))})},t}}]),t}();new l({element:"#avatar-crop-form",avatarCrop:"#avatar-crop",saveBtn:"#upload-avatar-btn"})},"12695715cd021610570e":function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r("3c059c9d674b4e8f63a9"),r("c962afacd3de715604c1");var o=function(){function t(e){n(this,t);var r=this;this.config=$.extend({element:null,group:"default"},e),this.element=$(this.config.element);var i=this.element,o=i.attr("width"),a=i.attr("height"),s=i.data("naturalWidth"),c=i.data("naturalHeight"),h=this.config.cropedWidth,l=this.config.cropedHeight,u=h/l,p=h*(s/o),f=l*(c/a);i.Jcrop({trueSize:[s,c],setSelect:[0,0,p,f],aspectRatio:u,keySupport:!1,allowSelect:!1,onSelect:function(t){r.onSelect(t)}})}return i(t,[{key:"crop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,r=app.imgCropUrl,n=$.extend(e.element.data("Jcrop").ui.selection.last,t,{width:this.element.width(),height:this.element.height(),group:e.config.group});n.x=n.x>0?n.x:0,n.y=n.y>0?n.y:0,$.post(r,n,function(t){e.afterCrop(t)})}},{key:"onSelect",value:function(t){}},{key:"afterCrop",value:function(t){}}]),t}();e.default=o},bdf3ee7433c7d244da7e:function(t,e,r){function n(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=f[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(h(n.parts[o],e))}else{for(var a=[],o=0;o<n.parts.length;o++)a.push(h(n.parts[o],e));f[n.id]={id:n.id,refs:1,parts:a}}}}function i(t){for(var e=[],r={},n=0;n<t.length;n++){var i=t[n],o=i[0],a=i[1],s=i[2],c=i[3],h={css:a,media:s,sourceMap:c};r[o]?r[o].parts.push(h):e.push(r[o]={id:o,parts:[h]})}return e}function o(t,e){var r=m(),n=y[y.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function c(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function h(t,e){var r,n,i;if(e.singleton){var o=x++;r=v||(v=s(e)),n=l.bind(null,r,o,!1),i=l.bind(null,r,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=c(e),n=p.bind(null,r),i=function(){a(r),r.href&&URL.revokeObjectURL(r.href)}):(r=s(e),n=u.bind(null,r),i=function(){a(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}function l(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function u(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function p(t,e){var r=e.css,n=e.sourceMap;n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var i=new Blob([r],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var f={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},g=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,x=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=g()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var r=i(t);return n(r,e),function(t){for(var o=[],a=0;a<r.length;a++){var s=r[a],c=f[s.id];c.refs--,o.push(c)}if(t){var h=i(t);n(h,e)}for(var a=0;a<o.length;a++){var c=o[a];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete f[c.id]}}}};var w=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},c962afacd3de715604c1:function(t,e,r){var n=r("c962afacd3de715604c6");"string"==typeof n&&(n=[[t.id,n,""]]);r("bdf3ee7433c7d244da7e")(n,{insertAt:"top"});n.locals&&(t.exports=n.locals)},"186c8a0bf2732d1ea26a":function(t,e){t.exports="data:image/gif;base64,R0lGODlhCAAIAJEAAKqqqv///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCgAAACwAAAAACAAIAAACDZQFCadrzVRMB9FZ5SwAIfkECQoAAAAsAAAAAAgACAAAAg+ELqCYaudeW9ChyOyltQAAIfkECQoAAAAsAAAAAAgACAAAAg8EhGKXm+rQYtC0WGl9oAAAIfkECQoAAAAsAAAAAAgACAAAAg+EhWKQernaYmjCWLF7qAAAIfkECQoAAAAsAAAAAAgACAAAAg2EISmna81UTAfRWeUsACH5BAkKAAAALAAAAAAIAAgAAAIPFA6imGrnXlvQocjspbUAACH5BAkKAAAALAAAAAAIAAgAAAIPlIBgl5vq0GLQtFhpfaIAACH5BAUKAAAALAAAAAAIAAgAAAIPlIFgknq52mJowlixe6gAADs="}});