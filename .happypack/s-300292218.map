{"version":3,"sources":["app/Resources/static-src/app/js/courseset-manage/base/index.js"],"names":["Base","init","initValidator","initSelect2","$","select2","treeview","dropdownAutoWidth","treeviewInitState","placeholderOption","$form","validator","validate","rules","title","maxlength","required","depends","val","trim","open_live_course_title","subtitle","messages","click","event","form","currentTarget","button","submit","$tags","ajax","url","data","dataType","quietMillis","term","page","q","page_limit","results","console","log","map","item","id","name","initSelection","element","callback","split","each","push","formatSelection","formatResult","formatSearching","multiple","maximumSelectionSize","placeholder","Translator","trans","width","createSearchChoice"],"mappings":";;;;AAAA;;;;IACMA,I;AACJ,kBAAc;AAAA;;AACZ,SAAKC,IAAL;AACD;;;;2BAEM;AACL,WAAKC,aAAL;AACA,WAAKC,WAAL;AACAC,QAAE,gDAAF,EAAoDC,OAApD,CAA4D;AAC5DC,kBAAU,IADkD;AAE5DC,2BAAmB,IAFyC;AAG5DC,2BAAmB,WAHyC;AAI5DC,2BAAmB;AACnB;AAL4D,OAA5D;AAOD;;;oCAEe;AACd,UAAMC,QAAQN,EAAE,iBAAF,CAAd;AACA,UAAMO,YAAYD,MAAME,QAAN,CAAe;AAC/BC,eAAO;AACLC,iBAAO;AACLC,uBAAW,GADN;AAELC,sBAAU;AACRC,qBADQ,qBACG;AACTb,kBAAE,IAAF,EAAQc,GAAR,CAAYd,EAAEe,IAAF,CAAOf,EAAE,IAAF,EAAQc,GAAR,EAAP,CAAZ;AACA,uBAAO,IAAP;AACD;AAJO,aAFL;AAQLE,oCAAwB,IARnB,CAQuB;AARvB,WADF;AAWLC,oBAAU;AACRL,sBAAU;AACRC,qBADQ,qBACG;AACTb,kBAAE,IAAF,EAAQc,GAAR,CAAYd,EAAEe,IAAF,CAAOf,EAAE,IAAF,EAAQc,GAAR,EAAP,CAAZ;AACA,uBAAO,KAAP;AACD;AAJO;AADF;AAXL,SADwB;AAqB/BI,kBAAU;AACRR,iBAAO;AACLE,sBAAU;AADL;AADC;AArBqB,OAAf,CAAlB;AA2BAZ,QAAE,wBAAF,EAA4BmB,KAA5B,CAAkC,UAACC,KAAD,EAAW;AAC3C,YAAIb,UAAUc,IAAV,EAAJ,EAAsB;AACpBrB,YAAEoB,MAAME,aAAR,EAAuBC,MAAvB,CAA8B,SAA9B;AACAjB,gBAAMkB,MAAN;AACD;AACF,OALD;AAMD;;;kCAEa;AACZ,UAAMC,QAAQzB,EAAE,OAAF,CAAd;AACAyB,YAAMxB,OAAN,CAAc;AACZyB,cAAM;AACJC,eAAKF,MAAMG,IAAN,CAAW,KAAX,CADD;AAEJC,oBAAU,MAFN;AAGJC,uBAAa,GAHT;AAIJF,cAJI,gBAIEG,IAJF,EAIQC,IAJR,EAIc;AAChB,mBAAO;AACLC,iBAAGF,IADE;AAELG,0BAAY;AAFP,aAAP;AAID,WATG;AAUJC,iBAVI,mBAUKP,IAVL,EAUW;AACbQ,oBAAQC,GAAR,CAAYT,IAAZ;AACA,mBAAO;AACLO,uBAASP,KAAKU,GAAL,CAAS,UAACC,IAAD,EAAU;AAC1B,uBAAO,EAAEC,IAAID,KAAKE,IAAX,EAAiBA,MAAMF,KAAKE,IAA5B,EAAP;AACD,eAFQ;AADJ,aAAP;AAKD;AAjBG,SADM;AAoBZC,qBApBY,yBAoBGC,OApBH,EAoBYC,QApBZ,EAoBsB;AAChC,cAAMhB,OAAO,EAAb;AACA5B,YAAE2C,QAAQ7B,GAAR,GAAc+B,KAAd,CAAoB,GAApB,CAAF,EAA4BC,IAA5B,CAAiC,YAAY;AAC3ClB,iBAAKmB,IAAL,CAAU;AACRP,kBAAI,IADI;AAERC,oBAAM;AAFE,aAAV;AAID,WALD;AAMAG,mBAAShB,IAAT;AACD,SA7BW;AA8BZoB,uBA9BY,2BA8BKT,IA9BL,EA8BW;AACrB,iBAAOA,KAAKE,IAAZ;AACD,SAhCW;AAiCZQ,oBAjCY,wBAiCEV,IAjCF,EAiCQ;AAClB,iBAAOA,KAAKE,IAAZ;AACD,SAnCW;;AAoCZS,yBAAiB,QApCL;AAqCZC,kBAAU,IArCE;AAsCZC,8BAAsB,EAtCV;AAuCZC,qBAAaC,WAAWC,KAAX,CAAiB,OAAjB,CAvCD;AAwCZC,eAAO,KAxCK;AAyCZC,0BAzCY,gCAyCU;AACpB,iBAAO,IAAP;AACD;AA3CW,OAAd;AA6CD;;;;;;AAGH,IAAI7D,IAAJ","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import 'select2';\nclass Base {\n  constructor() {\n    this.init();\n  }\n\n  init() {\n    this.initValidator();\n    this.initSelect2();\n    $('[data-role=\"tree-select\"], [name=\"categoryId\"]').select2({\n    treeview: true,\n    dropdownAutoWidth: true,\n    treeviewInitState: 'collapsed',\n    placeholderOption: 'first'\n    // treeviewInitState: 'expanded'\n  });\n  }\n\n  initValidator() {\n    const $form = $('#courseset-form');\n    const validator = $form.validate({\n      rules: {\n        title: {\n          maxlength: 100,\n          required: {\n            depends () {\n              $(this).val($.trim($(this).val()));\n              return true;\n            }\n          },\n          open_live_course_title: true// @TODO只有直播课程和直播公开课程需要此验证\n        },\n        subtitle: {\n          required: {\n            depends () {\n              $(this).val($.trim($(this).val()));\n              return false;\n            }\n          }\n        }\n      },\n      messages: {\n        title: {\n          required: '请输入有效的课程标题（直播公开课标题暂不支持<、>、\"、&、‘、’、”、“字符）'\n        }\n      }\n    });\n    $('#courseset-base-submit').click((event) => {\n      if (validator.form()) {\n        $(event.currentTarget).button('loading');\n        $form.submit();\n      }\n    });\n  }\n\n  initSelect2() {\n    const $tags = $('#tags');\n    $tags.select2({\n      ajax: {\n        url: $tags.data('url'),\n        dataType: 'json',\n        quietMillis: 500,\n        data (term, page) {\n          return {\n            q: term,\n            page_limit: 10\n          };\n        },\n        results (data) {\n          console.log(data);\n          return {\n            results: data.map((item) => {\n              return { id: item.name, name: item.name };\n            })\n          };\n        }\n      },\n      initSelection (element, callback) {\n        const data = [];\n        $(element.val().split(',')).each(function () {\n          data.push({\n            id: this,\n            name: this\n          });\n        });\n        callback(data);\n      },\n      formatSelection (item) {\n        return item.name;\n      },\n      formatResult (item) {\n        return item.name;\n      },\n      formatSearching: '搜索中...',\n      multiple: true,\n      maximumSelectionSize: 20,\n      placeholder: Translator.trans('请输入标签'),\n      width: 'off',\n      createSearchChoice () {\n        return null;\n      }\n    });\n  }\n}\n\nnew Base();\n"]}