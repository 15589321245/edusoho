{% extends 'TopxiaAdminBundle:Course:layout.html.twig' %}

{% block title %}笔记管理 - {{ parent() }}{% endblock %}

{% set menu = 'note' %}

{% set script_controller = 'course/note' %}

{% block main %}
<div class="page-header clearfix">
  <h1 class="pull-left">笔记管理</h1>
</div>

<div class="well well-sm">
  <form class="form-inline">
    <div class="form-group">
      {{ form_widget(form.keywords, {attr:{class:'form-control', placeholder:'输入关键词'}}) }}
    </div>

    <div class="form-group">
      {{ form_widget(form.nickname, {attr:{class:'form-control', placeholder:'输入作者昵称'}}) }}
    </div>

    <button class="btn btn-primary" type="submit">搜索</button>
  </form>
</div>

<div id="note-table-container">

  <table class="table table-striped table-hover" id="note-table">

    <thead>
      <tr>
        <th width="10%"> <input type="checkbox"  data-role="batch-select"> 作者</th>
        <th width="10%">课程标题</th>
        <th width="10">课时标题</th>
        <th width="45%">内容</th>
        <th width="15%">创建时间</th>
      </tr>
    </thead>

    <tbody>

      {% for note in notes %}
        <tr class="note-tr" id="note-table-tr-{{note.id}}">
          <td><input value="{{note.id}}" type="checkbox"  data-role="batch-item" >
            {{ admin_macro.user_link(users[note.userId]) }}
          </td>
          <td>
            {{ courses[note.courseId].title }}
          </td>
          <td>
            {{lessons[note.lessonId].title}}
          </td>
          <td>
              <div class="short-long-text">
                <div class="short-text text-sm text-muted">{{ note.content|plain_text(60) }} <span class="trigger">(展开)</span></div>
                <div class="long-text">{{ note.content|raw }} <span class="trigger">(收起)</span></div>
              </div>
          </td>
          <td>{{ note.createdTime|date('Y-n-d H:i:s') }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div>
    <label class="checkbox-inline"><input type="checkbox" data-role="batch-select"> 全选</label>
    <button class="btn btn-default btn-sm mlm" data-role="batch-delete"  data-name="笔记" data-url="{{ path('admin_note_delete_notes') }}">删除</button>
  </div>

</div>

  <div>
    {{ web_macro.paginator(paginator) }}
  </div>
{% endblock %} 