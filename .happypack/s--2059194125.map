{"version":3,"sources":["app/Resources/static-src/app/js/classroom-manage/set-info/index.js"],"names":["editor_classroom_about","CKEDITOR","replace","allowedContent","toolbar","filebrowserImageUploadUrl","$","data","filebrowserFlashUploadUrl","select2","treeview","dropdownAutoWidth","treeviewInitState","placeholderOption","validator","validate","rules","title","required","console","log","settings","click","form","toggleExpiryValue","val","change","app","arguments","classroomStatus","expiryValue","match","addClass","removeClass","$esBlock","text","expiryMode","$expiryValue","datetimepicker","elementAddRules","getExpiryModeDaysRules","language","autoclose","format","minView","endDate","Date","now","getExpiryModeDateRules","positive_currency","messages","after_now_date","$element","options","elementRemoveRules"],"mappings":"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","file":"index.js","sourceRoot":"/Users/kz/projects/edusoho","sourcesContent":["import notify from 'common/notify';\nimport 'common/select2';\nimport 'app/js/classroom-manage/classroom-create';\n\nlet editor_classroom_about = CKEDITOR.replace('about', {\n  allowedContent: true,\n  toolbar: 'Detail',\n  filebrowserImageUploadUrl: $('#about').data('imageUploadUrl'),\n  filebrowserFlashUploadUrl: $('#about').data('flashUploadUrl')\n});\n\n$('[data-role=\"tree-select\"], [name=\"categoryId\"]').select2({\n  treeview: true,\n  dropdownAutoWidth: true,\n  treeviewInitState: 'collapsed',\n  placeholderOption: 'first'\n});\n\nlet validator = $('#classroom-set-form').validate({\n  rules: {\n    title: {\n      required: true,\n    }\n  },\n});\n\nconsole.log(validator.settings.rules);\n\n\n$('[name=\"classroom_expiryValue\"]')\n\n\n\n$('#classroom-save').click(() => {\n  validator.form();\n})\n\ntoggleExpiryValue($(\"[name=expiryMode]:checked\").val());\n\n$(\"[name='expiryMode']\").change(function () {\n  if (app.arguments.classroomStatus == 'published') {\n    return false;\n  }\n  // validator.removeItem('[name=expiryValue]');\n\n  var expiryValue = $(\"[name='expiryValue']\").val();\n  if (expiryValue) {\n    if (expiryValue.match(\"-\")) {\n      $(\"[name='expiryValue']\").data('date', $(\"[name='expiryValue']\").val());\n    } else {\n      $(\"[name='expiryValue']\").data('days', $(\"[name='expiryValue']\").val());\n    }\n    $(\"[name='expiryValue']\").val('')\n  }\n\n  if ($(this).val() == 'none') {\n    $('.expiry-value-js').addClass('hidden');\n  } else {\n    $('.expiry-value-js').removeClass('hidden');\n    var $esBlock = $('.expiry-value-js > .controls > .help-block');\n    $esBlock.text($esBlock.data($(this).val()));\n    toggleExpiryValue($(this).val());\n  }\n});\nfunction toggleExpiryValue(expiryMode) {\n  let $expiryValue = $(\"[name='expiryValue']\");\n  if (!$expiryValue.val()) {\n    $expiryValue.val($expiryValue.data(expiryMode));\n  }\n  switch (expiryMode) {\n    case 'days':\n      $expiryValue.datetimepicker('remove');\n      $(\".expiry-value-js .controls > span\").removeClass('hidden');\n      elementAddRules($expiryValue,getExpiryModeDaysRules);\n      break;\n    case 'date':\n      $(\".expiry-value-js .controls > span\").addClass('hidden');\n      $expiryValue.datetimepicker({\n        language: 'zh-CN',\n        autoclose: true,\n        format: 'yyyy-mm-dd',\n        minView: 'month',\n        endDate: new Date(Date.now() + 86400 * 365 * 10 * 1000)\n      });\n      $expiryValue.datetimepicker('setStartDate', new Date);\n      elementAddRules($expiryValue,getExpiryModeDateRules);\n      break;\n    default:\n      break;\n  }\n}\n\n\nfunction getExpiryModeDaysRules() {\n  return {\n    required: true,\n    positive_currency: true,\n    messages: {\n      required: '请输入有效期天数',\n    }\n  }\n}\n\nfunction getExpiryModeDateRules() {\n  return {\n    required: true,\n    data: true,\n    messages: {\n      required: '请输入截至日期',\n      after_now_date: true,\n    }\n  }\n}\n\nfunction elementAddRules($element, options) {\n  \n  $element.rules(\"add\", options);\n}\n\nfunction elementRemoveRules($element) {\n  $element.rules('remove');\n}\n\n"]}