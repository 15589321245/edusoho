{% extends 'WebBundle:CourseSetManage:layout.html.twig' %}

{% block title %}{{ '教学计划列表'|trans }} - {{ parent() }}{% endblock %}
{% set side_nav = 'plan' %}
{% set use_webapck_loader = true %}

{% do script(['web/course-manage/index.js']) %}

{% block main %}
<!-- 当前课程的教学计划列表 -->
<div class="panel panel-default panel-col lesson-manage-panel">
  <div class="panel-heading">
    {{'教学计划列表'|trans}}
    <button class="btn btn-success btn-sm pull-right" data-toggle="modal" data-target="#modal" data-url="{{path('courseset_manage_course_create', {courseSetId: courseSet.id})}}">创建新的教学计划</button>
  </div>

  <div class="panel-body">
      <table id="course-table" class="table table-striped table-hover">
      	<thead>
      	  <th>名称</th>
          <th>任务数</th>
          <th>学员</th>
          <th>价格（元）</th>
          <th>操作</th>
      	</thead>
      	<tbody>
      		{%for course in courses %}
      		<tr>
      			<td>{{course.title}}
              <span class="label label-warning mll">会员免费</span>
              <span class="label label-warning mll">6折</span>
            </td>
      			<td>course.taskNum</td>
      			<td>course.stuNum</td>
      			<td>course.price</td>
      			<td>
      				<div class="btn-group">
		                <a class="btn btn-default btn-sm" href="{{path('courseset_manage_course_info', {courseSetId: courseSet.id, courseId: course.id})}}">管理</a>
		                <a href="#" type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">
		                  <span class="caret"></span>
		                </a>
		                <ul class="dropdown-menu pull-right">
		                  <li>
		                  	<a href="{{path('courseset_manage_course_preview', {courseSetId: courseSet.id, courseId: course.id})}}">预览</a>
		                  </li>
	      				  <li>
	      				  	<a href="javascript:;" data-toggle="modal" data-target="#modal" data-url="{{path('courseset_manage_course_copy', {courseSetId: courseSet.id, courseId: course.id})}}">复制为</a>
	      				  </li>
                    {% if course.status|default('') == 'published' %}
      				      <li>
      				      	<a href="javascript:;" data-url="{{path('courseset_manage_course_close', {courseSetId: courseSet.id, courseId: course.id})}}" class="js-close-course">关闭</a>
      				      </li>
                    {% else %}
      				      <li>
      				      	<a href="javascript:;" data-url="{{path('courseset_manage_course_delete', {courseSetId: courseSet.id, courseId: course.id})}}" class="js-delete-course">删除</a>
      				      </li>
      				      <li>
      				      	<a href="javascript:;" data-url="{{path('courseset_manage_course_publish', {courseSetId: courseSet.id, courseId: course.id})}}" class="js-publish-course">发布</a><!-- 已发布的不能删除，可关闭 -->
      				      </li>
                    {% endif %}
		                </ul>
		            </div>
      			</td>
      		</tr>
      		{% endfor %}
      	</tbody>
      </table>
  </div>
</div>
{% endblock %}